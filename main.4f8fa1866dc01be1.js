(self.webpackChunkiplocalize=self.webpackChunkiplocalize||[]).push([[179],{889:(Bd,Ma,qt)=>{"use strict";function pn(n){return"function"==typeof n}function Oc(n){const t=n(i=>{Error.call(i),i.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const Fn=Oc(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((i,s)=>`${s+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function f(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Ke{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const u of t)u.remove(this);else t.remove(this);const{initialTeardown:i}=this;if(pn(i))try{i()}catch(u){e=u instanceof Fn?u.errors:[u]}const{_finalizers:s}=this;if(s){this._finalizers=null;for(const u of s)try{$t(u)}catch(p){e=e??[],p instanceof Fn?e=[...e,...p.errors]:e.push(p)}}if(e)throw new Fn(e)}}add(e){var t;if(e&&e!==this)if(this.closed)$t(e);else{if(e instanceof Ke){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&f(t,e)}remove(e){const{_finalizers:t}=this;t&&f(t,e),e instanceof Ke&&e._removeParent(this)}}Ke.EMPTY=(()=>{const n=new Ke;return n.closed=!0,n})();const je=Ke.EMPTY;function Xo(n){return n instanceof Ke||n&&"closed"in n&&pn(n.remove)&&pn(n.add)&&pn(n.unsubscribe)}function $t(n){pn(n)?n():n.unsubscribe()}const Wt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},zi={setTimeout(n,e,...t){const{delegate:i}=zi;return i?.setTimeout?i.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=zi;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function si(n){zi.setTimeout(()=>{const{onUnhandledError:e}=Wt;if(!e)throw n;e(n)})}function er(){}const ds=Er("C",void 0,void 0);function Er(n,e,t){return{kind:n,value:e,error:t}}let Qr=null;function ur(n){if(Wt.useDeprecatedSynchronousErrorHandling){const e=!Qr;if(e&&(Qr={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:i}=Qr;if(Qr=null,t)throw i}}else n()}class ki extends Ke{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Xo(e)&&e.add(this)):this.destination=ec}static create(e,t,i){return new Ko(e,t,i)}next(e){this.isStopped?ra(function _l(n){return Er("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?ra(function Ql(n){return Er("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?ra(ds,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const zr=Function.prototype.bind;function ct(n,e){return zr.call(n,e)}class ti{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(i){cn(i)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(i){cn(i)}else cn(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){cn(t)}}}class Ko extends ki{constructor(e,t,i){let s;if(super(),pn(e)||!e)s={next:e??void 0,error:t??void 0,complete:i??void 0};else{let u;this&&Wt.useDeprecatedNextContext?(u=Object.create(e),u.unsubscribe=()=>this.unsubscribe(),s={next:e.next&&ct(e.next,u),error:e.error&&ct(e.error,u),complete:e.complete&&ct(e.complete,u)}):s=e}this.destination=new ti(s)}}function cn(n){Wt.useDeprecatedSynchronousErrorHandling?function As(n){Wt.useDeprecatedSynchronousErrorHandling&&Qr&&(Qr.errorThrown=!0,Qr.error=n)}(n):si(n)}function ra(n,e){const{onStoppedNotification:t}=Wt;t&&zi.setTimeout(()=>t(n,e))}const ec={closed:!0,next:er,error:function tr(n){throw n},complete:er},Is="function"==typeof Symbol&&Symbol.observable||"@@observable";function eo(n){return n}function yo(n){return 0===n.length?eo:1===n.length?n[0]:function(t){return n.reduce((i,s)=>s(i),t)}}let Lt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const i=new n;return i.source=this,i.operator=t,i}subscribe(t,i,s){const u=function Ei(n){return n&&n instanceof ki||function vo(n){return n&&pn(n.next)&&pn(n.error)&&pn(n.complete)}(n)&&Xo(n)}(t)?t:new Ko(t,i,s);return ur(()=>{const{operator:p,source:v}=this;u.add(p?p.call(u,v):v?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(t){try{return this._subscribe(t)}catch(i){t.error(i)}}forEach(t,i){return new(i=nr(i))((s,u)=>{const p=new Ko({next:v=>{try{t(v)}catch(C){u(C),p.unsubscribe()}},error:u,complete:s});this.subscribe(p)})}_subscribe(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)}[Is](){return this}pipe(...t){return yo(t)(this)}toPromise(t){return new(t=nr(t))((i,s)=>{let u;this.subscribe(p=>u=p,p=>s(p),()=>i(u))})}}return n.create=e=>new n(e),n})();function nr(n){var e;return null!==(e=n??Wt.Promise)&&void 0!==e?e:Promise}const Ps=Oc(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let mn=(()=>{class n extends Lt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const i=new Yo(this,this);return i.operator=t,i}_throwIfClosed(){if(this.closed)throw new Ps}next(t){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(t)}})}error(t){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:i}=this;for(;i.length;)i.shift().error(t)}})}complete(){ur(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:i,isStopped:s,observers:u}=this;return i||s?je:(this.currentObservers=null,u.push(t),new Ke(()=>{this.currentObservers=null,f(u,t)}))}_checkFinalizedStatuses(t){const{hasError:i,thrownError:s,isStopped:u}=this;i?t.error(s):u&&t.complete()}asObservable(){const t=new Lt;return t.source=this,t}}return n.create=(e,t)=>new Yo(e,t),n})();class Yo extends mn{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===i||i.call(t,e)}error(e){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===i||i.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,i;return null!==(i=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==i?i:je}}function fs(n){return pn(n?.lift)}function ni(n){return e=>{if(fs(e))return e.lift(function(t){try{return n(t,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Ln(n,e,t,i,s){return new ks(n,e,t,i,s)}class ks extends ki{constructor(e,t,i,s,u,p){super(e),this.onFinalize=u,this.shouldUnsubscribe=p,this._next=t?function(v){try{t(v)}catch(C){e.error(C)}}:super._next,this._error=s?function(v){try{s(v)}catch(C){e.error(C)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(v){e.error(v)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function gt(n,e){return ni((t,i)=>{let s=0;t.subscribe(Ln(i,u=>{i.next(n.call(e,u,s++))}))})}function Vo(n){return this instanceof Vo?(this.v=n,this):new Vo(n)}function la(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,e=n[Symbol.asyncIterator];return e?e.call(n):(n=function yi(n){var e="function"==typeof Symbol&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&"number"==typeof n.length)return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(u){t[u]=n[u]&&function(p){return new Promise(function(v,C){!function s(u,p,v,C){Promise.resolve(C).then(function(M){u({value:M,done:v})},p)}(v,C,(p=n[u](p)).done,p.value)})}}}const xe=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Te(n){return pn(n?.then)}function Se(n){return pn(n[Is])}function be(n){return Symbol.asyncIterator&&pn(n?.[Symbol.asyncIterator])}function Oe(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const ut=function st(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function ot(n){return pn(n?.[ut])}function Ht(n){return function Fs(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,i=t.apply(n,e||[]),u=[];return s={},p("next"),p("throw"),p("return"),s[Symbol.asyncIterator]=function(){return this},s;function p(Q){i[Q]&&(s[Q]=function(se){return new Promise(function(fe,Ee){u.push([Q,se,fe,Ee])>1||v(Q,se)})})}function v(Q,se){try{!function C(Q){Q.value instanceof Vo?Promise.resolve(Q.value.v).then(M,O):U(u[0][2],Q)}(i[Q](se))}catch(fe){U(u[0][3],fe)}}function M(Q){v("next",Q)}function O(Q){v("throw",Q)}function U(Q,se){Q(se),u.shift(),u.length&&v(u[0][0],u[0][1])}}(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:i,done:s}=yield Vo(t.read());if(s)return yield Vo(void 0);yield yield Vo(i)}}finally{t.releaseLock()}})}function nn(n){return pn(n?.getReader)}function It(n){if(n instanceof Lt)return n;if(null!=n){if(Se(n))return function ln(n){return new Lt(e=>{const t=n[Is]();if(pn(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(xe(n))return function _n(n){return new Lt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Te(n))return function Di(n){return new Lt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,si)})}(n);if(be(n))return mr(n);if(ot(n))return function ji(n){return new Lt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(nn(n))return function Xi(n){return mr(Ht(n))}(n)}throw Oe(n)}function mr(n){return new Lt(e=>{(function Uo(n,e){var t,i,s,u;return function Ci(n,e,t,i){return new(t||(t=Promise))(function(u,p){function v(O){try{M(i.next(O))}catch(U){p(U)}}function C(O){try{M(i.throw(O))}catch(U){p(U)}}function M(O){O.done?u(O.value):function s(u){return u instanceof t?u:new t(function(p){p(u)})}(O.value).then(v,C)}M((i=i.apply(n,e||[])).next())})}(this,void 0,void 0,function*(){try{for(t=la(n);!(i=yield t.next()).done;)if(e.next(i.value),e.closed)return}catch(p){s={error:p}}finally{try{i&&!i.done&&(u=t.return)&&(yield u.call(t))}finally{if(s)throw s.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function Qn(n,e,t,i=0,s=!1){const u=e.schedule(function(){t(),s?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(u),!s)return u}function pi(n,e,t=1/0){return pn(e)?pi((i,s)=>gt((u,p)=>e(i,u,s,p))(It(n(i,s))),t):("number"==typeof e&&(t=e),ni((i,s)=>function Cr(n,e,t,i,s,u,p,v){const C=[];let M=0,O=0,U=!1;const Q=()=>{U&&!C.length&&!M&&e.complete()},se=Ee=>M<i?fe(Ee):C.push(Ee),fe=Ee=>{u&&e.next(Ee),M++;let Be=!1;It(t(Ee,O++)).subscribe(Ln(e,Xe=>{s?.(Xe),u?se(Xe):e.next(Xe)},()=>{Be=!0},void 0,()=>{if(Be)try{for(M--;C.length&&M<i;){const Xe=C.shift();p?Qn(e,p,()=>fe(Xe)):fe(Xe)}Q()}catch(Xe){e.error(Xe)}}))};return n.subscribe(Ln(e,se,()=>{U=!0,Q()})),()=>{v?.()}}(i,s,n,t)))}function ir(n=1/0){return pi(eo,n)}const Qo=new Lt(n=>n.complete());function ka(n){return n&&pn(n.schedule)}function nc(n){return n[n.length-1]}function ic(n){return pn(nc(n))?n.pop():void 0}function no(n){return ka(nc(n))?n.pop():void 0}function Lc(n,e=0){return ni((t,i)=>{t.subscribe(Ln(i,s=>Qn(i,n,()=>i.next(s),e),()=>Qn(i,n,()=>i.complete(),e),s=>Qn(i,n,()=>i.error(s),e)))})}function rc(n,e=0){return ni((t,i)=>{i.add(n.schedule(()=>t.subscribe(i),e))})}function ms(n,e){if(!n)throw new Error("Iterable cannot be null");return new Lt(t=>{Qn(t,e,()=>{const i=n[Symbol.asyncIterator]();Qn(t,e,()=>{i.next().then(s=>{s.done?t.complete():t.next(s.value)})},0,!0)})})}function Li(n,e){return e?function hr(n,e){if(null!=n){if(Se(n))return function Ra(n,e){return It(n).pipe(rc(e),Lc(e))}(n,e);if(xe(n))return function oc(n,e){return new Lt(t=>{let i=0;return e.schedule(function(){i===n.length?t.complete():(t.next(n[i++]),t.closed||this.schedule())})})}(n,e);if(Te(n))return function Ls(n,e){return It(n).pipe(rc(e),Lc(e))}(n,e);if(be(n))return ms(n,e);if(ot(n))return function Ue(n,e){return new Lt(t=>{let i;return Qn(t,e,()=>{i=n[ut](),Qn(t,e,()=>{let s,u;try{({value:s,done:u}=i.next())}catch(p){return void t.error(p)}u?t.complete():t.next(s)},0,!0)}),()=>pn(i?.return)&&i.return()})}(n,e);if(nn(n))return function $i(n,e){return ms(Ht(n),e)}(n,e)}throw Oe(n)}(n,e):It(n)}function io(...n){const e=no(n),t=function ps(n,e){return"number"==typeof nc(n)?n.pop():e}(n,1/0),i=n;return i.length?1===i.length?It(i[0]):ir(t)(Li(i,e)):Qo}function Bc(n,e,...t){if(!0===e)return void n();if(!1===e)return;const i=new Ko({next:()=>{i.unsubscribe(),n()}});return e(...t).subscribe(i)}function $n(n){for(let e in n)if(n[e]===$n)return e;throw Error("Could not find renamed property on target object.")}function ht(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function Dt(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Dt).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function rn(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Vr=$n({__forward_ref__:$n});function wn(n){return n.__forward_ref__=wn,n.toString=function(){return Dt(this())},n}function dt(n){return Ur(n)?n():n}function Ur(n){return"function"==typeof n&&n.hasOwnProperty(Vr)&&n.__forward_ref__===wn}function Oa(n){return n&&!!n.\u0275providers}const wo="https://g.co/ng/security#xss";class Le extends Error{constructor(e,t){super(Ns(e,t)),this.code=e}}function Ns(n,e){return`NG0${Math.abs(n)}${e?": "+e.trim():""}`}function Vt(n){return"string"==typeof n?n:null==n?"":String(n)}function ca(n,e){throw new Le(-201,!1)}function oo(n,e){null==n&&function Sn(n,e,t,i){throw new Error(`ASSERTION ERROR: ${n}`+(null==i?"":` [Expected=> ${t} ${i} ${e} <=Actual]`))}(e,n,null,"!=")}function pt(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function mi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Vc(n){return Na(n,_s)||Na(n,Ba)}function Na(n,e){return n.hasOwnProperty(e)?n[e]:null}function Uc(n){return n&&(n.hasOwnProperty(Co)||n.hasOwnProperty(zs))?n[Co]:null}const _s=$n({\u0275prov:$n}),Co=$n({\u0275inj:$n}),Ba=$n({ngInjectableDef:$n}),zs=$n({ngInjectorDef:$n});var Bt=(()=>((Bt=Bt||{})[Bt.Default=0]="Default",Bt[Bt.Host=1]="Host",Bt[Bt.Self=2]="Self",Bt[Bt.SkipSelf=4]="SkipSelf",Bt[Bt.Optional=8]="Optional",Bt))();let ha;function Do(n){const e=ha;return ha=n,e}function za(n,e,t){const i=Vc(n);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:t&Bt.Optional?null:void 0!==e?e:void ca(Dt(n))}const ai=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),da={},sc="__NG_DI_FLAG__",Ua="ngTempTokenPath",Su="ngTokenPath",jc=/\n/gm,ja="\u0275",Cl="__source";let ts;function jr(n){const e=ts;return ts=n,e}function jo(n,e=Bt.Default){if(void 0===ts)throw new Le(-203,!1);return null===ts?za(n,void 0,e):ts.get(n,e&Bt.Optional?null:void 0,e)}function ze(n,e=Bt.Default){return(function El(){return ha}()||jo)(dt(n),e)}function Zt(n,e=Bt.Default){return ze(n,$a(e))}function $a(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function Dl(n){const e=[];for(let t=0;t<n.length;t++){const i=dt(n[t]);if(Array.isArray(i)){if(0===i.length)throw new Le(900,!1);let s,u=Bt.Default;for(let p=0;p<i.length;p++){const v=i[p],C=$c(v);"number"==typeof C?-1===C?s=v.token:u|=C:s=v}e.push(ze(s,u))}else e.push(ze(i))}return e}function Vs(n,e){return n[sc]=e,n.prototype[sc]=e,n}function $c(n){return n[sc]}function To(n){return{toString:n}.toString()}var $o=(()=>(($o=$o||{})[$o.OnPush=0]="OnPush",$o[$o.Default=1]="Default",$o))(),So=(()=>{return(n=So||(So={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",So;var n})();const ns={},Cn=[],Ha=$n({\u0275cmp:$n}),ac=$n({\u0275dir:$n}),Iu=$n({\u0275pipe:$n}),Dh=$n({\u0275mod:$n}),is=$n({\u0275fac:$n}),Ga=$n({__NG_ELEMENT_ID__:$n});let Tl=0;function Mo(n){return To(()=>{const e=lc(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===$o.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,data:n.data||{},encapsulation:n.encapsulation||So.Emulated,id:"c"+Tl++,styles:n.styles||Cn,_:null,schemas:n.schemas||null,tView:null};Gc(t);const i=n.dependencies;return t.directiveDefs=Ml(i,!1),t.pipeDefs=Ml(i,!0),t})}function Sh(n){return yn(n)||Ki(n)}function zd(n){return null!==n}function li(n){return To(()=>({type:n.type,bootstrap:n.bootstrap||Cn,declarations:n.declarations||Cn,imports:n.imports||Cn,exports:n.exports||Cn,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Hc(n,e){if(null==n)return ns;const t={};for(const i in n)if(n.hasOwnProperty(i)){let s=n[i],u=s;Array.isArray(s)&&(u=s[1],s=s[0]),t[s]=i,e&&(e[s]=u)}return t}function Nt(n){return To(()=>{const e=lc(n);return Gc(e),e})}function Tr(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function yn(n){return n[Ha]||null}function Ki(n){return n[ac]||null}function Sr(n){return n[Iu]||null}function so(n,e){const t=n[Dh]||null;if(!t&&!0===e)throw new Error(`Type ${Dt(n)} does not have '\u0275mod' property.`);return t}function lc(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,exportAs:n.exportAs||null,standalone:!0===n.standalone,selectors:n.selectors||Cn,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Hc(n.inputs,e),outputs:Hc(n.outputs)}}function Gc(n){n.features?.forEach(e=>e(n))}function Ml(n,e){if(!n)return null;const t=e?Sr:Sh;return()=>("function"==typeof n?n():n).map(i=>t(i)).filter(zd)}const Ho=0,Et=1,dn=2,Ti=3,rs=4,js=5,_r=6,ys=7,Ni=8,qa=9,cc=10,on=11,Pu=12,os=13,ku=14,Al=15,yr=16,Il=17,$s=18,$r=19,Wa=20,Ru=21,Bn=22,Ai=1,vi=2,uc=7,vs=8,ss=9,dr=10;function Xt(n){return Array.isArray(n)&&"object"==typeof n[Ai]}function Hr(n){return Array.isArray(n)&&!0===n[Ai]}function Za(n){return 0!=(4&n.flags)}function R(n){return n.componentOffset>-1}function F(n){return 1==(1&n.flags)}function G(n){return!!n.template}function de(n){return 0!=(256&n[dn])}function kl(n,e){return n.hasOwnProperty(is)?n[is]:null}class Ph{constructor(e,t,i){this.previousValue=e,this.currentValue=t,this.firstChange=i}isFirstChange(){return this.firstChange}}function Mr(){return kh}function kh(n){return n.type.prototype.ngOnChanges&&(n.setInput=Zf),Fm}function Fm(){const n=Rh(this),e=n?.current;if(e){const t=n.previous;if(t===ns)n.previous=e;else for(let i in e)t[i]=e[i];n.current=null,this.ngOnChanges(e)}}function Zf(n,e,t,i){const s=this.declaredInputs[t],u=Rh(n)||function Hd(n,e){return n[hc]=e}(n,{previous:ns,current:null}),p=u.current||(u.current={}),v=u.previous,C=v[s];p[s]=new Ph(C&&C.currentValue,e,v===ns),n[i]=e}Mr.ngInherit=!0;const hc="__ngSimpleChanges__";function Rh(n){return n[hc]||null}const ao=function(n,e,t){};function Ar(n){for(;Array.isArray(n);)n=n[Ho];return n}function Nu(n,e){return Ar(e[n])}function fr(n,e){return Ar(e[n.index])}function qd(n,e){return n.data[e]}function Zc(n,e){return n[e]}function Ao(n,e){const t=e[n];return Xt(t)?t:t[Ho]}function Bu(n){return 64==(64&n[dn])}function Hi(n,e){return null==e?null:n[e]}function Yf(n){n[$s]=0}function Lh(n,e){n[js]+=e;let t=n,i=n[Ti];for(;null!==i&&(1===e&&1===t[js]||-1===e&&0===t[js]);)i[js]+=e,t=i,i=i[Ti]}const fn={lFrame:X(null),bindingsEnabled:!0};function qs(){return fn.bindingsEnabled}function De(){return fn.lFrame.lView}function Rn(){return fn.lFrame.tView}function Gi(){let n=yt();for(;null!==n&&64===n.type;)n=n.parent;return n}function yt(){return fn.lFrame.currentTNode}function pa(n,e){const t=fn.lFrame;t.currentTNode=n,t.isParent=e}function Bh(){return fn.lFrame.isParent}function zu(){fn.lFrame.isParent=!1}function Io(){const n=fn.lFrame;let e=n.bindingRootIndex;return-1===e&&(e=n.bindingRootIndex=n.tView.bindingStartIndex),e}function Rl(){return fn.lFrame.bindingIndex++}function Go(n){const e=fn.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function h(n,e){const t=fn.lFrame;t.bindingIndex=t.bindingRootIndex=n,x(e)}function x(n){fn.lFrame.currentDirectiveIndex=n}function T(){return fn.lFrame.currentQueryIndex}function S(n){fn.lFrame.currentQueryIndex=n}function P(n){const e=n[Et];return 2===e.type?e.declTNode:1===e.type?n[_r]:null}function B(n,e,t){if(t&Bt.SkipSelf){let s=e,u=n;for(;!(s=s.parent,null!==s||t&Bt.Host||(s=P(u),null===s||(u=u[Al],10&s.type))););if(null===s)return!1;e=s,n=u}const i=fn.lFrame=j();return i.currentTNode=e,i.lView=n,!0}function N(n){const e=j(),t=n[Et];fn.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function j(){const n=fn.lFrame,e=null===n?null:n.child;return null===e?X(n):e}function X(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function J(){const n=fn.lFrame;return fn.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const te=J;function ee(){const n=J();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function Y(){return fn.lFrame.selectedIndex}function ae(n){fn.lFrame.selectedIndex=n}function oe(){const n=fn.lFrame;return qd(n.tView,n.selectedIndex)}function tt(n,e){for(let t=e.directiveStart,i=e.directiveEnd;t<i;t++){const u=n.data[t].type.prototype,{ngAfterContentInit:p,ngAfterContentChecked:v,ngAfterViewInit:C,ngAfterViewChecked:M,ngOnDestroy:O}=u;p&&(n.contentHooks??(n.contentHooks=[])).push(-t,p),v&&((n.contentHooks??(n.contentHooks=[])).push(t,v),(n.contentCheckHooks??(n.contentCheckHooks=[])).push(t,v)),C&&(n.viewHooks??(n.viewHooks=[])).push(-t,C),M&&((n.viewHooks??(n.viewHooks=[])).push(t,M),(n.viewCheckHooks??(n.viewCheckHooks=[])).push(t,M)),null!=O&&(n.destroyHooks??(n.destroyHooks=[])).push(t,O)}}function Ie(n,e,t){nt(n,e,3,t)}function qe(n,e,t,i){(3&n[dn])===t&&nt(n,e,t,i)}function Fe(n,e){let t=n[dn];(3&t)===e&&(t&=2047,t+=1,n[dn]=t)}function nt(n,e,t,i){const u=i??-1,p=e.length-1;let v=0;for(let C=void 0!==i?65535&n[$s]:0;C<p;C++)if("number"==typeof e[C+1]){if(v=e[C],null!=i&&v>=i)break}else e[C]<0&&(n[$s]+=65536),(v<u||-1==u)&&(Pe(n,t,e,C),n[$s]=(4294901760&n[$s])+C+2),C++}function Pe(n,e,t,i){const s=t[i]<0,u=t[i+1],v=n[s?-t[i]:t[i]];if(s){if(n[dn]>>11<n[$s]>>16&&(3&n[dn])===e){n[dn]+=2048,ao(4,v,u);try{u.call(v)}finally{ao(5,v,u)}}}else{ao(4,v,u);try{u.call(v)}finally{ao(5,v,u)}}}const He=-1;class it{constructor(e,t,i){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=i}}function Ct(n,e,t){let i=0;for(;i<t.length;){const s=t[i];if("number"==typeof s){if(0!==s)break;i++;const u=t[i++],p=t[i++],v=t[i++];n.setAttribute(e,p,v,u)}else{const u=s,p=t[++i];ii(u)?n.setProperty(e,u,p):n.setAttribute(e,u,p),i++}}return i}function Gn(n){return 3===n||4===n||6===n}function ii(n){return 64===n.charCodeAt(0)}function qn(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let i=0;i<e.length;i++){const s=e[i];"number"==typeof s?t=s:0===t||ri(n,t,s,null,-1===t||2===t?e[++i]:null)}}return n}function ri(n,e,t,i,s){let u=0,p=n.length;if(-1===e)p=-1;else for(;u<n.length;){const v=n[u++];if("number"==typeof v){if(v===e){p=-1;break}if(v>e){p=u-1;break}}}for(;u<n.length;){const v=n[u];if("number"==typeof v)break;if(v===t){if(null===i)return void(null!==s&&(n[u+1]=s));if(i===n[u+1])return void(n[u+2]=s)}u++,null!==i&&u++,null!==s&&u++}-1!==p&&(n.splice(p,0,e),u=p+1),n.splice(u++,0,t),null!==i&&n.splice(u++,0,i),null!==s&&n.splice(u++,0,s)}function Gr(n){return n!==He}function rr(n){return 32767&n}function as(n,e){let t=function xs(n){return n>>16}(n),i=e;for(;t>0;)i=i[Al],t--;return i}let xi=!0;function Yn(n){const e=xi;return xi=n,e}const Yi=255,lo=5;let Si=0;const qi={};function ma(n,e){const t=ga(n,e);if(-1!==t)return t;const i=e[Et];i.firstCreatePass&&(n.injectorIndex=e.length,pc(i.data,n),pc(e,null),pc(i.blueprint,null));const s=_a(n,e),u=n.injectorIndex;if(Gr(s)){const p=rr(s),v=as(s,e),C=v[Et].data;for(let M=0;M<8;M++)e[u+M]=v[p+M]|C[p+M]}return e[u+8]=s,u}function pc(n,e){n.push(0,0,0,0,0,0,0,0,e)}function ga(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function _a(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,i=null,s=e;for(;null!==s;){if(i=Sy(s),null===i)return He;if(t++,s=s[Al],-1!==i.injectorIndex)return i.injectorIndex|t<<16}return He}function Ka(n,e,t){!function Vh(n,e,t){let i;"string"==typeof t?i=t.charCodeAt(0)||0:t.hasOwnProperty(Ga)&&(i=t[Ga]),null==i&&(i=t[Ga]=Si++);const s=i&Yi;e.data[n+(s>>lo)]|=1<<s}(n,e,t)}function Kc(n,e,t){if(t&Bt.Optional||void 0!==n)return n;ca()}function jh(n,e,t,i){if(t&Bt.Optional&&void 0===i&&(i=null),!(t&(Bt.Self|Bt.Host))){const s=n[qa],u=Do(void 0);try{return s?s.get(e,i,t&Bt.Optional):za(e,i,t&Bt.Optional)}finally{Do(u)}}return Kc(i,0,t)}function Bm(n,e,t,i=Bt.Default,s){if(null!==n){if(1024&e[dn]){const p=function eb(n,e,t,i,s){let u=n,p=e;for(;null!==u&&null!==p&&1024&p[dn]&&!(256&p[dn]);){const v=zm(u,p,t,i|Bt.Self,qi);if(v!==qi)return v;let C=u.parent;if(!C){const M=p[Ru];if(M){const O=M.get(t,qi,i);if(O!==qi)return O}C=Sy(p),p=p[Al]}u=C}return s}(n,e,t,i,qi);if(p!==qi)return p}const u=zm(n,e,t,i,qi);if(u!==qi)return u}return jh(e,t,i,s)}function zm(n,e,t,i,s){const u=function Ty(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Ga)?n[Ga]:void 0;return"number"==typeof e?e>=0?e&Yi:ip:e}(t);if("function"==typeof u){if(!B(e,n,i))return i&Bt.Host?Kc(s,0,i):jh(e,t,i,s);try{const p=u(i);if(null!=p||i&Bt.Optional)return p;ca()}finally{te()}}else if("number"==typeof u){let p=null,v=ga(n,e),C=He,M=i&Bt.Host?e[yr][_r]:null;for((-1===v||i&Bt.SkipSelf)&&(C=-1===v?_a(n,e):e[v+8],C!==He&&Xd(i,!1)?(p=e[Et],v=rr(C),e=as(C,e)):v=-1);-1!==v;){const O=e[Et];if(np(u,v,O.data)){const U=Qx(v,e,t,p,i,M);if(U!==qi)return U}C=e[v+8],C!==He&&Xd(i,e[Et].data[v+8]===M)&&np(u,v,e)?(p=O,v=rr(C),e=as(C,e)):v=-1}}return s}function Qx(n,e,t,i,s,u){const p=e[Et],v=p.data[n+8],O=$h(v,p,t,null==i?R(v)&&xi:i!=p&&0!=(3&v.type),s&Bt.Host&&u===v);return null!==O?Ol(e,p,O,v):qi}function $h(n,e,t,i,s){const u=n.providerIndexes,p=e.data,v=1048575&u,C=n.directiveStart,O=u>>20,Q=s?v+O:n.directiveEnd;for(let se=i?v:v+O;se<Q;se++){const fe=p[se];if(se<C&&t===fe||se>=C&&fe.type===t)return se}if(s){const se=p[C];if(se&&G(se)&&se.type===t)return C}return null}function Ol(n,e,t,i){let s=n[t];const u=e.data;if(function Je(n){return n instanceof it}(s)){const p=s;p.resolving&&function bl(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new Le(-200,`Circular dependency in DI detected for ${n}${t}`)}(function An(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():Vt(n)}(u[t]));const v=Yn(p.canSeeViewProviders);p.resolving=!0;const C=p.injectImpl?Do(p.injectImpl):null;B(n,i,Bt.Default);try{s=n[t]=p.factory(void 0,u,n,i),e.firstCreatePass&&t>=i.directiveStart&&function ke(n,e,t){const{ngOnChanges:i,ngOnInit:s,ngDoCheck:u}=e.type.prototype;if(i){const p=kh(e);(t.preOrderHooks??(t.preOrderHooks=[])).push(n,p),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,p)}s&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-n,s),u&&((t.preOrderHooks??(t.preOrderHooks=[])).push(n,u),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(n,u))}(t,u[t],e)}finally{null!==C&&Do(C),Yn(v),p.resolving=!1,te()}}return s}function np(n,e,t){return!!(t[e+(n>>lo)]&1<<n)}function Xd(n,e){return!(n&Bt.Self||n&Bt.Host&&e)}class bs{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,i){return Bm(this._tNode,this._lView,e,$a(i),t)}}function ip(){return new bs(Gi(),De())}function co(n){return To(()=>{const e=n.prototype.constructor,t=e[is]||rp(e),i=Object.prototype;let s=Object.getPrototypeOf(n.prototype).constructor;for(;s&&s!==i;){const u=s[is]||rp(s);if(u&&u!==t)return u;s=Object.getPrototypeOf(s)}return u=>new u})}function rp(n){return Ur(n)?()=>{const e=rp(dt(n));return e&&e()}:kl(n)}function Sy(n){const e=n[Et],t=e.type;return 2===t?e.declTNode:1===t?n[_r]:null}const Fl="__parameters__";function Xs(n,e,t){return To(()=>{const i=function Zs(n){return function(...t){if(n){const i=n(...t);for(const s in i)this[s]=i[s]}}}(e);function s(...u){if(this instanceof s)return i.apply(this,u),this;const p=new s(...u);return v.annotation=p,v;function v(C,M,O){const U=C.hasOwnProperty(Fl)?C[Fl]:Object.defineProperty(C,Fl,{value:[]})[Fl];for(;U.length<=O;)U.push(null);return(U[O]=U[O]||[]).push(p),C}}return t&&(s.prototype=Object.create(t.prototype)),s.prototype.ngMetadataName=n,s.annotationCls=s,s})}class xt{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=pt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Po(n,e){n.forEach(t=>Array.isArray(t)?Po(t,e):e(t))}function sp(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function Bl(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function mc(n,e){const t=[];for(let i=0;i<n;i++)t.push(e);return t}function ws(n,e,t){let i=Jc(n,e);return i>=0?n[1|i]=t:(i=~i,function ap(n,e,t,i){let s=n.length;if(s==e)n.push(t,i);else if(1===s)n.push(i,n[0]),n[0]=t;else{for(s--,n.push(n[s-1],n[s]);s>e;)n[s]=n[s-2],s--;n[e]=t,n[e+1]=i}}(n,i,e,t)),i}function Vm(n,e){const t=Jc(n,e);if(t>=0)return n[1|t]}function Jc(n,e){return function Gh(n,e,t){let i=0,s=n.length>>t;for(;s!==i;){const u=i+(s-i>>1),p=n[u<<t];if(e===p)return u<<t;p>e?s=u:i=u+1}return~(s<<t)}(n,e,1)}const qr=Vs(Xs("Inject",n=>({token:n})),-1),ko=Vs(Xs("Optional"),8),Pi=Vs(Xs("SkipSelf"),4);var Wr=(()=>((Wr=Wr||{})[Wr.Important=1]="Important",Wr[Wr.DashCase=2]="DashCase",Wr))();const qu=new Map;let Xm=0;const pp="__ngContext__";function or(n,e){Xt(e)?(n[pp]=e[Wa],function Yh(n){qu.set(n[Wa],n)}(e)):n[pp]=e}let nf;function gp(n,e){return nf(n,e)}function rf(n){const e=n[Ti];return Hr(e)?e[Ti]:e}function tg(n){return eu(n[os])}function tl(n){return eu(n[rs])}function eu(n){for(;null!==n&&!Hr(n);)n=n[rs];return n}function vc(n,e,t,i,s){if(null!=i){let u,p=!1;Hr(i)?u=i:Xt(i)&&(p=!0,i=i[Ho]);const v=Ar(i);0===n&&null!==t?null==s?Xy(e,t,v):Wu(e,t,v,s||null,!0):1===n&&null!==t?Wu(e,t,v,s||null,!0):2===n?function mg(n,e,t){const i=vp(n,e);i&&function hb(n,e,t,i){n.removeChild(e,t,i)}(n,i,e,t)}(e,v,p):3===n&&e.destroyNode(v),null!=u&&function Xu(n,e,t,i,s){const u=t[uc];u!==Ar(t)&&vc(e,n,i,u,s);for(let v=dr;v<t.length;v++){const C=t[v];Zu(C[Et],C,n,e,i,u)}}(e,n,u,t,s)}}function ng(n,e,t){return n.createElement(e,t)}function og(n,e){const t=n[ss],i=t.indexOf(e),s=e[Ti];512&e[dn]&&(e[dn]&=-513,Lh(s,-1)),t.splice(i,1)}function xc(n,e){if(n.length<=dr)return;const t=dr+e,i=n[t];if(i){const s=i[Il];null!==s&&s!==n&&og(s,i),e>0&&(n[t-1][rs]=i[rs]);const u=Bl(n,dr+e);!function Wy(n,e){Zu(n,e,e[on],2,null,null),e[Ho]=null,e[_r]=null}(i[Et],i);const p=u[$r];null!==p&&p.detachView(u[Et]),i[Ti]=null,i[rs]=null,i[dn]&=-65}return i}function sg(n,e){if(!(128&e[dn])){const t=e[on];t.destroyNode&&Zu(n,e,t,3,null,null),function ub(n){let e=n[os];if(!e)return ag(n[Et],n);for(;e;){let t=null;if(Xt(e))t=e[os];else{const i=e[dr];i&&(t=i)}if(!t){for(;e&&!e[rs]&&e!==n;)Xt(e)&&ag(e[Et],e),e=e[Ti];null===e&&(e=n),Xt(e)&&ag(e[Et],e),t=e&&e[rs]}e=t}}(e)}}function ag(n,e){if(!(128&e[dn])){e[dn]&=-65,e[dn]|=128,function yp(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let i=0;i<t.length;i+=2){const s=e[t[i]];if(!(s instanceof it)){const u=t[i+1];if(Array.isArray(u))for(let p=0;p<u.length;p+=2){const v=s[u[p]],C=u[p+1];ao(4,v,C);try{C.call(v)}finally{ao(5,v,C)}}else{ao(4,s,u);try{u.call(s)}finally{ao(5,s,u)}}}}}(n,e),function td(n,e){const t=n.cleanup,i=e[ys];let s=-1;if(null!==t)for(let u=0;u<t.length-1;u+=2)if("string"==typeof t[u]){const p=t[u+3];p>=0?i[s=p]():i[s=-p].unsubscribe(),u+=2}else{const p=i[s=t[u+1]];t[u].call(p)}if(null!==i){for(let u=s+1;u<i.length;u++)(0,i[u])();e[ys]=null}}(n,e),1===e[Et].type&&e[on].destroy();const t=e[Il];if(null!==t&&Hr(e[Ti])){t!==e[Ti]&&og(t,e);const i=e[$r];null!==i&&i.detachView(n)}!function Ym(n){qu.delete(n[Wa])}(e)}}function lg(n,e,t){return function cg(n,e,t){let i=e;for(;null!==i&&40&i.type;)i=(e=i).parent;if(null===i)return t[Ho];{const{componentOffset:s}=i;if(s>-1){const{encapsulation:u}=n.data[i.directiveStart+s];if(u===So.None||u===So.Emulated)return null}return fr(i,t)}}(n,e.parent,t)}function Wu(n,e,t,i,s){n.insertBefore(e,t,i,s)}function Xy(n,e,t){n.appendChild(e,t)}function ug(n,e,t,i,s){null!==i?Wu(n,e,t,i,s):Xy(n,e,t)}function vp(n,e){return n.parentNode(e)}function hg(n,e,t){return fg(n,e,t)}let sf,xg,cf,fg=function dg(n,e,t){return 40&n.type?fr(n,t):null};function Oo(n,e,t,i){const s=lg(n,i,e),u=e[on],v=hg(i.parent||e[_r],i,e);if(null!=s)if(Array.isArray(t))for(let C=0;C<t.length;C++)ug(u,s,t[C],v,!1);else ug(u,s,t,v,!1);void 0!==sf&&sf(u,i,e,t,s)}function xp(n,e){if(null!==e){const t=e.type;if(3&t)return fr(e,n);if(4&t)return pg(-1,n[e.index]);if(8&t){const i=e.child;if(null!==i)return xp(n,i);{const s=n[e.index];return Hr(s)?pg(-1,s):Ar(s)}}if(32&t)return gp(e,n)()||Ar(n[e.index]);{const i=bp(n,e);return null!==i?Array.isArray(i)?i[0]:xp(rf(n[yr]),i):xp(n,e.next)}}return null}function bp(n,e){return null!==e?n[yr][_r].projection[e.projection]:null}function pg(n,e){const t=dr+n+1;if(t<e.length){const i=e[t],s=i[Et].firstChild;if(null!==s)return xp(i,s)}return e[uc]}function gg(n,e,t,i,s,u,p){for(;null!=t;){const v=i[t.index],C=t.type;if(p&&0===e&&(v&&or(Ar(v),i),t.flags|=2),32!=(32&t.flags))if(8&C)gg(n,e,t.child,i,s,u,!1),vc(e,n,s,v,u);else if(32&C){const M=gp(t,i);let O;for(;O=M();)vc(e,n,s,O,u);vc(e,n,s,v,u)}else 16&C?_g(n,e,i,t,s,u):vc(e,n,s,v,u);t=p?t.projectionNext:t.next}}function Zu(n,e,t,i,s,u){gg(t,i,n.firstChild,e,s,u,!1)}function _g(n,e,t,i,s,u){const p=t[yr],C=p[_r].projection[i.projection];if(Array.isArray(C))for(let M=0;M<C.length;M++)vc(e,n,s,C[M],u);else gg(n,e,C,p[Ti],s,u,!0)}function Ky(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Yy(n,e,t){const{mergedAttrs:i,classes:s,styles:u}=t;null!==i&&Ct(n,e,i),null!==s&&Ky(n,e,s),null!==u&&function pb(n,e,t){n.setAttribute(e,"style",t)}(n,e,u)}function bg(n){return function rd(){if(void 0===cf&&(cf=null,ai.trustedTypes))try{cf=ai.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return cf}()?.createScriptURL(n)||n}class wg{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${wo})`}}function bc(n){return n instanceof wg?n.changingThisBreaksApplicationSecurity:n}function wc(n,e){const t=function _b(n){return n instanceof wg&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${wo})`)}return t===e}const bb=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var Ir=(()=>((Ir=Ir||{})[Ir.NONE=0]="NONE",Ir[Ir.HTML=1]="HTML",Ir[Ir.STYLE=2]="STYLE",Ir[Ir.SCRIPT=3]="SCRIPT",Ir[Ir.URL=4]="URL",Ir[Ir.RESOURCE_URL=5]="RESOURCE_URL",Ir))();function Mp(n){const e=Pr();return e?e.sanitize(Ir.URL,n)||"":wc(n,"URL")?bc(n):function Sg(n){return(n=String(n)).match(bb)?n:"unsafe:"+n}(Vt(n))}function Ig(n){const e=Pr();if(e)return bg(e.sanitize(Ir.RESOURCE_URL,n)||"");if(wc(n,"ResourceURL"))return bg(bc(n));throw new Le(904,!1)}function Pr(){const n=De();return n&&n[Pu]}const nu=new xt("ENVIRONMENT_INITIALIZER"),Ju=new xt("INJECTOR",-1),ad=new xt("INJECTOR_DEF_TYPES");class Rg{get(e,t=da){if(t===da){const i=new Error(`NullInjectorError: No provider for ${Dt(e)}!`);throw i.name="NullInjectorError",i}return t}}function Mb(...n){return{\u0275providers:uv(0,n),\u0275fromNgModule:!0}}function uv(n,...e){const t=[],i=new Set;let s;return Po(e,u=>{const p=u;Og(p,t,[],i)&&(s||(s=[]),s.push(p))}),void 0!==s&&hv(s,t),t}function hv(n,e){for(let t=0;t<n.length;t++){const{providers:s}=n[t];Fg(s,u=>{e.push(u)})}}function Og(n,e,t,i){if(!(n=dt(n)))return!1;let s=null,u=Uc(n);const p=!u&&yn(n);if(u||p){if(p&&!p.standalone)return!1;s=n}else{const C=n.ngModule;if(u=Uc(C),!u)return!1;s=C}const v=i.has(s);if(p){if(v)return!1;if(i.add(s),p.dependencies){const C="function"==typeof p.dependencies?p.dependencies():p.dependencies;for(const M of C)Og(M,e,t,i)}}else{if(!u)return!1;{if(null!=u.imports&&!v){let M;i.add(s);try{Po(u.imports,O=>{Og(O,e,t,i)&&(M||(M=[]),M.push(O))})}finally{}void 0!==M&&hv(M,e)}if(!v){const M=kl(s)||(()=>new s);e.push({provide:s,useFactory:M,deps:Cn},{provide:ad,useValue:s,multi:!0},{provide:nu,useValue:()=>ze(s),multi:!0})}const C=u.providers;null==C||v||Fg(C,O=>{e.push(O)})}}return s!==n&&void 0!==n.providers}function Fg(n,e){for(let t of n)Oa(t)&&(t=t.\u0275providers),Array.isArray(t)?Fg(t,e):e(t)}const Ap=$n({provide:String,useValue:$n});function Lg(n){return null!==n&&"object"==typeof n&&Ap in n}function iu(n){return"function"==typeof n}const zg=new xt("Set Injector scope."),Ip={},Ib={};let Vg;function ff(){return void 0===Vg&&(Vg=new Rg),Vg}class Ul{}class kr extends Ul{get destroyed(){return this._destroyed}constructor(e,t,i,s){super(),this.parent=t,this.source=i,this.scopes=s,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,jg(e,p=>this.processProvider(p)),this.records.set(Ju,ld(void 0,this)),s.has("environment")&&this.records.set(Ul,ld(void 0,this));const u=this.records.get(zg);null!=u&&"string"==typeof u.value&&this.scopes.add(u.value),this.injectorDefTypes=new Set(this.get(ad.multi,Cn,Bt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const e of this._ngOnDestroyHooks)e.ngOnDestroy();for(const e of this._onDestroyHooks)e()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(e){this._onDestroyHooks.push(e)}runInContext(e){this.assertNotDestroyed();const t=jr(this),i=Do(void 0);try{return e()}finally{jr(t),Do(i)}}get(e,t=da,i=Bt.Default){this.assertNotDestroyed(),i=$a(i);const s=jr(this),u=Do(void 0);try{if(!(i&Bt.SkipSelf)){let v=this.records.get(e);if(void 0===v){const C=function kb(n){return"function"==typeof n||"object"==typeof n&&n instanceof xt}(e)&&Vc(e);v=C&&this.injectableDefInScope(C)?ld(Js(e),Ip):null,this.records.set(e,v)}if(null!=v)return this.hydrate(e,v)}return(i&Bt.Self?ff():this.parent).get(e,t=i&Bt.Optional&&t===da?null:t)}catch(p){if("NullInjectorError"===p.name){if((p[Ua]=p[Ua]||[]).unshift(Dt(e)),s)throw p;return function Au(n,e,t,i){const s=n[Ua];throw e[Cl]&&s.unshift(e[Cl]),n.message=function En(n,e,t,i=null){n=n&&"\n"===n.charAt(0)&&n.charAt(1)==ja?n.slice(2):n;let s=Dt(e);if(Array.isArray(e))s=e.map(Dt).join(" -> ");else if("object"==typeof e){let u=[];for(let p in e)if(e.hasOwnProperty(p)){let v=e[p];u.push(p+":"+("string"==typeof v?JSON.stringify(v):Dt(v)))}s=`{${u.join(", ")}}`}return`${t}${i?"("+i+")":""}[${s}]: ${n.replace(jc,"\n  ")}`}("\n"+n.message,s,t,i),n[Su]=s,n[Ua]=null,n}(p,e,"R3InjectorError",this.source)}throw p}finally{Do(u),jr(s)}}resolveInjectorInitializers(){const e=jr(this),t=Do(void 0);try{const i=this.get(nu.multi,Cn,Bt.Self);for(const s of i)s()}finally{jr(e),Do(t)}}toString(){const e=[],t=this.records;for(const i of t.keys())e.push(Dt(i));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Le(205,!1)}processProvider(e){let t=iu(e=dt(e))?e:dt(e&&e.provide);const i=function Pp(n){return Lg(n)?ld(void 0,n.useValue):ld(Qu(n),Ip)}(e);if(iu(e)||!0!==e.multi)this.records.get(t);else{let s=this.records.get(t);s||(s=ld(void 0,Ip,!0),s.factory=()=>Dl(s.multi),this.records.set(t,s)),t=e,s.multi.push(e)}this.records.set(t,i)}hydrate(e,t){return t.value===Ip&&(t.value=Ib,t.value=t.factory()),"object"==typeof t.value&&t.value&&function pf(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=dt(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Js(n){const e=Vc(n),t=null!==e?e.factory:kl(n);if(null!==t)return t;if(n instanceof xt)throw new Le(204,!1);if(n instanceof Function)return function Ug(n){const e=n.length;if(e>0)throw mc(e,"?"),new Le(204,!1);const t=function gs(n){return n&&(n[_s]||n[Ba])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new Le(204,!1)}function Qu(n,e,t){let i;if(iu(n)){const s=dt(n);return kl(s)||Js(s)}if(Lg(n))i=()=>dt(n.useValue);else if(function Bg(n){return!(!n||!n.useFactory)}(n))i=()=>n.useFactory(...Dl(n.deps||[]));else if(function Ng(n){return!(!n||!n.useExisting)}(n))i=()=>ze(dt(n.useExisting));else{const s=dt(n&&(n.useClass||n.provide));if(!function Pb(n){return!!n.deps}(n))return kl(s)||Js(s);i=()=>new s(...Dl(n.deps))}return i}function ld(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function jg(n,e){for(const t of n)Array.isArray(t)?jg(t,e):t&&Oa(t)?jg(t.\u0275providers,e):e(t)}class dv{}class $g{}class mv{resolveComponentFactory(e){throw function fv(n){const e=Error(`No component factory found for ${Dt(n)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=n,e}(e)}}let ru=(()=>{class n{}return n.NULL=new mv,n})();function Ec(){return nl(Gi(),De())}function nl(n,e){return new ar(fr(n,e))}let ar=(()=>{class n{constructor(t){this.nativeElement=t}}return n.__NG_ELEMENT_ID__=Ec,n})();function Rb(n){return n instanceof ar?n.nativeElement:n}class mf{}let Cc=(()=>{class n{}return n.__NG_ELEMENT_ID__=()=>function Ob(){const n=De(),t=Ao(Gi().index,n);return(Xt(t)?t:n)[on]}(),n})(),Fb=(()=>{class n{}return n.\u0275prov=pt({token:n,providedIn:"root",factory:()=>null}),n})();class eh{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const Lb=new eh("15.2.9"),Hg={},Gg="ngOriginalError";function ou(n){return n[Gg]}class th{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&ou(e);for(;t&&ou(t);)t=ou(t);return t||null}}function il(n){return n instanceof Function?n():n}function gf(n,e,t){let i=n.length;for(;;){const s=n.indexOf(e,t);if(-1===s)return s;if(0===s||n.charCodeAt(s-1)<=32){const u=e.length;if(s+u===i||n.charCodeAt(s+u)<=32)return s}t=s+1}}const vv="ng-template";function xv(n,e,t){let i=0,s=!0;for(;i<n.length;){let u=n[i++];if("string"==typeof u&&s){const p=n[i++];if(t&&"class"===u&&-1!==gf(p.toLowerCase(),e,0))return!0}else{if(1===u){for(;i<n.length&&"string"==typeof(u=n[i++]);)if(u.toLowerCase()===e)return!0;return!1}"number"==typeof u&&(s=!1)}}return!1}function Zg(n){return 4===n.type&&n.value!==vv}function Ub(n,e,t){return e===(4!==n.type||t?n.value:vv)}function bv(n,e,t){let i=4;const s=n.attrs||[],u=function wv(n){for(let e=0;e<n.length;e++)if(Gn(n[e]))return e;return n.length}(s);let p=!1;for(let v=0;v<e.length;v++){const C=e[v];if("number"!=typeof C){if(!p)if(4&i){if(i=2|1&i,""!==C&&!Ub(n,C,t)||""===C&&1===e.length){if(ba(i))return!1;p=!0}}else{const M=8&i?C:e[++v];if(8&i&&null!==n.attrs){if(!xv(n.attrs,M,t)){if(ba(i))return!1;p=!0}continue}const U=Xg(8&i?"class":C,s,Zg(n),t);if(-1===U){if(ba(i))return!1;p=!0;continue}if(""!==M){let Q;Q=U>u?"":s[U+1].toLowerCase();const se=8&i?Q:null;if(se&&-1!==gf(se,M,0)||2&i&&M!==Q){if(ba(i))return!1;p=!0}}}}else{if(!p&&!ba(i)&&!ba(C))return!1;if(p&&ba(C))continue;p=!1,i=C|1&i}}return ba(i)||p}function ba(n){return 0==(1&n)}function Xg(n,e,t,i){if(null===e)return-1;let s=0;if(i||!t){let u=!1;for(;s<e.length;){const p=e[s];if(p===n)return s;if(3===p||6===p)u=!0;else{if(1===p||2===p){let v=e[++s];for(;"string"==typeof v;)v=e[++s];continue}if(4===p)break;if(0===p){s+=4;continue}}s+=u?1:2}return-1}return function Dc(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const i=n[t];if("number"==typeof i)return-1;if(i===e)return t;t++}return-1}(e,n)}function Kg(n,e,t=!1){for(let i=0;i<e.length;i++)if(bv(n,e[i],t))return!0;return!1}function Ev(n,e){e:for(let t=0;t<e.length;t++){const i=e[t];if(n.length===i.length){for(let s=0;s<n.length;s++)if(n[s]!==i[s])continue e;return!0}}return!1}function Yg(n,e){return n?":not("+e.trim()+")":e}function Cv(n){let e=n[0],t=1,i=2,s="",u=!1;for(;t<n.length;){let p=n[t];if("string"==typeof p)if(2&i){const v=n[++t];s+="["+p+(v.length>0?'="'+v+'"':"")+"]"}else 8&i?s+="."+p:4&i&&(s+=" "+p);else""!==s&&!ba(p)&&(e+=Yg(u,s),s=""),i=p,u=u||!ba(i);t++}return""!==s&&(e+=Yg(u,s)),e}const xn={};function qo(n){Jg(Rn(),De(),Y()+n,!1)}function Jg(n,e,t,i){if(!i)if(3==(3&e[dn])){const u=n.preOrderCheckHooks;null!==u&&Ie(e,u,t)}else{const u=n.preOrderHooks;null!==u&&qe(e,u,0,t)}ae(t)}function t_(n,e=null,t=null,i){const s=_f(n,e,t,i);return s.resolveInjectorInitializers(),s}function _f(n,e=null,t=null,i,s=new Set){const u=[t||Cn,Mb(n)];return i=i||("object"==typeof n?void 0:Dt(n)),new kr(u,e||ff(),i||null,s)}let Or=(()=>{class n{static create(t,i){if(Array.isArray(t))return t_({name:""},i,t,"");{const s=t.name??"";return t_({name:s},t.parent,t.providers,s)}}}return n.THROW_IF_NOT_FOUND=da,n.NULL=new Rg,n.\u0275prov=pt({token:n,providedIn:"any",factory:()=>ze(Ju)}),n.__NG_ELEMENT_ID__=-1,n})();function $e(n,e=Bt.Default){const t=De();return null===t?ze(n,e):Bm(Gi(),t,dt(n),e)}function lu(){throw new Error("invalid")}function Ov(n,e){const t=n.contentQueries;if(null!==t)for(let i=0;i<t.length;i+=2){const u=t[i+1];if(-1!==u){const p=n.data[u];S(t[i]),p.contentQueries(2,e[u],u)}}}function zp(n,e,t,i,s,u,p,v,C,M,O){const U=e.blueprint.slice();return U[Ho]=s,U[dn]=76|i,(null!==O||n&&1024&n[dn])&&(U[dn]|=1024),Yf(U),U[Ti]=U[Al]=n,U[Ni]=t,U[cc]=p||n&&n[cc],U[on]=v||n&&n[on],U[Pu]=C||n&&n[Pu]||null,U[qa]=M||n&&n[qa]||null,U[_r]=u,U[Wa]=function Uy(){return Xm++}(),U[Ru]=O,U[yr]=2==e.type?n[yr]:U,U}function ah(n,e,t,i,s){let u=n.data[e];if(null===u)u=function a_(n,e,t,i,s){const u=yt(),p=Bh(),C=n.data[e]=function Kb(n,e,t,i,s,u){return{type:t,index:i,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:s,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,p?u:u&&u.parent,t,e,i,s);return null===n.firstChild&&(n.firstChild=C),null!==u&&(p?null==u.child&&null!==C.parent&&(u.child=C):null===u.next&&(u.next=C,C.prev=u)),C}(n,e,t,i,s),function m(){return fn.lFrame.inI18n}()&&(u.flags|=32);else if(64&u.type){u.type=t,u.value=i,u.attrs=s;const p=function fc(){const n=fn.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();u.injectorIndex=null===p?-1:p.injectorIndex}return pa(u,!0),u}function fd(n,e,t,i){if(0===t)return-1;const s=e.length;for(let u=0;u<t;u++)e.push(i),n.blueprint.push(i),n.data.push(null);return s}function l_(n,e,t){N(e);try{const i=n.viewQuery;null!==i&&_d(1,i,t);const s=n.template;null!==s&&Nv(n,e,s,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&Ov(n,e),n.staticViewQueries&&_d(2,n.viewQuery,t);const u=n.components;null!==u&&function Lv(n,e){for(let t=0;t<e.length;t++)qv(n,e[t])}(e,u)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{e[dn]&=-5,ee()}}function xf(n,e,t,i){const s=e[dn];if(128!=(128&s)){N(e);try{Yf(e),function zh(n){return fn.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&Nv(n,e,t,2,i);const p=3==(3&s);if(p){const M=n.preOrderCheckHooks;null!==M&&Ie(e,M,null)}else{const M=n.preOrderHooks;null!==M&&qe(e,M,0,null),Fe(e,0)}if(function Hv(n){for(let e=tg(n);null!==e;e=tl(e)){if(!e[vi])continue;const t=e[ss];for(let i=0;i<t.length;i++){const s=t[i];512&s[dn]||Lh(s[Ti],1),s[dn]|=512}}}(e),function $v(n){for(let e=tg(n);null!==e;e=tl(e))for(let t=dr;t<e.length;t++){const i=e[t],s=i[Et];Bu(i)&&xf(s,i,s.template,i[Ni])}}(e),null!==n.contentQueries&&Ov(n,e),p){const M=n.contentCheckHooks;null!==M&&Ie(e,M)}else{const M=n.contentHooks;null!==M&&qe(e,M,1),Fe(e,1)}!function Bp(n,e){const t=n.hostBindingOpCodes;if(null!==t)try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)ae(~s);else{const u=s,p=t[++i],v=t[++i];h(p,u),v(2,e[u])}}}finally{ae(-1)}}(n,e);const v=n.components;null!==v&&function Fv(n,e){for(let t=0;t<e.length;t++)Gv(n,e[t])}(e,v);const C=n.viewQuery;if(null!==C&&_d(2,C,i),p){const M=n.viewCheckHooks;null!==M&&Ie(e,M)}else{const M=n.viewHooks;null!==M&&qe(e,M,2),Fe(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[dn]&=-41,512&e[dn]&&(e[dn]&=-513,Lh(e[Ti],-1))}finally{ee()}}}function Nv(n,e,t,i,s){const u=Y(),p=2&i;try{ae(-1),p&&e.length>Bn&&Jg(n,e,Bn,!1),ao(p?2:0,s),t(i,s)}finally{ae(u),ao(p?3:1,s)}}function c_(n,e,t){if(Za(e)){const s=e.directiveEnd;for(let u=e.directiveStart;u<s;u++){const p=n.data[u];p.contentQueries&&p.contentQueries(1,t[u],u)}}}function pd(n,e,t){qs()&&(function zv(n,e,t,i){const s=t.directiveStart,u=t.directiveEnd;R(t)&&function jv(n,e,t){const i=fr(e,n),s=bf(t),u=n[cc],p=sl(n,zp(n,s,null,t.onPush?32:16,i,e,u,u.createRenderer(i,t),null,null,null));n[e.index]=p}(e,t,n.data[s+t.componentOffset]),n.firstCreatePass||ma(t,e),or(i,e);const p=t.initialInputs;for(let v=s;v<u;v++){const C=n.data[v],M=Ol(e,n,v,t);or(M,e),null!==p&&m_(0,v-s,M,C,0,p),G(C)&&(Ao(t.index,e)[Ni]=Ol(e,n,v,t))}}(n,e,t,fr(t,e)),64==(64&t.flags)&&Vv(n,e,t))}function md(n,e,t=fr){const i=e.localNames;if(null!==i){let s=e.index+1;for(let u=0;u<i.length;u+=2){const p=i[u+1],v=-1===p?t(e,n):n[p];n[s++]=v}}}function bf(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=u_(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts):e}function u_(n,e,t,i,s,u,p,v,C,M){const O=Bn+i,U=O+s,Q=function h_(n,e){const t=[];for(let i=0;i<e;i++)t.push(i<n?null:xn);return t}(O,U),se="function"==typeof M?M():M;return Q[Et]={type:n,blueprint:Q,template:t,queries:null,viewQuery:v,declTNode:e,data:Q.slice().fill(null,O),bindingStartIndex:O,expandoStartIndex:U,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof p?p():p,firstChild:null,schemas:C,consts:se,incompleteFirstPass:!1}}function Tc(n,e,t,i){const s=lh(e);null===t?s.push(i):(s.push(t),n.firstCreatePass&&qp(n).push(i,s.length-1))}function Vp(n,e,t,i){for(let s in n)if(n.hasOwnProperty(s)){t=null===t?{}:t;const u=n[s];null===i?f_(t,e,s,u):i.hasOwnProperty(s)&&f_(t,e,i[s],u)}return t}function f_(n,e,t,i){n.hasOwnProperty(t)?n[t].push(e,i):n[t]=[e,i]}function ea(n,e,t,i,s,u,p,v){const C=fr(e,t);let O,M=e.inputs;!v&&null!=M&&(O=M[i])?(Ef(n,t,O,i,s),R(e)&&function Jb(n,e){const t=Ao(e,n);16&t[dn]||(t[dn]|=32)}(t,e.index)):3&e.type&&(i=function Yb(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(i),s=null!=p?p(s,e.value||"",i):s,u.setProperty(C,i,s))}function p_(n,e,t,i){if(qs()){const s=null===i?null:{"":-1},u=function Ea(n,e){const t=n.directiveRegistry;let i=null,s=null;if(t)for(let u=0;u<t.length;u++){const p=t[u];if(Kg(e,p.selectors,!1))if(i||(i=[]),G(p))if(null!==p.findHostDirectiveDefs){const v=[];s=s||new Map,p.findHostDirectiveDefs(p,v,s),i.unshift(...v,p),Ca(n,e,v.length)}else i.unshift(p),Ca(n,e,0);else s=s||new Map,p.findHostDirectiveDefs?.(p,i,s),i.push(p)}return null===i?null:[i,s]}(n,t);let p,v;null===u?p=v=null:[p,v]=u,null!==p&&gd(n,e,t,p,s,v),s&&function cu(n,e,t){if(e){const i=n.localNames=[];for(let s=0;s<e.length;s+=2){const u=t[e[s+1]];if(null==u)throw new Le(-301,!1);i.push(e[s],u)}}}(t,i,s)}t.mergedAttrs=qn(t.mergedAttrs,t.attrs)}function gd(n,e,t,i,s,u){for(let M=0;M<i.length;M++)Ka(ma(t,e),n,i[M].type);!function uu(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,i.length);for(let M=0;M<i.length;M++){const O=i[M];O.providersResolver&&O.providersResolver(O)}let p=!1,v=!1,C=fd(n,e,i.length,null);for(let M=0;M<i.length;M++){const O=i[M];t.mergedAttrs=qn(t.mergedAttrs,O.hostAttrs),jp(n,t,e,C,O),jl(C,O,s),null!==O.contentQueries&&(t.flags|=4),(null!==O.hostBindings||null!==O.hostAttrs||0!==O.hostVars)&&(t.flags|=64);const U=O.type.prototype;!p&&(U.ngOnChanges||U.ngOnInit||U.ngDoCheck)&&((n.preOrderHooks??(n.preOrderHooks=[])).push(t.index),p=!0),!v&&(U.ngOnChanges||U.ngDoCheck)&&((n.preOrderCheckHooks??(n.preOrderCheckHooks=[])).push(t.index),v=!0),C++}!function Up(n,e,t){const s=e.directiveEnd,u=n.data,p=e.attrs,v=[];let C=null,M=null;for(let O=e.directiveStart;O<s;O++){const U=u[O],Q=t?t.get(U):null,fe=Q?Q.outputs:null;C=Vp(U.inputs,O,C,Q?Q.inputs:null),M=Vp(U.outputs,O,M,fe);const Ee=null===C||null===p||Zg(e)?null:nw(C,O,p);v.push(Ee)}null!==C&&(C.hasOwnProperty("class")&&(e.flags|=8),C.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=v,e.inputs=C,e.outputs=M}(n,t,u)}function Vv(n,e,t){const i=t.directiveStart,s=t.directiveEnd,u=t.index,p=function _(){return fn.lFrame.currentDirectiveIndex}();try{ae(u);for(let v=i;v<s;v++){const C=n.data[v],M=e[v];x(v),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Uv(C,M)}}finally{ae(-1),x(p)}}function Uv(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function Ca(n,e,t){e.componentOffset=t,(n.components??(n.components=[])).push(e.index)}function jl(n,e,t){if(t){if(e.exportAs)for(let i=0;i<e.exportAs.length;i++)t[e.exportAs[i]]=n;G(e)&&(t[""]=n)}}function jp(n,e,t,i,s){n.data[i]=s;const u=s.factory||(s.factory=kl(s.type)),p=new it(u,G(s),$e);n.blueprint[i]=p,t[i]=p,function ew(n,e,t,i,s){const u=s.hostBindings;if(u){let p=n.hostBindingOpCodes;null===p&&(p=n.hostBindingOpCodes=[]);const v=~e.index;(function tw(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(p)!=v&&p.push(v),p.push(t,i,u)}}(n,e,i,fd(n,t,s.hostVars,xn),s)}function ol(n,e,t,i,s,u){const p=fr(n,e);!function $p(n,e,t,i,s,u,p){if(null==u)n.removeAttribute(e,s,t);else{const v=null==p?Vt(u):p(u,i||"",s);n.setAttribute(e,s,v,t)}}(e[on],p,u,n.value,t,i,s)}function m_(n,e,t,i,s,u){const p=u[e];if(null!==p){const v=i.setInput;for(let C=0;C<p.length;){const M=p[C++],O=p[C++],U=p[C++];null!==v?i.setInput(t,U,M,O):t[O]=U}}}function nw(n,e,t){let i=null,s=0;for(;s<t.length;){const u=t[s];if(0!==u)if(5!==u){if("number"==typeof u)break;if(n.hasOwnProperty(u)){null===i&&(i=[]);const p=n[u];for(let v=0;v<p.length;v+=2)if(p[v]===e){i.push(u,p[v+1],t[s+1]);break}}s+=2}else s+=2;else s+=4}return i}function g_(n,e,t,i){return[n,!0,!1,e,null,0,i,t,null,null]}function Gv(n,e){const t=Ao(e,n);if(Bu(t)){const i=t[Et];48&t[dn]?xf(i,t,i.template,t[Ni]):t[js]>0&&Hp(t)}}function Hp(n){for(let i=tg(n);null!==i;i=tl(i))for(let s=dr;s<i.length;s++){const u=i[s];if(Bu(u))if(512&u[dn]){const p=u[Et];xf(p,u,p.template,u[Ni])}else u[js]>0&&Hp(u)}const t=n[Et].components;if(null!==t)for(let i=0;i<t.length;i++){const s=Ao(t[i],n);Bu(s)&&s[js]>0&&Hp(s)}}function qv(n,e){const t=Ao(e,n),i=t[Et];(function Wv(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])})(i,t),l_(i,t,t[Ni])}function sl(n,e){return n[os]?n[ku][rs]=e:n[os]=e,n[ku]=e,e}function wf(n){for(;n;){n[dn]|=32;const e=rf(n);if(de(n)&&!e)return n;n=e}return null}function Gp(n,e,t,i=!0){const s=e[cc];s.begin&&s.begin();try{xf(n,e,n.template,t)}catch(p){throw i&&al(e,p),p}finally{s.end&&s.end()}}function _d(n,e,t){S(0),e(n,t)}function lh(n){return n[ys]||(n[ys]=[])}function qp(n){return n.cleanup||(n.cleanup=[])}function al(n,e){const t=n[qa],i=t?t.get(th,null):null;i&&i.handleError(e)}function Ef(n,e,t,i,s){for(let u=0;u<t.length;){const p=t[u++],v=t[u++],C=e[p],M=n.data[p];null!==M.setInput?M.setInput(C,s,i,v):C[v]=s}}function ll(n,e,t){const i=Nu(e,n);!function _p(n,e,t){n.setValue(e,t)}(n[on],i,t)}function Cs(n,e,t){let i=t?n.styles:null,s=t?n.classes:null,u=0;if(null!==e)for(let p=0;p<e.length;p++){const v=e[p];"number"==typeof v?u=v:1==u?s=rn(s,v):2==u&&(i=rn(i,v+": "+e[++p]+";"))}t?n.styles=i:n.stylesWithoutHost=i,t?n.classes=s:n.classesWithoutHost=s}function $l(n,e,t,i,s=!1){for(;null!==t;){const u=e[t.index];if(null!==u&&i.push(Ar(u)),Hr(u))for(let v=dr;v<u.length;v++){const C=u[v],M=C[Et].firstChild;null!==M&&$l(C[Et],C,M,i)}const p=t.type;if(8&p)$l(n,e,t.child,i);else if(32&p){const v=gp(t,e);let C;for(;C=v();)i.push(C)}else if(16&p){const v=bp(e,t);if(Array.isArray(v))i.push(...v);else{const C=rf(e[yr]);$l(C[Et],C,v,i,!0)}}t=s?t.projectionNext:t.next}return i}class yd{get rootNodes(){const e=this._lView,t=e[Et];return $l(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Ni]}set context(e){this._lView[Ni]=e}get destroyed(){return 128==(128&this._lView[dn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[Ti];if(Hr(e)){const t=e[vs],i=t?t.indexOf(this):-1;i>-1&&(xc(e,i),Bl(t,i))}this._attachedToViewContainer=!1}sg(this._lView[Et],this._lView)}onDestroy(e){Tc(this._lView[Et],this._lView,null,e)}markForCheck(){wf(this._cdRefInjectingView||this._lView)}detach(){this._lView[dn]&=-65}reattach(){this._lView[dn]|=64}detectChanges(){Gp(this._lView[Et],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Le(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ig(n,e){Zu(n,e,e[on],2,null,null)}(this._lView[Et],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Le(902,!1);this._appRef=e}}class Zv extends yd{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;Gp(e[Et],e,e[Ni],!1)}checkNoChanges(){}get context(){return null}}class vd extends ru{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=yn(e);return new Df(t,this.ngModule)}}function Cf(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class Kv{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,i){i=$a(i);const s=this.injector.get(e,Hg,i);return s!==Hg||t===Hg?s:this.parentInjector.get(e,t,i)}}class Df extends $g{get inputs(){return Cf(this.componentDef.inputs)}get outputs(){return Cf(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Dv(n){return n.map(Cv).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,i,s){let u=(s=s||this.ngModule)instanceof Ul?s:s?.injector;u&&null!==this.componentDef.getStandaloneInjector&&(u=this.componentDef.getStandaloneInjector(u)||u);const p=u?new Kv(e,u):e,v=p.get(mf,null);if(null===v)throw new Le(407,!1);const C=p.get(Fb,null),M=v.createRenderer(null,this.componentDef),O=this.componentDef.selectors[0][0]||"div",U=i?function d_(n,e,t){return n.selectRootElement(e,t===So.ShadowDom)}(M,i,this.componentDef.encapsulation):ng(M,O,function Xv(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(O)),Q=this.componentDef.onPush?288:272,se=u_(0,null,null,1,0,null,null,null,null,null),fe=zp(null,se,null,Q,null,null,v,M,C,p,null);let Ee,Be;N(fe);try{const Xe=this.componentDef;let ft,Ye=null;Xe.findHostDirectiveDefs?(ft=[],Ye=new Map,Xe.findHostDirectiveDefs(Xe,ft,Ye),ft.push(Xe)):ft=[Xe];const Tt=function Jv(n,e){const t=n[Et],i=Bn;return n[i]=e,ah(t,i,2,"#host",null)}(fe,U),Kn=function rw(n,e,t,i,s,u,p,v){const C=s[Et];!function __(n,e,t,i){for(const s of n)e.mergedAttrs=qn(e.mergedAttrs,s.hostAttrs);null!==e.mergedAttrs&&(Cs(e,e.mergedAttrs,!0),null!==t&&Yy(i,t,e))}(i,n,e,p);const M=u.createRenderer(e,t),O=zp(s,bf(t),null,t.onPush?32:16,s[n.index],n,u,M,v||null,null,null);return C.firstCreatePass&&Ca(C,n,i.length-1),sl(s,O),s[n.index]=O}(Tt,U,Xe,ft,fe,v,M);Be=qd(se,Bn),U&&function e0(n,e,t,i){if(i)Ct(n,t,["ng-version",Lb.full]);else{const{attrs:s,classes:u}=function $b(n){const e=[],t=[];let i=1,s=2;for(;i<n.length;){let u=n[i];if("string"==typeof u)2===s?""!==u&&e.push(u,n[++i]):8===s&&t.push(u);else{if(!ba(s))break;s=u}i++}return{attrs:e,classes:t}}(e.selectors[0]);s&&Ct(n,t,s),u&&u.length>0&&Ky(n,t,u.join(" "))}}(M,Xe,U,i),void 0!==t&&function t0(n,e,t){const i=n.projection=[];for(let s=0;s<e.length;s++){const u=t[s];i.push(null!=u?Array.from(u):null)}}(Be,this.ngContentSelectors,t),Ee=function Qv(n,e,t,i,s,u){const p=Gi(),v=s[Et],C=fr(p,s);gd(v,s,p,t,null,i);for(let O=0;O<t.length;O++)or(Ol(s,v,p.directiveStart+O,p),s);Vv(v,s,p),C&&or(C,s);const M=Ol(s,v,p.directiveStart+p.componentOffset,p);if(n[Ni]=s[Ni]=M,null!==u)for(const O of u)O(M,e);return c_(v,p,n),M}(Kn,Xe,ft,Ye,fe,[y_]),l_(se,fe,null)}finally{ee()}return new Yv(this.componentType,Ee,nl(Be,fe),fe,Be)}}class Yv extends dv{constructor(e,t,i,s,u){super(),this.location=i,this._rootLView=s,this._tNode=u,this.instance=t,this.hostView=this.changeDetectorRef=new Zv(s),this.componentType=e}setInput(e,t){const i=this._tNode.inputs;let s;if(null!==i&&(s=i[e])){const u=this._rootLView;Ef(u[Et],u,s,e,t),wf(Ao(this._tNode.index,u))}}get injector(){return new bs(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function y_(){const n=Gi();tt(De()[Et],n)}function Xn(n){let e=function Zp(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const i=[n];for(;e;){let s;if(G(n))s=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new Le(903,!1);s=e.\u0275dir}if(s){if(t){i.push(s);const p=n;p.inputs=Sf(n.inputs),p.declaredInputs=Sf(n.declaredInputs),p.outputs=Sf(n.outputs);const v=s.hostBindings;v&&r(n,v);const C=s.viewQuery,M=s.contentQueries;if(C&&n0(n,C),M&&o(n,M),ht(n.inputs,s.inputs),ht(n.declaredInputs,s.declaredInputs),ht(n.outputs,s.outputs),G(s)&&s.data.animation){const O=n.data;O.animation=(O.animation||[]).concat(s.data.animation)}}const u=s.features;if(u)for(let p=0;p<u.length;p++){const v=u[p];v&&v.ngInherit&&v(n),v===Xn&&(t=!1)}}e=Object.getPrototypeOf(e)}!function Tf(n){let e=0,t=null;for(let i=n.length-1;i>=0;i--){const s=n[i];s.hostVars=e+=s.hostVars,s.hostAttrs=qn(s.hostAttrs,t=qn(t,s.hostAttrs))}}(i)}function Sf(n){return n===ns?{}:n===Cn?[]:n}function n0(n,e){const t=n.viewQuery;n.viewQuery=t?(i,s)=>{e(i,s),t(i,s)}:e}function o(n,e){const t=n.contentQueries;n.contentQueries=t?(i,s,u)=>{e(i,s,u),t(i,s,u)}:e}function r(n,e){const t=n.hostBindings;n.hostBindings=t?(i,s)=>{e(i,s),t(i,s)}:e}function ie(n,e,t){return n[e]=t}function ne(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function ce(n,e,t,i){const s=ne(n,e,t);return ne(n,e+1,i)||s}function Ae(n,e,t,i){const s=De();return ne(s,Rl(),e)&&(Rn(),ol(oe(),s,n,e,t,i)),Ae}function et(n,e,t,i,s,u){const v=ce(n,function Ws(){return fn.lFrame.bindingIndex}(),t,s);return Go(2),v?e+Vt(t)+i+Vt(s)+u:xn}function jt(n,e,t,i,s,u,p,v){const C=De(),M=Rn(),O=n+Bn,U=M.firstCreatePass?function bi(n,e,t,i,s,u,p,v,C){const M=e.consts,O=ah(e,n,4,p||null,Hi(M,v));p_(e,t,O,Hi(M,C)),tt(e,O);const U=O.tView=u_(2,O,i,s,u,e.directiveRegistry,e.pipeRegistry,null,e.schemas,M);return null!==e.queries&&(e.queries.template(e,O),U.queries=e.queries.embeddedTView(O)),O}(O,M,C,e,t,i,s,u,p):M.data[O];pa(U,!1);const Q=C[on].createComment("");Oo(M,C,Q,U),or(Q,C),sl(C,C[O]=g_(Q,C,Q,U)),F(U)&&pd(M,C,U),null!=p&&md(C,U,v)}function zn(n,e,t){const i=De();return ne(i,Rl(),e)&&ea(Rn(),oe(),i,n,e,i[on],t,!1),zn}function oi(n,e,t,i,s){const p=s?"class":"style";Ef(n,t,e.inputs[p],p,i)}function Qt(n,e,t,i){const s=De(),u=Rn(),p=Bn+n,v=s[on],C=u.firstCreatePass?function hi(n,e,t,i,s,u){const p=e.consts,C=ah(e,n,2,i,Hi(p,s));return p_(e,t,C,Hi(p,u)),null!==C.attrs&&Cs(C,C.attrs,!1),null!==C.mergedAttrs&&Cs(C,C.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,C),C}(p,u,s,e,t,i):u.data[p],M=s[p]=ng(v,e,function we(){return fn.lFrame.currentNamespace}()),O=F(C);return pa(C,!0),Yy(v,M,C),32!=(32&C.flags)&&Oo(u,s,M,C),0===function Qf(){return fn.lFrame.elementDepthCount}()&&or(M,s),function Lm(){fn.lFrame.elementDepthCount++}(),O&&(pd(u,s,C),c_(u,C,s)),null!==i&&md(s,C),Qt}function bn(){let n=Gi();Bh()?zu():(n=n.parent,pa(n,!1));const e=n;!function Gs(){fn.lFrame.elementDepthCount--}();const t=Rn();return t.firstCreatePass&&(tt(t,n),Za(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function wt(n){return 0!=(8&n.flags)}(e)&&oi(t,e,De(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function kt(n){return 0!=(16&n.flags)}(e)&&oi(t,e,De(),e.stylesWithoutHost,!1),bn}function gi(n,e,t,i){return Qt(n,e,t,i),bn(),gi}function Fi(n){return!!n&&"function"==typeof n.then}const ho=function fi(n){return!!n&&"function"==typeof n.subscribe};function Un(n,e,t,i){const s=De(),u=Rn(),p=Gi();return function Fo(n,e,t,i,s,u,p){const v=F(i),M=n.firstCreatePass&&qp(n),O=e[Ni],U=lh(e);let Q=!0;if(3&i.type||p){const Ee=fr(i,e),Be=p?p(Ee):Ee,Xe=U.length,ft=p?Tt=>p(Ar(Tt[i.index])):i.index;let Ye=null;if(!p&&v&&(Ye=function Lr(n,e,t,i){const s=n.cleanup;if(null!=s)for(let u=0;u<s.length-1;u+=2){const p=s[u];if(p===t&&s[u+1]===i){const v=e[ys],C=s[u+2];return v.length>C?v[C]:null}"string"==typeof p&&(u+=2)}return null}(n,e,s,i.index)),null!==Ye)(Ye.__ngLastListenerFn__||Ye).__ngNextListenerFn__=u,Ye.__ngLastListenerFn__=u,Q=!1;else{u=Da(i,e,O,u,!1);const Tt=t.listen(Be,s,u);U.push(u,Tt),M&&M.push(s,ft,Xe,Xe+1)}}else u=Da(i,e,O,u,!1);const se=i.outputs;let fe;if(Q&&null!==se&&(fe=se[s])){const Ee=fe.length;if(Ee)for(let Be=0;Be<Ee;Be+=2){const Kn=e[fe[Be]][fe[Be+1]].subscribe(u),wi=U.length;U.push(u,Kn),M&&M.push(s,i.index,wi,-(wi+1))}}}(u,s,s[on],p,n,e,i),Un}function xr(n,e,t,i){try{return ao(6,e,t),!1!==t(i)}catch(s){return al(n,s),!1}finally{ao(7,e,t)}}function Da(n,e,t,i,s){return function u(p){if(p===Function)return i;wf(n.componentOffset>-1?Ao(n.index,e):e);let C=xr(e,t,i,p),M=u.__ngNextListenerFn__;for(;M;)C=xr(e,t,M,p)&&C,M=M.__ngNextListenerFn__;return s&&!1===C&&(p.preventDefault(),p.returnValue=!1),C}}function hu(n=1){return function re(n){return(fn.lFrame.contextLView=function $(n,e){for(;n>0;)e=e[Al],n--;return e}(n,fn.lFrame.contextLView))[Ni]}(n)}function Mf(n,e){let t=null;const i=function jb(n){const e=n.attrs;if(null!=e){const t=e.indexOf(5);if(!(1&t))return e[t+1]}return null}(n);for(let s=0;s<e.length;s++){const u=e[s];if("*"!==u){if(null===i?Kg(n,u,!0):Ev(i,u))return s}else t=s}return t}function ul(n,e){return n<<17|e<<2}function Hl(n){return n>>17&32767}function Wo(n){return 2|n}function hl(n){return(131068&n)>>2}function Af(n,e){return-131069&n|e<<2}function Sc(n){return 1|n}function VC(n,e,t,i,s){const u=n[t+1],p=null===e;let v=i?Hl(u):hl(u),C=!1;for(;0!==v&&(!1===C||p);){const O=n[v+1];HP(n[v],e)&&(C=!0,n[v+1]=i?Sc(O):Wo(O)),v=i?Hl(O):hl(O)}C&&(n[t+1]=i?Wo(u):Sc(u))}function HP(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Jc(n,e)>=0}function sw(n,e,t){return Mc(n,e,t,!1),sw}function tm(n,e){return Mc(n,e,null,!0),tm}function Mc(n,e,t,i){const s=De(),u=Rn(),p=Go(2);u.firstUpdatePass&&function ZC(n,e,t,i){const s=n.data;if(null===s[t+1]){const u=s[Y()],p=function WC(n,e){return e>=n.expandoStartIndex}(n,t);(function JC(n,e){return 0!=(n.flags&(e?8:16))})(u,i)&&null===e&&!p&&(e=!1),e=function QP(n,e,t,i){const s=function w(n){const e=fn.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let u=i?e.residualClasses:e.residualStyles;if(null===s)0===(i?e.classBindings:e.styleBindings)&&(t=E_(t=aw(null,n,e,t,i),e.attrs,i),u=null);else{const p=e.directiveStylingLast;if(-1===p||n[p]!==s)if(t=aw(s,n,e,t,i),null===u){let C=function ek(n,e,t){const i=t?e.classBindings:e.styleBindings;if(0!==hl(i))return n[Hl(i)]}(n,e,i);void 0!==C&&Array.isArray(C)&&(C=aw(null,n,e,C[1],i),C=E_(C,e.attrs,i),function tk(n,e,t,i){n[Hl(t?e.classBindings:e.styleBindings)]=i}(n,e,i,C))}else u=function nk(n,e,t){let i;const s=e.directiveEnd;for(let u=1+e.directiveStylingLast;u<s;u++)i=E_(i,n[u].hostAttrs,t);return E_(i,e.attrs,t)}(n,e,i)}return void 0!==u&&(i?e.residualClasses=u:e.residualStyles=u),t}(s,u,e,i),function jP(n,e,t,i,s,u){let p=u?e.classBindings:e.styleBindings,v=Hl(p),C=hl(p);n[i]=t;let O,M=!1;if(Array.isArray(t)?(O=t[1],(null===O||Jc(t,O)>0)&&(M=!0)):O=t,s)if(0!==C){const Q=Hl(n[v+1]);n[i+1]=ul(Q,v),0!==Q&&(n[Q+1]=Af(n[Q+1],i)),n[v+1]=function Ds(n,e){return 131071&n|e<<17}(n[v+1],i)}else n[i+1]=ul(v,0),0!==v&&(n[v+1]=Af(n[v+1],i)),v=i;else n[i+1]=ul(C,0),0===v?v=i:n[C+1]=Af(n[C+1],i),C=i;M&&(n[i+1]=Wo(n[i+1])),VC(n,O,i,!0),VC(n,O,i,!1),function $P(n,e,t,i,s){const u=s?n.residualClasses:n.residualStyles;null!=u&&"string"==typeof e&&Jc(u,e)>=0&&(t[i+1]=Sc(t[i+1]))}(e,O,n,i,u),p=ul(v,C),u?e.classBindings=p:e.styleBindings=p}(s,u,e,t,p,i)}}(u,n,p,i),e!==xn&&ne(s,p,e)&&function KC(n,e,t,i,s,u,p,v){if(!(3&e.type))return;const C=n.data,M=C[v+1],O=function r0(n){return 1==(1&n)}(M)?YC(C,e,t,s,hl(M),p):void 0;o0(O)||(o0(u)||function ow(n){return 2==(2&n)}(M)&&(u=YC(C,null,t,s,v,p)),function af(n,e,t,i,s){if(e)s?n.addClass(t,i):n.removeClass(t,i);else{let u=-1===i.indexOf("-")?void 0:Wr.DashCase;null==s?n.removeStyle(t,i,u):("string"==typeof s&&s.endsWith("!important")&&(s=s.slice(0,-10),u|=Wr.Important),n.setStyle(t,i,s,u))}}(i,p,Nu(Y(),t),s,u))}(u,u.data[Y()],s,s[on],n,s[p+1]=function sk(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=Dt(bc(n)))),n}(e,t),i,p)}function aw(n,e,t,i,s){let u=null;const p=t.directiveEnd;let v=t.directiveStylingLast;for(-1===v?v=t.directiveStart:v++;v<p&&(u=e[v],i=E_(i,u.hostAttrs,s),u!==n);)v++;return null!==n&&(t.directiveStylingLast=v),i}function E_(n,e,t){const i=t?1:2;let s=-1;if(null!==e)for(let u=0;u<e.length;u++){const p=e[u];"number"==typeof p?s=p:s===i&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ws(n,p,!!t||e[++u]))}return void 0===n?null:n}function YC(n,e,t,i,s,u){const p=null===e;let v;for(;s>0;){const C=n[s],M=Array.isArray(C),O=M?C[1]:C,U=null===O;let Q=t[s+1];Q===xn&&(Q=U?Cn:void 0);let se=U?Vm(Q,i):O===i?Q:void 0;if(M&&!o0(se)&&(se=Vm(C,i)),o0(se)&&(v=se,p))return v;const fe=n[s+1];s=p?Hl(fe):hl(fe)}if(null!==e){let C=u?e.residualClasses:e.residualStyles;null!=C&&(v=Vm(C,i))}return v}function o0(n){return void 0!==n}function No(n,e=""){const t=De(),i=Rn(),s=n+Bn,u=i.firstCreatePass?ah(i,s,1,e,null):i.data[s],p=t[s]=function ed(n,e){return n.createText(e)}(t[on],e);Oo(i,t,p,u),pa(u,!1)}function lw(n){return ch("",n,""),lw}function ch(n,e,t){const i=De(),s=function Ve(n,e,t,i){return ne(n,Rl(),t)?e+Vt(t)+i:xn}(i,n,e,t);return s!==xn&&ll(i,Y(),s),ch}function cw(n,e,t,i,s){const u=De(),p=et(u,n,e,t,i,s);return p!==xn&&ll(u,Y(),p),cw}function uw(n,e,t){const i=De();return ne(i,Rl(),e)&&ea(Rn(),oe(),i,n,e,i[on],t,!0),uw}const If=void 0;var Tk=["en",[["a","p"],["AM","PM"],If],[["AM","PM"],If,If],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],If,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],If,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",If,"{1} 'at' {0}",If],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Dk(n){const t=Math.floor(Math.abs(n)),i=n.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===i?1:5}];let nm={};function ta(n){const e=function Sk(n){return n.toLowerCase().replace(/_/g,"-")}(n);let t=_D(e);if(t)return t;const i=e.split("-")[0];if(t=_D(i),t)return t;if("en"===i)return Tk;throw new Le(701,!1)}function _D(n){return n in nm||(nm[n]=ai.ng&&ai.ng.common&&ai.ng.common.locales&&ai.ng.common.locales[n]),nm[n]}var Mt=(()=>((Mt=Mt||{})[Mt.LocaleId=0]="LocaleId",Mt[Mt.DayPeriodsFormat=1]="DayPeriodsFormat",Mt[Mt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Mt[Mt.DaysFormat=3]="DaysFormat",Mt[Mt.DaysStandalone=4]="DaysStandalone",Mt[Mt.MonthsFormat=5]="MonthsFormat",Mt[Mt.MonthsStandalone=6]="MonthsStandalone",Mt[Mt.Eras=7]="Eras",Mt[Mt.FirstDayOfWeek=8]="FirstDayOfWeek",Mt[Mt.WeekendRange=9]="WeekendRange",Mt[Mt.DateFormat=10]="DateFormat",Mt[Mt.TimeFormat=11]="TimeFormat",Mt[Mt.DateTimeFormat=12]="DateTimeFormat",Mt[Mt.NumberSymbols=13]="NumberSymbols",Mt[Mt.NumberFormats=14]="NumberFormats",Mt[Mt.CurrencyCode=15]="CurrencyCode",Mt[Mt.CurrencySymbol=16]="CurrencySymbol",Mt[Mt.CurrencyName=17]="CurrencyName",Mt[Mt.Currencies=18]="Currencies",Mt[Mt.Directionality=19]="Directionality",Mt[Mt.PluralCase=20]="PluralCase",Mt[Mt.ExtraData=21]="ExtraData",Mt))();const im="en-US";let yD=im;function fw(n,e,t,i,s){if(n=dt(n),Array.isArray(n))for(let u=0;u<n.length;u++)fw(n[u],e,t,i,s);else{const u=Rn(),p=De();let v=iu(n)?n:dt(n.provide),C=Qu(n);const M=Gi(),O=1048575&M.providerIndexes,U=M.directiveStart,Q=M.providerIndexes>>20;if(iu(n)||!n.multi){const se=new it(C,s,$e),fe=mw(v,e,s?O:O+Q,U);-1===fe?(Ka(ma(M,p),u,v),pw(u,n,e.length),e.push(v),M.directiveStart++,M.directiveEnd++,s&&(M.providerIndexes+=1048576),t.push(se),p.push(se)):(t[fe]=se,p[fe]=se)}else{const se=mw(v,e,O+Q,U),fe=mw(v,e,O,O+Q),Be=fe>=0&&t[fe];if(s&&!Be||!s&&!(se>=0&&t[se])){Ka(ma(M,p),u,v);const Xe=function CR(n,e,t,i,s){const u=new it(n,t,$e);return u.multi=[],u.index=e,u.componentProviders=0,$D(u,s,i&&!t),u}(s?ER:wR,t.length,s,i,C);!s&&Be&&(t[fe].providerFactory=Xe),pw(u,n,e.length,0),e.push(v),M.directiveStart++,M.directiveEnd++,s&&(M.providerIndexes+=1048576),t.push(Xe),p.push(Xe)}else pw(u,n,se>-1?se:fe,$D(t[s?fe:se],C,!s&&i));!s&&i&&Be&&t[fe].componentProviders++}}}function pw(n,e,t,i){const s=iu(e),u=function Ab(n){return!!n.useClass}(e);if(s||u){const C=(u?dt(e.useClass):e).prototype.ngOnDestroy;if(C){const M=n.destroyHooks||(n.destroyHooks=[]);if(!s&&e.multi){const O=M.indexOf(t);-1===O?M.push(t,[i,C]):M[O+1].push(i,C)}else M.push(t,C)}}}function $D(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function mw(n,e,t,i){for(let s=t;s<i;s++)if(e[s]===n)return s;return-1}function wR(n,e,t,i){return gw(this.multi,[])}function ER(n,e,t,i){const s=this.multi;let u;if(this.providerFactory){const p=this.providerFactory.componentProviders,v=Ol(t,t[Et],this.providerFactory.index,i);u=v.slice(0,p),gw(s,u);for(let C=p;C<v.length;C++)u.push(v[C])}else u=[],gw(s,u);return u}function gw(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function lr(n,e=[]){return t=>{t.providersResolver=(i,s)=>function bR(n,e,t){const i=Rn();if(i.firstCreatePass){const s=G(n);fw(t,i.data,i.blueprint,s,!0),fw(e,i.data,i.blueprint,s,!1)}}(i,s?s(n):n,e)}}class rm{}class HD{}class GD extends rm{constructor(e,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vd(this);const i=so(e);this._bootstrapComponents=il(i.bootstrap),this._r3Injector=_f(e,t,[{provide:rm,useValue:this},{provide:ru,useValue:this.componentFactoryResolver}],Dt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class _w extends HD{constructor(e){super(),this.moduleType=e}create(e){return new GD(this.moduleType,e)}}class TR extends rm{constructor(e,t,i){super(),this.componentFactoryResolver=new vd(this),this.instance=null;const s=new kr([...e,{provide:rm,useValue:this},{provide:ru,useValue:this.componentFactoryResolver}],t||ff(),i,new Set(["environment"]));this.injector=s,s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function u0(n,e,t=null){return new TR(n,e,t).injector}let SR=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const i=uv(0,t.type),s=i.length>0?u0([i],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,s)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=pt({token:n,providedIn:"environment",factory:()=>new n(ze(Ul))}),n})();function yw(n){n.getStandaloneInjector=e=>e.get(SR).getOrCreateStandaloneInjector(n)}function A_(n,e){const t=n[e];return t===xn?void 0:t}function xw(n,e){const t=Rn();let i;const s=n+Bn;t.firstCreatePass?(i=function qR(n,e){if(e)for(let t=e.length-1;t>=0;t--){const i=e[t];if(n===i.name)return i}}(e,t.pipeRegistry),t.data[s]=i,i.onDestroy&&(t.destroyHooks??(t.destroyHooks=[])).push(s,i.onDestroy)):i=t.data[s];const u=i.factory||(i.factory=kl(i.type)),p=Do($e);try{const v=Yn(!1),C=u();return Yn(v),function tn(n,e,t,i){t>=n.data.length&&(n.data[t]=null,n.blueprint[t]=null),e[t]=i}(t,De(),s,C),C}finally{Do(p)}}function iT(n,e,t){const i=n+Bn,s=De(),u=Zc(s,i);return I_(s,i)?function JD(n,e,t,i,s,u){const p=e+t;return ne(n,p,s)?ie(n,p+1,u?i.call(u,s):i(s)):A_(n,p+1)}(s,Io(),e,u.transform,t,u):u.transform(t)}function rT(n,e,t,i){const s=n+Bn,u=De(),p=Zc(u,s);return I_(u,s)?function QD(n,e,t,i,s,u,p){const v=e+t;return ce(n,v,s,u)?ie(n,v+2,p?i.call(p,s,u):i(s,u)):A_(n,v+2)}(u,Io(),e,p.transform,t,i,p):p.transform(t,i)}function I_(n,e){return n[Et].data[e].pure}function bw(n){return e=>{setTimeout(n,void 0,e)}}const cr=class KR extends mn{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,i){let s=e,u=t||(()=>null),p=i;if(e&&"object"==typeof e){const C=e;s=C.next?.bind(C),u=C.error?.bind(C),p=C.complete?.bind(C)}this.__isAsync&&(u=bw(u),s&&(s=bw(s)),p&&(p=bw(p)));const v=super.subscribe({next:s,error:u,complete:p});return e instanceof Ke&&e.add(v),v}};function YR(){return this._results[Symbol.iterator]()}class ww{get changes(){return this._changes||(this._changes=new cr)}constructor(e=!1){this._emitDistinctChangesOnly=e,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=ww.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=YR)}get(e){return this._results[e]}map(e){return this._results.map(e)}filter(e){return this._results.filter(e)}find(e){return this._results.find(e)}reduce(e,t){return this._results.reduce(e,t)}forEach(e){this._results.forEach(e)}some(e){return this._results.some(e)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(e,t){const i=this;i.dirty=!1;const s=function Ks(n){return n.flat(Number.POSITIVE_INFINITY)}(e);(this._changesDetected=!function My(n,e,t){if(n.length!==e.length)return!1;for(let i=0;i<n.length;i++){let s=n[i],u=e[i];if(t&&(s=t(s),u=t(u)),u!==s)return!1}return!0}(i._results,s,t))&&(i._results=s,i.length=s.length,i.last=s[this.length-1],i.first=s[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let mu=(()=>{class n{}return n.__NG_ELEMENT_ID__=eO,n})();const JR=mu,QR=class extends JR{constructor(e,t,i){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=i}createEmbeddedView(e,t){const i=this._declarationTContainer.tView,s=zp(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null,t||null);s[Il]=this._declarationLView[this._declarationTContainer.index];const p=this._declarationLView[$r];return null!==p&&(s[$r]=p.createEmbeddedView(i)),l_(i,s,e),new yd(s)}};function eO(){return h0(Gi(),De())}function h0(n,e){return 4&n.type?new QR(e,n,nl(n,e)):null}let Gl=(()=>{class n{}return n.__NG_ELEMENT_ID__=tO,n})();function tO(){return aT(Gi(),De())}const nO=Gl,oT=class extends nO{constructor(e,t,i){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=i}get element(){return nl(this._hostTNode,this._hostLView)}get injector(){return new bs(this._hostTNode,this._hostLView)}get parentInjector(){const e=_a(this._hostTNode,this._hostLView);if(Gr(e)){const t=as(e,this._hostLView),i=rr(e);return new bs(t[Et].data[i+8],t)}return new bs(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=sT(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-dr}createEmbeddedView(e,t,i){let s,u;"number"==typeof i?s=i:null!=i&&(s=i.index,u=i.injector);const p=e.createEmbeddedView(t||{},u);return this.insert(p,s),p}createComponent(e,t,i,s,u){const p=e&&!function uo(n){return"function"==typeof n}(e);let v;if(p)v=t;else{const U=t||{};v=U.index,i=U.injector,s=U.projectableNodes,u=U.environmentInjector||U.ngModuleRef}const C=p?e:new Df(yn(e)),M=i||this.parentInjector;if(!u&&null==C.ngModule){const Q=(p?M:this.parentInjector).get(Ul,null);Q&&(u=Q)}const O=C.create(M,s,void 0,u);return this.insert(O.hostView,v),O}insert(e,t){const i=e._lView,s=i[Et];if(function Kf(n){return Hr(n[Ti])}(i)){const O=this.indexOf(e);if(-1!==O)this.detach(O);else{const U=i[Ti],Q=new oT(U,U[_r],U[Ti]);Q.detach(Q.indexOf(e))}}const u=this._adjustIndex(t),p=this._lContainer;!function rg(n,e,t,i){const s=dr+i,u=t.length;i>0&&(t[s-1][rs]=e),i<u-dr?(e[rs]=t[s],sp(t,dr+i,e)):(t.push(e),e[rs]=null),e[Ti]=t;const p=e[Il];null!==p&&t!==p&&function Zy(n,e){const t=n[ss];e[yr]!==e[Ti][Ti][yr]&&(n[vi]=!0),null===t?n[ss]=[e]:t.push(e)}(p,e);const v=e[$r];null!==v&&v.insertView(n),e[dn]|=64}(s,i,p,u);const v=pg(u,p),C=i[on],M=vp(C,p[uc]);return null!==M&&function cb(n,e,t,i,s,u){i[Ho]=s,i[_r]=e,Zu(n,i,t,1,s,u)}(s,p[_r],C,i,M,v),e.attachToViewContainerRef(),sp(Ew(p),u,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=sT(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),i=xc(this._lContainer,t);i&&(Bl(Ew(this._lContainer),t),sg(i[Et],i))}detach(e){const t=this._adjustIndex(e,-1),i=xc(this._lContainer,t);return i&&null!=Bl(Ew(this._lContainer),t)?new yd(i):null}_adjustIndex(e,t=0){return e??this.length+t}};function sT(n){return n[vs]}function Ew(n){return n[vs]||(n[vs]=[])}function aT(n,e){let t;const i=e[n.index];if(Hr(i))t=i;else{let s;if(8&n.type)s=Ar(i);else{const u=e[on];s=u.createComment("");const p=fr(n,e);Wu(u,vp(u,p),s,function fb(n,e){return n.nextSibling(e)}(u,p),!1)}e[n.index]=t=g_(i,e,s,n),sl(e,t)}return new oT(t,n,e)}class Cw{constructor(e){this.queryList=e,this.matches=null}clone(){return new Cw(this.queryList)}setDirty(){this.queryList.setDirty()}}class Dw{constructor(e=[]){this.queries=e}createEmbeddedView(e){const t=e.queries;if(null!==t){const i=null!==e.contentQueries?e.contentQueries[0]:t.length,s=[];for(let u=0;u<i;u++){const p=t.getByIndex(u);s.push(this.queries[p.indexInDeclarationView].clone())}return new Dw(s)}return null}insertView(e){this.dirtyQueriesWithMatches(e)}detachView(e){this.dirtyQueriesWithMatches(e)}dirtyQueriesWithMatches(e){for(let t=0;t<this.queries.length;t++)null!==fT(e,t).matches&&this.queries[t].setDirty()}}class lT{constructor(e,t,i=null){this.predicate=e,this.flags=t,this.read=i}}class Tw{constructor(e=[]){this.queries=e}elementStart(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(e,t)}elementEnd(e){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}embeddedTView(e){let t=null;for(let i=0;i<this.length;i++){const s=null!==t?t.length:0,u=this.getByIndex(i).embeddedTView(e,s);u&&(u.indexInDeclarationView=i,null!==t?t.push(u):t=[u])}return null!==t?new Tw(t):null}template(e,t){for(let i=0;i<this.queries.length;i++)this.queries[i].template(e,t)}getByIndex(e){return this.queries[e]}get length(){return this.queries.length}track(e){this.queries.push(e)}}class Sw{constructor(e,t=-1){this.metadata=e,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}elementEnd(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}template(e,t){this.elementStart(e,t)}embeddedTView(e,t){return this.isApplyingToNode(e)?(this.crossesNgTemplate=!0,this.addMatch(-e.index,t),new Sw(this.metadata)):null}isApplyingToNode(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let i=e.parent;for(;null!==i&&8&i.type&&i.index!==t;)i=i.parent;return t===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(e,t){const i=this.metadata.predicate;if(Array.isArray(i))for(let s=0;s<i.length;s++){const u=i[s];this.matchTNodeWithReadOption(e,t,iO(t,u)),this.matchTNodeWithReadOption(e,t,$h(t,e,u,!1,!1))}else i===mu?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,$h(t,e,i,!1,!1))}matchTNodeWithReadOption(e,t,i){if(null!==i){const s=this.metadata.read;if(null!==s)if(s===ar||s===Gl||s===mu&&4&t.type)this.addMatch(t.index,-2);else{const u=$h(t,e,s,!1,!1);null!==u&&this.addMatch(t.index,u)}else this.addMatch(t.index,i)}}addMatch(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}function iO(n,e){const t=n.localNames;if(null!==t)for(let i=0;i<t.length;i+=2)if(t[i]===e)return t[i+1];return null}function oO(n,e,t,i){return-1===t?function rO(n,e){return 11&n.type?nl(n,e):4&n.type?h0(n,e):null}(e,n):-2===t?function sO(n,e,t){return t===ar?nl(e,n):t===mu?h0(e,n):t===Gl?aT(e,n):void 0}(n,e,i):Ol(n,n[Et],t,e)}function cT(n,e,t,i){const s=e[$r].queries[i];if(null===s.matches){const u=n.data,p=t.matches,v=[];for(let C=0;C<p.length;C+=2){const M=p[C];v.push(M<0?null:oO(e,u[M],p[C+1],t.metadata.read))}s.matches=v}return s.matches}function Mw(n,e,t,i){const s=n.queries.getByIndex(t),u=s.matches;if(null!==u){const p=cT(n,e,s,t);for(let v=0;v<u.length;v+=2){const C=u[v];if(C>0)i.push(p[v/2]);else{const M=u[v+1],O=e[-C];for(let U=dr;U<O.length;U++){const Q=O[U];Q[Il]===Q[Ti]&&Mw(Q[Et],Q,M,i)}if(null!==O[ss]){const U=O[ss];for(let Q=0;Q<U.length;Q++){const se=U[Q];Mw(se[Et],se,M,i)}}}}}return i}function d0(n){const e=De(),t=Rn(),i=T();S(i+1);const s=fT(t,i);if(n.dirty&&function Wd(n){return 4==(4&n[dn])}(e)===(2==(2&s.metadata.flags))){if(null===s.matches)n.reset([]);else{const u=s.crossesNgTemplate?Mw(t,e,i,[]):cT(t,e,s,i);n.reset(u,Rb),n.notifyOnChanges()}return!0}return!1}function Aw(n,e,t){const i=Rn();i.firstCreatePass&&(function dT(n,e,t){null===n.queries&&(n.queries=new Tw),n.queries.track(new Sw(e,t))}(i,new lT(n,e,t),-1),2==(2&e)&&(i.staticViewQueries=!0)),function hT(n,e,t){const i=new ww(4==(4&t));Tc(n,e,i,i.destroy),null===e[$r]&&(e[$r]=new Dw),e[$r].queries.push(new Cw(i))}(i,De(),e)}function f0(){return function aO(n,e){return n[$r].queries[e].queryList}(De(),T())}function fT(n,e){return n.queries.getByIndex(e)}function m0(...n){}const k_=new xt("Application Initializer");let g0=(()=>{class n{constructor(t){this.appInits=t,this.resolve=m0,this.reject=m0,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,s)=>{this.resolve=i,this.reject=s})}runInitializers(){if(this.initialized)return;const t=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let s=0;s<this.appInits.length;s++){const u=this.appInits[s]();if(Fi(u))t.push(u);else if(ho(u)){const p=new Promise((v,C)=>{u.subscribe({complete:v,error:C})});t.push(p)}}Promise.all(t).then(()=>{i()}).catch(s=>{this.reject(s)}),0===t.length&&i(),this.initialized=!0}}return n.\u0275fac=function(t){return new(t||n)(ze(k_,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const R_=new xt("AppId",{providedIn:"root",factory:function PT(){return`${Fw()}${Fw()}${Fw()}`}});function Fw(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const kT=new xt("Platform Initializer"),am=new xt("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),O_=new xt("AnimationModuleType");let AO=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const gu=new xt("LocaleId",{providedIn:"root",factory:()=>Zt(gu,Bt.Optional|Bt.SkipSelf)||function IO(){return typeof $localize<"u"&&$localize.locale||im}()});class kO{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let RT=(()=>{class n{compileModuleSync(t){return new _w(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const i=this.compileModuleSync(t),u=il(so(t).declarations).reduce((p,v)=>{const C=yn(v);return C&&p.push(new Df(C)),p},[]);return new kO(i,u)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const FO=(()=>Promise.resolve(0))();function Lw(n){typeof Zone>"u"?FO.then(()=>{n&&n.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",n)}class On{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new cr(!1),this.onMicrotaskEmpty=new cr(!1),this.onStable=new cr(!1),this.onError=new cr(!1),typeof Zone>"u")throw new Le(908,!1);Zone.assertZonePatched();const s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&t,s.shouldCoalesceRunChangeDetection=i,s.lastRequestAnimationFrameId=-1,s.nativeRequestAnimationFrame=function LO(){let n=ai.requestAnimationFrame,e=ai.cancelAnimationFrame;if(typeof Zone<"u"&&n&&e){const t=n[Zone.__symbol__("OriginalDelegate")];t&&(n=t);const i=e[Zone.__symbol__("OriginalDelegate")];i&&(e=i)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function zO(n){const e=()=>{!function BO(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(ai,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,Bw(n),n.isCheckStableRunning=!0,Nw(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),Bw(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,i,s,u,p,v)=>{try{return LT(n),t.invokeTask(s,u,p,v)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||n.shouldCoalesceRunChangeDetection)&&e(),NT(n)}},onInvoke:(t,i,s,u,p,v,C)=>{try{return LT(n),t.invoke(s,u,p,v,C)}finally{n.shouldCoalesceRunChangeDetection&&e(),NT(n)}},onHasTask:(t,i,s,u)=>{t.hasTask(s,u),i===s&&("microTask"==u.change?(n._hasPendingMicrotasks=u.microTask,Bw(n),Nw(n)):"macroTask"==u.change&&(n.hasPendingMacrotasks=u.macroTask))},onHandleError:(t,i,s,u)=>(t.handleError(s,u),n.runOutsideAngular(()=>n.onError.emit(u)),!1)})}(s)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!On.isInAngularZone())throw new Le(909,!1)}static assertNotInAngularZone(){if(On.isInAngularZone())throw new Le(909,!1)}run(e,t,i){return this._inner.run(e,t,i)}runTask(e,t,i,s){const u=this._inner,p=u.scheduleEventTask("NgZoneEvent: "+s,e,NO,m0,m0);try{return u.runTask(p,t,i)}finally{u.cancelTask(p)}}runGuarded(e,t,i){return this._inner.runGuarded(e,t,i)}runOutsideAngular(e){return this._outer.run(e)}}const NO={};function Nw(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function Bw(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function LT(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function NT(n){n._nesting--,Nw(n)}class VO{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new cr,this.onMicrotaskEmpty=new cr,this.onStable=new cr,this.onError=new cr}run(e,t,i){return e.apply(t,i)}runGuarded(e,t,i){return e.apply(t,i)}runOutsideAngular(e){return e()}runTask(e,t,i,s){return e.apply(t,i)}}const BT=new xt(""),_0=new xt("");let Uw,zw=(()=>{class n{constructor(t,i,s){this._ngZone=t,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Uw||(function UO(n){Uw=n}(s),s.addToWindow(i)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{On.assertNotInAngularZone(),Lw(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Lw(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(t)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,i,s){let u=-1;i&&i>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(p=>p.timeoutId!==u),t(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:t,timeoutId:u,updateCb:s})}whenStable(t,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,i,s){return[]}}return n.\u0275fac=function(t){return new(t||n)(ze(On),ze(Vw),ze(_0))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),Vw=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,i){this._applications.set(t,i)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,i=!0){return Uw?.findTestabilityInTree(this,t,i)??null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const uh=!1;let bd=null;const zT=new xt("AllowMultipleToken"),jw=new xt("PlatformDestroyListeners"),VT=new xt("appBootstrapListener");class UT{constructor(e,t){this.name=e,this.token=t}}function $T(n,e,t=[]){const i=`Platform: ${e}`,s=new xt(i);return(u=[])=>{let p=$w();if(!p||p.injector.get(zT,!1)){const v=[...t,...u,{provide:s,useValue:!0}];n?n(v):function HO(n){if(bd&&!bd.get(zT,!1))throw new Le(400,!1);bd=n;const e=n.get(GT);(function jT(n){const e=n.get(kT,null);e&&e.forEach(t=>t())})(n)}(function HT(n=[],e){return Or.create({name:e,providers:[{provide:zg,useValue:"platform"},{provide:jw,useValue:new Set([()=>bd=null])},...n]})}(v,i))}return function qO(n){const e=$w();if(!e)throw new Le(401,!1);return e}()}}function $w(){return bd?.get(GT)??null}let GT=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,i){const s=function WT(n,e){let t;return t="noop"===n?new VO:("zone.js"===n?void 0:n)||new On(e),t}(i?.ngZone,function qT(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!n||!n.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!n||!n.ngZoneRunCoalescing)||!1}}(i)),u=[{provide:On,useValue:s}];return s.run(()=>{const p=Or.create({providers:u,parent:this.injector,name:t.moduleType.name}),v=t.create(p),C=v.injector.get(th,null);if(!C)throw new Le(402,!1);return s.runOutsideAngular(()=>{const M=s.onError.subscribe({next:O=>{C.handleError(O)}});v.onDestroy(()=>{y0(this._modules,v),M.unsubscribe()})}),function ZT(n,e,t){try{const i=t();return Fi(i)?i.catch(s=>{throw e.runOutsideAngular(()=>n.handleError(s)),s}):i}catch(i){throw e.runOutsideAngular(()=>n.handleError(i)),i}}(C,s,()=>{const M=v.injector.get(g0);return M.runInitializers(),M.donePromise.then(()=>(function vD(n){oo(n,"Expected localeId to be defined"),"string"==typeof n&&(yD=n.toLowerCase().replace(/_/g,"-"))}(v.injector.get(gu,im)||im),this._moduleDoBootstrap(v),v))})})}bootstrapModule(t,i=[]){const s=XT({},i);return function jO(n,e,t){const i=new _w(t);return Promise.resolve(i)}(0,0,t).then(u=>this.bootstrapModuleFactory(u,s))}_moduleDoBootstrap(t){const i=t.injector.get(Pf);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(s=>i.bootstrap(s));else{if(!t.instance.ngDoBootstrap)throw new Le(-403,!1);t.instance.ngDoBootstrap(i)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Le(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const t=this._injector.get(jw,null);t&&(t.forEach(i=>i()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(t){return new(t||n)(ze(Or))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function XT(n,e){return Array.isArray(e)?e.reduce(XT,n):{...n,...e}}let Pf=(()=>{class n{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,i,s){this._zone=t,this._injector=i,this._exceptionHandler=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const u=new Lt(v=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{v.next(this._stable),v.complete()})}),p=new Lt(v=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{On.assertNotInAngularZone(),Lw(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,v.next(!0))})})});const M=this._zone.onUnstable.subscribe(()=>{On.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{v.next(!1)}))});return()=>{C.unsubscribe(),M.unsubscribe()}});this.isStable=io(u,p.pipe(function Nc(n={}){const{connector:e=(()=>new mn),resetOnError:t=!0,resetOnComplete:i=!0,resetOnRefCountZero:s=!0}=n;return u=>{let p,v,C,M=0,O=!1,U=!1;const Q=()=>{v?.unsubscribe(),v=void 0},se=()=>{Q(),p=C=void 0,O=U=!1},fe=()=>{const Ee=p;se(),Ee?.unsubscribe()};return ni((Ee,Be)=>{M++,!U&&!O&&Q();const Xe=C=C??e();Be.add(()=>{M--,0===M&&!U&&!O&&(v=Bc(fe,s))}),Xe.subscribe(Be),!p&&M>0&&(p=new Ko({next:ft=>Xe.next(ft),error:ft=>{U=!0,Q(),v=Bc(se,t,ft),Xe.error(ft)},complete:()=>{O=!0,Q(),v=Bc(se,i),Xe.complete()}}),It(Ee).subscribe(p))})(u)}}()))}bootstrap(t,i){const s=t instanceof $g;if(!this._injector.get(g0).done){!s&&function Us(n){const e=yn(n)||Ki(n)||Sr(n);return null!==e&&e.standalone}(t);throw new Le(405,uh)}let p;p=s?t:this._injector.get(ru).resolveComponentFactory(t),this.componentTypes.push(p.componentType);const v=function $O(n){return n.isBoundToModule}(p)?void 0:this._injector.get(rm),M=p.create(Or.NULL,[],i||p.selector,v),O=M.location.nativeElement,U=M.injector.get(BT,null);return U?.registerApplication(O),M.onDestroy(()=>{this.detachView(M.hostView),y0(this.components,M),U?.unregisterApplication(O)}),this._loadComponent(M),M}tick(){if(this._runningTick)throw new Le(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const i=t;this._views.push(i),i.attachToAppRef(this)}detachView(t){const i=t;y0(this._views,i),i.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const i=this._injector.get(VT,[]);i.push(...this._bootstrapListeners),i.forEach(s=>s(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>y0(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Le(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(t){return new(t||n)(ze(On),ze(Ul),ze(th))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function y0(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}let F_=(()=>{class n{}return n.__NG_ELEMENT_ID__=ZO,n})();function ZO(n){return function XO(n,e,t){if(R(n)&&!t){const i=Ao(n.index,e);return new yd(i,i)}return 47&n.type?new yd(e[yr],e):null}(Gi(),De(),16==(16&n))}const lF=$T(null,"core",[]);let cF=(()=>{class n{constructor(t){}}return n.\u0275fac=function(t){return new(t||n)(ze(Pf))},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})();function lm(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let Zw=null;function hh(){return Zw}class dF{}const ei=new xt("DocumentToken");let Xw=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return function fF(){return ze(sS)}()},providedIn:"platform"}),n})();const pF=new xt("Location Initialized");let sS=(()=>{class n extends Xw{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return hh().getBaseHref(this._doc)}onPopState(t){const i=hh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",t,!1),()=>i.removeEventListener("popstate",t)}onHashChange(t){const i=hh().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",t,!1),()=>i.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,i,s){aS()?this._history.pushState(t,i,s):this._location.hash=s}replaceState(t,i,s){aS()?this._history.replaceState(t,i,s):this._location.hash=s}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:function(){return function mF(){return new sS(ze(ei))}()},providedIn:"platform"}),n})();function aS(){return!!window.history.pushState}function Kw(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function lS(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function dh(n){return n&&"?"!==n[0]?"?"+n:n}let Rf=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return Zt(uS)},providedIn:"root"}),n})();const cS=new xt("appBaseHref");let uS=(()=>{class n extends Rf{constructor(t,i){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Zt(ei).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Kw(this._baseHref,t)}path(t=!1){const i=this._platformLocation.pathname+dh(this._platformLocation.search),s=this._platformLocation.hash;return s&&t?`${i}${s}`:i}pushState(t,i,s,u){const p=this.prepareExternalUrl(s+dh(u));this._platformLocation.pushState(t,i,p)}replaceState(t,i,s,u){const p=this.prepareExternalUrl(s+dh(u));this._platformLocation.replaceState(t,i,p)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(ze(Xw),ze(cS,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),gF=(()=>{class n extends Rf{constructor(t,i){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=i&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let i=this._platformLocation.hash;return null==i&&(i="#"),i.length>0?i.substring(1):i}prepareExternalUrl(t){const i=Kw(this._baseHref,t);return i.length>0?"#"+i:i}pushState(t,i,s,u){let p=this.prepareExternalUrl(s+dh(u));0==p.length&&(p=this._platformLocation.pathname),this._platformLocation.pushState(t,i,p)}replaceState(t,i,s,u){let p=this.prepareExternalUrl(s+dh(u));0==p.length&&(p=this._platformLocation.pathname),this._platformLocation.replaceState(t,i,p)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(ze(Xw),ze(cS,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),N_=(()=>{class n{constructor(t){this._subject=new cr,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const i=this._locationStrategy.getBaseHref();this._basePath=function vF(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(lS(hS(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,i=""){return this.path()==this.normalize(t+dh(i))}normalize(t){return n.stripTrailingSlash(function yF(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,hS(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,i="",s=null){this._locationStrategy.pushState(s,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+dh(i)),s)}replaceState(t,i="",s=null){this._locationStrategy.replaceState(s,"",t,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+dh(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)})),()=>{const i=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(i,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",i){this._urlChangeListeners.forEach(s=>s(t,i))}subscribe(t,i,s){return this._subject.subscribe({next:t,error:i,complete:s})}}return n.normalizeQueryParams=dh,n.joinWithSlash=Kw,n.stripTrailingSlash=lS,n.\u0275fac=function(t){return new(t||n)(ze(Rf))},n.\u0275prov=pt({token:n,factory:function(){return function _F(){return new N_(ze(Rf))}()},providedIn:"root"}),n})();function hS(n){return n.replace(/\/index.html$/,"")}var Kr=(()=>((Kr=Kr||{})[Kr.Format=0]="Format",Kr[Kr.Standalone=1]="Standalone",Kr))(),Jn=(()=>((Jn=Jn||{})[Jn.Narrow=0]="Narrow",Jn[Jn.Abbreviated=1]="Abbreviated",Jn[Jn.Wide=2]="Wide",Jn[Jn.Short=3]="Short",Jn))(),br=(()=>((br=br||{})[br.Short=0]="Short",br[br.Medium=1]="Medium",br[br.Long=2]="Long",br[br.Full=3]="Full",br))(),sn=(()=>((sn=sn||{})[sn.Decimal=0]="Decimal",sn[sn.Group=1]="Group",sn[sn.List=2]="List",sn[sn.PercentSign=3]="PercentSign",sn[sn.PlusSign=4]="PlusSign",sn[sn.MinusSign=5]="MinusSign",sn[sn.Exponential=6]="Exponential",sn[sn.SuperscriptingExponent=7]="SuperscriptingExponent",sn[sn.PerMille=8]="PerMille",sn[sn.Infinity=9]="Infinity",sn[sn.NaN=10]="NaN",sn[sn.TimeSeparator=11]="TimeSeparator",sn[sn.CurrencyDecimal=12]="CurrencyDecimal",sn[sn.CurrencyGroup=13]="CurrencyGroup",sn))();function w0(n,e){return Wl(ta(n)[Mt.DateFormat],e)}function E0(n,e){return Wl(ta(n)[Mt.TimeFormat],e)}function C0(n,e){return Wl(ta(n)[Mt.DateTimeFormat],e)}function ql(n,e){const t=ta(n),i=t[Mt.NumberSymbols][e];if(typeof i>"u"){if(e===sn.CurrencyDecimal)return t[Mt.NumberSymbols][sn.Decimal];if(e===sn.CurrencyGroup)return t[Mt.NumberSymbols][sn.Group]}return i}function fS(n){if(!n[Mt.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[Mt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Wl(n,e){for(let t=e;t>-1;t--)if(typeof n[t]<"u")return n[t];throw new Error("Locale data API: locale data undefined")}function Jw(n){const[e,t]=n.split(":");return{hours:+e,minutes:+t}}const kF=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,B_={},RF=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Bo=(()=>((Bo=Bo||{})[Bo.Short=0]="Short",Bo[Bo.ShortGMT=1]="ShortGMT",Bo[Bo.Long=2]="Long",Bo[Bo.Extended=3]="Extended",Bo))(),un=(()=>((un=un||{})[un.FullYear=0]="FullYear",un[un.Month=1]="Month",un[un.Date=2]="Date",un[un.Hours=3]="Hours",un[un.Minutes=4]="Minutes",un[un.Seconds=5]="Seconds",un[un.FractionalSeconds=6]="FractionalSeconds",un[un.Day=7]="Day",un))(),Pn=(()=>((Pn=Pn||{})[Pn.DayPeriods=0]="DayPeriods",Pn[Pn.Days=1]="Days",Pn[Pn.Months=2]="Months",Pn[Pn.Eras=3]="Eras",Pn))();function OF(n,e,t,i){let s=function $F(n){if(gS(n))return n;if("number"==typeof n&&!isNaN(n))return new Date(n);if("string"==typeof n){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){const[s,u=1,p=1]=n.split("-").map(v=>+v);return D0(s,u-1,p)}const t=parseFloat(n);if(!isNaN(n-t))return new Date(t);let i;if(i=n.match(kF))return function HF(n){const e=new Date(0);let t=0,i=0;const s=n[8]?e.setUTCFullYear:e.setFullYear,u=n[8]?e.setUTCHours:e.setHours;n[9]&&(t=Number(n[9]+n[10]),i=Number(n[9]+n[11])),s.call(e,Number(n[1]),Number(n[2])-1,Number(n[3]));const p=Number(n[4]||0)-t,v=Number(n[5]||0)-i,C=Number(n[6]||0),M=Math.floor(1e3*parseFloat("0."+(n[7]||0)));return u.call(e,p,v,C,M),e}(i)}const e=new Date(n);if(!gS(e))throw new Error(`Unable to convert "${n}" into a date`);return e}(n);e=fh(t,e)||e;let v,p=[];for(;e;){if(v=RF.exec(e),!v){p.push(e);break}{p=p.concat(v.slice(1));const O=p.pop();if(!O)break;e=O}}let C=s.getTimezoneOffset();i&&(C=mS(i,C),s=function jF(n,e,t){const i=t?-1:1,s=n.getTimezoneOffset();return function UF(n,e){return(n=new Date(n.getTime())).setMinutes(n.getMinutes()+e),n}(n,i*(mS(e,s)-s))}(s,i,!0));let M="";return p.forEach(O=>{const U=function VF(n){if(e1[n])return e1[n];let e;switch(n){case"G":case"GG":case"GGG":e=Qi(Pn.Eras,Jn.Abbreviated);break;case"GGGG":e=Qi(Pn.Eras,Jn.Wide);break;case"GGGGG":e=Qi(Pn.Eras,Jn.Narrow);break;case"y":e=po(un.FullYear,1,0,!1,!0);break;case"yy":e=po(un.FullYear,2,0,!0,!0);break;case"yyy":e=po(un.FullYear,3,0,!1,!0);break;case"yyyy":e=po(un.FullYear,4,0,!1,!0);break;case"Y":e=A0(1);break;case"YY":e=A0(2,!0);break;case"YYY":e=A0(3);break;case"YYYY":e=A0(4);break;case"M":case"L":e=po(un.Month,1,1);break;case"MM":case"LL":e=po(un.Month,2,1);break;case"MMM":e=Qi(Pn.Months,Jn.Abbreviated);break;case"MMMM":e=Qi(Pn.Months,Jn.Wide);break;case"MMMMM":e=Qi(Pn.Months,Jn.Narrow);break;case"LLL":e=Qi(Pn.Months,Jn.Abbreviated,Kr.Standalone);break;case"LLLL":e=Qi(Pn.Months,Jn.Wide,Kr.Standalone);break;case"LLLLL":e=Qi(Pn.Months,Jn.Narrow,Kr.Standalone);break;case"w":e=Qw(1);break;case"ww":e=Qw(2);break;case"W":e=Qw(1,!0);break;case"d":e=po(un.Date,1);break;case"dd":e=po(un.Date,2);break;case"c":case"cc":e=po(un.Day,1);break;case"ccc":e=Qi(Pn.Days,Jn.Abbreviated,Kr.Standalone);break;case"cccc":e=Qi(Pn.Days,Jn.Wide,Kr.Standalone);break;case"ccccc":e=Qi(Pn.Days,Jn.Narrow,Kr.Standalone);break;case"cccccc":e=Qi(Pn.Days,Jn.Short,Kr.Standalone);break;case"E":case"EE":case"EEE":e=Qi(Pn.Days,Jn.Abbreviated);break;case"EEEE":e=Qi(Pn.Days,Jn.Wide);break;case"EEEEE":e=Qi(Pn.Days,Jn.Narrow);break;case"EEEEEE":e=Qi(Pn.Days,Jn.Short);break;case"a":case"aa":case"aaa":e=Qi(Pn.DayPeriods,Jn.Abbreviated);break;case"aaaa":e=Qi(Pn.DayPeriods,Jn.Wide);break;case"aaaaa":e=Qi(Pn.DayPeriods,Jn.Narrow);break;case"b":case"bb":case"bbb":e=Qi(Pn.DayPeriods,Jn.Abbreviated,Kr.Standalone,!0);break;case"bbbb":e=Qi(Pn.DayPeriods,Jn.Wide,Kr.Standalone,!0);break;case"bbbbb":e=Qi(Pn.DayPeriods,Jn.Narrow,Kr.Standalone,!0);break;case"B":case"BB":case"BBB":e=Qi(Pn.DayPeriods,Jn.Abbreviated,Kr.Format,!0);break;case"BBBB":e=Qi(Pn.DayPeriods,Jn.Wide,Kr.Format,!0);break;case"BBBBB":e=Qi(Pn.DayPeriods,Jn.Narrow,Kr.Format,!0);break;case"h":e=po(un.Hours,1,-12);break;case"hh":e=po(un.Hours,2,-12);break;case"H":e=po(un.Hours,1);break;case"HH":e=po(un.Hours,2);break;case"m":e=po(un.Minutes,1);break;case"mm":e=po(un.Minutes,2);break;case"s":e=po(un.Seconds,1);break;case"ss":e=po(un.Seconds,2);break;case"S":e=po(un.FractionalSeconds,1);break;case"SS":e=po(un.FractionalSeconds,2);break;case"SSS":e=po(un.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":e=S0(Bo.Short);break;case"ZZZZZ":e=S0(Bo.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":e=S0(Bo.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":e=S0(Bo.Long);break;default:return null}return e1[n]=e,e}(O);M+=U?U(s,t,C):"''"===O?"'":O.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),M}function D0(n,e,t){const i=new Date(0);return i.setFullYear(n,e,t),i.setHours(0,0,0),i}function fh(n,e){const t=function xF(n){return ta(n)[Mt.LocaleId]}(n);if(B_[t]=B_[t]||{},B_[t][e])return B_[t][e];let i="";switch(e){case"shortDate":i=w0(n,br.Short);break;case"mediumDate":i=w0(n,br.Medium);break;case"longDate":i=w0(n,br.Long);break;case"fullDate":i=w0(n,br.Full);break;case"shortTime":i=E0(n,br.Short);break;case"mediumTime":i=E0(n,br.Medium);break;case"longTime":i=E0(n,br.Long);break;case"fullTime":i=E0(n,br.Full);break;case"short":const s=fh(n,"shortTime"),u=fh(n,"shortDate");i=T0(C0(n,br.Short),[s,u]);break;case"medium":const p=fh(n,"mediumTime"),v=fh(n,"mediumDate");i=T0(C0(n,br.Medium),[p,v]);break;case"long":const C=fh(n,"longTime"),M=fh(n,"longDate");i=T0(C0(n,br.Long),[C,M]);break;case"full":const O=fh(n,"fullTime"),U=fh(n,"fullDate");i=T0(C0(n,br.Full),[O,U])}return i&&(B_[t][e]=i),i}function T0(n,e){return e&&(n=n.replace(/\{([^}]+)}/g,function(t,i){return null!=e&&i in e?e[i]:t})),n}function Pc(n,e,t="-",i,s){let u="";(n<0||s&&n<=0)&&(s?n=1-n:(n=-n,u=t));let p=String(n);for(;p.length<e;)p="0"+p;return i&&(p=p.slice(p.length-e)),u+p}function po(n,e,t=0,i=!1,s=!1){return function(u,p){let v=function LF(n,e){switch(n){case un.FullYear:return e.getFullYear();case un.Month:return e.getMonth();case un.Date:return e.getDate();case un.Hours:return e.getHours();case un.Minutes:return e.getMinutes();case un.Seconds:return e.getSeconds();case un.FractionalSeconds:return e.getMilliseconds();case un.Day:return e.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}(n,u);if((t>0||v>-t)&&(v+=t),n===un.Hours)0===v&&-12===t&&(v=12);else if(n===un.FractionalSeconds)return function FF(n,e){return Pc(n,3).substring(0,e)}(v,e);const C=ql(p,sn.MinusSign);return Pc(v,e,C,i,s)}}function Qi(n,e,t=Kr.Format,i=!1){return function(s,u){return function NF(n,e,t,i,s,u){switch(t){case Pn.Months:return function EF(n,e,t){const i=ta(n),u=Wl([i[Mt.MonthsFormat],i[Mt.MonthsStandalone]],e);return Wl(u,t)}(e,s,i)[n.getMonth()];case Pn.Days:return function wF(n,e,t){const i=ta(n),u=Wl([i[Mt.DaysFormat],i[Mt.DaysStandalone]],e);return Wl(u,t)}(e,s,i)[n.getDay()];case Pn.DayPeriods:const p=n.getHours(),v=n.getMinutes();if(u){const M=function SF(n){const e=ta(n);return fS(e),(e[Mt.ExtraData][2]||[]).map(i=>"string"==typeof i?Jw(i):[Jw(i[0]),Jw(i[1])])}(e),O=function MF(n,e,t){const i=ta(n);fS(i);const u=Wl([i[Mt.ExtraData][0],i[Mt.ExtraData][1]],e)||[];return Wl(u,t)||[]}(e,s,i),U=M.findIndex(Q=>{if(Array.isArray(Q)){const[se,fe]=Q,Ee=p>=se.hours&&v>=se.minutes,Be=p<fe.hours||p===fe.hours&&v<fe.minutes;if(se.hours<fe.hours){if(Ee&&Be)return!0}else if(Ee||Be)return!0}else if(Q.hours===p&&Q.minutes===v)return!0;return!1});if(-1!==U)return O[U]}return function bF(n,e,t){const i=ta(n),u=Wl([i[Mt.DayPeriodsFormat],i[Mt.DayPeriodsStandalone]],e);return Wl(u,t)}(e,s,i)[p<12?0:1];case Pn.Eras:return function CF(n,e){return Wl(ta(n)[Mt.Eras],e)}(e,i)[n.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${t}`)}}(s,u,n,e,t,i)}}function S0(n){return function(e,t,i){const s=-1*i,u=ql(t,sn.MinusSign),p=s>0?Math.floor(s/60):Math.ceil(s/60);switch(n){case Bo.Short:return(s>=0?"+":"")+Pc(p,2,u)+Pc(Math.abs(s%60),2,u);case Bo.ShortGMT:return"GMT"+(s>=0?"+":"")+Pc(p,1,u);case Bo.Long:return"GMT"+(s>=0?"+":"")+Pc(p,2,u)+":"+Pc(Math.abs(s%60),2,u);case Bo.Extended:return 0===i?"Z":(s>=0?"+":"")+Pc(p,2,u)+":"+Pc(Math.abs(s%60),2,u);default:throw new Error(`Unknown zone width "${n}"`)}}}const BF=0,M0=4;function pS(n){return D0(n.getFullYear(),n.getMonth(),n.getDate()+(M0-n.getDay()))}function Qw(n,e=!1){return function(t,i){let s;if(e){const u=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,p=t.getDate();s=1+Math.floor((p+u)/7)}else{const u=pS(t),p=function zF(n){const e=D0(n,BF,1).getDay();return D0(n,0,1+(e<=M0?M0:M0+7)-e)}(u.getFullYear()),v=u.getTime()-p.getTime();s=1+Math.round(v/6048e5)}return Pc(s,n,ql(i,sn.MinusSign))}}function A0(n,e=!1){return function(t,i){return Pc(pS(t).getFullYear(),n,ql(i,sn.MinusSign),e)}}const e1={};function mS(n,e){n=n.replace(/:/g,"");const t=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(t)?e:t}function gS(n){return n instanceof Date&&!isNaN(n.valueOf())}function xS(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const i=t.indexOf("="),[s,u]=-1==i?[t,""]:[t.slice(0,i),t.slice(i+1)];if(s.trim()===e)return decodeURIComponent(u)}return null}let DS=(()=>{class n{constructor(t,i){this._viewContainer=t,this._context=new aL,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){TS("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){TS("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,i){return!0}}return n.\u0275fac=function(t){return new(t||n)($e(Gl),$e(mu))},n.\u0275dir=Nt({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class aL{constructor(){this.$implicit=null,this.ngIf=null}}function TS(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${Dt(e)}'.`)}function kc(n,e){return new Le(2100,!1)}let MS=(()=>{class n{transform(t){if(null==t)return null;if("string"!=typeof t)throw kc();return t.toUpperCase()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275pipe=Tr({name:"uppercase",type:n,pure:!0,standalone:!0}),n})();const vL=new xt("DATE_PIPE_DEFAULT_TIMEZONE"),xL=new xt("DATE_PIPE_DEFAULT_OPTIONS");let AS=(()=>{class n{constructor(t,i,s){this.locale=t,this.defaultTimezone=i,this.defaultOptions=s}transform(t,i,s,u){if(null==t||""===t||t!=t)return null;try{return OF(t,i??this.defaultOptions?.dateFormat??"mediumDate",u||this.locale,s??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(p){throw kc()}}}return n.\u0275fac=function(t){return new(t||n)($e(gu,16),$e(vL,24),$e(xL,24))},n.\u0275pipe=Tr({name:"date",type:n,pure:!0,standalone:!0}),n})(),IL=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})();const PS="browser";function d1(n){return n===PS}let OL=(()=>{class n{}return n.\u0275prov=pt({token:n,providedIn:"root",factory:()=>new FL(ze(ei),window)}),n})();class FL{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function LL(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let s=i.currentNode;for(;s;){const u=s.shadowRoot;if(u){const p=u.getElementById(e)||u.querySelector(`[name="${e}"]`);if(p)return p}s=i.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),i=t.left+this.window.pageXOffset,s=t.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(i-u[0],s-u[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=kS(this.window.history)||kS(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function kS(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class RS{}class cN extends dF{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class m1 extends cN{static makeCurrent(){!function hF(n){Zw||(Zw=n)}(new m1)}onAndCancel(e,t,i){return e.addEventListener(t,i,!1),()=>{e.removeEventListener(t,i,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function uN(){return U_=U_||document.querySelector("base"),U_?U_.getAttribute("href"):null}();return null==t?null:function hN(n){R0=R0||document.createElement("a"),R0.setAttribute("href",n);const e=R0.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){U_=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return xS(document.cookie,e)}}let R0,U_=null;const BS=new xt("TRANSITION_ID"),fN=[{provide:k_,useFactory:function dN(n,e,t){return()=>{t.get(g0).donePromise.then(()=>{const i=hh(),s=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let u=0;u<s.length;u++)i.remove(s[u])})}},deps:[BS,ei,Or],multi:!0}];let mN=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const O0=new xt("EventManagerPlugins");let F0=(()=>{class n{constructor(t,i){this._zone=i,this._eventNameToPlugin=new Map,t.forEach(s=>{s.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,i,s){return this._findPluginFor(i).addEventListener(t,i,s)}addGlobalEventListener(t,i,s){return this._findPluginFor(i).addGlobalEventListener(t,i,s)}getZone(){return this._zone}_findPluginFor(t){const i=this._eventNameToPlugin.get(t);if(i)return i;const s=this._plugins;for(let u=0;u<s.length;u++){const p=s[u];if(p.supports(t))return this._eventNameToPlugin.set(t,p),p}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(ze(O0),ze(On))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();class zS{constructor(e){this._doc=e}addGlobalEventListener(e,t,i){const s=hh().getGlobalEventTarget(this._doc,e);if(!s)throw new Error(`Unsupported event target ${s} for event ${t}`);return this.addEventListener(s,t,i)}}let VS=(()=>{class n{constructor(){this.usageCount=new Map}addStyles(t){for(const i of t)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(t){for(const i of t)0===this.changeUsageCount(i,-1)&&this.onStyleRemoved(i)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,i){const s=this.usageCount;let u=s.get(t)??0;return u+=i,u>0?s.set(t,u):s.delete(t),u}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),j_=(()=>{class n extends VS{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const i of this.hostNodes)this.addStyleToHost(i,t)}onStyleRemoved(t){const i=this.styleRef;i.get(t)?.forEach(u=>u.remove()),i.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const i of this.getAllStyles())this.addStyleToHost(t,i)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,i){const s=this.doc.createElement("style");s.textContent=i,t.appendChild(s);const u=this.styleRef.get(i);u?u.push(s):this.styleRef.set(i,[s])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const g1={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},_1=/%COMP%/g,$S=new xt("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function HS(n,e){return e.flat(100).map(t=>t.replace(_1,n))}function GS(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let L0=(()=>{class n{constructor(t,i,s,u){this.eventManager=t,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestory=u,this.rendererByCompId=new Map,this.defaultRenderer=new y1(t)}createRenderer(t,i){if(!t||!i)return this.defaultRenderer;const s=this.getOrCreateRenderer(t,i);return s instanceof ZS?s.applyToHost(t):s instanceof v1&&s.applyStyles(),s}getOrCreateRenderer(t,i){const s=this.rendererByCompId;let u=s.get(i.id);if(!u){const p=this.eventManager,v=this.sharedStylesHost,C=this.removeStylesOnCompDestory;switch(i.encapsulation){case So.Emulated:u=new ZS(p,v,i,this.appId,C);break;case So.ShadowDom:return new wN(p,v,t,i);default:u=new v1(p,v,i,C)}u.onDestroy=()=>s.delete(i.id),s.set(i.id,u)}return u}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(ze(F0),ze(j_),ze(R_),ze($S))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();class y1{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(g1[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(WS(e)?e.content:e).appendChild(t)}insertBefore(e,t,i){e&&(WS(e)?e.content:e).insertBefore(t,i)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let i="string"==typeof e?document.querySelector(e):e;if(!i)throw new Error(`The selector "${e}" did not match any elements`);return t||(i.textContent=""),i}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,i,s){if(s){t=s+":"+t;const u=g1[s];u?e.setAttributeNS(u,t,i):e.setAttribute(t,i)}else e.setAttribute(t,i)}removeAttribute(e,t,i){if(i){const s=g1[i];s?e.removeAttributeNS(s,t):e.removeAttribute(`${i}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,i,s){s&(Wr.DashCase|Wr.Important)?e.style.setProperty(t,i,s&Wr.Important?"important":""):e.style[t]=i}removeStyle(e,t,i){i&Wr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,i){e[t]=i}setValue(e,t){e.nodeValue=t}listen(e,t,i){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,GS(i)):this.eventManager.addEventListener(e,t,GS(i))}}function WS(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class wN extends y1{constructor(e,t,i,s){super(e),this.sharedStylesHost=t,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=HS(s.id,s.styles);for(const p of u){const v=document.createElement("style");v.textContent=p,this.shadowRoot.appendChild(v)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,i){return super.insertBefore(this.nodeOrShadowRoot(e),t,i)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class v1 extends y1{constructor(e,t,i,s,u=i.id){super(e),this.sharedStylesHost=t,this.removeStylesOnCompDestory=s,this.rendererUsageCount=0,this.styles=HS(u,i.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class ZS extends v1{constructor(e,t,i,s,u){const p=s+"-"+i.id;super(e,t,i,u,p),this.contentAttr=function vN(n){return"_ngcontent-%COMP%".replace(_1,n)}(p),this.hostAttr=function xN(n){return"_nghost-%COMP%".replace(_1,n)}(p)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const i=super.createElement(e,t);return super.setAttribute(i,this.contentAttr,""),i}}let EN=(()=>{class n extends zS{constructor(t){super(t)}supports(t){return!0}addEventListener(t,i,s){return t.addEventListener(i,s,!1),()=>this.removeEventListener(t,i,s)}removeEventListener(t,i,s){return t.removeEventListener(i,s)}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const XS=["alt","control","meta","shift"],CN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},DN={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let TN=(()=>{class n extends zS{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,i,s){const u=n.parseEventName(i),p=n.eventCallback(u.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>hh().onAndCancel(t,u.domEventName,p))}static parseEventName(t){const i=t.toLowerCase().split("."),s=i.shift();if(0===i.length||"keydown"!==s&&"keyup"!==s)return null;const u=n._normalizeKey(i.pop());let p="",v=i.indexOf("code");if(v>-1&&(i.splice(v,1),p="code."),XS.forEach(M=>{const O=i.indexOf(M);O>-1&&(i.splice(O,1),p+=M+".")}),p+=u,0!=i.length||0===u.length)return null;const C={};return C.domEventName=s,C.fullKey=p,C}static matchEventFullKeyCode(t,i){let s=CN[t.key]||t.key,u="";return i.indexOf("code.")>-1&&(s=t.code,u="code."),!(null==s||!s)&&(s=s.toLowerCase()," "===s?s="space":"."===s&&(s="dot"),XS.forEach(p=>{p!==s&&(0,DN[p])(t)&&(u+=p+".")}),u+=s,u===i)}static eventCallback(t,i,s){return u=>{n.matchEventFullKeyCode(u,t)&&s.runGuarded(()=>i(u))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const IN=$T(lF,"browser",[{provide:am,useValue:PS},{provide:kT,useValue:function SN(){m1.makeCurrent()},multi:!0},{provide:ei,useFactory:function AN(){return function sr(n){xg=n}(document),document},deps:[]}]),JS=new xt(""),QS=[{provide:_0,useClass:class pN{addToWindow(e){ai.getAngularTestability=(i,s=!0)=>{const u=e.findTestabilityInTree(i,s);if(null==u)throw new Error("Could not find testability for element.");return u},ai.getAllAngularTestabilities=()=>e.getAllTestabilities(),ai.getAllAngularRootElements=()=>e.getAllRootElements(),ai.frameworkStabilizers||(ai.frameworkStabilizers=[]),ai.frameworkStabilizers.push(i=>{const s=ai.getAllAngularTestabilities();let u=s.length,p=!1;const v=function(C){p=p||C,u--,0==u&&i(p)};s.forEach(function(C){C.whenStable(v)})})}findTestabilityInTree(e,t,i){return null==t?null:e.getTestability(t)??(i?hh().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:BT,useClass:zw,deps:[On,Vw,_0]},{provide:zw,useClass:zw,deps:[On,Vw,_0]}],eM=[{provide:zg,useValue:"root"},{provide:th,useFactory:function MN(){return new th},deps:[]},{provide:O0,useClass:EN,multi:!0,deps:[ei,On,am]},{provide:O0,useClass:TN,multi:!0,deps:[ei]},{provide:L0,useClass:L0,deps:[F0,j_,R_,$S]},{provide:mf,useExisting:L0},{provide:VS,useExisting:j_},{provide:j_,useClass:j_,deps:[ei]},{provide:F0,useClass:F0,deps:[O0,On]},{provide:RS,useClass:mN,deps:[]},[]];let tM=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:R_,useValue:t.appId},{provide:BS,useExisting:R_},fN]}}}return n.\u0275fac=function(t){return new(t||n)(ze(JS,12))},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[...eM,...QS],imports:[IL,cF]}),n})(),nM=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:function(t){let i=null;return i=t?new t:function kN(){return new nM(ze(ei))}(),i},providedIn:"root"}),n})();function Ut(...n){return Li(n,no(n))}typeof window<"u"&&window;class Zl extends mn{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:i}=this;if(e)throw t;return this._throwIfClosed(),i}next(e){super.next(this._value=e)}}const N0=Oc(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:BN}=Array,{getPrototypeOf:zN,prototype:VN,keys:UN}=Object;function oM(n){if(1===n.length){const e=n[0];if(BN(e))return{args:e,keys:null};if(function jN(n){return n&&"object"==typeof n&&zN(n)===VN}(e)){const t=UN(e);return{args:t.map(i=>e[i]),keys:t}}}return{args:n,keys:null}}const{isArray:$N}=Array;function w1(n){return gt(e=>function HN(n,e){return $N(e)?n(...e):n(e)}(n,e))}function sM(n,e){return n.reduce((t,i,s)=>(t[i]=e[s],t),{})}function E1(...n){const e=no(n),t=ic(n),{args:i,keys:s}=oM(n);if(0===i.length)return Li([],e);const u=new Lt(function GN(n,e,t=eo){return i=>{aM(e,()=>{const{length:s}=n,u=new Array(s);let p=s,v=s;for(let C=0;C<s;C++)aM(e,()=>{const M=Li(n[C],e);let O=!1;M.subscribe(Ln(i,U=>{u[C]=U,O||(O=!0,v--),v||i.next(t(u.slice()))},()=>{--p||i.complete()}))},i)},i)}}(i,e,s?p=>sM(s,p):eo));return t?u.pipe(w1(t)):u}function aM(n,e,t){n?Qn(t,n,e):e()}function cm(...n){return function qN(){return ir(1)}()(Li(n,no(n)))}function um(n){return new Lt(e=>{It(n()).subscribe(e)})}function hm(n,e){const t=pn(n)?n:()=>n,i=s=>s.error(t());return new Lt(e?s=>e.schedule(i,0,s):i)}function C1(){return ni((n,e)=>{let t=null;n._refCount++;const i=Ln(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const s=n._connection,u=t;t=null,s&&(!u||s===u)&&s.unsubscribe(),e.unsubscribe()});n.subscribe(i),i.closed||(t=n.connect())})}class D1 extends Lt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,fs(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ke;const t=this.getSubject();e.add(this.source.subscribe(Ln(t,void 0,()=>{this._teardown(),t.complete()},i=>{this._teardown(),t.error(i)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ke.EMPTY)}return e}refCount(){return C1()(this)}}function Sa(n,e){return ni((t,i)=>{let s=null,u=0,p=!1;const v=()=>p&&!s&&i.complete();t.subscribe(Ln(i,C=>{s?.unsubscribe();let M=0;const O=u++;It(n(C,O)).subscribe(s=Ln(i,U=>i.next(e?e(C,U,O,M++):U),()=>{s=null,v()}))},()=>{p=!0,v()}))})}function mo(n){return n<=0?()=>Qo:ni((e,t)=>{let i=0;e.subscribe(Ln(t,s=>{++i<=n&&(t.next(s),n<=i&&t.complete())}))})}function $_(...n){const e=no(n);return ni((t,i)=>{(e?cm(n,t,e):cm(n,t)).subscribe(i)})}function Br(n,e){return ni((t,i)=>{let s=0;t.subscribe(Ln(i,u=>n.call(e,u,s++)&&i.next(u)))})}function B0(n){return ni((e,t)=>{let i=!1;e.subscribe(Ln(t,s=>{i=!0,t.next(s)},()=>{i||t.next(n),t.complete()}))})}function lM(n=WN){return ni((e,t)=>{let i=!1;e.subscribe(Ln(t,s=>{i=!0,t.next(s)},()=>i?t.complete():t.error(n())))})}function WN(){return new N0}function Ed(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Br((s,u)=>n(s,u,i)):eo,mo(1),t?B0(e):lM(()=>new N0))}function Cd(n,e){return pn(e)?pi(n,e,1):pi(n,1)}function us(n,e,t){const i=pn(n)||e||t?{next:n,error:e,complete:t}:n;return i?ni((s,u)=>{var p;null===(p=i.subscribe)||void 0===p||p.call(i);let v=!0;s.subscribe(Ln(u,C=>{var M;null===(M=i.next)||void 0===M||M.call(i,C),u.next(C)},()=>{var C;v=!1,null===(C=i.complete)||void 0===C||C.call(i),u.complete()},C=>{var M;v=!1,null===(M=i.error)||void 0===M||M.call(i,C),u.error(C)},()=>{var C,M;v&&(null===(C=i.unsubscribe)||void 0===C||C.call(i)),null===(M=i.finalize)||void 0===M||M.call(i)}))}):eo}function Dd(n){return ni((e,t)=>{let u,i=null,s=!1;i=e.subscribe(Ln(t,void 0,void 0,p=>{u=It(n(p,Dd(n)(e))),i?(i.unsubscribe(),i=null,u.subscribe(t)):s=!0})),s&&(i.unsubscribe(),i=null,u.subscribe(t))})}function cM(n,e){return ni(function ZN(n,e,t,i,s){return(u,p)=>{let v=t,C=e,M=0;u.subscribe(Ln(p,O=>{const U=M++;C=v?n(C,O,U):(v=!0,O),i&&p.next(C)},s&&(()=>{v&&p.next(C),p.complete()})))}}(n,e,arguments.length>=2,!0))}function T1(n){return n<=0?()=>Qo:ni((e,t)=>{let i=[];e.subscribe(Ln(t,s=>{i.push(s),n<i.length&&i.shift()},()=>{for(const s of i)t.next(s);t.complete()},void 0,()=>{i=null}))})}function uM(n,e){const t=arguments.length>=2;return i=>i.pipe(n?Br((s,u)=>n(s,u,i)):eo,T1(1),t?B0(e):lM(()=>new N0))}function hM(n){return gt(()=>n)}function S1(n){return ni((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Dn="primary",H_=Symbol("RouteTitle");class KN{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function dm(n){return new KN(n)}function YN(n,e,t){const i=t.path.split("/");if(i.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||i.length<n.length))return null;const s={};for(let u=0;u<i.length;u++){const p=i[u],v=n[u];if(p.startsWith(":"))s[p.substring(1)]=v;else if(p!==v.path)return null}return{consumed:n.slice(0,i.length),posParams:s}}function _u(n,e){const t=n?Object.keys(n):void 0,i=e?Object.keys(e):void 0;if(!t||!i||t.length!=i.length)return!1;let s;for(let u=0;u<t.length;u++)if(s=t[u],!dM(n[s],e[s]))return!1;return!0}function dM(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),i=[...e].sort();return t.every((s,u)=>i[u]===s)}return n===e}function fM(n){return Array.prototype.concat.apply([],n)}function pM(n){return n.length>0?n[n.length-1]:null}function hs(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function Td(n){return ho(n)?n:Fi(n)?Li(Promise.resolve(n)):Ut(n)}const z0=!1,QN={exact:function _M(n,e,t){if(!Of(n.segments,e.segments)||!V0(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const i in e.children)if(!n.children[i]||!_M(n.children[i],e.children[i],t))return!1;return!0},subset:yM},mM={exact:function eB(n,e){return _u(n,e)},subset:function tB(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>dM(n[t],e[t]))},ignored:()=>!0};function gM(n,e,t){return QN[t.paths](n.root,e.root,t.matrixParams)&&mM[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function yM(n,e,t){return vM(n,e,e.segments,t)}function vM(n,e,t,i){if(n.segments.length>t.length){const s=n.segments.slice(0,t.length);return!(!Of(s,t)||e.hasChildren()||!V0(s,t,i))}if(n.segments.length===t.length){if(!Of(n.segments,t)||!V0(n.segments,t,i))return!1;for(const s in e.children)if(!n.children[s]||!yM(n.children[s],e.children[s],i))return!1;return!0}{const s=t.slice(0,n.segments.length),u=t.slice(n.segments.length);return!!(Of(n.segments,s)&&V0(n.segments,s,i)&&n.children[Dn])&&vM(n.children[Dn],e,u,i)}}function V0(n,e,t){return e.every((i,s)=>mM[t](n[s].parameters,i.parameters))}class Sd{constructor(e=new jn([],{}),t={},i=null){this.root=e,this.queryParams=t,this.fragment=i}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=dm(this.queryParams)),this._queryParamMap}toString(){return rB.serialize(this)}}class jn{constructor(e,t){this.segments=e,this.children=t,this.parent=null,hs(t,(i,s)=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return U0(this)}}class G_{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=dm(this.parameters)),this._parameterMap}toString(){return wM(this)}}function Of(n,e){return n.length===e.length&&n.every((t,i)=>t.path===e[i].path)}let q_=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return new M1},providedIn:"root"}),n})();class M1{parse(e){const t=new fB(e);return new Sd(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${W_(e.root,!0)}`,i=function aB(n){const e=Object.keys(n).map(t=>{const i=n[t];return Array.isArray(i)?i.map(s=>`${j0(t)}=${j0(s)}`).join("&"):`${j0(t)}=${j0(i)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${i}${"string"==typeof e.fragment?`#${function oB(n){return encodeURI(n)}(e.fragment)}`:""}`}}const rB=new M1;function U0(n){return n.segments.map(e=>wM(e)).join("/")}function W_(n,e){if(!n.hasChildren())return U0(n);if(e){const t=n.children[Dn]?W_(n.children[Dn],!1):"",i=[];return hs(n.children,(s,u)=>{u!==Dn&&i.push(`${u}:${W_(s,!1)}`)}),i.length>0?`${t}(${i.join("//")})`:t}{const t=function iB(n,e){let t=[];return hs(n.children,(i,s)=>{s===Dn&&(t=t.concat(e(i,s)))}),hs(n.children,(i,s)=>{s!==Dn&&(t=t.concat(e(i,s)))}),t}(n,(i,s)=>s===Dn?[W_(n.children[Dn],!1)]:[`${s}:${W_(i,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Dn]?`${U0(n)}/${t[0]}`:`${U0(n)}/(${t.join("//")})`}}function xM(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function j0(n){return xM(n).replace(/%3B/gi,";")}function A1(n){return xM(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $0(n){return decodeURIComponent(n)}function bM(n){return $0(n.replace(/\+/g,"%20"))}function wM(n){return`${A1(n.path)}${function sB(n){return Object.keys(n).map(e=>`;${A1(e)}=${A1(n[e])}`).join("")}(n.parameters)}`}const lB=/^[^\/()?;=#]+/;function H0(n){const e=n.match(lB);return e?e[0]:""}const cB=/^[^=?&#]+/,hB=/^[^&#]+/;class fB{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new jn([],{}):new jn([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(i[Dn]=new jn(e,t)),i}parseSegment(){const e=H0(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Le(4009,z0);return this.capture(e),new G_($0(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=H0(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const s=H0(this.remaining);s&&(i=s,this.capture(i))}e[$0(t)]=$0(i)}parseQueryParam(e){const t=function uB(n){const e=n.match(cB);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let i="";if(this.consumeOptional("=")){const p=function dB(n){const e=n.match(hB);return e?e[0]:""}(this.remaining);p&&(i=p,this.capture(i))}const s=bM(t),u=bM(i);if(e.hasOwnProperty(s)){let p=e[s];Array.isArray(p)||(p=[p],e[s]=p),p.push(u)}else e[s]=u}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const i=H0(this.remaining),s=this.remaining[i.length];if("/"!==s&&")"!==s&&";"!==s)throw new Le(4010,z0);let u;i.indexOf(":")>-1?(u=i.slice(0,i.indexOf(":")),this.capture(u),this.capture(":")):e&&(u=Dn);const p=this.parseChildren();t[u]=1===Object.keys(p).length?p[Dn]:new jn([],p),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Le(4011,z0)}}function I1(n){return n.segments.length>0?new jn([],{[Dn]:n}):n}function G0(n){const e={};for(const i of Object.keys(n.children)){const u=G0(n.children[i]);(u.segments.length>0||u.hasChildren())&&(e[i]=u)}return function pB(n){if(1===n.numberOfChildren&&n.children[Dn]){const e=n.children[Dn];return new jn(n.segments.concat(e.segments),e.children)}return n}(new jn(n.segments,e))}function Ff(n){return n instanceof Sd}const P1=!1;function mB(n,e,t,i,s){if(0===t.length)return fm(e.root,e.root,e.root,i,s);const u=function SM(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new TM(!0,0,n);let e=0,t=!1;const i=n.reduce((s,u,p)=>{if("object"==typeof u&&null!=u){if(u.outlets){const v={};return hs(u.outlets,(C,M)=>{v[M]="string"==typeof C?C.split("/"):C}),[...s,{outlets:v}]}if(u.segmentPath)return[...s,u.segmentPath]}return"string"!=typeof u?[...s,u]:0===p?(u.split("/").forEach((v,C)=>{0==C&&"."===v||(0==C&&""===v?t=!0:".."===v?e++:""!=v&&s.push(v))}),s):[...s,u]},[]);return new TM(t,e,i)}(t);return u.toRoot()?fm(e.root,e.root,new jn([],{}),i,s):function p(C){const M=function _B(n,e,t,i){if(n.isAbsolute)return new pm(e.root,!0,0);if(-1===i)return new pm(t,t===e.root,0);return function MM(n,e,t){let i=n,s=e,u=t;for(;u>s;){if(u-=s,i=i.parent,!i)throw new Le(4005,P1&&"Invalid number of '../'");s=i.segments.length}return new pm(i,!1,s-u)}(t,i+(Z_(n.commands[0])?0:1),n.numberOfDoubleDots)}(u,e,n.snapshot?._urlSegment,C),O=M.processChildren?mm(M.segmentGroup,M.index,u.commands):k1(M.segmentGroup,M.index,u.commands);return fm(e.root,M.segmentGroup,O,i,s)}(n.snapshot?._lastPathIndex)}function Z_(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function X_(n){return"object"==typeof n&&null!=n&&n.outlets}function fm(n,e,t,i,s){let p,u={};i&&hs(i,(C,M)=>{u[M]=Array.isArray(C)?C.map(O=>`${O}`):`${C}`}),p=n===e?t:DM(n,e,t);const v=I1(G0(p));return new Sd(v,u,s)}function DM(n,e,t){const i={};return hs(n.children,(s,u)=>{i[u]=s===e?t:DM(s,e,t)}),new jn(n.segments,i)}class TM{constructor(e,t,i){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=i,e&&i.length>0&&Z_(i[0]))throw new Le(4003,P1&&"Root segment cannot have matrix parameters");const s=i.find(X_);if(s&&s!==pM(i))throw new Le(4004,P1&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class pm{constructor(e,t,i){this.segmentGroup=e,this.processChildren=t,this.index=i}}function k1(n,e,t){if(n||(n=new jn([],{})),0===n.segments.length&&n.hasChildren())return mm(n,e,t);const i=function vB(n,e,t){let i=0,s=e;const u={match:!1,pathIndex:0,commandIndex:0};for(;s<n.segments.length;){if(i>=t.length)return u;const p=n.segments[s],v=t[i];if(X_(v))break;const C=`${v}`,M=i<t.length-1?t[i+1]:null;if(s>0&&void 0===C)break;if(C&&M&&"object"==typeof M&&void 0===M.outlets){if(!IM(C,M,p))return u;i+=2}else{if(!IM(C,{},p))return u;i++}s++}return{match:!0,pathIndex:s,commandIndex:i}}(n,e,t),s=t.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){const u=new jn(n.segments.slice(0,i.pathIndex),{});return u.children[Dn]=new jn(n.segments.slice(i.pathIndex),n.children),mm(u,0,s)}return i.match&&0===s.length?new jn(n.segments,{}):i.match&&!n.hasChildren()?R1(n,e,t):i.match?mm(n,0,s):R1(n,e,t)}function mm(n,e,t){if(0===t.length)return new jn(n.segments,{});{const i=function yB(n){return X_(n[0])?n[0].outlets:{[Dn]:n}}(t),s={};if(!i[Dn]&&n.children[Dn]&&1===n.numberOfChildren&&0===n.children[Dn].segments.length){const u=mm(n.children[Dn],e,t);return new jn(n.segments,u.children)}return hs(i,(u,p)=>{"string"==typeof u&&(u=[u]),null!==u&&(s[p]=k1(n.children[p],e,u))}),hs(n.children,(u,p)=>{void 0===i[p]&&(s[p]=u)}),new jn(n.segments,s)}}function R1(n,e,t){const i=n.segments.slice(0,e);let s=0;for(;s<t.length;){const u=t[s];if(X_(u)){const C=xB(u.outlets);return new jn(i,C)}if(0===s&&Z_(t[0])){i.push(new G_(n.segments[e].path,AM(t[0]))),s++;continue}const p=X_(u)?u.outlets[Dn]:`${u}`,v=s<t.length-1?t[s+1]:null;p&&v&&Z_(v)?(i.push(new G_(p,AM(v))),s+=2):(i.push(new G_(p,{})),s++)}return new jn(i,{})}function xB(n){const e={};return hs(n,(t,i)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[i]=R1(new jn([],{}),0,t))}),e}function AM(n){const e={};return hs(n,(t,i)=>e[i]=`${t}`),e}function IM(n,e,t){return n==t.path&&_u(e,t.parameters)}const K_="imperative";class yu{constructor(e,t){this.id=e,this.url=t}}class O1 extends yu{constructor(e,t,i="imperative",s=null){super(e,t),this.type=0,this.navigationTrigger=i,this.restoredState=s}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Lf extends yu{constructor(e,t,i){super(e,t),this.urlAfterRedirects=i,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class q0 extends yu{constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class W0 extends yu{constructor(e,t,i,s){super(e,t),this.reason=i,this.code=s,this.type=16}}class F1 extends yu{constructor(e,t,i,s){super(e,t),this.error=i,this.target=s,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class bB extends yu{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wB extends yu{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class EB extends yu{constructor(e,t,i,s,u){super(e,t),this.urlAfterRedirects=i,this.state=s,this.shouldActivate=u,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class CB extends yu{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class DB extends yu{constructor(e,t,i,s){super(e,t),this.urlAfterRedirects=i,this.state=s,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class TB{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class SB{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class MB{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class AB{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class IB{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PB{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class PM{constructor(e,t,i){this.routerEvent=e,this.position=t,this.anchor=i,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let OB=(()=>{class n{createUrlTree(t,i,s,u,p,v){return mB(t||i.root,s,u,p,v)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),LB=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(e){return OB.\u0275fac(e)},providedIn:"root"}),n})();class kM{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=L1(e,this._root);return t?t.children.map(i=>i.value):[]}firstChild(e){const t=L1(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=N1(e,this._root);return t.length<2?[]:t[t.length-2].children.map(s=>s.value).filter(s=>s!==e)}pathFromRoot(e){return N1(e,this._root).map(t=>t.value)}}function L1(n,e){if(n===e.value)return e;for(const t of e.children){const i=L1(n,t);if(i)return i}return null}function N1(n,e){if(n===e.value)return[e];for(const t of e.children){const i=N1(n,t);if(i.length)return i.unshift(e),i}return[]}class ph{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function gm(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class RM extends kM{constructor(e,t){super(e),this.snapshot=t,B1(this,e)}toString(){return this.snapshot.toString()}}function OM(n,e){const t=function NB(n,e){const p=new Z0([],{},{},"",{},Dn,e,null,n.root,-1,{});return new LM("",new ph(p,[]))}(n,e),i=new Zl([new G_("",{})]),s=new Zl({}),u=new Zl({}),p=new Zl({}),v=new Zl(""),C=new _m(i,s,p,v,u,Dn,e,t.root);return C.snapshot=t.root,new RM(new ph(C,[]),t)}class _m{constructor(e,t,i,s,u,p,v,C){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=u,this.outlet=p,this.component=v,this.title=this.data?.pipe(gt(M=>M[H_]))??Ut(void 0),this._futureSnapshot=C}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(gt(e=>dm(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(gt(e=>dm(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function FM(n,e="emptyOnly"){const t=n.pathFromRoot;let i=0;if("always"!==e)for(i=t.length-1;i>=1;){const s=t[i],u=t[i-1];if(s.routeConfig&&""===s.routeConfig.path)i--;else{if(u.component)break;i--}}return function BB(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(i))}class Z0{get title(){return this.data?.[H_]}constructor(e,t,i,s,u,p,v,C,M,O,U){this.url=e,this.params=t,this.queryParams=i,this.fragment=s,this.data=u,this.outlet=p,this.component=v,this.routeConfig=C,this._urlSegment=M,this._lastPathIndex=O,this._resolve=U}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=dm(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=dm(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(i=>i.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class LM extends kM{constructor(e,t){super(t),this.url=e,B1(this,t)}toString(){return NM(this._root)}}function B1(n,e){e.value._routerState=n,e.children.forEach(t=>B1(n,t))}function NM(n){const e=n.children.length>0?` { ${n.children.map(NM).join(", ")} } `:"";return`${n.value}${e}`}function z1(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,_u(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),_u(e.params,t.params)||n.params.next(t.params),function JN(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!_u(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),_u(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function V1(n,e){const t=_u(n.params,e.params)&&function nB(n,e){return Of(n,e)&&n.every((t,i)=>_u(t.parameters,e[i].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||V1(n.parent,e.parent))}function Y_(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const i=t.value;i._futureSnapshot=e.value;const s=function VB(n,e,t){return e.children.map(i=>{for(const s of t.children)if(n.shouldReuseRoute(i.value,s.value.snapshot))return Y_(n,i,s);return Y_(n,i)})}(n,e,t);return new ph(i,s)}{if(n.shouldAttach(e.value)){const u=n.retrieve(e.value);if(null!==u){const p=u.route;return p.value._futureSnapshot=e.value,p.children=e.children.map(v=>Y_(n,v)),p}}const i=function UB(n){return new _m(new Zl(n.url),new Zl(n.params),new Zl(n.queryParams),new Zl(n.fragment),new Zl(n.data),n.outlet,n.component,n)}(e.value),s=e.children.map(u=>Y_(n,u));return new ph(i,s)}}const U1="ngNavigationCancelingError";function BM(n,e){const{redirectTo:t,navigationBehaviorOptions:i}=Ff(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,s=zM(!1,0,e);return s.url=t,s.navigationBehaviorOptions=i,s}function zM(n,e,t){const i=new Error("NavigationCancelingError: "+(n||""));return i[U1]=!0,i.cancellationCode=e,t&&(i.url=t),i}function VM(n){return UM(n)&&Ff(n.url)}function UM(n){return n&&n[U1]}class jB{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new J_,this.attachRef=null}}let J_=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,i){const s=this.getOrCreateContext(t);s.outlet=i,this.contexts.set(t,s)}onChildOutletDestroyed(t){const i=this.getContext(t);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let i=this.getContext(t);return i||(i=new jB,this.contexts.set(t,i)),i}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const X0=!1;let j1=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Dn,this.activateEvents=new cr,this.deactivateEvents=new cr,this.attachEvents=new cr,this.detachEvents=new cr,this.parentContexts=Zt(J_),this.location=Zt(Gl),this.changeDetector=Zt(F_),this.environmentInjector=Zt(Ul)}ngOnChanges(t){if(t.name){const{firstChange:i,previousValue:s}=t.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Le(4012,X0);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Le(4012,X0);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Le(4012,X0);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,i){this.activated=t,this._activatedRoute=i,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,i){if(this.isActivated)throw new Le(4013,X0);this._activatedRoute=t;const s=this.location,p=t.snapshot.component,v=this.parentContexts.getOrCreateContext(this.name).children,C=new $B(t,v,s.injector);if(i&&function HB(n){return!!n.resolveComponentFactory}(i)){const M=i.resolveComponentFactory(p);this.activated=s.createComponent(M,s.length,C)}else this.activated=s.createComponent(p,{index:s.length,injector:C,environmentInjector:i??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=Nt({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Mr]}),n})();class $B{constructor(e,t,i){this.route=e,this.childContexts=t,this.parent=i}get(e,t){return e===_m?this.route:e===J_?this.childContexts:this.parent.get(e,t)}}let $1=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Mo({type:n,selectors:[["ng-component"]],standalone:!0,features:[yw],decls:1,vars:0,template:function(t,i){1&t&&gi(0,"router-outlet")},dependencies:[j1],encapsulation:2}),n})();function jM(n,e){return n.providers&&!n._injector&&(n._injector=u0(n.providers,e,`Route: ${n.path}`)),n._injector??e}function G1(n){const e=n.children&&n.children.map(G1),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Dn&&(t.component=$1),t}function Xl(n){return n.outlet||Dn}function $M(n,e){const t=n.filter(i=>Xl(i)===e);return t.push(...n.filter(i=>Xl(i)!==e)),t}function Q_(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class XB{constructor(e,t,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=i,this.forwardEvent=s}activate(e){const t=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,i,e),z1(this.futureState.root),this.activateChildRoutes(t,i,e)}deactivateChildRoutes(e,t,i){const s=gm(t);e.children.forEach(u=>{const p=u.value.outlet;this.deactivateRoutes(u,s[p],i),delete s[p]}),hs(s,(u,p)=>{this.deactivateRouteAndItsChildren(u,i)})}deactivateRoutes(e,t,i){const s=e.value,u=t?t.value:null;if(s===u)if(s.component){const p=i.getContext(s.outlet);p&&this.deactivateChildRoutes(e,t,p.children)}else this.deactivateChildRoutes(e,t,i);else u&&this.deactivateRouteAndItsChildren(t,i)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,u=gm(e);for(const p of Object.keys(u))this.deactivateRouteAndItsChildren(u[p],s);if(i&&i.outlet){const p=i.outlet.detach(),v=i.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:p,route:e,contexts:v})}}deactivateRouteAndOutlet(e,t){const i=t.getContext(e.value.outlet),s=i&&e.value.component?i.children:t,u=gm(e);for(const p of Object.keys(u))this.deactivateRouteAndItsChildren(u[p],s);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.resolver=null,i.route=null)}activateChildRoutes(e,t,i){const s=gm(t);e.children.forEach(u=>{this.activateRoutes(u,s[u.value.outlet],i),this.forwardEvent(new PB(u.value.snapshot))}),e.children.length&&this.forwardEvent(new AB(e.value.snapshot))}activateRoutes(e,t,i){const s=e.value,u=t?t.value:null;if(z1(s),s===u)if(s.component){const p=i.getOrCreateContext(s.outlet);this.activateChildRoutes(e,t,p.children)}else this.activateChildRoutes(e,t,i);else if(s.component){const p=i.getOrCreateContext(s.outlet);if(this.routeReuseStrategy.shouldAttach(s.snapshot)){const v=this.routeReuseStrategy.retrieve(s.snapshot);this.routeReuseStrategy.store(s.snapshot,null),p.children.onOutletReAttached(v.contexts),p.attachRef=v.componentRef,p.route=v.route.value,p.outlet&&p.outlet.attach(v.componentRef,v.route.value),z1(v.route.value),this.activateChildRoutes(e,null,p.children)}else{const v=Q_(s.snapshot),C=v?.get(ru)??null;p.attachRef=null,p.route=s,p.resolver=C,p.injector=v,p.outlet&&p.outlet.activateWith(s,p.injector),this.activateChildRoutes(e,null,p.children)}}else this.activateChildRoutes(e,null,i)}}class HM{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class K0{constructor(e,t){this.component=e,this.route=t}}function KB(n,e,t){const i=n._root;return ey(i,e?e._root:null,t,[i.value])}function ym(n,e){const t=Symbol(),i=e.get(n,t);return i===t?"function"!=typeof n||function Du(n){return null!==Vc(n)}(n)?e.get(n):n:i}function ey(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const u=gm(e);return n.children.forEach(p=>{(function JB(n,e,t,i,s={canDeactivateChecks:[],canActivateChecks:[]}){const u=n.value,p=e?e.value:null,v=t?t.getContext(n.value.outlet):null;if(p&&u.routeConfig===p.routeConfig){const C=function QB(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!Of(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Of(n.url,e.url)||!_u(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!V1(n,e)||!_u(n.queryParams,e.queryParams);default:return!V1(n,e)}}(p,u,u.routeConfig.runGuardsAndResolvers);C?s.canActivateChecks.push(new HM(i)):(u.data=p.data,u._resolvedData=p._resolvedData),ey(n,e,u.component?v?v.children:null:t,i,s),C&&v&&v.outlet&&v.outlet.isActivated&&s.canDeactivateChecks.push(new K0(v.outlet.component,p))}else p&&ty(e,v,s),s.canActivateChecks.push(new HM(i)),ey(n,null,u.component?v?v.children:null:t,i,s)})(p,u[p.value.outlet],t,i.concat([p.value]),s),delete u[p.value.outlet]}),hs(u,(p,v)=>ty(p,t.getContext(v),s)),s}function ty(n,e,t){const i=gm(n),s=n.value;hs(i,(u,p)=>{ty(u,s.component?e?e.children.getContext(p):null:e,t)}),t.canDeactivateChecks.push(new K0(s.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,s))}function ny(n){return"function"==typeof n}function q1(n){return n instanceof N0||"EmptyError"===n?.name}const Y0=Symbol("INITIAL_VALUE");function vm(){return Sa(n=>E1(n.map(e=>e.pipe(mo(1),$_(Y0)))).pipe(gt(e=>{for(const t of e)if(!0!==t){if(t===Y0)return Y0;if(!1===t||t instanceof Sd)return t}return!0}),Br(e=>e!==Y0),mo(1)))}function GM(n){return function zt(...n){return yo(n)}(us(e=>{if(Ff(e))throw BM(0,e)}),gt(e=>!0===e))}const W1={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function qM(n,e,t,i,s){const u=Z1(n,e,t);return u.matched?function gz(n,e,t,i){const s=e.canMatch;return s&&0!==s.length?Ut(s.map(p=>{const v=ym(p,n);return Td(function oz(n){return n&&ny(n.canMatch)}(v)?v.canMatch(e,t):n.runInContext(()=>v(e,t)))})).pipe(vm(),GM()):Ut(!0)}(i=jM(e,i),e,t).pipe(gt(p=>!0===p?u:{...W1})):Ut(u)}function Z1(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...W1}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const s=(e.matcher||YN)(t,n,e);if(!s)return{...W1};const u={};hs(s.posParams,(v,C)=>{u[C]=v.path});const p=s.consumed.length>0?{...u,...s.consumed[s.consumed.length-1].parameters}:u;return{matched:!0,consumedSegments:s.consumed,remainingSegments:t.slice(s.consumed.length),parameters:p,positionalParamSegments:s.posParams??{}}}function J0(n,e,t,i){if(t.length>0&&function vz(n,e,t){return t.some(i=>Q0(n,e,i)&&Xl(i)!==Dn)}(n,t,i)){const u=new jn(e,function yz(n,e,t,i){const s={};s[Dn]=i,i._sourceSegment=n,i._segmentIndexShift=e.length;for(const u of t)if(""===u.path&&Xl(u)!==Dn){const p=new jn([],{});p._sourceSegment=n,p._segmentIndexShift=e.length,s[Xl(u)]=p}return s}(n,e,i,new jn(t,n.children)));return u._sourceSegment=n,u._segmentIndexShift=e.length,{segmentGroup:u,slicedSegments:[]}}if(0===t.length&&function xz(n,e,t){return t.some(i=>Q0(n,e,i))}(n,t,i)){const u=new jn(n.segments,function _z(n,e,t,i,s){const u={};for(const p of i)if(Q0(n,t,p)&&!s[Xl(p)]){const v=new jn([],{});v._sourceSegment=n,v._segmentIndexShift=e.length,u[Xl(p)]=v}return{...s,...u}}(n,e,t,i,n.children));return u._sourceSegment=n,u._segmentIndexShift=e.length,{segmentGroup:u,slicedSegments:t}}const s=new jn(n.segments,n.children);return s._sourceSegment=n,s._segmentIndexShift=e.length,{segmentGroup:s,slicedSegments:t}}function Q0(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function WM(n,e,t,i){return!!(Xl(n)===i||i!==Dn&&Q0(e,t,n))&&("**"===n.path||Z1(e,n,t).matched)}function ZM(n,e,t){return 0===e.length&&!n.children[t]}const ex=!1;class tx{constructor(e){this.segmentGroup=e||null}}class XM{constructor(e){this.urlTree=e}}function iy(n){return hm(new tx(n))}function KM(n){return hm(new XM(n))}class Cz{constructor(e,t,i,s,u){this.injector=e,this.configLoader=t,this.urlSerializer=i,this.urlTree=s,this.config=u,this.allowRedirects=!0}apply(){const e=J0(this.urlTree.root,[],[],this.config).segmentGroup,t=new jn(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Dn).pipe(gt(u=>this.createUrlTree(G0(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Dd(u=>{if(u instanceof XM)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof tx?this.noMatchError(u):u}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Dn).pipe(gt(s=>this.createUrlTree(G0(s),e.queryParams,e.fragment))).pipe(Dd(s=>{throw s instanceof tx?this.noMatchError(s):s}))}noMatchError(e){return new Le(4002,ex)}createUrlTree(e,t,i){const s=I1(e);return new Sd(s,t,i)}expandSegmentGroup(e,t,i,s){return 0===i.segments.length&&i.hasChildren()?this.expandChildren(e,t,i).pipe(gt(u=>new jn([],u))):this.expandSegment(e,i,t,i.segments,s,!0)}expandChildren(e,t,i){const s=[];for(const u of Object.keys(i.children))"primary"===u?s.unshift(u):s.push(u);return Li(s).pipe(Cd(u=>{const p=i.children[u],v=$M(t,u);return this.expandSegmentGroup(e,v,p,u).pipe(gt(C=>({segment:C,outlet:u})))}),cM((u,p)=>(u[p.outlet]=p.segment,u),{}),uM())}expandSegment(e,t,i,s,u,p){return Li(i).pipe(Cd(v=>this.expandSegmentAgainstRoute(e,t,i,v,s,u,p).pipe(Dd(M=>{if(M instanceof tx)return Ut(null);throw M}))),Ed(v=>!!v),Dd((v,C)=>{if(q1(v))return ZM(t,s,u)?Ut(new jn([],{})):iy(t);throw v}))}expandSegmentAgainstRoute(e,t,i,s,u,p,v){return WM(s,t,u,p)?void 0===s.redirectTo?this.matchSegmentAgainstRoute(e,t,s,u,p):v&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,i,s,u,p):iy(t):iy(t)}expandSegmentAgainstRouteUsingRedirect(e,t,i,s,u,p){return"**"===s.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,s,p):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,s,u,p)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,i,s){const u=this.applyRedirectCommands([],i.redirectTo,{});return i.redirectTo.startsWith("/")?KM(u):this.lineralizeSegments(i,u).pipe(pi(p=>{const v=new jn(p,{});return this.expandSegment(e,v,t,p,s,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,i,s,u,p){const{matched:v,consumedSegments:C,remainingSegments:M,positionalParamSegments:O}=Z1(t,s,u);if(!v)return iy(t);const U=this.applyRedirectCommands(C,s.redirectTo,O);return s.redirectTo.startsWith("/")?KM(U):this.lineralizeSegments(s,U).pipe(pi(Q=>this.expandSegment(e,t,i,Q.concat(M),p,!1)))}matchSegmentAgainstRoute(e,t,i,s,u){return"**"===i.path?(e=jM(i,e),i.loadChildren?(i._loadedRoutes?Ut({routes:i._loadedRoutes,injector:i._loadedInjector}):this.configLoader.loadChildren(e,i)).pipe(gt(v=>(i._loadedRoutes=v.routes,i._loadedInjector=v.injector,new jn(s,{})))):Ut(new jn(s,{}))):qM(t,i,s,e).pipe(Sa(({matched:p,consumedSegments:v,remainingSegments:C})=>p?this.getChildConfig(e=i._injector??e,i,s).pipe(pi(O=>{const U=O.injector??e,Q=O.routes,{segmentGroup:se,slicedSegments:fe}=J0(t,v,C,Q),Ee=new jn(se.segments,se.children);if(0===fe.length&&Ee.hasChildren())return this.expandChildren(U,Q,Ee).pipe(gt(Ye=>new jn(v,Ye)));if(0===Q.length&&0===fe.length)return Ut(new jn(v,{}));const Be=Xl(i)===u;return this.expandSegment(U,Ee,Q,fe,Be?Dn:u,!0).pipe(gt(ft=>new jn(v.concat(ft.segments),ft.children)))})):iy(t)))}getChildConfig(e,t,i){return t.children?Ut({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?Ut({routes:t._loadedRoutes,injector:t._loadedInjector}):function mz(n,e,t,i){const s=e.canLoad;return void 0===s||0===s.length?Ut(!0):Ut(s.map(p=>{const v=ym(p,n);return Td(function tz(n){return n&&ny(n.canLoad)}(v)?v.canLoad(e,t):n.runInContext(()=>v(e,t)))})).pipe(vm(),GM())}(e,t,i).pipe(pi(s=>s?this.configLoader.loadChildren(e,t).pipe(us(u=>{t._loadedRoutes=u.routes,t._loadedInjector=u.injector})):function wz(n){return hm(zM(ex,3))}())):Ut({routes:[],injector:e})}lineralizeSegments(e,t){let i=[],s=t.root;for(;;){if(i=i.concat(s.segments),0===s.numberOfChildren)return Ut(i);if(s.numberOfChildren>1||!s.children[Dn])return e.redirectTo,hm(new Le(4e3,ex));s=s.children[Dn]}}applyRedirectCommands(e,t,i){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,i)}applyRedirectCreateUrlTree(e,t,i,s){const u=this.createSegmentGroup(e,t.root,i,s);return new Sd(u,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const i={};return hs(e,(s,u)=>{if("string"==typeof s&&s.startsWith(":")){const v=s.substring(1);i[u]=t[v]}else i[u]=s}),i}createSegmentGroup(e,t,i,s){const u=this.createSegments(e,t.segments,i,s);let p={};return hs(t.children,(v,C)=>{p[C]=this.createSegmentGroup(e,v,i,s)}),new jn(u,p)}createSegments(e,t,i,s){return t.map(u=>u.path.startsWith(":")?this.findPosParam(e,u,s):this.findOrReturn(u,i))}findPosParam(e,t,i){const s=i[t.path.substring(1)];if(!s)throw new Le(4001,ex);return s}findOrReturn(e,t){let i=0;for(const s of t){if(s.path===e.path)return t.splice(i),s;i++}return e}}class Tz{}class Az{constructor(e,t,i,s,u,p,v){this.injector=e,this.rootComponentType=t,this.config=i,this.urlTree=s,this.url=u,this.paramsInheritanceStrategy=p,this.urlSerializer=v}recognize(){const e=J0(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Dn).pipe(gt(t=>{if(null===t)return null;const i=new Z0([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Dn,this.rootComponentType,null,this.urlTree.root,-1,{}),s=new ph(i,t),u=new LM(this.url,s);return this.inheritParamsAndData(u._root),u}))}inheritParamsAndData(e){const t=e.value,i=FM(t,this.paramsInheritanceStrategy);t.params=Object.freeze(i.params),t.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s))}processSegmentGroup(e,t,i,s){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,t,i):this.processSegment(e,t,i,i.segments,s)}processChildren(e,t,i){return Li(Object.keys(i.children)).pipe(Cd(s=>{const u=i.children[s],p=$M(t,s);return this.processSegmentGroup(e,p,u,s)}),cM((s,u)=>s&&u?(s.push(...u),s):null),function XN(n,e=!1){return ni((t,i)=>{let s=0;t.subscribe(Ln(i,u=>{const p=n(u,s++);(p||e)&&i.next(u),!p&&i.complete()}))})}(s=>null!==s),B0(null),uM(),gt(s=>{if(null===s)return null;const u=JM(s);return function Iz(n){n.sort((e,t)=>e.value.outlet===Dn?-1:t.value.outlet===Dn?1:e.value.outlet.localeCompare(t.value.outlet))}(u),u}))}processSegment(e,t,i,s,u){return Li(t).pipe(Cd(p=>this.processSegmentAgainstRoute(p._injector??e,p,i,s,u)),Ed(p=>!!p),Dd(p=>{if(q1(p))return ZM(i,s,u)?Ut([]):Ut(null);throw p}))}processSegmentAgainstRoute(e,t,i,s,u){if(t.redirectTo||!WM(t,i,s,u))return Ut(null);let p;if("**"===t.path){const v=s.length>0?pM(s).parameters:{},C=eA(i)+s.length;p=Ut({snapshot:new Z0(s,v,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tA(t),Xl(t),t.component??t._loadedComponent??null,t,QM(i),C,nA(t)),consumedSegments:[],remainingSegments:[]})}else p=qM(i,t,s,e).pipe(gt(({matched:v,consumedSegments:C,remainingSegments:M,parameters:O})=>{if(!v)return null;const U=eA(i)+C.length;return{snapshot:new Z0(C,O,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,tA(t),Xl(t),t.component??t._loadedComponent??null,t,QM(i),U,nA(t)),consumedSegments:C,remainingSegments:M}}));return p.pipe(Sa(v=>{if(null===v)return Ut(null);const{snapshot:C,consumedSegments:M,remainingSegments:O}=v;e=t._injector??e;const U=t._loadedInjector??e,Q=function Pz(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:se,slicedSegments:fe}=J0(i,M,O,Q.filter(Be=>void 0===Be.redirectTo));if(0===fe.length&&se.hasChildren())return this.processChildren(U,Q,se).pipe(gt(Be=>null===Be?null:[new ph(C,Be)]));if(0===Q.length&&0===fe.length)return Ut([new ph(C,[])]);const Ee=Xl(t)===u;return this.processSegment(U,Q,se,fe,Ee?Dn:u).pipe(gt(Be=>null===Be?null:[new ph(C,Be)]))}))}}function kz(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function JM(n){const e=[],t=new Set;for(const i of n){if(!kz(i)){e.push(i);continue}const s=e.find(u=>i.value.routeConfig===u.value.routeConfig);void 0!==s?(s.children.push(...i.children),t.add(s)):e.push(i)}for(const i of t){const s=JM(i.children);e.push(new ph(i.value,s))}return e.filter(i=>!t.has(i))}function QM(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function eA(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function tA(n){return n.data||{}}function nA(n){return n.resolve||{}}function iA(n){return"string"==typeof n.title||null===n.title}function X1(n){return Sa(e=>{const t=n(e);return t?Li(t).pipe(gt(()=>e)):Ut(e)})}const xm=new xt("ROUTES");let K1=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Zt(RT)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Ut(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const i=Td(t.loadComponent()).pipe(gt(oA),us(u=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=u}),S1(()=>{this.componentLoaders.delete(t)})),s=new D1(i,()=>new mn).pipe(C1());return this.componentLoaders.set(t,s),s}loadChildren(t,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Ut({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);const u=this.loadModuleFactoryOrRoutes(i.loadChildren).pipe(gt(v=>{this.onLoadEndListener&&this.onLoadEndListener(i);let C,M,O=!1;Array.isArray(v)?M=v:(C=v.create(t).injector,M=fM(C.get(xm,[],Bt.Self|Bt.Optional)));return{routes:M.map(G1),injector:C}}),S1(()=>{this.childrenLoaders.delete(i)})),p=new D1(u,()=>new mn).pipe(C1());return this.childrenLoaders.set(i,p),p}loadModuleFactoryOrRoutes(t){return Td(t()).pipe(gt(oA),pi(i=>i instanceof HD||Array.isArray(i)?Ut(i):Li(this.compiler.compileModuleAsync(i))))}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function oA(n){return function Vz(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let ix=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new mn,this.configLoader=Zt(K1),this.environmentInjector=Zt(Ul),this.urlSerializer=Zt(q_),this.rootContexts=Zt(J_),this.navigationId=0,this.afterPreactivation=()=>Ut(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=s=>this.events.next(new SB(s)),this.configLoader.onLoadStartListener=s=>this.events.next(new TB(s))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const i=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:i})}setupNavigations(t){return this.transitions=new Zl({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:K_,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Br(i=>0!==i.id),gt(i=>({...i,extractedUrl:t.urlHandlingStrategy.extract(i.rawUrl)})),Sa(i=>{let s=!1,u=!1;return Ut(i).pipe(us(p=>{this.currentNavigation={id:p.id,initialUrl:p.rawUrl,extractedUrl:p.extractedUrl,trigger:p.source,extras:p.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Sa(p=>{const v=t.browserUrlTree.toString(),C=!t.navigated||p.extractedUrl.toString()!==v||v!==t.currentUrlTree.toString();if(!C&&"reload"!==(p.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const O="";return this.events.next(new W0(p.id,t.serializeUrl(i.rawUrl),O,0)),t.rawUrlTree=p.rawUrl,p.resolve(null),Qo}if(t.urlHandlingStrategy.shouldProcessUrl(p.rawUrl))return sA(p.source)&&(t.browserUrlTree=p.extractedUrl),Ut(p).pipe(Sa(O=>{const U=this.transitions?.getValue();return this.events.next(new O1(O.id,this.urlSerializer.serialize(O.extractedUrl),O.source,O.restoredState)),U!==this.transitions?.getValue()?Qo:Promise.resolve(O)}),function Dz(n,e,t,i){return Sa(s=>function Ez(n,e,t,i,s){return new Cz(n,e,t,i,s).apply()}(n,e,t,s.extractedUrl,i).pipe(gt(u=>({...s,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),us(O=>{this.currentNavigation={...this.currentNavigation,finalUrl:O.urlAfterRedirects},i.urlAfterRedirects=O.urlAfterRedirects}),function Oz(n,e,t,i,s){return pi(u=>function Mz(n,e,t,i,s,u,p="emptyOnly"){return new Az(n,e,t,i,s,p,u).recognize().pipe(Sa(v=>null===v?function Sz(n){return new Lt(e=>e.error(n))}(new Tz):Ut(v)))}(n,e,t,u.urlAfterRedirects,i.serialize(u.urlAfterRedirects),i,s).pipe(gt(p=>({...u,targetSnapshot:p}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),us(O=>{if(i.targetSnapshot=O.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!O.extras.skipLocationChange){const Q=t.urlHandlingStrategy.merge(O.urlAfterRedirects,O.rawUrl);t.setBrowserUrl(Q,O)}t.browserUrlTree=O.urlAfterRedirects}const U=new bB(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot);this.events.next(U)}));if(C&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:O,extractedUrl:U,source:Q,restoredState:se,extras:fe}=p,Ee=new O1(O,this.urlSerializer.serialize(U),Q,se);this.events.next(Ee);const Be=OM(U,this.rootComponentType).snapshot;return Ut(i={...p,targetSnapshot:Be,urlAfterRedirects:U,extras:{...fe,skipLocationChange:!1,replaceUrl:!1}})}{const O="";return this.events.next(new W0(p.id,t.serializeUrl(i.extractedUrl),O,1)),t.rawUrlTree=p.rawUrl,p.resolve(null),Qo}}),us(p=>{const v=new wB(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(v)}),gt(p=>i={...p,guards:KB(p.targetSnapshot,p.currentSnapshot,this.rootContexts)}),function az(n,e){return pi(t=>{const{targetSnapshot:i,currentSnapshot:s,guards:{canActivateChecks:u,canDeactivateChecks:p}}=t;return 0===p.length&&0===u.length?Ut({...t,guardsResult:!0}):function lz(n,e,t,i){return Li(n).pipe(pi(s=>function pz(n,e,t,i,s){const u=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return u&&0!==u.length?Ut(u.map(v=>{const C=Q_(e)??s,M=ym(v,C);return Td(function rz(n){return n&&ny(n.canDeactivate)}(M)?M.canDeactivate(n,e,t,i):C.runInContext(()=>M(n,e,t,i))).pipe(Ed())})).pipe(vm()):Ut(!0)}(s.component,s.route,t,e,i)),Ed(s=>!0!==s,!0))}(p,i,s,n).pipe(pi(v=>v&&function ez(n){return"boolean"==typeof n}(v)?function cz(n,e,t,i){return Li(e).pipe(Cd(s=>cm(function hz(n,e){return null!==n&&e&&e(new MB(n)),Ut(!0)}(s.route.parent,i),function uz(n,e){return null!==n&&e&&e(new IB(n)),Ut(!0)}(s.route,i),function fz(n,e,t){const i=e[e.length-1],u=e.slice(0,e.length-1).reverse().map(p=>function YB(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(p)).filter(p=>null!==p).map(p=>um(()=>Ut(p.guards.map(C=>{const M=Q_(p.node)??t,O=ym(C,M);return Td(function iz(n){return n&&ny(n.canActivateChild)}(O)?O.canActivateChild(i,n):M.runInContext(()=>O(i,n))).pipe(Ed())})).pipe(vm())));return Ut(u).pipe(vm())}(n,s.path,t),function dz(n,e,t){const i=e.routeConfig?e.routeConfig.canActivate:null;if(!i||0===i.length)return Ut(!0);const s=i.map(u=>um(()=>{const p=Q_(e)??t,v=ym(u,p);return Td(function nz(n){return n&&ny(n.canActivate)}(v)?v.canActivate(e,n):p.runInContext(()=>v(e,n))).pipe(Ed())}));return Ut(s).pipe(vm())}(n,s.route,t))),Ed(s=>!0!==s,!0))}(i,u,n,e):Ut(v)),gt(v=>({...t,guardsResult:v})))})}(this.environmentInjector,p=>this.events.next(p)),us(p=>{if(i.guardsResult=p.guardsResult,Ff(p.guardsResult))throw BM(0,p.guardsResult);const v=new EB(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot,!!p.guardsResult);this.events.next(v)}),Br(p=>!!p.guardsResult||(t.restoreHistory(p),this.cancelNavigationTransition(p,"",3),!1)),X1(p=>{if(p.guards.canActivateChecks.length)return Ut(p).pipe(us(v=>{const C=new CB(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(C)}),Sa(v=>{let C=!1;return Ut(v).pipe(function Fz(n,e){return pi(t=>{const{targetSnapshot:i,guards:{canActivateChecks:s}}=t;if(!s.length)return Ut(t);let u=0;return Li(s).pipe(Cd(p=>function Lz(n,e,t,i){const s=n.routeConfig,u=n._resolve;return void 0!==s?.title&&!iA(s)&&(u[H_]=s.title),function Nz(n,e,t,i){const s=function Bz(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===s.length)return Ut({});const u={};return Li(s).pipe(pi(p=>function zz(n,e,t,i){const s=Q_(e)??i,u=ym(n,s);return Td(u.resolve?u.resolve(e,t):s.runInContext(()=>u(e,t)))}(n[p],e,t,i).pipe(Ed(),us(v=>{u[p]=v}))),T1(1),hM(u),Dd(p=>q1(p)?Qo:hm(p)))}(u,n,e,i).pipe(gt(p=>(n._resolvedData=p,n.data=FM(n,t).resolve,s&&iA(s)&&(n.data[H_]=s.title),null)))}(p.route,i,n,e)),us(()=>u++),T1(1),pi(p=>u===s.length?Ut(t):Qo))})}(t.paramsInheritanceStrategy,this.environmentInjector),us({next:()=>C=!0,complete:()=>{C||(t.restoreHistory(v),this.cancelNavigationTransition(v,"",2))}}))}),us(v=>{const C=new DB(v.id,this.urlSerializer.serialize(v.extractedUrl),this.urlSerializer.serialize(v.urlAfterRedirects),v.targetSnapshot);this.events.next(C)}))}),X1(p=>{const v=C=>{const M=[];C.routeConfig?.loadComponent&&!C.routeConfig._loadedComponent&&M.push(this.configLoader.loadComponent(C.routeConfig).pipe(us(O=>{C.component=O}),gt(()=>{})));for(const O of C.children)M.push(...v(O));return M};return E1(v(p.targetSnapshot.root)).pipe(B0(),mo(1))}),X1(()=>this.afterPreactivation()),gt(p=>{const v=function zB(n,e,t){const i=Y_(n,e._root,t?t._root:void 0);return new RM(i,e)}(t.routeReuseStrategy,p.targetSnapshot,p.currentRouterState);return i={...p,targetRouterState:v}}),us(p=>{t.currentUrlTree=p.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(p.urlAfterRedirects,p.rawUrl),t.routerState=p.targetRouterState,"deferred"===t.urlUpdateStrategy&&(p.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,p),t.browserUrlTree=p.urlAfterRedirects)}),((n,e,t)=>gt(i=>(new XB(e,i.targetRouterState,i.currentRouterState,t).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,p=>this.events.next(p)),mo(1),us({next:p=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new Lf(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(p.targetRouterState.snapshot),p.resolve(!0)},complete:()=>{s=!0}}),S1(()=>{s||u||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),Dd(p=>{if(u=!0,UM(p)){VM(p)||(t.navigated=!0,t.restoreHistory(i,!0));const v=new q0(i.id,this.urlSerializer.serialize(i.extractedUrl),p.message,p.cancellationCode);if(this.events.next(v),VM(p)){const C=t.urlHandlingStrategy.merge(p.url,t.rawUrlTree),M={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||sA(i.source)};t.scheduleNavigation(C,K_,null,M,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{t.restoreHistory(i,!0);const v=new F1(i.id,this.urlSerializer.serialize(i.extractedUrl),p,i.targetSnapshot??void 0);this.events.next(v);try{i.resolve(t.errorHandler(p))}catch(C){i.reject(C)}}return Qo}))}))}cancelNavigationTransition(t,i,s){const u=new q0(t.id,this.urlSerializer.serialize(t.extractedUrl),i,s);this.events.next(u),t.resolve(!1)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function sA(n){return n!==K_}let aA=(()=>{class n{buildTitle(t){let i,s=t.root;for(;void 0!==s;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(u=>u.outlet===Dn);return i}getResolvedTitleForRoute(t){return t.data[H_]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return Zt(Uz)},providedIn:"root"}),n})(),Uz=(()=>{class n extends aA{constructor(t){super(),this.title=t}updateTitle(t){const i=this.buildTitle(t);void 0!==i&&this.title.setTitle(i)}}return n.\u0275fac=function(t){return new(t||n)(ze(nM))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),jz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return Zt(Hz)},providedIn:"root"}),n})();class $z{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let Hz=(()=>{class n extends $z{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=co(n)))(i||n)}}(),n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const rx=new xt("",{providedIn:"root",factory:()=>({})});let qz=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:function(){return Zt(Wz)},providedIn:"root"}),n})(),Wz=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,i){return t}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Zz(n){throw n}function Xz(n,e,t){return e.parse("/")}const Kz={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Yz={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let dl=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Zt(AO),this.isNgZoneEnabled=!1,this.options=Zt(rx,{optional:!0})||{},this.errorHandler=this.options.errorHandler||Zz,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||Xz,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Zt(qz),this.routeReuseStrategy=Zt(jz),this.urlCreationStrategy=Zt(LB),this.titleStrategy=Zt(aA),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=fM(Zt(xm,{optional:!0})??[]),this.navigationTransitions=Zt(ix),this.urlSerializer=Zt(q_),this.location=Zt(N_),this.isNgZoneEnabled=Zt(On)instanceof On&&On.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Sd,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=OM(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId??0},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),K_,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const i="popstate"===t.type?"popstate":"hashchange";"popstate"===i&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,i,t.state)},0)}))}navigateToSyncWithBrowser(t,i,s){const u={replaceUrl:!0},p=s?.navigationId?s:null;if(s){const C={...s};delete C.navigationId,delete C.\u0275routerPageId,0!==Object.keys(C).length&&(u.state=C)}const v=this.parseUrl(t);this.scheduleNavigation(v,i,p,u)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(G1),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,i={}){const{relativeTo:s,queryParams:u,fragment:p,queryParamsHandling:v,preserveFragment:C}=i,M=C?this.currentUrlTree.fragment:p;let O=null;switch(v){case"merge":O={...this.currentUrlTree.queryParams,...u};break;case"preserve":O=this.currentUrlTree.queryParams;break;default:O=u||null}return null!==O&&(O=this.removeEmptyProps(O)),this.urlCreationStrategy.createUrlTree(s,this.routerState,this.currentUrlTree,t,O,M??null)}navigateByUrl(t,i={skipLocationChange:!1}){const s=Ff(t)?t:this.parseUrl(t),u=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(u,K_,null,i)}navigate(t,i={skipLocationChange:!1}){return function Jz(n){for(let e=0;e<n.length;e++){const t=n[e];if(null==t)throw new Le(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,i),i)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let i;try{i=this.urlSerializer.parse(t)}catch(s){i=this.malformedUriErrorHandler(s,this.urlSerializer,t)}return i}isActive(t,i){let s;if(s=!0===i?{...Kz}:!1===i?{...Yz}:i,Ff(t))return gM(this.currentUrlTree,t,s);const u=this.parseUrl(t);return gM(this.currentUrlTree,u,s)}removeEmptyProps(t){return Object.keys(t).reduce((i,s)=>{const u=t[s];return null!=u&&(i[s]=u),i},{})}scheduleNavigation(t,i,s,u,p){if(this.disposed)return Promise.resolve(!1);let v,C,M,O;return p?(v=p.resolve,C=p.reject,M=p.promise):M=new Promise((U,Q)=>{v=U,C=Q}),O="computed"===this.canceledNavigationResolution?s&&s.\u0275routerPageId?s.\u0275routerPageId:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:O,source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:u,resolve:v,reject:C,promise:M,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),M.catch(U=>Promise.reject(U))}setBrowserUrl(t,i){const s=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){const p={...i.extras.state,...this.generateNgRouterState(i.id,this.browserPageId)};this.location.replaceState(s,"",p)}else{const u={...i.extras.state,...this.generateNgRouterState(i.id,i.targetPageId)};this.location.go(s,"",u)}}restoreHistory(t,i=!1){if("computed"===this.canceledNavigationResolution){const u=this.currentPageId-(this.browserPageId??this.currentPageId);0!==u?this.location.historyGo(u):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===u&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(i&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,i){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:i}:{navigationId:t}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ox=(()=>{class n{constructor(t,i,s,u,p,v){this.router=t,this.route=i,this.tabIndexAttribute=s,this.renderer=u,this.el=p,this.locationStrategy=v,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new mn;const C=p.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===C||"area"===C,this.isAnchorElement?this.subscription=t.events.subscribe(M=>{M instanceof Lf&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=lm(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=lm(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=lm(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,i,s,u,p){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||i||s||u||p||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function Pg(n,e,t){return function Tb(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?Ig:Mp}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,i){const s=this.renderer,u=this.el.nativeElement;null!==i?s.setAttribute(u,t,i):s.removeAttribute(u,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)($e(dl),$e(_m),function op(n){return function Uh(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const i=t.length;let s=0;for(;s<i;){const u=t[s];if(Gn(u))break;if(0===u)s+=2;else if("number"==typeof u)for(s++;s<i&&"string"==typeof t[s];)s++;else{if(u===e)return t[s+1];s+=2}}}return null}(Gi(),n)}("tabindex"),$e(Cc),$e(ar),$e(Rf))},n.\u0275dir=Nt({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,i){1&t&&Un("click",function(u){return i.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&t&&Ae("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Mr]}),n})();class lA{}let tV=(()=>{class n{constructor(t,i,s,u,p){this.router=t,this.injector=s,this.preloadingStrategy=u,this.loader=p}setUpPreloading(){this.subscription=this.router.events.pipe(Br(t=>t instanceof Lf),Cd(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,i){const s=[];for(const u of i){u.providers&&!u._injector&&(u._injector=u0(u.providers,t,`Route: ${u.path}`));const p=u._injector??t,v=u._loadedInjector??p;(u.loadChildren&&!u._loadedRoutes&&void 0===u.canLoad||u.loadComponent&&!u._loadedComponent)&&s.push(this.preloadConfig(p,u)),(u.children||u._loadedRoutes)&&s.push(this.processRoutes(v,u.children??u._loadedRoutes))}return Li(s).pipe(ir())}preloadConfig(t,i){return this.preloadingStrategy.preload(i,()=>{let s;s=i.loadChildren&&void 0===i.canLoad?this.loader.loadChildren(t,i):Ut(null);const u=s.pipe(pi(p=>null===p?Ut(void 0):(i._loadedRoutes=p.routes,i._loadedInjector=p.injector,this.processRoutes(p.injector??t,p.routes))));return i.loadComponent&&!i._loadedComponent?Li([u,this.loader.loadComponent(i)]).pipe(ir()):u})}}return n.\u0275fac=function(t){return new(t||n)(ze(dl),ze(RT),ze(Ul),ze(lA),ze(K1))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const J1=new xt("");let cA=(()=>{class n{constructor(t,i,s,u,p={}){this.urlSerializer=t,this.transitions=i,this.viewportScroller=s,this.zone=u,this.options=p,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},p.scrollPositionRestoration=p.scrollPositionRestoration||"disabled",p.anchorScrolling=p.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof O1?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Lf&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof PM&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new PM(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return n.\u0275fac=function(t){lu()},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();var fl=(()=>((fl=fl||{})[fl.COMPLETE=0]="COMPLETE",fl[fl.FAILED=1]="FAILED",fl[fl.REDIRECTING=2]="REDIRECTING",fl))();const bm=!1;function Md(n,e){return{\u0275kind:n,\u0275providers:e}}const Q1=new xt("",{providedIn:"root",factory:()=>!1});function hA(){const n=Zt(Or);return e=>{const t=n.get(Pf);if(e!==t.components[0])return;const i=n.get(dl),s=n.get(dA);1===n.get(eE)&&i.initialNavigation(),n.get(fA,null,Bt.Optional)?.setUpPreloading(),n.get(J1,null,Bt.Optional)?.init(),i.resetRootComponentType(t.componentTypes[0]),s.closed||(s.next(),s.complete(),s.unsubscribe())}}const dA=new xt(bm?"bootstrap done indicator":"",{factory:()=>new mn}),eE=new xt(bm?"initial navigation":"",{providedIn:"root",factory:()=>1});function sV(){let n=[];return n=bm?[{provide:nu,multi:!0,useFactory:()=>{const e=Zt(dl);return()=>e.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function kB(n){if(!("type"in n))return`Unknown Router Event: ${n.constructor.name}`;switch(n.type){case 14:return`ActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${n.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${n.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state}, shouldActivate: ${n.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 2:return`NavigationCancel(id: ${n.id}, url: '${n.url}')`;case 16:return`NavigationSkipped(id: ${n.id}, url: '${n.url}')`;case 1:return`NavigationEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${n.id}, url: '${n.url}', error: ${n.error})`;case 0:return`NavigationStart(id: ${n.id}, url: '${n.url}')`;case 6:return`ResolveEnd(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 5:return`ResolveStart(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 10:return`RouteConfigLoadEnd(path: ${n.route.path})`;case 9:return`RouteConfigLoadStart(path: ${n.route.path})`;case 4:return`RoutesRecognized(id: ${n.id}, url: '${n.url}', urlAfterRedirects: '${n.urlAfterRedirects}', state: ${n.state})`;case 15:return`Scroll(anchor: '${n.anchor}', position: '${n.position?`${n.position[0]}, ${n.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],Md(1,n)}const fA=new xt(bm?"router preloader":"");function aV(n){return Md(0,[{provide:fA,useExisting:tV},{provide:lA,useExisting:n}])}const ry=!1,pA=new xt(ry?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),lV=[N_,{provide:q_,useClass:M1},dl,J_,{provide:_m,useFactory:function uA(n){return n.routerState.root},deps:[dl]},K1,ry?{provide:Q1,useValue:!0}:[]];function cV(){return new UT("Router",dl)}let mA=(()=>{class n{constructor(t){}static forRoot(t,i){return{ngModule:n,providers:[lV,ry&&i?.enableTracing?sV().\u0275providers:[],{provide:xm,multi:!0,useValue:t},{provide:pA,useFactory:fV,deps:[[dl,new ko,new Pi]]},{provide:rx,useValue:i||{}},i?.useHash?{provide:Rf,useClass:gF}:{provide:Rf,useClass:uS},{provide:J1,useFactory:()=>{const n=Zt(OL),e=Zt(On),t=Zt(rx),i=Zt(ix),s=Zt(q_);return t.scrollOffset&&n.setOffset(t.scrollOffset),new cA(s,i,n,e,t)}},i?.preloadingStrategy?aV(i.preloadingStrategy).\u0275providers:[],{provide:UT,multi:!0,useFactory:cV},i?.initialNavigation?pV(i):[],[{provide:gA,useFactory:hA},{provide:VT,multi:!0,useExisting:gA}]]}}static forChild(t){return{ngModule:n,providers:[{provide:xm,multi:!0,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)(ze(pA,8))},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[$1]}),n})();function fV(n){if(ry&&n)throw new Le(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function pV(n){return["disabled"===n.initialNavigation?Md(3,[{provide:k_,multi:!0,useFactory:()=>{const e=Zt(dl);return()=>{e.setUpLocationChangeListener()}}},{provide:eE,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?Md(2,[{provide:eE,useValue:0},{provide:k_,multi:!0,deps:[Or],useFactory:e=>{const t=e.get(pF,Promise.resolve());return()=>t.then(()=>new Promise(i=>{const s=e.get(dl),u=e.get(dA);(function nV(n,e){n.events.pipe(Br(t=>t instanceof Lf||t instanceof q0||t instanceof F1||t instanceof W0),gt(t=>t instanceof Lf||t instanceof W0?fl.COMPLETE:t instanceof q0&&(0===t.code||1===t.code)?fl.REDIRECTING:fl.FAILED),Br(t=>t!==fl.REDIRECTING),mo(1)).subscribe(()=>{e()})})(s,()=>{i(!0)}),e.get(ix).afterPreactivation=()=>(i(!0),u.closed?Ut(void 0):u),s.initialNavigation()}))}}]).\u0275providers:[]]}const gA=new xt(ry?"Router Initializer":"");var gV=qt(226),_V=qt.n(gV);let _A=(()=>{class n{constructor(t,i){this._renderer=t,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(t,i){this._renderer.setProperty(this._elementRef.nativeElement,t,i)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)($e(Cc),$e(ar))},n.\u0275dir=Nt({type:n}),n})(),Nf=(()=>{class n extends _A{}return n.\u0275fac=function(){let e;return function(i){return(e||(e=co(n)))(i||n)}}(),n.\u0275dir=Nt({type:n,features:[Xn]}),n})();const vu=new xt("NgValueAccessor"),xV={provide:vu,useExisting:wn(()=>sx),multi:!0},wV=new xt("CompositionEventMode");let sx=(()=>{class n extends _A{constructor(t,i,s){super(t,i),this._compositionMode=s,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function bV(){const n=hh()?hh().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)($e(Cc),$e(ar),$e(wV,8))},n.\u0275dir=Nt({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,i){1&t&&Un("input",function(u){return i._handleInput(u.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(u){return i._compositionEnd(u.target.value)})},features:[lr([xV]),Xn]}),n})();const EV=!1,Ts=new xt("NgValidators"),Id=new xt("NgAsyncValidators");function MA(n){return null!=n}function AA(n){const e=Fi(n)?Li(n):n;if(EV&&!ho(e)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof n&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new Le(-1101,t)}return e}function IA(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function PA(n,e){return e.map(t=>t(n))}function kA(n){return n.map(e=>function DV(n){return!n.validate}(e)?e:t=>e.validate(t))}function tE(n){return null!=n?function RA(n){if(!n)return null;const e=n.filter(MA);return 0==e.length?null:function(t){return IA(PA(t,e))}}(kA(n)):null}function nE(n){return null!=n?function OA(n){if(!n)return null;const e=n.filter(MA);return 0==e.length?null:function(t){return function yV(...n){const e=ic(n),{args:t,keys:i}=oM(n),s=new Lt(u=>{const{length:p}=t;if(!p)return void u.complete();const v=new Array(p);let C=p,M=p;for(let O=0;O<p;O++){let U=!1;It(t[O]).subscribe(Ln(u,Q=>{U||(U=!0,M--),v[O]=Q},()=>C--,void 0,()=>{(!C||!U)&&(M||u.next(i?sM(i,v):v),u.complete())}))}});return e?s.pipe(w1(e)):s}(PA(t,e).map(AA)).pipe(gt(IA))}}(kA(n)):null}function FA(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function iE(n){return n?Array.isArray(n)?n:[n]:[]}function lx(n,e){return Array.isArray(n)?n.includes(e):n===e}function BA(n,e){const t=iE(e);return iE(n).forEach(s=>{lx(t,s)||t.push(s)}),t}function zA(n,e){return iE(e).filter(t=>!lx(n,t))}class VA{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=tE(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=nE(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class ia extends VA{get formDirective(){return null}get path(){return null}}class Pd extends VA{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class UA{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let jA=(()=>{class n extends UA{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)($e(Pd,2))},n.\u0275dir=Nt({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,i){2&t&&tm("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Xn]}),n})();const oy="VALID",ux="INVALID",wm="PENDING",sy="DISABLED";function hx(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class qA{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===oy}get invalid(){return this.status===ux}get pending(){return this.status==wm}get disabled(){return this.status===sy}get enabled(){return this.status!==sy}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(BA(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(BA(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(zA(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(zA(e,this._rawAsyncValidators))}hasValidator(e){return lx(this._rawValidators,e)}hasAsyncValidator(e){return lx(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=wm,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=sy,this.errors=null,this._forEachChild(i=>{i.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=oy,this._forEachChild(i=>{i.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===oy||this.status===wm)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sy:oy}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=wm,this._hasOwnPendingAsyncValidator=!0;const t=AA(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((i,s)=>i&&i._find(s),this)}getError(e,t){const i=t?this.get(t):this;return i&&i.errors?i.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new cr,this.statusChanges=new cr}_calculateStatus(){return this._allControlsDisabled()?sy:this.errors?ux:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(wm)?wm:this._anyControlsHaveStatus(ux)?ux:oy}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){hx(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function RV(n){return Array.isArray(n)?tE(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function OV(n){return Array.isArray(n)?nE(n):n||null}(this._rawAsyncValidators)}}const Em=new xt("CallSetDisabledState",{providedIn:"root",factory:()=>dx}),dx="always";function ay(n,e,t=dx){(function uE(n,e){const t=function LA(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(FA(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const i=function NA(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(FA(i,e.asyncValidator)):"function"==typeof i&&n.setAsyncValidators([i]);const s=()=>n.updateValueAndValidity();mx(e._rawValidators,s),mx(e._rawAsyncValidators,s)})(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function NV(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&WA(n,e)})}(n,e),function zV(n,e){const t=(i,s)=>{e.valueAccessor.writeValue(i),s&&e.viewToModelUpdate(i)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function BV(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&WA(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function LV(n,e){if(e.valueAccessor.setDisabledState){const t=i=>{e.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function mx(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function WA(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function KA(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function YA(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const JA=class extends qA{constructor(e=null,t,i){super(function aE(n){return(hx(n)?n.validators:n)||null}(t),function lE(n,e){return(hx(e)?e.asyncValidators:n)||null}(i,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),hx(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=YA(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){KA(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){KA(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){YA(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},WV={provide:Pd,useExisting:wn(()=>mE)},tI=(()=>Promise.resolve())();let mE=(()=>{class n extends Pd{constructor(t,i,s,u,p,v){super(),this._changeDetectorRef=p,this.callSetDisabledState=v,this.control=new JA,this._registered=!1,this.update=new cr,this._parent=t,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=function fE(n,e){if(!e)return null;let t,i,s;return Array.isArray(e),e.forEach(u=>{u.constructor===sx?t=u:function jV(n){return Object.getPrototypeOf(n.constructor)===Nf}(u)?i=u:s=u}),s||i||t||null}(0,u)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const i=t.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function dE(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){ay(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){tI.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const i=t.isDisabled.currentValue,s=0!==i&&lm(i);tI.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function fx(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)($e(ia,9),$e(Ts,10),$e(Id,10),$e(vu,10),$e(F_,8),$e(Em,8))},n.\u0275dir=Nt({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[lr([WV]),Xn,Mr]}),n})(),iI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})(),v3=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[iI]}),n})(),b3=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Em,useValue:t.callSetDisabledState??dx}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[v3]}),n})();var wE=qt(898);function bI(n,e=0){return function E3(n){return!isNaN(parseFloat(n))&&!isNaN(Number(n))}(n)?Number(n):e}function _x(n){return Array.isArray(n)?n:[n]}function go(n){return null==n?"":"string"==typeof n?n:`${n}px`}function Cm(n){return n instanceof ar?n.nativeElement:n}const C3=["addListener","removeListener"],D3=["addEventListener","removeEventListener"],T3=["on","off"];function Dm(n,e,t,i){if(pn(t)&&(i=t,t=void 0),i)return Dm(n,e,t).pipe(w1(i));const[s,u]=function A3(n){return pn(n.addEventListener)&&pn(n.removeEventListener)}(n)?D3.map(p=>v=>n[p](e,v,t)):function S3(n){return pn(n.addListener)&&pn(n.removeListener)}(n)?C3.map(wI(n,e)):function M3(n){return pn(n.on)&&pn(n.off)}(n)?T3.map(wI(n,e)):[];if(!s&&xe(n))return pi(p=>Dm(p,e,t))(It(n));if(!s)throw new TypeError("Invalid event target");return new Lt(p=>{const v=(...C)=>p.next(1<C.length?C:C[0]);return s(v),()=>u(v)})}function wI(n,e){return t=>i=>n[t](e,i)}class I3 extends Ke{constructor(e,t){super()}schedule(e,t=0){return this}}const yx={setInterval(n,e,...t){const{delegate:i}=yx;return i?.setInterval?i.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=yx;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class EE extends I3{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var i;if(this.closed)return this;this.state=e;const s=this.id,u=this.scheduler;return null!=s&&(this.id=this.recycleAsyncId(u,s,t)),this.pending=!0,this.delay=t,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(u,this.id,t),this}requestAsyncId(e,t,i=0){return yx.setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return t;null!=t&&yx.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let s,i=!1;try{this.work(e)}catch(u){i=!0,s=u||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),s}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:i}=t;this.work=this.state=this.scheduler=null,this.pending=!1,f(i,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const cy={schedule(n){let e=requestAnimationFrame,t=cancelAnimationFrame;const{delegate:i}=cy;i&&(e=i.requestAnimationFrame,t=i.cancelAnimationFrame);const s=e(u=>{t=void 0,n(u)});return new Ke(()=>t?.(s))},requestAnimationFrame(...n){const{delegate:e}=cy;return(e?.requestAnimationFrame||requestAnimationFrame)(...n)},cancelAnimationFrame(...n){const{delegate:e}=cy;return(e?.cancelAnimationFrame||cancelAnimationFrame)(...n)},delegate:void 0},EI={now:()=>(EI.delegate||Date).now(),delegate:void 0};class uy{constructor(e,t=uy.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,i){return new this.schedulerActionCtor(this,e).schedule(i,t)}}uy.now=EI.now;class CE extends uy{constructor(e,t=uy.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let i;this._active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const R3=new class k3 extends CE{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;e=e||i.shift();do{if(s=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,s){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw s}}}(class P3 extends EE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=cy.requestAnimationFrame(()=>e.flush(void 0))))}recycleAsyncId(e,t,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:u}=e;null!=t&&(null===(s=u[u.length-1])||void 0===s?void 0:s.id)!==t&&(cy.cancelAnimationFrame(t),e._scheduled=void 0)}});let DE,O3=1;const vx={};function CI(n){return n in vx&&(delete vx[n],!0)}const F3={setImmediate(n){const e=O3++;return vx[e]=!0,DE||(DE=Promise.resolve()),DE.then(()=>CI(e)&&n()),e},clearImmediate(n){CI(n)}},{setImmediate:L3,clearImmediate:N3}=F3,xx={setImmediate(...n){const{delegate:e}=xx;return(e?.setImmediate||L3)(...n)},clearImmediate(n){const{delegate:e}=xx;return(e?.clearImmediate||N3)(n)},delegate:void 0},V3=new class z3 extends CE{flush(e){this._active=!0;const t=this._scheduled;this._scheduled=void 0;const{actions:i}=this;let s;e=e||i.shift();do{if(s=e.execute(e.state,e.delay))break}while((e=i[0])&&e.id===t&&i.shift());if(this._active=!1,s){for(;(e=i[0])&&e.id===t&&i.shift();)e.unsubscribe();throw s}}}(class B3 extends EE{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}requestAsyncId(e,t,i=0){return null!==i&&i>0?super.requestAsyncId(e,t,i):(e.actions.push(this),e._scheduled||(e._scheduled=xx.setImmediate(e.flush.bind(e,void 0))))}recycleAsyncId(e,t,i=0){var s;if(null!=i?i>0:this.delay>0)return super.recycleAsyncId(e,t,i);const{actions:u}=e;null!=t&&(null===(s=u[u.length-1])||void 0===s?void 0:s.id)!==t&&(xx.clearImmediate(t),e._scheduled=void 0)}}),bx=new CE(EE),U3=bx;function DI(n=0,e,t=U3){let i=-1;return null!=e&&(ka(e)?t=e:i=e),new Lt(s=>{let u=function $3(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;u<0&&(u=0);let p=0;return t.schedule(function(){s.closed||(s.next(p++),0<=i?this.schedule(void 0,i):s.complete())},u)})}function TE(n,e=bx){return function j3(n){return ni((e,t)=>{let i=!1,s=null,u=null,p=!1;const v=()=>{if(u?.unsubscribe(),u=null,i){i=!1;const M=s;s=null,t.next(M)}p&&t.complete()},C=()=>{u=null,p&&t.complete()};e.subscribe(Ln(t,M=>{i=!0,s=M,u||It(n(M)).subscribe(u=Ln(t,v,C))},()=>{p=!0,(!i||!u||u.closed)&&t.complete()}))})}(()=>DI(n,e))}function hy(n){return ni((e,t)=>{It(n).subscribe(Ln(t,()=>t.complete(),er)),!t.closed&&e.subscribe(t)})}let SE;try{SE=typeof Intl<"u"&&Intl.v8BreakIterator}catch{SE=!1}let dy,Ex,zf,ME,Rc=(()=>{class n{constructor(t){this._platformId=t,this.isBrowser=this._platformId?d1(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!SE)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return n.\u0275fac=function(t){return new(t||n)(ze(am))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function wx(n){return function H3(){if(null==dy&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>dy=!0}))}finally{dy=dy||!1}return dy}()?n:!!n.capture}function SI(){if(null==zf){if("object"!=typeof document||!document||"function"!=typeof Element||!Element)return zf=!1,zf;if("scrollBehavior"in document.documentElement.style)zf=!0;else{const n=Element.prototype.scrollTo;zf=!!n&&!/\{\s*\[native code\]\s*\}/.test(n.toString())}}return zf}function fy(){if("object"!=typeof document||!document)return 0;if(null==Ex){const n=document.createElement("div"),e=n.style;n.dir="rtl",e.width="1px",e.overflow="auto",e.visibility="hidden",e.pointerEvents="none",e.position="absolute";const t=document.createElement("div"),i=t.style;i.width="2px",i.height="1px",n.appendChild(t),document.body.appendChild(n),Ex=0,0===n.scrollLeft&&(n.scrollLeft=1,Ex=0===n.scrollLeft?1:2),n.remove()}return Ex}function AE(){let n=typeof document<"u"&&document?document.activeElement:null;for(;n&&n.shadowRoot;){const e=n.shadowRoot.activeElement;if(e===n)break;n=e}return n}function kd(n){return n.composedPath?n.composedPath()[0]:n.target}function IE(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}const W3=new xt("cdk-dir-doc",{providedIn:"root",factory:function Z3(){return Zt(ei)}}),X3=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Adlm|Arab|Hebr|Nkoo|Rohg|Thaa))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;let Sm=(()=>{class n{constructor(t){this.value="ltr",this.change=new cr,t&&(this.value=function K3(n){const e=n?.toLowerCase()||"";return"auto"===e&&typeof navigator<"u"&&navigator?.language?X3.test(navigator.language)?"rtl":"ltr":"rtl"===e?"rtl":"ltr"}((t.body?t.body.dir:null)||(t.documentElement?t.documentElement.dir:null)||"ltr"))}ngOnDestroy(){this.change.complete()}}return n.\u0275fac=function(t){return new(t||n)(ze(W3,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),py=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})();const Y3=["contentWrapper"],J3=["*"],Q3=new xt("VIRTUAL_SCROLL_STRATEGY");let Cx=(()=>{class n{constructor(t,i,s){this._ngZone=t,this._platform=i,this._scrolled=new mn,this._globalSubscription=null,this._scrolledCount=0,this.scrollContainers=new Map,this._document=s}register(t){this.scrollContainers.has(t)||this.scrollContainers.set(t,t.elementScrolled().subscribe(()=>this._scrolled.next(t)))}deregister(t){const i=this.scrollContainers.get(t);i&&(i.unsubscribe(),this.scrollContainers.delete(t))}scrolled(t=20){return this._platform.isBrowser?new Lt(i=>{this._globalSubscription||this._addGlobalListener();const s=t>0?this._scrolled.pipe(TE(t)).subscribe(i):this._scrolled.subscribe(i);return this._scrolledCount++,()=>{s.unsubscribe(),this._scrolledCount--,this._scrolledCount||this._removeGlobalListener()}}):Ut()}ngOnDestroy(){this._removeGlobalListener(),this.scrollContainers.forEach((t,i)=>this.deregister(i)),this._scrolled.complete()}ancestorScrolled(t,i){const s=this.getAncestorScrollContainers(t);return this.scrolled(i).pipe(Br(u=>!u||s.indexOf(u)>-1))}getAncestorScrollContainers(t){const i=[];return this.scrollContainers.forEach((s,u)=>{this._scrollableContainsElement(u,t)&&i.push(u)}),i}_getWindow(){return this._document.defaultView||window}_scrollableContainsElement(t,i){let s=Cm(i),u=t.getElementRef().nativeElement;do{if(s==u)return!0}while(s=s.parentElement);return!1}_addGlobalListener(){this._globalSubscription=this._ngZone.runOutsideAngular(()=>Dm(this._getWindow().document,"scroll").subscribe(()=>this._scrolled.next()))}_removeGlobalListener(){this._globalSubscription&&(this._globalSubscription.unsubscribe(),this._globalSubscription=null)}}return n.\u0275fac=function(t){return new(t||n)(ze(On),ze(Rc),ze(ei,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),MI=(()=>{class n{constructor(t,i,s,u){this.elementRef=t,this.scrollDispatcher=i,this.ngZone=s,this.dir=u,this._destroyed=new mn,this._elementScrolled=new Lt(p=>this.ngZone.runOutsideAngular(()=>Dm(this.elementRef.nativeElement,"scroll").pipe(hy(this._destroyed)).subscribe(p)))}ngOnInit(){this.scrollDispatcher.register(this)}ngOnDestroy(){this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(t){const i=this.elementRef.nativeElement,s=this.dir&&"rtl"==this.dir.value;null==t.left&&(t.left=s?t.end:t.start),null==t.right&&(t.right=s?t.start:t.end),null!=t.bottom&&(t.top=i.scrollHeight-i.clientHeight-t.bottom),s&&0!=fy()?(null!=t.left&&(t.right=i.scrollWidth-i.clientWidth-t.left),2==fy()?t.left=t.right:1==fy()&&(t.left=t.right?-t.right:t.right)):null!=t.right&&(t.left=i.scrollWidth-i.clientWidth-t.right),this._applyScrollToOptions(t)}_applyScrollToOptions(t){const i=this.elementRef.nativeElement;SI()?i.scrollTo(t):(null!=t.top&&(i.scrollTop=t.top),null!=t.left&&(i.scrollLeft=t.left))}measureScrollOffset(t){const i="left",s="right",u=this.elementRef.nativeElement;if("top"==t)return u.scrollTop;if("bottom"==t)return u.scrollHeight-u.clientHeight-u.scrollTop;const p=this.dir&&"rtl"==this.dir.value;return"start"==t?t=p?s:i:"end"==t&&(t=p?i:s),p&&2==fy()?t==i?u.scrollWidth-u.clientWidth-u.scrollLeft:u.scrollLeft:p&&1==fy()?t==i?u.scrollLeft+u.scrollWidth-u.clientWidth:-u.scrollLeft:t==i?u.scrollLeft:u.scrollWidth-u.clientWidth-u.scrollLeft}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(Cx),$e(On),$e(Sm,8))},n.\u0275dir=Nt({type:n,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]],standalone:!0}),n})(),PE=(()=>{class n{constructor(t,i,s){this._platform=t,this._change=new mn,this._changeListener=u=>{this._change.next(u)},this._document=s,i.runOutsideAngular(()=>{if(t.isBrowser){const u=this._getWindow();u.addEventListener("resize",this._changeListener),u.addEventListener("orientationchange",this._changeListener)}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){if(this._platform.isBrowser){const t=this._getWindow();t.removeEventListener("resize",this._changeListener),t.removeEventListener("orientationchange",this._changeListener)}this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();const t={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),t}getViewportRect(){const t=this.getViewportScrollPosition(),{width:i,height:s}=this.getViewportSize();return{top:t.top,left:t.left,bottom:t.top+s,right:t.left+i,height:s,width:i}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};const t=this._document,i=this._getWindow(),s=t.documentElement,u=s.getBoundingClientRect();return{top:-u.top||t.body.scrollTop||i.scrollY||s.scrollTop||0,left:-u.left||t.body.scrollLeft||i.scrollX||s.scrollLeft||0}}change(t=20){return t>0?this._change.pipe(TE(t)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){const t=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:t.innerWidth,height:t.innerHeight}:{width:0,height:0}}}return n.\u0275fac=function(t){return new(t||n)(ze(Rc),ze(On),ze(ei,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const AI=new xt("VIRTUAL_SCROLLABLE");let nU=(()=>{class n extends MI{constructor(t,i,s,u){super(t,i,s,u)}measureViewportSize(t){const i=this.elementRef.nativeElement;return"horizontal"===t?i.clientWidth:i.clientHeight}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(Cx),$e(On),$e(Sm,8))},n.\u0275dir=Nt({type:n,features:[Xn]}),n})();const rU=typeof requestAnimationFrame<"u"?R3:V3;let oU=(()=>{class n extends nU{get orientation(){return this._orientation}set orientation(t){this._orientation!==t&&(this._orientation=t,this._calculateSpacerSize())}get appendOnly(){return this._appendOnly}set appendOnly(t){this._appendOnly=function w3(n){return null!=n&&"false"!=`${n}`}(t)}constructor(t,i,s,u,p,v,C,M){super(t,v,s,p),this.elementRef=t,this._changeDetectorRef=i,this._scrollStrategy=u,this.scrollable=M,this._platform=Zt(Rc),this._detachedSubject=new mn,this._renderedRangeSubject=new mn,this._orientation="vertical",this._appendOnly=!1,this.scrolledIndexChange=new Lt(O=>this._scrollStrategy.scrolledIndexChange.subscribe(U=>Promise.resolve().then(()=>this.ngZone.run(()=>O.next(U))))),this.renderedRangeStream=this._renderedRangeSubject,this._totalContentSize=0,this._totalContentWidth="",this._totalContentHeight="",this._renderedRange={start:0,end:0},this._dataLength=0,this._viewportSize=0,this._renderedContentOffset=0,this._renderedContentOffsetNeedsRewrite=!1,this._isChangeDetectionPending=!1,this._runAfterChangeDetection=[],this._viewportChanges=Ke.EMPTY,this._viewportChanges=C.change().subscribe(()=>{this.checkViewportSize()}),this.scrollable||(this.elementRef.nativeElement.classList.add("cdk-virtual-scrollable"),this.scrollable=this)}ngOnInit(){this._platform.isBrowser&&(this.scrollable===this&&super.ngOnInit(),this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._measureViewportSize(),this._scrollStrategy.attach(this),this.scrollable.elementScrolled().pipe($_(null),TE(0,rU)).subscribe(()=>this._scrollStrategy.onContentScrolled()),this._markChangeDetectionNeeded()})))}ngOnDestroy(){this.detach(),this._scrollStrategy.detach(),this._renderedRangeSubject.complete(),this._detachedSubject.complete(),this._viewportChanges.unsubscribe(),super.ngOnDestroy()}attach(t){this.ngZone.runOutsideAngular(()=>{this._forOf=t,this._forOf.dataStream.pipe(hy(this._detachedSubject)).subscribe(i=>{const s=i.length;s!==this._dataLength&&(this._dataLength=s,this._scrollStrategy.onDataLengthChanged()),this._doChangeDetection()})})}detach(){this._forOf=null,this._detachedSubject.next()}getDataLength(){return this._dataLength}getViewportSize(){return this._viewportSize}getRenderedRange(){return this._renderedRange}measureBoundingClientRectWithScrollOffset(t){return this.getElementRef().nativeElement.getBoundingClientRect()[t]}setTotalContentSize(t){this._totalContentSize!==t&&(this._totalContentSize=t,this._calculateSpacerSize(),this._markChangeDetectionNeeded())}setRenderedRange(t){(function iU(n,e){return n.start==e.start&&n.end==e.end})(this._renderedRange,t)||(this.appendOnly&&(t={start:0,end:Math.max(this._renderedRange.end,t.end)}),this._renderedRangeSubject.next(this._renderedRange=t),this._markChangeDetectionNeeded(()=>this._scrollStrategy.onContentRendered()))}getOffsetToRenderedContentStart(){return this._renderedContentOffsetNeedsRewrite?null:this._renderedContentOffset}setRenderedContentOffset(t,i="to-start"){t=this.appendOnly&&"to-start"===i?0:t;const u="horizontal"==this.orientation,p=u?"X":"Y";let C=`translate${p}(${Number((u&&this.dir&&"rtl"==this.dir.value?-1:1)*t)}px)`;this._renderedContentOffset=t,"to-end"===i&&(C+=` translate${p}(-100%)`,this._renderedContentOffsetNeedsRewrite=!0),this._renderedContentTransform!=C&&(this._renderedContentTransform=C,this._markChangeDetectionNeeded(()=>{this._renderedContentOffsetNeedsRewrite?(this._renderedContentOffset-=this.measureRenderedContentSize(),this._renderedContentOffsetNeedsRewrite=!1,this.setRenderedContentOffset(this._renderedContentOffset)):this._scrollStrategy.onRenderedOffsetChanged()}))}scrollToOffset(t,i="auto"){const s={behavior:i};"horizontal"===this.orientation?s.start=t:s.top=t,this.scrollable.scrollTo(s)}scrollToIndex(t,i="auto"){this._scrollStrategy.scrollToIndex(t,i)}measureScrollOffset(t){let i;return i=this.scrollable==this?s=>super.measureScrollOffset(s):s=>this.scrollable.measureScrollOffset(s),Math.max(0,i(t??("horizontal"===this.orientation?"start":"top"))-this.measureViewportOffset())}measureViewportOffset(t){let i;const s="left",u="right",p="rtl"==this.dir?.value;i="start"==t?p?u:s:"end"==t?p?s:u:t||("horizontal"===this.orientation?"left":"top");const v=this.scrollable.measureBoundingClientRectWithScrollOffset(i);return this.elementRef.nativeElement.getBoundingClientRect()[i]-v}measureRenderedContentSize(){const t=this._contentWrapper.nativeElement;return"horizontal"===this.orientation?t.offsetWidth:t.offsetHeight}measureRangeSize(t){return this._forOf?this._forOf.measureRangeSize(t,this.orientation):0}checkViewportSize(){this._measureViewportSize(),this._scrollStrategy.onDataLengthChanged()}_measureViewportSize(){this._viewportSize=this.scrollable.measureViewportSize(this.orientation)}_markChangeDetectionNeeded(t){t&&this._runAfterChangeDetection.push(t),this._isChangeDetectionPending||(this._isChangeDetectionPending=!0,this.ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>{this._doChangeDetection()})))}_doChangeDetection(){this._isChangeDetectionPending=!1,this._contentWrapper.nativeElement.style.transform=this._renderedContentTransform,this.ngZone.run(()=>this._changeDetectorRef.markForCheck());const t=this._runAfterChangeDetection;this._runAfterChangeDetection=[];for(const i of t)i()}_calculateSpacerSize(){this._totalContentHeight="horizontal"===this.orientation?"":`${this._totalContentSize}px`,this._totalContentWidth="horizontal"===this.orientation?`${this._totalContentSize}px`:""}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(F_),$e(On),$e(Q3,8),$e(Sm,8),$e(Cx),$e(PE),$e(AI,8))},n.\u0275cmp=Mo({type:n,selectors:[["cdk-virtual-scroll-viewport"]],viewQuery:function(t,i){if(1&t&&Aw(Y3,7),2&t){let s;d0(s=f0())&&(i._contentWrapper=s.first)}},hostAttrs:[1,"cdk-virtual-scroll-viewport"],hostVars:4,hostBindings:function(t,i){2&t&&tm("cdk-virtual-scroll-orientation-horizontal","horizontal"===i.orientation)("cdk-virtual-scroll-orientation-vertical","horizontal"!==i.orientation)},inputs:{orientation:"orientation",appendOnly:"appendOnly"},outputs:{scrolledIndexChange:"scrolledIndexChange"},standalone:!0,features:[lr([{provide:MI,useFactory:(e,t)=>e||t,deps:[[new ko,new qr(AI)],n]}]),Xn,yw],ngContentSelectors:J3,decls:4,vars:4,consts:[[1,"cdk-virtual-scroll-content-wrapper"],["contentWrapper",""],[1,"cdk-virtual-scroll-spacer"]],template:function(t,i){1&t&&(function xd(n){const e=De()[yr][_r];if(!e.projection){const i=e.projection=mc(n?n.length:1,null),s=i.slice();let u=e.child;for(;null!==u;){const p=n?Mf(u,n):0;null!==p&&(s[p]?s[p].projectionNext=u:i[p]=u,s[p]=u),u=u.next}}}(),Qt(0,"div",0,1),function v_(n,e=0,t){const i=De(),s=Rn(),u=ah(s,Bn+n,16,null,t||null);null===u.projection&&(u.projection=e),zu(),32!=(32&u.flags)&&function wp(n,e,t){_g(e[on],0,e,t,lg(n,t,e),hg(t.parent||e[_r],t,e))}(s,i,u)}(2),bn(),gi(3,"div",2)),2&t&&(qo(3),sw("width",i._totalContentWidth)("height",i._totalContentHeight))},styles:["cdk-virtual-scroll-viewport{display:block;position:relative;transform:translateZ(0)}.cdk-virtual-scrollable{overflow:auto;will-change:scroll-position;contain:strict;-webkit-overflow-scrolling:touch}.cdk-virtual-scroll-content-wrapper{position:absolute;top:0;left:0;contain:content}[dir=rtl] .cdk-virtual-scroll-content-wrapper{right:0;left:auto}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper{min-height:100%}.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-horizontal .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-left:0;padding-right:0;margin-left:0;margin-right:0;border-left-width:0;border-right-width:0;outline:none}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper{min-width:100%}.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>dl:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ol:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>table:not([cdkVirtualFor]),.cdk-virtual-scroll-orientation-vertical .cdk-virtual-scroll-content-wrapper>ul:not([cdkVirtualFor]){padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:0;border-top-width:0;border-bottom-width:0;outline:none}.cdk-virtual-scroll-spacer{height:1px;transform-origin:0 0;flex:0 0 auto}[dir=rtl] .cdk-virtual-scroll-spacer{transform-origin:100% 0}"],encapsulation:2,changeDetection:0}),n})(),II=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})(),PI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[py,II,oU,py,II]}),n})();class kE{attach(e){return this._attachedHost=e,e.attach(this)}detach(){let e=this._attachedHost;null!=e&&(this._attachedHost=null,e.detach())}get isAttached(){return null!=this._attachedHost}setAttachedHost(e){this._attachedHost=e}}class RE extends kE{constructor(e,t,i,s,u){super(),this.component=e,this.viewContainerRef=t,this.injector=i,this.componentFactoryResolver=s,this.projectableNodes=u}}class kI extends kE{constructor(e,t,i,s){super(),this.templateRef=e,this.viewContainerRef=t,this.context=i,this.injector=s}get origin(){return this.templateRef.elementRef}attach(e,t=this.context){return this.context=t,super.attach(e)}detach(){return this.context=void 0,super.detach()}}class sU extends kE{constructor(e){super(),this.element=e instanceof ar?e.nativeElement:e}}class OE{constructor(){this._isDisposed=!1,this.attachDomPortal=null}hasAttached(){return!!this._attachedPortal}attach(e){return e instanceof RE?(this._attachedPortal=e,this.attachComponentPortal(e)):e instanceof kI?(this._attachedPortal=e,this.attachTemplatePortal(e)):this.attachDomPortal&&e instanceof sU?(this._attachedPortal=e,this.attachDomPortal(e)):void 0}detach(){this._attachedPortal&&(this._attachedPortal.setAttachedHost(null),this._attachedPortal=null),this._invokeDisposeFn()}dispose(){this.hasAttached()&&this.detach(),this._invokeDisposeFn(),this._isDisposed=!0}setDisposeFn(e){this._disposeFn=e}_invokeDisposeFn(){this._disposeFn&&(this._disposeFn(),this._disposeFn=null)}}class aU extends OE{constructor(e,t,i,s,u){super(),this.outletElement=e,this._componentFactoryResolver=t,this._appRef=i,this._defaultInjector=s,this.attachDomPortal=p=>{const v=p.element,C=this._document.createComment("dom-portal");v.parentNode.insertBefore(C,v),this.outletElement.appendChild(v),this._attachedPortal=p,super.setDisposeFn(()=>{C.parentNode&&C.parentNode.replaceChild(v,C)})},this._document=u}attachComponentPortal(e){const i=(e.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(e.component);let s;return e.viewContainerRef?(s=e.viewContainerRef.createComponent(i,e.viewContainerRef.length,e.injector||e.viewContainerRef.injector,e.projectableNodes||void 0),this.setDisposeFn(()=>s.destroy())):(s=i.create(e.injector||this._defaultInjector||Or.NULL),this._appRef.attachView(s.hostView),this.setDisposeFn(()=>{this._appRef.viewCount>0&&this._appRef.detachView(s.hostView),s.destroy()})),this.outletElement.appendChild(this._getComponentRootNode(s)),this._attachedPortal=e,s}attachTemplatePortal(e){let t=e.viewContainerRef,i=t.createEmbeddedView(e.templateRef,e.context,{injector:e.injector});return i.rootNodes.forEach(s=>this.outletElement.appendChild(s)),i.detectChanges(),this.setDisposeFn(()=>{let s=t.indexOf(i);-1!==s&&t.remove(s)}),this._attachedPortal=e,i}dispose(){super.dispose(),this.outletElement.remove()}_getComponentRootNode(e){return e.hostView.rootNodes[0]}}let FE=(()=>{class n extends OE{constructor(t,i,s){super(),this._componentFactoryResolver=t,this._viewContainerRef=i,this._isInitialized=!1,this.attached=new cr,this.attachDomPortal=u=>{const p=u.element,v=this._document.createComment("dom-portal");u.setAttachedHost(this),p.parentNode.insertBefore(v,p),this._getRootNode().appendChild(p),this._attachedPortal=u,super.setDisposeFn(()=>{v.parentNode&&v.parentNode.replaceChild(p,v)})},this._document=s}get portal(){return this._attachedPortal}set portal(t){this.hasAttached()&&!t&&!this._isInitialized||(this.hasAttached()&&super.detach(),t&&super.attach(t),this._attachedPortal=t||null)}get attachedRef(){return this._attachedRef}ngOnInit(){this._isInitialized=!0}ngOnDestroy(){super.dispose(),this._attachedRef=this._attachedPortal=null}attachComponentPortal(t){t.setAttachedHost(this);const i=null!=t.viewContainerRef?t.viewContainerRef:this._viewContainerRef,u=(t.componentFactoryResolver||this._componentFactoryResolver).resolveComponentFactory(t.component),p=i.createComponent(u,i.length,t.injector||i.injector,t.projectableNodes||void 0);return i!==this._viewContainerRef&&this._getRootNode().appendChild(p.hostView.rootNodes[0]),super.setDisposeFn(()=>p.destroy()),this._attachedPortal=t,this._attachedRef=p,this.attached.emit(p),p}attachTemplatePortal(t){t.setAttachedHost(this);const i=this._viewContainerRef.createEmbeddedView(t.templateRef,t.context,{injector:t.injector});return super.setDisposeFn(()=>this._viewContainerRef.clear()),this._attachedPortal=t,this._attachedRef=i,this.attached.emit(i),i}_getRootNode(){const t=this._viewContainerRef.element.nativeElement;return t.nodeType===t.ELEMENT_NODE?t:t.parentNode}}return n.\u0275fac=function(t){return new(t||n)($e(ru),$e(Gl),$e(ei))},n.\u0275dir=Nt({type:n,selectors:[["","cdkPortalOutlet",""]],inputs:{portal:["cdkPortalOutlet","portal"]},outputs:{attached:"attached"},exportAs:["cdkPortalOutlet"],features:[Xn]}),n})(),Dx=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({}),n})();const RI=SI();class lU{constructor(e,t){this._viewportRuler=e,this._previousHTMLStyles={top:"",left:""},this._isEnabled=!1,this._document=t}attach(){}enable(){if(this._canBeEnabled()){const e=this._document.documentElement;this._previousScrollPosition=this._viewportRuler.getViewportScrollPosition(),this._previousHTMLStyles.left=e.style.left||"",this._previousHTMLStyles.top=e.style.top||"",e.style.left=go(-this._previousScrollPosition.left),e.style.top=go(-this._previousScrollPosition.top),e.classList.add("cdk-global-scrollblock"),this._isEnabled=!0}}disable(){if(this._isEnabled){const e=this._document.documentElement,i=e.style,s=this._document.body.style,u=i.scrollBehavior||"",p=s.scrollBehavior||"";this._isEnabled=!1,i.left=this._previousHTMLStyles.left,i.top=this._previousHTMLStyles.top,e.classList.remove("cdk-global-scrollblock"),RI&&(i.scrollBehavior=s.scrollBehavior="auto"),window.scroll(this._previousScrollPosition.left,this._previousScrollPosition.top),RI&&(i.scrollBehavior=u,s.scrollBehavior=p)}}_canBeEnabled(){if(this._document.documentElement.classList.contains("cdk-global-scrollblock")||this._isEnabled)return!1;const t=this._document.body,i=this._viewportRuler.getViewportSize();return t.scrollHeight>i.height||t.scrollWidth>i.width}}class cU{constructor(e,t,i,s){this._scrollDispatcher=e,this._ngZone=t,this._viewportRuler=i,this._config=s,this._scrollSubscription=null,this._detach=()=>{this.disable(),this._overlayRef.hasAttached()&&this._ngZone.run(()=>this._overlayRef.detach())}}attach(e){this._overlayRef=e}enable(){if(this._scrollSubscription)return;const e=this._scrollDispatcher.scrolled(0).pipe(Br(t=>!t||!this._overlayRef.overlayElement.contains(t.getElementRef().nativeElement)));this._config&&this._config.threshold&&this._config.threshold>1?(this._initialScrollPosition=this._viewportRuler.getViewportScrollPosition().top,this._scrollSubscription=e.subscribe(()=>{const t=this._viewportRuler.getViewportScrollPosition().top;Math.abs(t-this._initialScrollPosition)>this._config.threshold?this._detach():this._overlayRef.updatePosition()})):this._scrollSubscription=e.subscribe(this._detach)}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}class OI{enable(){}disable(){}attach(){}}function LE(n,e){return e.some(t=>n.bottom<t.top||n.top>t.bottom||n.right<t.left||n.left>t.right)}function FI(n,e){return e.some(t=>n.top<t.top||n.bottom>t.bottom||n.left<t.left||n.right>t.right)}class uU{constructor(e,t,i,s){this._scrollDispatcher=e,this._viewportRuler=t,this._ngZone=i,this._config=s,this._scrollSubscription=null}attach(e){this._overlayRef=e}enable(){this._scrollSubscription||(this._scrollSubscription=this._scrollDispatcher.scrolled(this._config?this._config.scrollThrottle:0).subscribe(()=>{if(this._overlayRef.updatePosition(),this._config&&this._config.autoClose){const t=this._overlayRef.overlayElement.getBoundingClientRect(),{width:i,height:s}=this._viewportRuler.getViewportSize();LE(t,[{width:i,height:s,bottom:s,right:i,top:0,left:0}])&&(this.disable(),this._ngZone.run(()=>this._overlayRef.detach()))}}))}disable(){this._scrollSubscription&&(this._scrollSubscription.unsubscribe(),this._scrollSubscription=null)}detach(){this.disable(),this._overlayRef=null}}let hU=(()=>{class n{constructor(t,i,s,u){this._scrollDispatcher=t,this._viewportRuler=i,this._ngZone=s,this.noop=()=>new OI,this.close=p=>new cU(this._scrollDispatcher,this._ngZone,this._viewportRuler,p),this.block=()=>new lU(this._viewportRuler,this._document),this.reposition=p=>new uU(this._scrollDispatcher,this._viewportRuler,this._ngZone,p),this._document=u}}return n.\u0275fac=function(t){return new(t||n)(ze(Cx),ze(PE),ze(On),ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class LI{constructor(e){if(this.scrollStrategy=new OI,this.panelClass="",this.hasBackdrop=!1,this.backdropClass="cdk-overlay-dark-backdrop",this.disposeOnNavigation=!1,e){const t=Object.keys(e);for(const i of t)void 0!==e[i]&&(this[i]=e[i])}}}class dU{constructor(e,t){this.connectionPair=e,this.scrollableViewProperties=t}}let NI=(()=>{class n{constructor(t){this._attachedOverlays=[],this._document=t}ngOnDestroy(){this.detach()}add(t){this.remove(t),this._attachedOverlays.push(t)}remove(t){const i=this._attachedOverlays.indexOf(t);i>-1&&this._attachedOverlays.splice(i,1),0===this._attachedOverlays.length&&this.detach()}}return n.\u0275fac=function(t){return new(t||n)(ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),fU=(()=>{class n extends NI{constructor(t,i){super(t),this._ngZone=i,this._keydownListener=s=>{const u=this._attachedOverlays;for(let p=u.length-1;p>-1;p--)if(u[p]._keydownEvents.observers.length>0){const v=u[p]._keydownEvents;this._ngZone?this._ngZone.run(()=>v.next(s)):v.next(s);break}}}add(t){super.add(t),this._isAttached||(this._ngZone?this._ngZone.runOutsideAngular(()=>this._document.body.addEventListener("keydown",this._keydownListener)):this._document.body.addEventListener("keydown",this._keydownListener),this._isAttached=!0)}detach(){this._isAttached&&(this._document.body.removeEventListener("keydown",this._keydownListener),this._isAttached=!1)}}return n.\u0275fac=function(t){return new(t||n)(ze(ei),ze(On,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),pU=(()=>{class n extends NI{constructor(t,i,s){super(t),this._platform=i,this._ngZone=s,this._cursorStyleIsSet=!1,this._pointerDownListener=u=>{this._pointerDownEventTarget=kd(u)},this._clickListener=u=>{const p=kd(u),v="click"===u.type&&this._pointerDownEventTarget?this._pointerDownEventTarget:p;this._pointerDownEventTarget=null;const C=this._attachedOverlays.slice();for(let M=C.length-1;M>-1;M--){const O=C[M];if(O._outsidePointerEvents.observers.length<1||!O.hasAttached())continue;if(O.overlayElement.contains(p)||O.overlayElement.contains(v))break;const U=O._outsidePointerEvents;this._ngZone?this._ngZone.run(()=>U.next(u)):U.next(u)}}}add(t){if(super.add(t),!this._isAttached){const i=this._document.body;this._ngZone?this._ngZone.runOutsideAngular(()=>this._addEventListeners(i)):this._addEventListeners(i),this._platform.IOS&&!this._cursorStyleIsSet&&(this._cursorOriginalValue=i.style.cursor,i.style.cursor="pointer",this._cursorStyleIsSet=!0),this._isAttached=!0}}detach(){if(this._isAttached){const t=this._document.body;t.removeEventListener("pointerdown",this._pointerDownListener,!0),t.removeEventListener("click",this._clickListener,!0),t.removeEventListener("auxclick",this._clickListener,!0),t.removeEventListener("contextmenu",this._clickListener,!0),this._platform.IOS&&this._cursorStyleIsSet&&(t.style.cursor=this._cursorOriginalValue,this._cursorStyleIsSet=!1),this._isAttached=!1}}_addEventListeners(t){t.addEventListener("pointerdown",this._pointerDownListener,!0),t.addEventListener("click",this._clickListener,!0),t.addEventListener("auxclick",this._clickListener,!0),t.addEventListener("contextmenu",this._clickListener,!0)}}return n.\u0275fac=function(t){return new(t||n)(ze(ei),ze(Rc),ze(On,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Tx=(()=>{class n{constructor(t,i){this._platform=i,this._document=t}ngOnDestroy(){this._containerElement?.remove()}getContainerElement(){return this._containerElement||this._createContainer(),this._containerElement}_createContainer(){const t="cdk-overlay-container";if(this._platform.isBrowser||IE()){const s=this._document.querySelectorAll(`.${t}[platform="server"], .${t}[platform="test"]`);for(let u=0;u<s.length;u++)s[u].remove()}const i=this._document.createElement("div");i.classList.add(t),IE()?i.setAttribute("platform","test"):this._platform.isBrowser||i.setAttribute("platform","server"),this._document.body.appendChild(i),this._containerElement=i}}return n.\u0275fac=function(t){return new(t||n)(ze(ei),ze(Rc))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class my{constructor(e,t,i,s,u,p,v,C,M,O=!1){this._portalOutlet=e,this._host=t,this._pane=i,this._config=s,this._ngZone=u,this._keyboardDispatcher=p,this._document=v,this._location=C,this._outsideClickDispatcher=M,this._animationsDisabled=O,this._backdropElement=null,this._backdropClick=new mn,this._attachments=new mn,this._detachments=new mn,this._locationChanges=Ke.EMPTY,this._backdropClickHandler=U=>this._backdropClick.next(U),this._backdropTransitionendHandler=U=>{this._disposeBackdrop(U.target)},this._keydownEvents=new mn,this._outsidePointerEvents=new mn,s.scrollStrategy&&(this._scrollStrategy=s.scrollStrategy,this._scrollStrategy.attach(this)),this._positionStrategy=s.positionStrategy}get overlayElement(){return this._pane}get backdropElement(){return this._backdropElement}get hostElement(){return this._host}attach(e){!this._host.parentElement&&this._previousHostParent&&this._previousHostParent.appendChild(this._host);const t=this._portalOutlet.attach(e);return this._positionStrategy&&this._positionStrategy.attach(this),this._updateStackingOrder(),this._updateElementSize(),this._updateElementDirection(),this._scrollStrategy&&this._scrollStrategy.enable(),this._ngZone.onStable.pipe(mo(1)).subscribe(()=>{this.hasAttached()&&this.updatePosition()}),this._togglePointerEvents(!0),this._config.hasBackdrop&&this._attachBackdrop(),this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!0),this._attachments.next(),this._keyboardDispatcher.add(this),this._config.disposeOnNavigation&&(this._locationChanges=this._location.subscribe(()=>this.dispose())),this._outsideClickDispatcher.add(this),"function"==typeof t?.onDestroy&&t.onDestroy(()=>{this.hasAttached()&&this._ngZone.runOutsideAngular(()=>Promise.resolve().then(()=>this.detach()))}),t}detach(){if(!this.hasAttached())return;this.detachBackdrop(),this._togglePointerEvents(!1),this._positionStrategy&&this._positionStrategy.detach&&this._positionStrategy.detach(),this._scrollStrategy&&this._scrollStrategy.disable();const e=this._portalOutlet.detach();return this._detachments.next(),this._keyboardDispatcher.remove(this),this._detachContentWhenStable(),this._locationChanges.unsubscribe(),this._outsideClickDispatcher.remove(this),e}dispose(){const e=this.hasAttached();this._positionStrategy&&this._positionStrategy.dispose(),this._disposeScrollStrategy(),this._disposeBackdrop(this._backdropElement),this._locationChanges.unsubscribe(),this._keyboardDispatcher.remove(this),this._portalOutlet.dispose(),this._attachments.complete(),this._backdropClick.complete(),this._keydownEvents.complete(),this._outsidePointerEvents.complete(),this._outsideClickDispatcher.remove(this),this._host?.remove(),this._previousHostParent=this._pane=this._host=null,e&&this._detachments.next(),this._detachments.complete()}hasAttached(){return this._portalOutlet.hasAttached()}backdropClick(){return this._backdropClick}attachments(){return this._attachments}detachments(){return this._detachments}keydownEvents(){return this._keydownEvents}outsidePointerEvents(){return this._outsidePointerEvents}getConfig(){return this._config}updatePosition(){this._positionStrategy&&this._positionStrategy.apply()}updatePositionStrategy(e){e!==this._positionStrategy&&(this._positionStrategy&&this._positionStrategy.dispose(),this._positionStrategy=e,this.hasAttached()&&(e.attach(this),this.updatePosition()))}updateSize(e){this._config={...this._config,...e},this._updateElementSize()}setDirection(e){this._config={...this._config,direction:e},this._updateElementDirection()}addPanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!0)}removePanelClass(e){this._pane&&this._toggleClasses(this._pane,e,!1)}getDirection(){const e=this._config.direction;return e?"string"==typeof e?e:e.value:"ltr"}updateScrollStrategy(e){e!==this._scrollStrategy&&(this._disposeScrollStrategy(),this._scrollStrategy=e,this.hasAttached()&&(e.attach(this),e.enable()))}_updateElementDirection(){this._host.setAttribute("dir",this.getDirection())}_updateElementSize(){if(!this._pane)return;const e=this._pane.style;e.width=go(this._config.width),e.height=go(this._config.height),e.minWidth=go(this._config.minWidth),e.minHeight=go(this._config.minHeight),e.maxWidth=go(this._config.maxWidth),e.maxHeight=go(this._config.maxHeight)}_togglePointerEvents(e){this._pane.style.pointerEvents=e?"":"none"}_attachBackdrop(){const e="cdk-overlay-backdrop-showing";this._backdropElement=this._document.createElement("div"),this._backdropElement.classList.add("cdk-overlay-backdrop"),this._animationsDisabled&&this._backdropElement.classList.add("cdk-overlay-backdrop-noop-animation"),this._config.backdropClass&&this._toggleClasses(this._backdropElement,this._config.backdropClass,!0),this._host.parentElement.insertBefore(this._backdropElement,this._host),this._backdropElement.addEventListener("click",this._backdropClickHandler),!this._animationsDisabled&&typeof requestAnimationFrame<"u"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{this._backdropElement&&this._backdropElement.classList.add(e)})}):this._backdropElement.classList.add(e)}_updateStackingOrder(){this._host.nextSibling&&this._host.parentNode.appendChild(this._host)}detachBackdrop(){const e=this._backdropElement;if(e){if(this._animationsDisabled)return void this._disposeBackdrop(e);e.classList.remove("cdk-overlay-backdrop-showing"),this._ngZone.runOutsideAngular(()=>{e.addEventListener("transitionend",this._backdropTransitionendHandler)}),e.style.pointerEvents="none",this._backdropTimeout=this._ngZone.runOutsideAngular(()=>setTimeout(()=>{this._disposeBackdrop(e)},500))}}_toggleClasses(e,t,i){const s=_x(t||[]).filter(u=>!!u);s.length&&(i?e.classList.add(...s):e.classList.remove(...s))}_detachContentWhenStable(){this._ngZone.runOutsideAngular(()=>{const e=this._ngZone.onStable.pipe(hy(io(this._attachments,this._detachments))).subscribe(()=>{(!this._pane||!this._host||0===this._pane.children.length)&&(this._pane&&this._config.panelClass&&this._toggleClasses(this._pane,this._config.panelClass,!1),this._host&&this._host.parentElement&&(this._previousHostParent=this._host.parentElement,this._host.remove()),e.unsubscribe())})})}_disposeScrollStrategy(){const e=this._scrollStrategy;e&&(e.disable(),e.detach&&e.detach())}_disposeBackdrop(e){e&&(e.removeEventListener("click",this._backdropClickHandler),e.removeEventListener("transitionend",this._backdropTransitionendHandler),e.remove(),this._backdropElement===e&&(this._backdropElement=null)),this._backdropTimeout&&(clearTimeout(this._backdropTimeout),this._backdropTimeout=void 0)}}const BI="cdk-overlay-connected-position-bounding-box",mU=/([A-Za-z%]+)$/;class gU{get positions(){return this._preferredPositions}constructor(e,t,i,s,u){this._viewportRuler=t,this._document=i,this._platform=s,this._overlayContainer=u,this._lastBoundingBoxSize={width:0,height:0},this._isPushed=!1,this._canPush=!0,this._growAfterOpen=!1,this._hasFlexibleDimensions=!0,this._positionLocked=!1,this._viewportMargin=0,this._scrollables=[],this._preferredPositions=[],this._positionChanges=new mn,this._resizeSubscription=Ke.EMPTY,this._offsetX=0,this._offsetY=0,this._appliedPanelClasses=[],this.positionChanges=this._positionChanges,this.setOrigin(e)}attach(e){this._validatePositions(),e.hostElement.classList.add(BI),this._overlayRef=e,this._boundingBox=e.hostElement,this._pane=e.overlayElement,this._isDisposed=!1,this._isInitialRender=!0,this._lastPosition=null,this._resizeSubscription.unsubscribe(),this._resizeSubscription=this._viewportRuler.change().subscribe(()=>{this._isInitialRender=!0,this.apply()})}apply(){if(this._isDisposed||!this._platform.isBrowser)return;if(!this._isInitialRender&&this._positionLocked&&this._lastPosition)return void this.reapplyLastPosition();this._clearPanelClasses(),this._resetOverlayElementStyles(),this._resetBoundingBoxStyles(),this._viewportRect=this._getNarrowedViewportRect(),this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const e=this._originRect,t=this._overlayRect,i=this._viewportRect,s=this._containerRect,u=[];let p;for(let v of this._preferredPositions){let C=this._getOriginPoint(e,s,v),M=this._getOverlayPoint(C,t,v),O=this._getOverlayFit(M,t,i,v);if(O.isCompletelyWithinViewport)return this._isPushed=!1,void this._applyPosition(v,C);this._canFitWithFlexibleDimensions(O,M,i)?u.push({position:v,origin:C,overlayRect:t,boundingBoxRect:this._calculateBoundingBoxRect(C,v)}):(!p||p.overlayFit.visibleArea<O.visibleArea)&&(p={overlayFit:O,overlayPoint:M,originPoint:C,position:v,overlayRect:t})}if(u.length){let v=null,C=-1;for(const M of u){const O=M.boundingBoxRect.width*M.boundingBoxRect.height*(M.position.weight||1);O>C&&(C=O,v=M)}return this._isPushed=!1,void this._applyPosition(v.position,v.origin)}if(this._canPush)return this._isPushed=!0,void this._applyPosition(p.position,p.originPoint);this._applyPosition(p.position,p.originPoint)}detach(){this._clearPanelClasses(),this._lastPosition=null,this._previousPushAmount=null,this._resizeSubscription.unsubscribe()}dispose(){this._isDisposed||(this._boundingBox&&Vf(this._boundingBox.style,{top:"",left:"",right:"",bottom:"",height:"",width:"",alignItems:"",justifyContent:""}),this._pane&&this._resetOverlayElementStyles(),this._overlayRef&&this._overlayRef.hostElement.classList.remove(BI),this.detach(),this._positionChanges.complete(),this._overlayRef=this._boundingBox=null,this._isDisposed=!0)}reapplyLastPosition(){if(this._isDisposed||!this._platform.isBrowser)return;const e=this._lastPosition;if(e){this._originRect=this._getOriginRect(),this._overlayRect=this._pane.getBoundingClientRect(),this._viewportRect=this._getNarrowedViewportRect(),this._containerRect=this._overlayContainer.getContainerElement().getBoundingClientRect();const t=this._getOriginPoint(this._originRect,this._containerRect,e);this._applyPosition(e,t)}else this.apply()}withScrollableContainers(e){return this._scrollables=e,this}withPositions(e){return this._preferredPositions=e,-1===e.indexOf(this._lastPosition)&&(this._lastPosition=null),this._validatePositions(),this}withViewportMargin(e){return this._viewportMargin=e,this}withFlexibleDimensions(e=!0){return this._hasFlexibleDimensions=e,this}withGrowAfterOpen(e=!0){return this._growAfterOpen=e,this}withPush(e=!0){return this._canPush=e,this}withLockedPosition(e=!0){return this._positionLocked=e,this}setOrigin(e){return this._origin=e,this}withDefaultOffsetX(e){return this._offsetX=e,this}withDefaultOffsetY(e){return this._offsetY=e,this}withTransformOriginOn(e){return this._transformOriginSelector=e,this}_getOriginPoint(e,t,i){let s,u;if("center"==i.originX)s=e.left+e.width/2;else{const p=this._isRtl()?e.right:e.left,v=this._isRtl()?e.left:e.right;s="start"==i.originX?p:v}return t.left<0&&(s-=t.left),u="center"==i.originY?e.top+e.height/2:"top"==i.originY?e.top:e.bottom,t.top<0&&(u-=t.top),{x:s,y:u}}_getOverlayPoint(e,t,i){let s,u;return s="center"==i.overlayX?-t.width/2:"start"===i.overlayX?this._isRtl()?-t.width:0:this._isRtl()?0:-t.width,u="center"==i.overlayY?-t.height/2:"top"==i.overlayY?0:-t.height,{x:e.x+s,y:e.y+u}}_getOverlayFit(e,t,i,s){const u=VI(t);let{x:p,y:v}=e,C=this._getOffset(s,"x"),M=this._getOffset(s,"y");C&&(p+=C),M&&(v+=M);let Q=0-v,se=v+u.height-i.height,fe=this._subtractOverflows(u.width,0-p,p+u.width-i.width),Ee=this._subtractOverflows(u.height,Q,se),Be=fe*Ee;return{visibleArea:Be,isCompletelyWithinViewport:u.width*u.height===Be,fitsInViewportVertically:Ee===u.height,fitsInViewportHorizontally:fe==u.width}}_canFitWithFlexibleDimensions(e,t,i){if(this._hasFlexibleDimensions){const s=i.bottom-t.y,u=i.right-t.x,p=zI(this._overlayRef.getConfig().minHeight),v=zI(this._overlayRef.getConfig().minWidth);return(e.fitsInViewportVertically||null!=p&&p<=s)&&(e.fitsInViewportHorizontally||null!=v&&v<=u)}return!1}_pushOverlayOnScreen(e,t,i){if(this._previousPushAmount&&this._positionLocked)return{x:e.x+this._previousPushAmount.x,y:e.y+this._previousPushAmount.y};const s=VI(t),u=this._viewportRect,p=Math.max(e.x+s.width-u.width,0),v=Math.max(e.y+s.height-u.height,0),C=Math.max(u.top-i.top-e.y,0),M=Math.max(u.left-i.left-e.x,0);let O=0,U=0;return O=s.width<=u.width?M||-p:e.x<this._viewportMargin?u.left-i.left-e.x:0,U=s.height<=u.height?C||-v:e.y<this._viewportMargin?u.top-i.top-e.y:0,this._previousPushAmount={x:O,y:U},{x:e.x+O,y:e.y+U}}_applyPosition(e,t){if(this._setTransformOrigin(e),this._setOverlayElementStyles(t,e),this._setBoundingBoxStyles(t,e),e.panelClass&&this._addPanelClasses(e.panelClass),this._lastPosition=e,this._positionChanges.observers.length){const i=this._getScrollVisibility(),s=new dU(e,i);this._positionChanges.next(s)}this._isInitialRender=!1}_setTransformOrigin(e){if(!this._transformOriginSelector)return;const t=this._boundingBox.querySelectorAll(this._transformOriginSelector);let i,s=e.overlayY;i="center"===e.overlayX?"center":this._isRtl()?"start"===e.overlayX?"right":"left":"start"===e.overlayX?"left":"right";for(let u=0;u<t.length;u++)t[u].style.transformOrigin=`${i} ${s}`}_calculateBoundingBoxRect(e,t){const i=this._viewportRect,s=this._isRtl();let u,p,v,O,U,Q;if("top"===t.overlayY)p=e.y,u=i.height-p+this._viewportMargin;else if("bottom"===t.overlayY)v=i.height-e.y+2*this._viewportMargin,u=i.height-v+this._viewportMargin;else{const se=Math.min(i.bottom-e.y+i.top,e.y),fe=this._lastBoundingBoxSize.height;u=2*se,p=e.y-se,u>fe&&!this._isInitialRender&&!this._growAfterOpen&&(p=e.y-fe/2)}if("end"===t.overlayX&&!s||"start"===t.overlayX&&s)Q=i.width-e.x+this._viewportMargin,O=e.x-this._viewportMargin;else if("start"===t.overlayX&&!s||"end"===t.overlayX&&s)U=e.x,O=i.right-e.x;else{const se=Math.min(i.right-e.x+i.left,e.x),fe=this._lastBoundingBoxSize.width;O=2*se,U=e.x-se,O>fe&&!this._isInitialRender&&!this._growAfterOpen&&(U=e.x-fe/2)}return{top:p,left:U,bottom:v,right:Q,width:O,height:u}}_setBoundingBoxStyles(e,t){const i=this._calculateBoundingBoxRect(e,t);!this._isInitialRender&&!this._growAfterOpen&&(i.height=Math.min(i.height,this._lastBoundingBoxSize.height),i.width=Math.min(i.width,this._lastBoundingBoxSize.width));const s={};if(this._hasExactPosition())s.top=s.left="0",s.bottom=s.right=s.maxHeight=s.maxWidth="",s.width=s.height="100%";else{const u=this._overlayRef.getConfig().maxHeight,p=this._overlayRef.getConfig().maxWidth;s.height=go(i.height),s.top=go(i.top),s.bottom=go(i.bottom),s.width=go(i.width),s.left=go(i.left),s.right=go(i.right),s.alignItems="center"===t.overlayX?"center":"end"===t.overlayX?"flex-end":"flex-start",s.justifyContent="center"===t.overlayY?"center":"bottom"===t.overlayY?"flex-end":"flex-start",u&&(s.maxHeight=go(u)),p&&(s.maxWidth=go(p))}this._lastBoundingBoxSize=i,Vf(this._boundingBox.style,s)}_resetBoundingBoxStyles(){Vf(this._boundingBox.style,{top:"0",left:"0",right:"0",bottom:"0",height:"",width:"",alignItems:"",justifyContent:""})}_resetOverlayElementStyles(){Vf(this._pane.style,{top:"",left:"",bottom:"",right:"",position:"",transform:""})}_setOverlayElementStyles(e,t){const i={},s=this._hasExactPosition(),u=this._hasFlexibleDimensions,p=this._overlayRef.getConfig();if(s){const O=this._viewportRuler.getViewportScrollPosition();Vf(i,this._getExactOverlayY(t,e,O)),Vf(i,this._getExactOverlayX(t,e,O))}else i.position="static";let v="",C=this._getOffset(t,"x"),M=this._getOffset(t,"y");C&&(v+=`translateX(${C}px) `),M&&(v+=`translateY(${M}px)`),i.transform=v.trim(),p.maxHeight&&(s?i.maxHeight=go(p.maxHeight):u&&(i.maxHeight="")),p.maxWidth&&(s?i.maxWidth=go(p.maxWidth):u&&(i.maxWidth="")),Vf(this._pane.style,i)}_getExactOverlayY(e,t,i){let s={top:"",bottom:""},u=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(u=this._pushOverlayOnScreen(u,this._overlayRect,i)),"bottom"===e.overlayY?s.bottom=this._document.documentElement.clientHeight-(u.y+this._overlayRect.height)+"px":s.top=go(u.y),s}_getExactOverlayX(e,t,i){let p,s={left:"",right:""},u=this._getOverlayPoint(t,this._overlayRect,e);return this._isPushed&&(u=this._pushOverlayOnScreen(u,this._overlayRect,i)),p=this._isRtl()?"end"===e.overlayX?"left":"right":"end"===e.overlayX?"right":"left","right"===p?s.right=this._document.documentElement.clientWidth-(u.x+this._overlayRect.width)+"px":s.left=go(u.x),s}_getScrollVisibility(){const e=this._getOriginRect(),t=this._pane.getBoundingClientRect(),i=this._scrollables.map(s=>s.getElementRef().nativeElement.getBoundingClientRect());return{isOriginClipped:FI(e,i),isOriginOutsideView:LE(e,i),isOverlayClipped:FI(t,i),isOverlayOutsideView:LE(t,i)}}_subtractOverflows(e,...t){return t.reduce((i,s)=>i-Math.max(s,0),e)}_getNarrowedViewportRect(){const e=this._document.documentElement.clientWidth,t=this._document.documentElement.clientHeight,i=this._viewportRuler.getViewportScrollPosition();return{top:i.top+this._viewportMargin,left:i.left+this._viewportMargin,right:i.left+e-this._viewportMargin,bottom:i.top+t-this._viewportMargin,width:e-2*this._viewportMargin,height:t-2*this._viewportMargin}}_isRtl(){return"rtl"===this._overlayRef.getDirection()}_hasExactPosition(){return!this._hasFlexibleDimensions||this._isPushed}_getOffset(e,t){return"x"===t?null==e.offsetX?this._offsetX:e.offsetX:null==e.offsetY?this._offsetY:e.offsetY}_validatePositions(){}_addPanelClasses(e){this._pane&&_x(e).forEach(t=>{""!==t&&-1===this._appliedPanelClasses.indexOf(t)&&(this._appliedPanelClasses.push(t),this._pane.classList.add(t))})}_clearPanelClasses(){this._pane&&(this._appliedPanelClasses.forEach(e=>{this._pane.classList.remove(e)}),this._appliedPanelClasses=[])}_getOriginRect(){const e=this._origin;if(e instanceof ar)return e.nativeElement.getBoundingClientRect();if(e instanceof Element)return e.getBoundingClientRect();const t=e.width||0,i=e.height||0;return{top:e.y,bottom:e.y+i,left:e.x,right:e.x+t,height:i,width:t}}}function Vf(n,e){for(let t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function zI(n){if("number"!=typeof n&&null!=n){const[e,t]=n.split(mU);return t&&"px"!==t?null:parseFloat(e)}return n||null}function VI(n){return{top:Math.floor(n.top),right:Math.floor(n.right),bottom:Math.floor(n.bottom),left:Math.floor(n.left),width:Math.floor(n.width),height:Math.floor(n.height)}}const UI="cdk-global-overlay-wrapper";class _U{constructor(){this._cssPosition="static",this._topOffset="",this._bottomOffset="",this._alignItems="",this._xPosition="",this._xOffset="",this._width="",this._height="",this._isDisposed=!1}attach(e){const t=e.getConfig();this._overlayRef=e,this._width&&!t.width&&e.updateSize({width:this._width}),this._height&&!t.height&&e.updateSize({height:this._height}),e.hostElement.classList.add(UI),this._isDisposed=!1}top(e=""){return this._bottomOffset="",this._topOffset=e,this._alignItems="flex-start",this}left(e=""){return this._xOffset=e,this._xPosition="left",this}bottom(e=""){return this._topOffset="",this._bottomOffset=e,this._alignItems="flex-end",this}right(e=""){return this._xOffset=e,this._xPosition="right",this}start(e=""){return this._xOffset=e,this._xPosition="start",this}end(e=""){return this._xOffset=e,this._xPosition="end",this}width(e=""){return this._overlayRef?this._overlayRef.updateSize({width:e}):this._width=e,this}height(e=""){return this._overlayRef?this._overlayRef.updateSize({height:e}):this._height=e,this}centerHorizontally(e=""){return this.left(e),this._xPosition="center",this}centerVertically(e=""){return this.top(e),this._alignItems="center",this}apply(){if(!this._overlayRef||!this._overlayRef.hasAttached())return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement.style,i=this._overlayRef.getConfig(),{width:s,height:u,maxWidth:p,maxHeight:v}=i,C=!("100%"!==s&&"100vw"!==s||p&&"100%"!==p&&"100vw"!==p),M=!("100%"!==u&&"100vh"!==u||v&&"100%"!==v&&"100vh"!==v),O=this._xPosition,U=this._xOffset,Q="rtl"===this._overlayRef.getConfig().direction;let se="",fe="",Ee="";C?Ee="flex-start":"center"===O?(Ee="center",Q?fe=U:se=U):Q?"left"===O||"end"===O?(Ee="flex-end",se=U):("right"===O||"start"===O)&&(Ee="flex-start",fe=U):"left"===O||"start"===O?(Ee="flex-start",se=U):("right"===O||"end"===O)&&(Ee="flex-end",fe=U),e.position=this._cssPosition,e.marginLeft=C?"0":se,e.marginTop=M?"0":this._topOffset,e.marginBottom=this._bottomOffset,e.marginRight=C?"0":fe,t.justifyContent=Ee,t.alignItems=M?"flex-start":this._alignItems}dispose(){if(this._isDisposed||!this._overlayRef)return;const e=this._overlayRef.overlayElement.style,t=this._overlayRef.hostElement,i=t.style;t.classList.remove(UI),i.justifyContent=i.alignItems=e.marginTop=e.marginBottom=e.marginLeft=e.marginRight=e.position="",this._overlayRef=null,this._isDisposed=!0}}let yU=(()=>{class n{constructor(t,i,s,u){this._viewportRuler=t,this._document=i,this._platform=s,this._overlayContainer=u}global(){return new _U}flexibleConnectedTo(t){return new gU(t,this._viewportRuler,this._document,this._platform,this._overlayContainer)}}return n.\u0275fac=function(t){return new(t||n)(ze(PE),ze(ei),ze(Rc),ze(Tx))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),vU=0,Mm=(()=>{class n{constructor(t,i,s,u,p,v,C,M,O,U,Q,se){this.scrollStrategies=t,this._overlayContainer=i,this._componentFactoryResolver=s,this._positionBuilder=u,this._keyboardDispatcher=p,this._injector=v,this._ngZone=C,this._document=M,this._directionality=O,this._location=U,this._outsideClickDispatcher=Q,this._animationsModuleType=se}create(t){const i=this._createHostElement(),s=this._createPaneElement(i),u=this._createPortalOutlet(s),p=new LI(t);return p.direction=p.direction||this._directionality.value,new my(u,i,s,p,this._ngZone,this._keyboardDispatcher,this._document,this._location,this._outsideClickDispatcher,"NoopAnimations"===this._animationsModuleType)}position(){return this._positionBuilder}_createPaneElement(t){const i=this._document.createElement("div");return i.id="cdk-overlay-"+vU++,i.classList.add("cdk-overlay-pane"),t.appendChild(i),i}_createHostElement(){const t=this._document.createElement("div");return this._overlayContainer.getContainerElement().appendChild(t),t}_createPortalOutlet(t){return this._appRef||(this._appRef=this._injector.get(Pf)),new aU(t,this._componentFactoryResolver,this._appRef,this._injector,this._document)}}return n.\u0275fac=function(t){return new(t||n)(ze(hU),ze(Tx),ze(ru),ze(yU),ze(fU),ze(Or),ze(On),ze(ei),ze(Sm),ze(N_),ze(pU),ze(O_,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const wU={provide:new xt("cdk-connected-overlay-scroll-strategy"),deps:[Mm],useFactory:function bU(n){return()=>n.scrollStrategies.reposition()}};let jI=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[Mm,wU],imports:[py,Dx,PI,PI]}),n})();function HI(n,...e){return e.length?e.some(t=>n[t]):n.altKey||n.shiftKey||n.ctrlKey||n.metaKey}function GI(n){return Br((e,t)=>n<=t)}function AU(n,e){return n===e}let IU=(()=>{class n{create(t){return typeof MutationObserver>"u"?null:new MutationObserver(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),PU=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[IU]}),n})();const qI=new Set;let Am,RU=(()=>{class n{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):FU}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function OU(n){if(!qI.has(n))try{Am||(Am=document.createElement("style"),Am.setAttribute("type","text/css"),document.head.appendChild(Am)),Am.sheet&&(Am.sheet.insertRule(`@media ${n} {body{ }}`,0),qI.add(n))}catch(e){console.error(e)}}(t),this._matchMedia(t)}}return n.\u0275fac=function(t){return new(t||n)(ze(Rc))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function FU(n){return{matches:"all"===n||""===n,media:n,addListener:()=>{},removeListener:()=>{}}}let LU=(()=>{class n{constructor(t,i){this._mediaMatcher=t,this._zone=i,this._queries=new Map,this._destroySubject=new mn}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return WI(_x(t)).some(s=>this._registerQuery(s).mql.matches)}observe(t){let u=E1(WI(_x(t)).map(p=>this._registerQuery(p).observable));return u=cm(u.pipe(mo(1)),u.pipe(GI(1),function kU(n,e=bx){return ni((t,i)=>{let s=null,u=null,p=null;const v=()=>{if(s){s.unsubscribe(),s=null;const M=u;u=null,i.next(M)}};function C(){const M=p+n,O=e.now();if(O<M)return s=this.schedule(void 0,M-O),void i.add(s);v()}t.subscribe(Ln(i,M=>{u=M,p=e.now(),s||(s=e.schedule(C,n),i.add(s))},()=>{v(),i.complete()},void 0,()=>{u=s=null}))})}(0))),u.pipe(gt(p=>{const v={matches:!1,breakpoints:{}};return p.forEach(({matches:C,query:M})=>{v.matches=v.matches||C,v.breakpoints[M]=C}),v}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const i=this._mediaMatcher.matchMedia(t),u={observable:new Lt(p=>{const v=C=>this._zone.run(()=>p.next(C));return i.addListener(v),()=>{i.removeListener(v)}}).pipe($_(i),gt(({matches:p})=>({query:t,matches:p})),hy(this._destroySubject)),mql:i};return this._queries.set(t,u),u}}return n.\u0275fac=function(t){return new(t||n)(ze(RU),ze(On))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function WI(n){return n.map(e=>e.split(",")).reduce((e,t)=>e.concat(t)).map(e=>e.trim())}let Sx=(()=>{class n{constructor(t){this._platform=t}isDisabled(t){return t.hasAttribute("disabled")}isVisible(t){return function VU(n){return!!(n.offsetWidth||n.offsetHeight||"function"==typeof n.getClientRects&&n.getClientRects().length)}(t)&&"visible"===getComputedStyle(t).visibility}isTabbable(t){if(!this._platform.isBrowser)return!1;const i=function zU(n){try{return n.frameElement}catch{return null}}(function ZU(n){return n.ownerDocument&&n.ownerDocument.defaultView||window}(t));if(i&&(-1===YI(i)||!this.isVisible(i)))return!1;let s=t.nodeName.toLowerCase(),u=YI(t);return t.hasAttribute("contenteditable")?-1!==u:!("iframe"===s||"object"===s||this._platform.WEBKIT&&this._platform.IOS&&!function qU(n){let e=n.nodeName.toLowerCase(),t="input"===e&&n.type;return"text"===t||"password"===t||"select"===e||"textarea"===e}(t))&&("audio"===s?!!t.hasAttribute("controls")&&-1!==u:"video"===s?-1!==u&&(null!==u||this._platform.FIREFOX||t.hasAttribute("controls")):t.tabIndex>=0)}isFocusable(t,i){return function WU(n){return!function jU(n){return function HU(n){return"input"==n.nodeName.toLowerCase()}(n)&&"hidden"==n.type}(n)&&(function UU(n){let e=n.nodeName.toLowerCase();return"input"===e||"select"===e||"button"===e||"textarea"===e}(n)||function $U(n){return function GU(n){return"a"==n.nodeName.toLowerCase()}(n)&&n.hasAttribute("href")}(n)||n.hasAttribute("contenteditable")||KI(n))}(t)&&!this.isDisabled(t)&&(i?.ignoreVisibility||this.isVisible(t))}}return n.\u0275fac=function(t){return new(t||n)(ze(Rc))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function KI(n){if(!n.hasAttribute("tabindex")||void 0===n.tabIndex)return!1;let e=n.getAttribute("tabindex");return!(!e||isNaN(parseInt(e,10)))}function YI(n){if(!KI(n))return null;const e=parseInt(n.getAttribute("tabindex")||"",10);return isNaN(e)?-1:e}class XU{get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}constructor(e,t,i,s,u=!1){this._element=e,this._checker=t,this._ngZone=i,this._document=s,this._hasAttached=!1,this.startAnchorListener=()=>this.focusLastTabbableElement(),this.endAnchorListener=()=>this.focusFirstTabbableElement(),this._enabled=!0,u||this.attachAnchors()}destroy(){const e=this._startAnchor,t=this._endAnchor;e&&(e.removeEventListener("focus",this.startAnchorListener),e.remove()),t&&(t.removeEventListener("focus",this.endAnchorListener),t.remove()),this._startAnchor=this._endAnchor=null,this._hasAttached=!1}attachAnchors(){return!!this._hasAttached||(this._ngZone.runOutsideAngular(()=>{this._startAnchor||(this._startAnchor=this._createAnchor(),this._startAnchor.addEventListener("focus",this.startAnchorListener)),this._endAnchor||(this._endAnchor=this._createAnchor(),this._endAnchor.addEventListener("focus",this.endAnchorListener))}),this._element.parentNode&&(this._element.parentNode.insertBefore(this._startAnchor,this._element),this._element.parentNode.insertBefore(this._endAnchor,this._element.nextSibling),this._hasAttached=!0),this._hasAttached)}focusInitialElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusInitialElement(e)))})}focusFirstTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusFirstTabbableElement(e)))})}focusLastTabbableElementWhenReady(e){return new Promise(t=>{this._executeOnStable(()=>t(this.focusLastTabbableElement(e)))})}_getRegionBoundary(e){const t=this._element.querySelectorAll(`[cdk-focus-region-${e}], [cdkFocusRegion${e}], [cdk-focus-${e}]`);return"start"==e?t.length?t[0]:this._getFirstTabbableElement(this._element):t.length?t[t.length-1]:this._getLastTabbableElement(this._element)}focusInitialElement(e){const t=this._element.querySelector("[cdk-focus-initial], [cdkFocusInitial]");if(t){if(!this._checker.isFocusable(t)){const i=this._getFirstTabbableElement(t);return i?.focus(e),!!i}return t.focus(e),!0}return this.focusFirstTabbableElement(e)}focusFirstTabbableElement(e){const t=this._getRegionBoundary("start");return t&&t.focus(e),!!t}focusLastTabbableElement(e){const t=this._getRegionBoundary("end");return t&&t.focus(e),!!t}hasAttached(){return this._hasAttached}_getFirstTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=0;i<t.length;i++){const s=t[i].nodeType===this._document.ELEMENT_NODE?this._getFirstTabbableElement(t[i]):null;if(s)return s}return null}_getLastTabbableElement(e){if(this._checker.isFocusable(e)&&this._checker.isTabbable(e))return e;const t=e.children;for(let i=t.length-1;i>=0;i--){const s=t[i].nodeType===this._document.ELEMENT_NODE?this._getLastTabbableElement(t[i]):null;if(s)return s}return null}_createAnchor(){const e=this._document.createElement("div");return this._toggleAnchorTabIndex(this._enabled,e),e.classList.add("cdk-visually-hidden"),e.classList.add("cdk-focus-trap-anchor"),e.setAttribute("aria-hidden","true"),e}_toggleAnchorTabIndex(e,t){e?t.setAttribute("tabindex","0"):t.removeAttribute("tabindex")}toggleAnchors(e){this._startAnchor&&this._endAnchor&&(this._toggleAnchorTabIndex(e,this._startAnchor),this._toggleAnchorTabIndex(e,this._endAnchor))}_executeOnStable(e){this._ngZone.isStable?e():this._ngZone.onStable.pipe(mo(1)).subscribe(e)}}let NE=(()=>{class n{constructor(t,i,s){this._checker=t,this._ngZone=i,this._document=s}create(t,i=!1){return new XU(t,this._checker,this._ngZone,this._document,i)}}return n.\u0275fac=function(t){return new(t||n)(ze(Sx),ze(On),ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function JI(n){return 0===n.buttons||0===n.offsetX&&0===n.offsetY}function QI(n){const e=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0];return!(!e||-1!==e.identifier||null!=e.radiusX&&1!==e.radiusX||null!=e.radiusY&&1!==e.radiusY)}const KU=new xt("cdk-input-modality-detector-options"),YU={ignoreKeys:[18,17,224,91,16]},Im=wx({passive:!0,capture:!0});let JU=(()=>{class n{get mostRecentModality(){return this._modality.value}constructor(t,i,s,u){this._platform=t,this._mostRecentTarget=null,this._modality=new Zl(null),this._lastTouchMs=0,this._onKeydown=p=>{this._options?.ignoreKeys?.some(v=>v===p.keyCode)||(this._modality.next("keyboard"),this._mostRecentTarget=kd(p))},this._onMousedown=p=>{Date.now()-this._lastTouchMs<650||(this._modality.next(JI(p)?"keyboard":"mouse"),this._mostRecentTarget=kd(p))},this._onTouchstart=p=>{QI(p)?this._modality.next("keyboard"):(this._lastTouchMs=Date.now(),this._modality.next("touch"),this._mostRecentTarget=kd(p))},this._options={...YU,...u},this.modalityDetected=this._modality.pipe(GI(1)),this.modalityChanged=this.modalityDetected.pipe(function MU(n,e=eo){return n=n??AU,ni((t,i)=>{let s,u=!0;t.subscribe(Ln(i,p=>{const v=e(p);(u||!n(s,v))&&(u=!1,s=v,i.next(p))}))})}()),t.isBrowser&&i.runOutsideAngular(()=>{s.addEventListener("keydown",this._onKeydown,Im),s.addEventListener("mousedown",this._onMousedown,Im),s.addEventListener("touchstart",this._onTouchstart,Im)})}ngOnDestroy(){this._modality.complete(),this._platform.isBrowser&&(document.removeEventListener("keydown",this._onKeydown,Im),document.removeEventListener("mousedown",this._onMousedown,Im),document.removeEventListener("touchstart",this._onTouchstart,Im))}}return n.\u0275fac=function(t){return new(t||n)(ze(Rc),ze(On),ze(ei),ze(KU,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ej=new xt("cdk-focus-monitor-default-options"),Mx=wx({passive:!0,capture:!0});let BE=(()=>{class n{constructor(t,i,s,u,p){this._ngZone=t,this._platform=i,this._inputModalityDetector=s,this._origin=null,this._windowFocused=!1,this._originFromTouchInteraction=!1,this._elementInfo=new Map,this._monitoredElementCount=0,this._rootNodeFocusListenerCount=new Map,this._windowFocusListener=()=>{this._windowFocused=!0,this._windowFocusTimeoutId=window.setTimeout(()=>this._windowFocused=!1)},this._stopInputModalityDetector=new mn,this._rootNodeFocusAndBlurListener=v=>{for(let M=kd(v);M;M=M.parentElement)"focus"===v.type?this._onFocus(v,M):this._onBlur(v,M)},this._document=u,this._detectionMode=p?.detectionMode||0}monitor(t,i=!1){const s=Cm(t);if(!this._platform.isBrowser||1!==s.nodeType)return Ut(null);const u=function q3(n){if(function G3(){if(null==ME){const n=typeof document<"u"?document.head:null;ME=!(!n||!n.createShadowRoot&&!n.attachShadow)}return ME}()){const e=n.getRootNode?n.getRootNode():null;if(typeof ShadowRoot<"u"&&ShadowRoot&&e instanceof ShadowRoot)return e}return null}(s)||this._getDocument(),p=this._elementInfo.get(s);if(p)return i&&(p.checkChildren=!0),p.subject;const v={checkChildren:i,subject:new mn,rootNode:u};return this._elementInfo.set(s,v),this._registerGlobalListeners(v),v.subject}stopMonitoring(t){const i=Cm(t),s=this._elementInfo.get(i);s&&(s.subject.complete(),this._setClasses(i),this._elementInfo.delete(i),this._removeGlobalListeners(s))}focusVia(t,i,s){const u=Cm(t);u===this._getDocument().activeElement?this._getClosestElementsInfo(u).forEach(([v,C])=>this._originChanged(v,i,C)):(this._setOrigin(i),"function"==typeof u.focus&&u.focus(s))}ngOnDestroy(){this._elementInfo.forEach((t,i)=>this.stopMonitoring(i))}_getDocument(){return this._document||document}_getWindow(){return this._getDocument().defaultView||window}_getFocusOrigin(t){return this._origin?this._originFromTouchInteraction?this._shouldBeAttributedToTouch(t)?"touch":"program":this._origin:this._windowFocused&&this._lastFocusOrigin?this._lastFocusOrigin:t&&this._isLastInteractionFromInputLabel(t)?"mouse":"program"}_shouldBeAttributedToTouch(t){return 1===this._detectionMode||!!t?.contains(this._inputModalityDetector._mostRecentTarget)}_setClasses(t,i){t.classList.toggle("cdk-focused",!!i),t.classList.toggle("cdk-touch-focused","touch"===i),t.classList.toggle("cdk-keyboard-focused","keyboard"===i),t.classList.toggle("cdk-mouse-focused","mouse"===i),t.classList.toggle("cdk-program-focused","program"===i)}_setOrigin(t,i=!1){this._ngZone.runOutsideAngular(()=>{this._origin=t,this._originFromTouchInteraction="touch"===t&&i,0===this._detectionMode&&(clearTimeout(this._originTimeoutId),this._originTimeoutId=setTimeout(()=>this._origin=null,this._originFromTouchInteraction?650:1))})}_onFocus(t,i){const s=this._elementInfo.get(i),u=kd(t);!s||!s.checkChildren&&i!==u||this._originChanged(i,this._getFocusOrigin(u),s)}_onBlur(t,i){const s=this._elementInfo.get(i);!s||s.checkChildren&&t.relatedTarget instanceof Node&&i.contains(t.relatedTarget)||(this._setClasses(i),this._emitOrigin(s,null))}_emitOrigin(t,i){t.subject.observers.length&&this._ngZone.run(()=>t.subject.next(i))}_registerGlobalListeners(t){if(!this._platform.isBrowser)return;const i=t.rootNode,s=this._rootNodeFocusListenerCount.get(i)||0;s||this._ngZone.runOutsideAngular(()=>{i.addEventListener("focus",this._rootNodeFocusAndBlurListener,Mx),i.addEventListener("blur",this._rootNodeFocusAndBlurListener,Mx)}),this._rootNodeFocusListenerCount.set(i,s+1),1==++this._monitoredElementCount&&(this._ngZone.runOutsideAngular(()=>{this._getWindow().addEventListener("focus",this._windowFocusListener)}),this._inputModalityDetector.modalityDetected.pipe(hy(this._stopInputModalityDetector)).subscribe(u=>{this._setOrigin(u,!0)}))}_removeGlobalListeners(t){const i=t.rootNode;if(this._rootNodeFocusListenerCount.has(i)){const s=this._rootNodeFocusListenerCount.get(i);s>1?this._rootNodeFocusListenerCount.set(i,s-1):(i.removeEventListener("focus",this._rootNodeFocusAndBlurListener,Mx),i.removeEventListener("blur",this._rootNodeFocusAndBlurListener,Mx),this._rootNodeFocusListenerCount.delete(i))}--this._monitoredElementCount||(this._getWindow().removeEventListener("focus",this._windowFocusListener),this._stopInputModalityDetector.next(),clearTimeout(this._windowFocusTimeoutId),clearTimeout(this._originTimeoutId))}_originChanged(t,i,s){this._setClasses(t,i),this._emitOrigin(s,i),this._lastFocusOrigin=i}_getClosestElementsInfo(t){const i=[];return this._elementInfo.forEach((s,u)=>{(u===t||s.checkChildren&&u.contains(t))&&i.push([u,s])}),i}_isLastInteractionFromInputLabel(t){const{_mostRecentTarget:i,mostRecentModality:s}=this._inputModalityDetector;if("mouse"!==s||!i||i===t||"INPUT"!==t.nodeName&&"TEXTAREA"!==t.nodeName||t.disabled)return!1;const u=t.labels;if(u)for(let p=0;p<u.length;p++)if(u[p].contains(i))return!0;return!1}}return n.\u0275fac=function(t){return new(t||n)(ze(On),ze(Rc),ze(JU),ze(ei,8),ze(ej,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const t2="cdk-high-contrast-black-on-white",n2="cdk-high-contrast-white-on-black",zE="cdk-high-contrast-active";let r2=(()=>{class n{constructor(t,i){this._platform=t,this._document=i,this._breakpointSubscription=Zt(LU).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const i=this._document.defaultView||window,s=i&&i.getComputedStyle?i.getComputedStyle(t):null,u=(s&&s.backgroundColor||"").replace(/ /g,"");switch(t.remove(),u){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(zE,t2,n2),this._hasCheckedHighContrastMode=!0;const i=this.getHighContrastMode();1===i?t.add(zE,t2):2===i&&t.add(zE,n2)}}}return n.\u0275fac=function(t){return new(t||n)(ze(Rc),ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),tj=(()=>{class n{constructor(t){t._applyBodyHighContrastModeCssClasses()}}return n.\u0275fac=function(t){return new(t||n)(ze(r2))},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[PU]}),n})();function nj(n,e){}class Ax{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.closeOnNavigation=!0,this.closeOnDestroy=!0,this.closeOnOverlayDetachments=!0}}let o2=(()=>{class n extends OE{constructor(t,i,s,u,p,v,C,M){super(),this._elementRef=t,this._focusTrapFactory=i,this._config=u,this._interactivityChecker=p,this._ngZone=v,this._overlayRef=C,this._focusMonitor=M,this._elementFocusedBeforeDialogWasOpened=null,this._closeInteractionType=null,this.attachDomPortal=O=>{this._portalOutlet.hasAttached();const U=this._portalOutlet.attachDomPortal(O);return this._contentAttached(),U},this._ariaLabelledBy=this._config.ariaLabelledBy||null,this._document=s}_contentAttached(){this._initializeFocusTrap(),this._handleBackdropClicks(),this._captureInitialFocus()}_captureInitialFocus(){this._trapFocus()}ngOnDestroy(){this._restoreFocus()}attachComponentPortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachComponentPortal(t);return this._contentAttached(),i}attachTemplatePortal(t){this._portalOutlet.hasAttached();const i=this._portalOutlet.attachTemplatePortal(t);return this._contentAttached(),i}_recaptureFocus(){this._containsFocus()||this._trapFocus()}_forceFocus(t,i){this._interactivityChecker.isFocusable(t)||(t.tabIndex=-1,this._ngZone.runOutsideAngular(()=>{const s=()=>{t.removeEventListener("blur",s),t.removeEventListener("mousedown",s),t.removeAttribute("tabindex")};t.addEventListener("blur",s),t.addEventListener("mousedown",s)})),t.focus(i)}_focusByCssSelector(t,i){let s=this._elementRef.nativeElement.querySelector(t);s&&this._forceFocus(s,i)}_trapFocus(){const t=this._elementRef.nativeElement;switch(this._config.autoFocus){case!1:case"dialog":this._containsFocus()||t.focus();break;case!0:case"first-tabbable":this._focusTrap.focusInitialElementWhenReady().then(i=>{i||this._focusDialogContainer()});break;case"first-heading":this._focusByCssSelector('h1, h2, h3, h4, h5, h6, [role="heading"]');break;default:this._focusByCssSelector(this._config.autoFocus)}}_restoreFocus(){const t=this._config.restoreFocus;let i=null;if("string"==typeof t?i=this._document.querySelector(t):"boolean"==typeof t?i=t?this._elementFocusedBeforeDialogWasOpened:null:t&&(i=t),this._config.restoreFocus&&i&&"function"==typeof i.focus){const s=AE(),u=this._elementRef.nativeElement;(!s||s===this._document.body||s===u||u.contains(s))&&(this._focusMonitor?(this._focusMonitor.focusVia(i,this._closeInteractionType),this._closeInteractionType=null):i.focus())}this._focusTrap&&this._focusTrap.destroy()}_focusDialogContainer(){this._elementRef.nativeElement.focus&&this._elementRef.nativeElement.focus()}_containsFocus(){const t=this._elementRef.nativeElement,i=AE();return t===i||t.contains(i)}_initializeFocusTrap(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._document&&(this._elementFocusedBeforeDialogWasOpened=AE())}_handleBackdropClicks(){this._overlayRef.backdropClick().subscribe(()=>{this._config.disableClose&&this._recaptureFocus()})}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(NE),$e(ei,8),$e(Ax),$e(Sx),$e(On),$e(my),$e(BE))},n.\u0275cmp=Mo({type:n,selectors:[["cdk-dialog-container"]],viewQuery:function(t,i){if(1&t&&Aw(FE,7),2&t){let s;d0(s=f0())&&(i._portalOutlet=s.first)}},hostAttrs:["tabindex","-1",1,"cdk-dialog-container"],hostVars:6,hostBindings:function(t,i){2&t&&Ae("id",i._config.id||null)("role",i._config.role)("aria-modal",i._config.ariaModal)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null)},features:[Xn],decls:1,vars:0,consts:[["cdkPortalOutlet",""]],template:function(t,i){1&t&&jt(0,nj,0,0,"ng-template",0)},dependencies:[FE],styles:[".cdk-dialog-container{display:block;width:100%;height:100%;min-height:inherit;max-height:inherit}"],encapsulation:2}),n})();class VE{constructor(e,t){this.overlayRef=e,this.config=t,this.closed=new mn,this.disableClose=t.disableClose,this.backdropClick=e.backdropClick(),this.keydownEvents=e.keydownEvents(),this.outsidePointerEvents=e.outsidePointerEvents(),this.id=t.id,this.keydownEvents.subscribe(i=>{27===i.keyCode&&!this.disableClose&&!HI(i)&&(i.preventDefault(),this.close(void 0,{focusOrigin:"keyboard"}))}),this.backdropClick.subscribe(()=>{this.disableClose||this.close(void 0,{focusOrigin:"mouse"})}),this._detachSubscription=e.detachments().subscribe(()=>{!1!==t.closeOnOverlayDetachments&&this.close()})}close(e,t){if(this.containerInstance){const i=this.closed;this.containerInstance._closeInteractionType=t?.focusOrigin||"program",this._detachSubscription.unsubscribe(),this.overlayRef.dispose(),i.next(e),i.complete(),this.componentInstance=this.containerInstance=null}}updatePosition(){return this.overlayRef.updatePosition(),this}updateSize(e="",t=""){return this.overlayRef.updateSize({width:e,height:t}),this}addPanelClass(e){return this.overlayRef.addPanelClass(e),this}removePanelClass(e){return this.overlayRef.removePanelClass(e),this}}const s2=new xt("DialogScrollStrategy"),ij=new xt("DialogData"),rj=new xt("DefaultDialogConfig"),sj={provide:s2,deps:[Mm],useFactory:function oj(n){return()=>n.scrollStrategies.block()}};let aj=0,a2=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}constructor(t,i,s,u,p,v){this._overlay=t,this._injector=i,this._defaultOptions=s,this._parentDialog=u,this._overlayContainer=p,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new mn,this._afterOpenedAtThisLevel=new mn,this._ariaHiddenElements=new Map,this.afterAllClosed=um(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe($_(void 0))),this._scrollStrategy=v}open(t,i){(i={...this._defaultOptions||new Ax,...i}).id=i.id||"cdk-dialog-"+aj++,i.id&&this.getDialogById(i.id);const u=this._getOverlayConfig(i),p=this._overlay.create(u),v=new VE(p,i),C=this._attachContainer(p,v,i);return v.containerInstance=C,this._attachDialogContent(t,v,C,i),this.openDialogs.length||this._hideNonDialogContentFromAssistiveTechnology(),this.openDialogs.push(v),v.closed.subscribe(()=>this._removeOpenDialog(v,!0)),this.afterOpened.next(v),v}closeAll(){UE(this.openDialogs,t=>t.close())}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){UE(this._openDialogsAtThisLevel,t=>{!1===t.config.closeOnDestroy&&this._removeOpenDialog(t,!1)}),UE(this._openDialogsAtThisLevel,t=>t.close()),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete(),this._openDialogsAtThisLevel=[]}_getOverlayConfig(t){const i=new LI({positionStrategy:t.positionStrategy||this._overlay.position().global().centerHorizontally().centerVertically(),scrollStrategy:t.scrollStrategy||this._scrollStrategy(),panelClass:t.panelClass,hasBackdrop:t.hasBackdrop,direction:t.direction,minWidth:t.minWidth,minHeight:t.minHeight,maxWidth:t.maxWidth,maxHeight:t.maxHeight,width:t.width,height:t.height,disposeOnNavigation:t.closeOnNavigation});return t.backdropClass&&(i.backdropClass=t.backdropClass),i}_attachContainer(t,i,s){const u=s.injector||s.viewContainerRef?.injector,p=[{provide:Ax,useValue:s},{provide:VE,useValue:i},{provide:my,useValue:t}];let v;s.container?"function"==typeof s.container?v=s.container:(v=s.container.type,p.push(...s.container.providers(s))):v=o2;const C=new RE(v,s.viewContainerRef,Or.create({parent:u||this._injector,providers:p}),s.componentFactoryResolver);return t.attach(C).instance}_attachDialogContent(t,i,s,u){if(t instanceof mu){const p=this._createInjector(u,i,s,void 0);let v={$implicit:u.data,dialogRef:i};u.templateContext&&(v={...v,..."function"==typeof u.templateContext?u.templateContext():u.templateContext}),s.attachTemplatePortal(new kI(t,null,v,p))}else{const p=this._createInjector(u,i,s,this._injector),v=s.attachComponentPortal(new RE(t,u.viewContainerRef,p,u.componentFactoryResolver));i.componentInstance=v.instance}}_createInjector(t,i,s,u){const p=t.injector||t.viewContainerRef?.injector,v=[{provide:ij,useValue:t.data},{provide:VE,useValue:i}];return t.providers&&("function"==typeof t.providers?v.push(...t.providers(i,t,s)):v.push(...t.providers)),t.direction&&(!p||!p.get(Sm,null,{optional:!0}))&&v.push({provide:Sm,useValue:{value:t.direction,change:Ut()}}),Or.create({parent:p||u,providers:v})}_removeOpenDialog(t,i){const s=this.openDialogs.indexOf(t);s>-1&&(this.openDialogs.splice(s,1),this.openDialogs.length||(this._ariaHiddenElements.forEach((u,p)=>{u?p.setAttribute("aria-hidden",u):p.removeAttribute("aria-hidden")}),this._ariaHiddenElements.clear(),i&&this._getAfterAllClosed().next()))}_hideNonDialogContentFromAssistiveTechnology(){const t=this._overlayContainer.getContainerElement();if(t.parentElement){const i=t.parentElement.children;for(let s=i.length-1;s>-1;s--){const u=i[s];u!==t&&"SCRIPT"!==u.nodeName&&"STYLE"!==u.nodeName&&!u.hasAttribute("aria-live")&&(this._ariaHiddenElements.set(u,u.getAttribute("aria-hidden")),u.setAttribute("aria-hidden","true"))}}}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}}return n.\u0275fac=function(t){return new(t||n)(ze(Mm),ze(Or),ze(rj,8),ze(n,12),ze(Tx),ze(s2))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();function UE(n,e){let t=n.length;for(;t--;)e(n[t])}let lj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[a2,sj],imports:[jI,Dx,tj,Dx]}),n})();const uj=new xt("mat-sanity-checks",{providedIn:"root",factory:function cj(){return!0}});let u2=(()=>{class n{constructor(t,i,s){this._sanityChecks=i,this._document=s,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!IE()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return n.\u0275fac=function(t){return new(t||n)(ze(r2),ze(uj,8),ze(ei))},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[py,py]}),n})();class dj{constructor(e,t,i,s=!1){this._renderer=e,this.element=t,this.config=i,this._animationForciblyDisabledThroughCss=s,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const h2=wx({passive:!0,capture:!0});class fj{constructor(){this._events=new Map,this._delegateEventHandler=e=>{const t=kd(e);t&&this._events.get(e.type)?.forEach((i,s)=>{(s===t||s.contains(t))&&i.forEach(u=>u.handleEvent(e))})}}addHandler(e,t,i,s){const u=this._events.get(t);if(u){const p=u.get(i);p?p.add(s):u.set(i,new Set([s]))}else this._events.set(t,new Map([[i,new Set([s])]])),e.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,h2)})}removeHandler(e,t,i){const s=this._events.get(e);if(!s)return;const u=s.get(t);u&&(u.delete(i),0===u.size&&s.delete(t),0===s.size&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,h2)))}}const d2={enterDuration:225,exitDuration:150},f2=wx({passive:!0,capture:!0}),p2=["mousedown","touchstart"],m2=["mouseup","mouseleave","touchend","touchcancel"];class Ix{constructor(e,t,i,s){this._target=e,this._ngZone=t,this._platform=s,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,s.isBrowser&&(this._containerElement=Cm(i))}fadeInRipple(e,t,i={}){const s=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),u={...d2,...i.animation};i.centered&&(e=s.left+s.width/2,t=s.top+s.height/2);const p=i.radius||function mj(n,e,t){const i=Math.max(Math.abs(n-t.left),Math.abs(n-t.right)),s=Math.max(Math.abs(e-t.top),Math.abs(e-t.bottom));return Math.sqrt(i*i+s*s)}(e,t,s),v=e-s.left,C=t-s.top,M=u.enterDuration,O=document.createElement("div");O.classList.add("mat-ripple-element"),O.style.left=v-p+"px",O.style.top=C-p+"px",O.style.height=2*p+"px",O.style.width=2*p+"px",null!=i.color&&(O.style.backgroundColor=i.color),O.style.transitionDuration=`${M}ms`,this._containerElement.appendChild(O);const U=window.getComputedStyle(O),se=U.transitionDuration,fe="none"===U.transitionProperty||"0s"===se||"0s, 0s"===se||0===s.width&&0===s.height,Ee=new dj(this,O,i,fe);O.style.transform="scale3d(1, 1, 1)",Ee.state=0,i.persistent||(this._mostRecentTransientRipple=Ee);let Be=null;return!fe&&(M||u.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const Xe=()=>this._finishRippleTransition(Ee),ft=()=>this._destroyRipple(Ee);O.addEventListener("transitionend",Xe),O.addEventListener("transitioncancel",ft),Be={onTransitionEnd:Xe,onTransitionCancel:ft}}),this._activeRipples.set(Ee,Be),(fe||!M)&&this._finishRippleTransition(Ee),Ee}fadeOutRipple(e){if(2===e.state||3===e.state)return;const t=e.element,i={...d2,...e.config.animation};t.style.transitionDuration=`${i.exitDuration}ms`,t.style.opacity="0",e.state=2,(e._animationForciblyDisabledThroughCss||!i.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){const t=Cm(e);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,p2.forEach(i=>{Ix._eventManager.addHandler(this._ngZone,i,t,this)}))}handleEvent(e){"mousedown"===e.type?this._onMousedown(e):"touchstart"===e.type?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{m2.forEach(t=>{this._triggerElement.addEventListener(t,this,f2)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){0===e.state?this._startFadeOutTransition(e):2===e.state&&this._destroyRipple(e)}_startFadeOutTransition(e){const t=e===this._mostRecentTransientRipple,{persistent:i}=e.config;e.state=1,!i&&(!t||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){const t=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=3,null!==t&&(e.element.removeEventListener("transitionend",t.onTransitionEnd),e.element.removeEventListener("transitioncancel",t.onTransitionCancel)),e.element.remove()}_onMousedown(e){const t=JI(e),i=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!i&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!QI(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=e.changedTouches;for(let i=0;i<t.length;i++)this.fadeInRipple(t[i].clientX,t[i].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{!e.config.persistent&&(1===e.state||e.config.terminateOnPointerUp&&0===e.state)&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const e=this._triggerElement;e&&(p2.forEach(t=>Ix._eventManager.removeHandler(t,e,this)),this._pointerUpEventsRegistered&&m2.forEach(t=>e.removeEventListener(t,this,f2)))}}Ix._eventManager=new fj;class g2{}class gj{}const mh="*";function v2(n,e=null){return{type:2,steps:n,options:e}}function Pm(n){return{type:6,styles:n,offset:null}}function C2(n){Promise.resolve().then(n)}class _y{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){C2(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class D2{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,i=0,s=0;const u=this.players.length;0==u?C2(()=>this._onFinish()):this.players.forEach(p=>{p.onDone(()=>{++t==u&&this._onFinish()}),p.onDestroy(()=>{++i==u&&this._onDestroy()}),p.onStart(()=>{++s==u&&this._onStart()})}),this.totalTime=this.players.reduce((p,v)=>Math.max(p,v.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const t=e*this.totalTime;this.players.forEach(i=>{const s=i.totalTime?Math.min(1,t/i.totalTime):1;i.setPosition(s)})}getPosition(){const e=this.players.reduce((t,i)=>null===t||i.totalTime>t.totalTime?i:t,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}const jE="!";function yj(n,e){}class Px{constructor(){this.role="dialog",this.panelClass="",this.hasBackdrop=!0,this.backdropClass="",this.disableClose=!1,this.width="",this.height="",this.maxWidth="80vw",this.data=null,this.ariaDescribedBy=null,this.ariaLabelledBy=null,this.ariaLabel=null,this.ariaModal=!0,this.autoFocus="first-tabbable",this.restoreFocus=!0,this.delayFocusTrap=!0,this.closeOnNavigation=!0}}const $E="mdc-dialog--open",T2="mdc-dialog--opening",S2="mdc-dialog--closing";let bj=(()=>{class n extends o2{constructor(t,i,s,u,p,v,C,M){super(t,i,s,u,p,v,C,M),this._animationStateChanged=new cr}_captureInitialFocus(){this._config.delayFocusTrap||this._trapFocus()}_openAnimationDone(t){this._config.delayFocusTrap&&this._trapFocus(),this._animationStateChanged.next({state:"opened",totalTime:t})}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(NE),$e(ei,8),$e(Px),$e(Sx),$e(On),$e(my),$e(BE))},n.\u0275cmp=Mo({type:n,selectors:[["ng-component"]],features:[Xn],decls:0,vars:0,template:function(t,i){},encapsulation:2}),n})();const M2="--mat-dialog-transition-duration";function A2(n){return null==n?null:"number"==typeof n?n:n.endsWith("ms")?bI(n.substring(0,n.length-2)):n.endsWith("s")?1e3*bI(n.substring(0,n.length-1)):"0"===n?0:null}let wj=(()=>{class n extends bj{constructor(t,i,s,u,p,v,C,M,O){super(t,i,s,u,p,v,C,O),this._animationMode=M,this._animationsEnabled="NoopAnimations"!==this._animationMode,this._hostElement=this._elementRef.nativeElement,this._openAnimationDuration=this._animationsEnabled?A2(this._config.enterAnimationDuration)??150:0,this._closeAnimationDuration=this._animationsEnabled?A2(this._config.exitAnimationDuration)??75:0,this._animationTimer=null,this._finishDialogOpen=()=>{this._clearAnimationClasses(),this._openAnimationDone(this._openAnimationDuration)},this._finishDialogClose=()=>{this._clearAnimationClasses(),this._animationStateChanged.emit({state:"closed",totalTime:this._closeAnimationDuration})}}_contentAttached(){super._contentAttached(),this._startOpenAnimation()}ngOnDestroy(){super.ngOnDestroy(),null!==this._animationTimer&&clearTimeout(this._animationTimer)}_startOpenAnimation(){this._animationStateChanged.emit({state:"opening",totalTime:this._openAnimationDuration}),this._animationsEnabled?(this._hostElement.style.setProperty(M2,`${this._openAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(T2,$E)),this._waitForAnimationToComplete(this._openAnimationDuration,this._finishDialogOpen)):(this._hostElement.classList.add($E),Promise.resolve().then(()=>this._finishDialogOpen()))}_startExitAnimation(){this._animationStateChanged.emit({state:"closing",totalTime:this._closeAnimationDuration}),this._hostElement.classList.remove($E),this._animationsEnabled?(this._hostElement.style.setProperty(M2,`${this._openAnimationDuration}ms`),this._requestAnimationFrame(()=>this._hostElement.classList.add(S2)),this._waitForAnimationToComplete(this._closeAnimationDuration,this._finishDialogClose)):Promise.resolve().then(()=>this._finishDialogClose())}_clearAnimationClasses(){this._hostElement.classList.remove(T2,S2)}_waitForAnimationToComplete(t,i){null!==this._animationTimer&&clearTimeout(this._animationTimer),this._animationTimer=setTimeout(i,t)}_requestAnimationFrame(t){this._ngZone.runOutsideAngular(()=>{"function"==typeof requestAnimationFrame?requestAnimationFrame(t):t()})}}return n.\u0275fac=function(t){return new(t||n)($e(ar),$e(NE),$e(ei,8),$e(Px),$e(Sx),$e(On),$e(my),$e(O_,8),$e(BE))},n.\u0275cmp=Mo({type:n,selectors:[["mat-dialog-container"]],hostAttrs:["tabindex","-1",1,"mat-mdc-dialog-container","mdc-dialog"],hostVars:8,hostBindings:function(t,i){2&t&&(uw("id",i._config.id),Ae("aria-modal",i._config.ariaModal)("role",i._config.role)("aria-labelledby",i._config.ariaLabel?null:i._ariaLabelledBy)("aria-label",i._config.ariaLabel)("aria-describedby",i._config.ariaDescribedBy||null),tm("_mat-animation-noopable",!i._animationsEnabled))},features:[Xn],decls:3,vars:0,consts:[[1,"mdc-dialog__container"],[1,"mat-mdc-dialog-surface","mdc-dialog__surface"],["cdkPortalOutlet",""]],template:function(t,i){1&t&&(Qt(0,"div",0)(1,"div",1),jt(2,yj,0,0,"ng-template",2),bn()())},dependencies:[FE],styles:['.mdc-elevation-overlay{position:absolute;border-radius:inherit;pointer-events:none;opacity:var(--mdc-elevation-overlay-opacity, 0);transition:opacity 280ms cubic-bezier(0.4, 0, 0.2, 1)}.mdc-dialog,.mdc-dialog__scrim{position:fixed;top:0;left:0;align-items:center;justify-content:center;box-sizing:border-box;width:100%;height:100%}.mdc-dialog{display:none;z-index:var(--mdc-dialog-z-index, 7)}.mdc-dialog .mdc-dialog__content{padding:20px 24px 20px 24px}.mdc-dialog .mdc-dialog__surface{min-width:280px}@media(max-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:calc(100vw - 32px)}}@media(min-width: 592px){.mdc-dialog .mdc-dialog__surface{max-width:560px}}.mdc-dialog .mdc-dialog__surface{max-height:calc(100% - 32px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-width:none}@media(max-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px;width:560px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 112px)}}@media(max-width: 720px)and (min-width: 672px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:560px}}@media(max-width: 720px)and (max-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:calc(100vh - 160px)}}@media(max-width: 720px)and (min-height: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{max-height:560px}}@media(max-width: 720px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}@media(max-width: 720px)and (max-height: 400px),(max-width: 600px),(min-width: 720px)and (max-height: 400px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{height:100%;max-height:100vh;max-width:100vw;width:100vw;border-radius:0}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{order:-1;left:-12px}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__header{padding:0 16px 9px;justify-content:flex-start}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__title{margin-left:calc(16px - 2 * 12px)}}@media(min-width: 960px){.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface{width:calc(100vw - 400px)}.mdc-dialog.mdc-dialog--fullscreen .mdc-dialog__surface .mdc-dialog__close{right:-12px}}.mdc-dialog.mdc-dialog__scrim--hidden .mdc-dialog__scrim{opacity:0}.mdc-dialog__scrim{opacity:0;z-index:-1}.mdc-dialog__container{display:flex;flex-direction:row;align-items:center;justify-content:space-around;box-sizing:border-box;height:100%;transform:scale(0.8);opacity:0;pointer-events:none}.mdc-dialog__surface{position:relative;display:flex;flex-direction:column;flex-grow:0;flex-shrink:0;box-sizing:border-box;max-width:100%;max-height:100%;pointer-events:auto;overflow-y:auto}.mdc-dialog__surface .mdc-elevation-overlay{width:100%;height:100%;top:0;left:0}[dir=rtl] .mdc-dialog__surface,.mdc-dialog__surface[dir=rtl]{text-align:right}@media screen and (forced-colors: active),(-ms-high-contrast: active){.mdc-dialog__surface{outline:2px solid windowText}}.mdc-dialog__surface::before{position:absolute;box-sizing:border-box;width:100%;height:100%;top:0;left:0;border:2px solid rgba(0,0,0,0);border-radius:inherit;content:"";pointer-events:none}@media screen and (forced-colors: active){.mdc-dialog__surface::before{border-color:CanvasText}}@media screen and (-ms-high-contrast: active),screen and (-ms-high-contrast: none){.mdc-dialog__surface::before{content:none}}.mdc-dialog__title{display:block;margin-top:0;position:relative;flex-shrink:0;box-sizing:border-box;margin:0 0 1px;padding:0 24px 9px}.mdc-dialog__title::before{display:inline-block;width:0;height:40px;content:"";vertical-align:0}[dir=rtl] .mdc-dialog__title,.mdc-dialog__title[dir=rtl]{text-align:right}.mdc-dialog--scrollable .mdc-dialog__title{margin-bottom:1px;padding-bottom:15px}.mdc-dialog--fullscreen .mdc-dialog__header{align-items:baseline;border-bottom:1px solid rgba(0,0,0,0);display:inline-flex;justify-content:space-between;padding:0 24px 9px;z-index:1}@media screen and (forced-colors: active){.mdc-dialog--fullscreen .mdc-dialog__header{border-bottom-color:CanvasText}}.mdc-dialog--fullscreen .mdc-dialog__header .mdc-dialog__close{right:-12px}.mdc-dialog--fullscreen .mdc-dialog__title{margin-bottom:0;padding:0;border-bottom:0}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__title{border-bottom:0;margin-bottom:0}.mdc-dialog--fullscreen .mdc-dialog__close{top:5px}.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog--fullscreen.mdc-dialog--scrollable .mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--fullscreen--titleless .mdc-dialog__close{margin-top:4px}.mdc-dialog--fullscreen--titleless.mdc-dialog--scrollable .mdc-dialog__close{margin-top:0}.mdc-dialog__content{flex-grow:1;box-sizing:border-box;margin:0;overflow:auto}.mdc-dialog__content>:first-child{margin-top:0}.mdc-dialog__content>:last-child{margin-bottom:0}.mdc-dialog__title+.mdc-dialog__content,.mdc-dialog__header+.mdc-dialog__content{padding-top:0}.mdc-dialog--scrollable .mdc-dialog__title+.mdc-dialog__content{padding-top:8px;padding-bottom:8px}.mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:6px 0 0}.mdc-dialog--scrollable .mdc-dialog__content .mdc-deprecated-list:first-child:last-child{padding:0}.mdc-dialog__actions{display:flex;position:relative;flex-shrink:0;flex-wrap:wrap;align-items:center;justify-content:flex-end;box-sizing:border-box;min-height:52px;margin:0;padding:8px;border-top:1px solid rgba(0,0,0,0)}@media screen and (forced-colors: active){.mdc-dialog__actions{border-top-color:CanvasText}}.mdc-dialog--stacked .mdc-dialog__actions{flex-direction:column;align-items:flex-end}.mdc-dialog__button{margin-left:8px;margin-right:0;max-width:100%;text-align:right}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{margin-left:0;margin-right:8px}.mdc-dialog__button:first-child{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button:first-child,.mdc-dialog__button:first-child[dir=rtl]{margin-left:0;margin-right:0}[dir=rtl] .mdc-dialog__button,.mdc-dialog__button[dir=rtl]{text-align:left}.mdc-dialog--stacked .mdc-dialog__button:not(:first-child){margin-top:12px}.mdc-dialog--open,.mdc-dialog--opening,.mdc-dialog--closing{display:flex}.mdc-dialog--opening .mdc-dialog__scrim{transition:opacity 150ms linear}.mdc-dialog--opening .mdc-dialog__container{transition:opacity 75ms linear,transform 150ms 0ms cubic-bezier(0, 0, 0.2, 1)}.mdc-dialog--closing .mdc-dialog__scrim,.mdc-dialog--closing .mdc-dialog__container{transition:opacity 75ms linear}.mdc-dialog--closing .mdc-dialog__container{transform:none}.mdc-dialog--open .mdc-dialog__scrim{opacity:1}.mdc-dialog--open .mdc-dialog__container{transform:none;opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim{opacity:1}.mdc-dialog--open.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{transition:opacity 75ms linear}.mdc-dialog--open.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim{transition:opacity 150ms linear}.mdc-dialog__surface-scrim{display:none;opacity:0;position:absolute;width:100%;height:100%;z-index:1}.mdc-dialog__surface-scrim--shown .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--showing .mdc-dialog__surface-scrim,.mdc-dialog__surface-scrim--hiding .mdc-dialog__surface-scrim{display:block}.mdc-dialog-scroll-lock{overflow:hidden}.mdc-dialog--no-content-padding .mdc-dialog__content{padding:0}.mdc-dialog--sheet .mdc-dialog__close{right:12px;top:9px;position:absolute;z-index:1}.mdc-dialog__scrim--removed{pointer-events:none}.mdc-dialog__scrim--removed .mdc-dialog__scrim,.mdc-dialog__scrim--removed .mdc-dialog__surface-scrim{display:none}.mat-mdc-dialog-content{max-height:65vh}.mat-mdc-dialog-container{position:static;display:block}.mat-mdc-dialog-container,.mat-mdc-dialog-container .mdc-dialog__container,.mat-mdc-dialog-container .mdc-dialog__surface{max-height:inherit;min-height:inherit;min-width:inherit;max-width:inherit}.mat-mdc-dialog-container .mdc-dialog__surface{display:block;width:100%;height:100%}.mat-mdc-dialog-container{outline:0}.mat-mdc-dialog-container .mdc-dialog__surface{background-color:var(--mdc-dialog-container-color, white)}.mat-mdc-dialog-container .mdc-dialog__surface{box-shadow:var(--mdc-dialog-container-elevation, 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12))}.mat-mdc-dialog-container .mdc-dialog__surface{border-radius:var(--mdc-dialog-container-shape, var(--mdc-shape-medium, 4px))}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title,.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__actions,.mat-mdc-dialog-container.mdc-dialog--scrollable.mdc-dialog-scroll-divider-footer .mdc-dialog__actions{border-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container.mdc-dialog--scrollable .mdc-dialog__title{border-bottom-color:var(--mdc-dialog-with-divider-divider-color, black)}.mat-mdc-dialog-container .mdc-dialog__title{font-family:var(--mdc-dialog-subhead-font, "Arial");line-height:var(--mdc-dialog-subhead-line-height, 14px);font-size:var(--mdc-dialog-subhead-size, 14px);font-weight:var(--mdc-dialog-subhead-weight, 500);letter-spacing:var(--mdc-dialog-subhead-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__title{color:var(--mdc-dialog-subhead-color, black)}.mat-mdc-dialog-container .mdc-dialog__content{font-family:var(--mdc-dialog-supporting-text-font, "Arial");line-height:var(--mdc-dialog-supporting-text-line-height, 14px);font-size:var(--mdc-dialog-supporting-text-size, 14px);font-weight:var(--mdc-dialog-supporting-text-weight, 500);letter-spacing:var(--mdc-dialog-supporting-text-tracking, 1px)}.mat-mdc-dialog-container .mdc-dialog__content{color:var(--mdc-dialog-supporting-text-color, black)}.mat-mdc-dialog-container .mdc-dialog__container{transition-duration:var(--mat-dialog-transition-duration, 0ms)}.mat-mdc-dialog-container._mat-animation-noopable .mdc-dialog__container{transition:none}.mat-mdc-dialog-content{display:block}.mat-mdc-dialog-actions{justify-content:start}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-center,.mat-mdc-dialog-actions[align=center]{justify-content:center}.mat-mdc-dialog-actions.mat-mdc-dialog-actions-align-end,.mat-mdc-dialog-actions[align=end]{justify-content:flex-end}.mat-mdc-dialog-actions .mat-button-base+.mat-button-base,.mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-mdc-dialog-actions .mat-button-base+.mat-button-base,[dir=rtl] .mat-mdc-dialog-actions .mat-mdc-button-base+.mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2}),n})();class I2{constructor(e,t,i){this._ref=e,this._containerInstance=i,this._afterOpened=new mn,this._beforeClosed=new mn,this._state=0,this.disableClose=t.disableClose,this.id=e.id,i._animationStateChanged.pipe(Br(s=>"opened"===s.state),mo(1)).subscribe(()=>{this._afterOpened.next(),this._afterOpened.complete()}),i._animationStateChanged.pipe(Br(s=>"closed"===s.state),mo(1)).subscribe(()=>{clearTimeout(this._closeFallbackTimeout),this._finishDialogClose()}),e.overlayRef.detachments().subscribe(()=>{this._beforeClosed.next(this._result),this._beforeClosed.complete(),this._finishDialogClose()}),io(this.backdropClick(),this.keydownEvents().pipe(Br(s=>27===s.keyCode&&!this.disableClose&&!HI(s)))).subscribe(s=>{this.disableClose||(s.preventDefault(),function Ej(n,e,t){n._closeInteractionType=e,n.close(t)}(this,"keydown"===s.type?"keyboard":"mouse"))})}close(e){this._result=e,this._containerInstance._animationStateChanged.pipe(Br(t=>"closing"===t.state),mo(1)).subscribe(t=>{this._beforeClosed.next(e),this._beforeClosed.complete(),this._ref.overlayRef.detachBackdrop(),this._closeFallbackTimeout=setTimeout(()=>this._finishDialogClose(),t.totalTime+100)}),this._state=1,this._containerInstance._startExitAnimation()}afterOpened(){return this._afterOpened}afterClosed(){return this._ref.closed}beforeClosed(){return this._beforeClosed}backdropClick(){return this._ref.backdropClick}keydownEvents(){return this._ref.keydownEvents}updatePosition(e){let t=this._ref.config.positionStrategy;return e&&(e.left||e.right)?e.left?t.left(e.left):t.right(e.right):t.centerHorizontally(),e&&(e.top||e.bottom)?e.top?t.top(e.top):t.bottom(e.bottom):t.centerVertically(),this._ref.updatePosition(),this}updateSize(e="",t=""){return this._ref.updateSize(e,t),this}addPanelClass(e){return this._ref.addPanelClass(e),this}removePanelClass(e){return this._ref.removePanelClass(e),this}getState(){return this._state}_finishDialogClose(){this._state=2,this._ref.close(this._result,{focusOrigin:this._closeInteractionType}),this.componentInstance=null}}const P2=new xt("MatMdcDialogData"),Cj=new xt("mat-mdc-dialog-default-options"),k2=new xt("mat-mdc-dialog-scroll-strategy"),Tj={provide:k2,deps:[Mm],useFactory:function Dj(n){return()=>n.scrollStrategies.block()}};let Sj=0,Mj=(()=>{class n{get openDialogs(){return this._parentDialog?this._parentDialog.openDialogs:this._openDialogsAtThisLevel}get afterOpened(){return this._parentDialog?this._parentDialog.afterOpened:this._afterOpenedAtThisLevel}_getAfterAllClosed(){const t=this._parentDialog;return t?t._getAfterAllClosed():this._afterAllClosedAtThisLevel}constructor(t,i,s,u,p,v,C,M,O,U){this._overlay=t,this._defaultOptions=s,this._parentDialog=u,this._dialogRefConstructor=C,this._dialogContainerType=M,this._dialogDataToken=O,this._openDialogsAtThisLevel=[],this._afterAllClosedAtThisLevel=new mn,this._afterOpenedAtThisLevel=new mn,this._idPrefix="mat-dialog-",this.dialogConfigClass=Px,this.afterAllClosed=um(()=>this.openDialogs.length?this._getAfterAllClosed():this._getAfterAllClosed().pipe($_(void 0))),this._scrollStrategy=v,this._dialog=i.get(a2)}open(t,i){let s;(i={...this._defaultOptions||new Px,...i}).id=i.id||`${this._idPrefix}${Sj++}`,i.scrollStrategy=i.scrollStrategy||this._scrollStrategy();const u=this._dialog.open(t,{...i,positionStrategy:this._overlay.position().global().centerHorizontally().centerVertically(),disableClose:!0,closeOnDestroy:!1,closeOnOverlayDetachments:!1,container:{type:this._dialogContainerType,providers:()=>[{provide:this.dialogConfigClass,useValue:i},{provide:Ax,useValue:i}]},templateContext:()=>({dialogRef:s}),providers:(p,v,C)=>(s=new this._dialogRefConstructor(p,i,C),s.updatePosition(i?.position),[{provide:this._dialogContainerType,useValue:C},{provide:this._dialogDataToken,useValue:v.data},{provide:this._dialogRefConstructor,useValue:s}])});return s.componentInstance=u.componentInstance,this.openDialogs.push(s),this.afterOpened.next(s),s.afterClosed().subscribe(()=>{const p=this.openDialogs.indexOf(s);p>-1&&(this.openDialogs.splice(p,1),this.openDialogs.length||this._getAfterAllClosed().next())}),s}closeAll(){this._closeDialogs(this.openDialogs)}getDialogById(t){return this.openDialogs.find(i=>i.id===t)}ngOnDestroy(){this._closeDialogs(this._openDialogsAtThisLevel),this._afterAllClosedAtThisLevel.complete(),this._afterOpenedAtThisLevel.complete()}_closeDialogs(t){let i=t.length;for(;i--;)t[i].close()}}return n.\u0275fac=function(t){lu()},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),R2=(()=>{class n extends Mj{constructor(t,i,s,u,p,v,C,M){super(t,i,u,v,C,p,I2,wj,P2,M),this._idPrefix="mat-mdc-dialog-"}}return n.\u0275fac=function(t){return new(t||n)(ze(Mm),ze(Or),ze(N_,8),ze(Cj,8),ze(k2),ze(n,12),ze(Tx),ze(O_,8))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),Aj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[R2,Tj],imports:[lj,jI,Dx,u2,u2]}),n})(),Ij=(()=>{class n{constructor(t,i){this.dialogRef=t,this.data=i,this.mapbox=wE,this.lat=-21.529409,this.lng=-64.731242,this.style="mapbox://styles/mapbox/satellite-streets-v12",this.mapbox.accessToken="pk.eyJ1IjoiZG9naW1hcGJveCIsImEiOiJjbGs3OGRjaHUwNXF1M2xuejVjbG8wc3BpIn0.PCmcwIcWtoAqDTNR7cBUWw"}ngOnInit(){this.map=new wE.Map({container:"map",style:this.style,zoom:13,center:[this.data.lng,this.data.lat]}),this.map.on("load",()=>{this.map.resize(),(new wE.Marker).setLngLat([this.data.lng,this.data.lat]).addTo(this.map)})}}return n.\u0275fac=function(t){return new(t||n)($e(I2),$e(P2))},n.\u0275cmp=Mo({type:n,selectors:[["app-mapa"]],decls:1,vars:0,consts:[["id","map"]],template:function(t,i){1&t&&gi(0,"div",0)},styles:["#map[_ngcontent-%COMP%]{width:100%;height:100vh}"]}),n})();const HE_API_KEY_IPDATA="4de6779ccd997dc12af260e7635eda63a6cc3c1d56287dd4bf802adf";class kx{}class GE{}class gh{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const i=t.indexOf(":");if(i>0){const s=t.slice(0,i),u=s.toLowerCase(),p=t.slice(i+1).trim();this.maybeSetNormalizedName(s,u),this.headers.has(u)?this.headers.get(u).push(p):this.headers.set(u,[p])}})}:()=>{this.headers=new Map,Object.entries(e).forEach(([t,i])=>{let s;if(s="string"==typeof i?[i]:"number"==typeof i?[i.toString()]:i.map(u=>u.toString()),s.length>0){const u=t.toLowerCase();this.headers.set(u,s),this.maybeSetNormalizedName(t,u)}})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof gh?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new gh;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof gh?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let i=e.value;if("string"==typeof i&&(i=[i]),0===i.length)return;this.maybeSetNormalizedName(e.name,t);const s=("a"===e.op?this.headers.get(t):void 0)||[];s.push(...i),this.headers.set(t,s);break;case"d":const u=e.value;if(u){let p=this.headers.get(t);if(!p)return;p=p.filter(v=>-1===u.indexOf(v)),0===p.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,p)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class Pj{encodeKey(e){return F2(e)}encodeValue(e){return F2(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Rj=/%(\d[a-f0-9])/gi,Oj={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function F2(n){return encodeURIComponent(n).replace(Rj,(e,t)=>Oj[t]??e)}function Rx(n){return`${n}`}class Rd{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new Pj,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function kj(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(s=>{const u=s.indexOf("="),[p,v]=-1==u?[e.decodeKey(s),""]:[e.decodeKey(s.slice(0,u)),e.decodeValue(s.slice(u+1))],C=t.get(p)||[];C.push(v),t.set(p,C)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const i=e.fromObject[t],s=Array.isArray(i)?i.map(Rx):[Rx(i)];this.map.set(t,s)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(i=>{const s=e[i];Array.isArray(s)?s.forEach(u=>{t.push({param:i,value:u,op:"a"})}):t.push({param:i,value:s,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(i=>t+"="+this.encoder.encodeValue(i)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Rd({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(Rx(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let i=this.map.get(e.param)||[];const s=i.indexOf(Rx(e.value));-1!==s&&i.splice(s,1),i.length>0?this.map.set(e.param,i):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class Fj{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function L2(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function N2(n){return typeof Blob<"u"&&n instanceof Blob}function B2(n){return typeof FormData<"u"&&n instanceof FormData}class yy{constructor(e,t,i,s){let u;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Lj(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||s?(this.body=void 0!==i?i:null,u=s):u=i,u&&(this.reportProgress=!!u.reportProgress,this.withCredentials=!!u.withCredentials,u.responseType&&(this.responseType=u.responseType),u.headers&&(this.headers=u.headers),u.context&&(this.context=u.context),u.params&&(this.params=u.params)),this.headers||(this.headers=new gh),this.context||(this.context=new Fj),this.params){const p=this.params.toString();if(0===p.length)this.urlWithParams=t;else{const v=t.indexOf("?");this.urlWithParams=t+(-1===v?"?":v<t.length-1?"&":"")+p}}else this.params=new Rd,this.urlWithParams=t}serializeBody(){return null===this.body?null:L2(this.body)||N2(this.body)||B2(this.body)||function Nj(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Rd?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||B2(this.body)?null:N2(this.body)?this.body.type||null:L2(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Rd?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,i=e.url||this.url,s=e.responseType||this.responseType,u=void 0!==e.body?e.body:this.body,p=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,v=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let C=e.headers||this.headers,M=e.params||this.params;const O=e.context??this.context;return void 0!==e.setHeaders&&(C=Object.keys(e.setHeaders).reduce((U,Q)=>U.set(Q,e.setHeaders[Q]),C)),e.setParams&&(M=Object.keys(e.setParams).reduce((U,Q)=>U.set(Q,e.setParams[Q]),M)),new yy(t,i,u,{params:M,headers:C,context:O,reportProgress:v,responseType:s,withCredentials:p})}}var _o=(()=>((_o=_o||{})[_o.Sent=0]="Sent",_o[_o.UploadProgress=1]="UploadProgress",_o[_o.ResponseHeader=2]="ResponseHeader",_o[_o.DownloadProgress=3]="DownloadProgress",_o[_o.Response=4]="Response",_o[_o.User=5]="User",_o))();class qE{constructor(e,t=200,i="OK"){this.headers=e.headers||new gh,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||i,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class WE extends qE{constructor(e={}){super(e),this.type=_o.ResponseHeader}clone(e={}){return new WE({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Ox extends qE{constructor(e={}){super(e),this.type=_o.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new Ox({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class z2 extends qE{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function ZE(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let V2=(()=>{class n{constructor(t){this.handler=t}request(t,i,s={}){let u;if(t instanceof yy)u=t;else{let C,M;C=s.headers instanceof gh?s.headers:new gh(s.headers),s.params&&(M=s.params instanceof Rd?s.params:new Rd({fromObject:s.params})),u=new yy(t,i,void 0!==s.body?s.body:null,{headers:C,context:s.context,params:M,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials})}const p=Ut(u).pipe(Cd(C=>this.handler.handle(C)));if(t instanceof yy||"events"===s.observe)return p;const v=p.pipe(Br(C=>C instanceof Ox));switch(s.observe||"body"){case"body":switch(u.responseType){case"arraybuffer":return v.pipe(gt(C=>{if(null!==C.body&&!(C.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return C.body}));case"blob":return v.pipe(gt(C=>{if(null!==C.body&&!(C.body instanceof Blob))throw new Error("Response is not a Blob.");return C.body}));case"text":return v.pipe(gt(C=>{if(null!==C.body&&"string"!=typeof C.body)throw new Error("Response is not a string.");return C.body}));default:return v.pipe(gt(C=>C.body))}case"response":return v;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(t,i={}){return this.request("DELETE",t,i)}get(t,i={}){return this.request("GET",t,i)}head(t,i={}){return this.request("HEAD",t,i)}jsonp(t,i){return this.request("JSONP",t,{params:(new Rd).append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,i={}){return this.request("OPTIONS",t,i)}patch(t,i,s={}){return this.request("PATCH",t,ZE(s,i))}post(t,i,s={}){return this.request("POST",t,ZE(s,i))}put(t,i,s={}){return this.request("PUT",t,ZE(s,i))}}return n.\u0275fac=function(t){return new(t||n)(ze(kx))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();function U2(n,e){return e(n)}function Bj(n,e){return(t,i)=>e.intercept(t,{handle:s=>n(s,i)})}const Vj=new xt("HTTP_INTERCEPTORS"),vy=new xt("HTTP_INTERCEPTOR_FNS");function Uj(){let n=null;return(e,t)=>(null===n&&(n=(Zt(Vj,{optional:!0})??[]).reduceRight(Bj,U2)),n(e,t))}let j2=(()=>{class n extends kx{constructor(t,i){super(),this.backend=t,this.injector=i,this.chain=null}handle(t){if(null===this.chain){const i=Array.from(new Set(this.injector.get(vy)));this.chain=i.reduceRight((s,u)=>function zj(n,e,t){return(i,s)=>t.runInContext(()=>e(i,u=>n(u,s)))}(s,u,this.injector),U2)}return this.chain(t,i=>this.backend.handle(i))}}return n.\u0275fac=function(t){return new(t||n)(ze(GE),ze(Ul))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const Gj=/^\)\]\}',?\n/;let H2=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Lt(i=>{const s=this.xhrFactory.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((se,fe)=>s.setRequestHeader(se,fe.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const se=t.detectContentTypeHeader();null!==se&&s.setRequestHeader("Content-Type",se)}if(t.responseType){const se=t.responseType.toLowerCase();s.responseType="json"!==se?se:"text"}const u=t.serializeBody();let p=null;const v=()=>{if(null!==p)return p;const se=s.statusText||"OK",fe=new gh(s.getAllResponseHeaders()),Ee=function qj(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(s)||t.url;return p=new WE({headers:fe,status:s.status,statusText:se,url:Ee}),p},C=()=>{let{headers:se,status:fe,statusText:Ee,url:Be}=v(),Xe=null;204!==fe&&(Xe=typeof s.response>"u"?s.responseText:s.response),0===fe&&(fe=Xe?200:0);let ft=fe>=200&&fe<300;if("json"===t.responseType&&"string"==typeof Xe){const Ye=Xe;Xe=Xe.replace(Gj,"");try{Xe=""!==Xe?JSON.parse(Xe):null}catch(Tt){Xe=Ye,ft&&(ft=!1,Xe={error:Tt,text:Xe})}}ft?(i.next(new Ox({body:Xe,headers:se,status:fe,statusText:Ee,url:Be||void 0})),i.complete()):i.error(new z2({error:Xe,headers:se,status:fe,statusText:Ee,url:Be||void 0}))},M=se=>{const{url:fe}=v(),Ee=new z2({error:se,status:s.status||0,statusText:s.statusText||"Unknown Error",url:fe||void 0});i.error(Ee)};let O=!1;const U=se=>{O||(i.next(v()),O=!0);let fe={type:_o.DownloadProgress,loaded:se.loaded};se.lengthComputable&&(fe.total=se.total),"text"===t.responseType&&s.responseText&&(fe.partialText=s.responseText),i.next(fe)},Q=se=>{let fe={type:_o.UploadProgress,loaded:se.loaded};se.lengthComputable&&(fe.total=se.total),i.next(fe)};return s.addEventListener("load",C),s.addEventListener("error",M),s.addEventListener("timeout",M),s.addEventListener("abort",M),t.reportProgress&&(s.addEventListener("progress",U),null!==u&&s.upload&&s.upload.addEventListener("progress",Q)),s.send(u),i.next({type:_o.Sent}),()=>{s.removeEventListener("error",M),s.removeEventListener("abort",M),s.removeEventListener("load",C),s.removeEventListener("timeout",M),t.reportProgress&&(s.removeEventListener("progress",U),null!==u&&s.upload&&s.upload.removeEventListener("progress",Q)),s.readyState!==s.DONE&&s.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(ze(RS))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();const XE=new xt("XSRF_ENABLED"),G2=new xt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),q2=new xt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class W2{}let Xj=(()=>{class n{constructor(t,i,s){this.doc=t,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=xS(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(ze(ei),ze(am),ze(G2))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();function Kj(n,e){const t=n.url.toLowerCase();if(!Zt(XE)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const i=Zt(W2).getToken(),s=Zt(q2);return null!=i&&!n.headers.has(s)&&(n=n.clone({headers:n.headers.set(s,i)})),e(n)}var Jr=(()=>((Jr=Jr||{})[Jr.Interceptors=0]="Interceptors",Jr[Jr.LegacyInterceptors=1]="LegacyInterceptors",Jr[Jr.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Jr[Jr.NoXsrfProtection=3]="NoXsrfProtection",Jr[Jr.JsonpSupport=4]="JsonpSupport",Jr[Jr.RequestsMadeViaParent=5]="RequestsMadeViaParent",Jr))();function km(n,e){return{\u0275kind:n,\u0275providers:e}}function Yj(...n){const e=[V2,H2,j2,{provide:kx,useExisting:j2},{provide:GE,useExisting:H2},{provide:vy,useValue:Kj,multi:!0},{provide:XE,useValue:!0},{provide:W2,useClass:Xj}];for(const t of n)e.push(...t.\u0275providers);return function cv(n){return{\u0275providers:n}}(e)}const Z2=new xt("LEGACY_INTERCEPTOR_FN");let Qj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[Yj(km(Jr.LegacyInterceptors,[{provide:Z2,useFactory:Uj},{provide:vy,useExisting:Z2,multi:!0}]))]}),n})(),e5=(()=>{class n{constructor(t){this.http=t,this.url="https://api.ipdata.co"}getIP(t){return t?this.http.get(`${this.url}/${t}?api-key=${HE_API_KEY_IPDATA}`).toPromise():this.http.get(`${this.url}?api-key=${HE_API_KEY_IPDATA}`).toPromise()}}return n.\u0275fac=function(t){return new(t||n)(ze(V2))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function t5(n,e){if(1&n&&(Qt(0,"label",10),No(1),Qt(2,"span",8),No(3,"Compa\xf1ia que brinda el servicio "),bn()()),2&n){const t=hu();qo(1),ch(" ",t.info.connection.domain," ")}}function n5(n,e){if(1&n&&(Qt(0,"label",10),No(1),xw(2,"date"),Qt(3,"span",8),No(4,"Fecha y hora actual"),bn()()),2&n){const t=hu();qo(1),ch(" ",rT(2,1,t.info.timezone.current_time,"medium")," ")}}let r5=(()=>{class n{constructor(t,i){this.ipl=t,this.dialog=i,this.ip="",this.info={}}ngOnChanges(t){t.ip&&this.info_ip(this.ip)}info_ip(t){this.ipl.getIP(t).then(i=>{this.info=i,console.log(i)})}abrirUbicacion(t,i){this.dialog.open(Ij,{data:{lat:t,lng:i},width:"90%",height:"90%"})}}return n.\u0275fac=function(t){return new(t||n)($e(e5),$e(R2))},n.\u0275cmp=Mo({type:n,selectors:[["app-detalle"]],inputs:{ip:"ip"},features:[Mr],decls:34,vars:9,consts:[[1,"container"],[1,"row","bg-light"],[1,"col","border","d-flex","justify-content-center","align-items-center","flex-column"],[1,"text-dark","mt-3"],[1,"text-dark","text-center","mb-2"],[1,"d-flex","flex-column","flex-md-row","p-4","gap-4","py-md-5","align-items-center","justify-content-center"],[1,"list-group","list-group-checkable","d-grid","gap-2","border-0"],["for","listGroupCheckableRadios1",1,"list-group-item","rounded-3","py-3","mb-2"],[1,"d-block","small","opacity-50"],["for","listGroupCheckableRadios2",1,"list-group-item","rounded-3","py-3","mb-2"],["for","listGroupCheckableRadios3",1,"list-group-item","rounded-3","py-3","mb-2"],["alt","bandera","width","50","height","50",3,"src"],["class","list-group-item rounded-3 py-3 mb-2","for","listGroupCheckableRadios3",4,"ngIf"],[1,"d-grid","gap-2"],[1,"btn","btn-primary",3,"click"]],template:function(t,i){1&t&&(Qt(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),No(4),bn(),Qt(5,"span",4),No(6,"Esta es la ip publica que estas usando para conectarte a internet."),bn()()(),Qt(7,"div",5)(8,"div",6)(9,"label",7),No(10),Qt(11,"span",8),No(12,"Continente desde donde de conecta "),bn()(),Qt(13,"label",9),No(14),Qt(15,"span",8),No(16,"Pais desde se conecta"),bn()(),Qt(17,"label",10),No(18),Qt(19,"span",8),No(20,"Ciudad donde se realiza la coneccion"),bn()(),Qt(21,"label",10),No(22),Qt(23,"span",8),No(24,"Ip con el que se conecta "),bn()(),Qt(25,"label",10),gi(26,"img",11),Qt(27,"span",8),No(28,"Bandera"),bn()(),jt(29,t5,4,1,"label",12),jt(30,n5,5,4,"label",12),Qt(31,"div",13)(32,"a",14),Un("click",function(){return i.abrirUbicacion(i.info.latitude,i.info.longitude)}),No(33," Abrir ubicacion "),bn()()()()()),2&t&&(qo(4),lw(i.info.ip),qo(6),ch(" ",i.info.continent_name," "),qo(4),cw(" ",i.info.country_name," (",i.info.country_code,") "),qo(4),ch(" ",i.info.city||"Desconocido"," "),qo(4),ch(" ",i.info.ip," "),qo(4),zn("src",i.info.flag,Mp),qo(3),zn("ngIf",i.info.connection),qo(1),zn("ngIf",i.info.timezone))},dependencies:[DS,AS]}),n})();const o5=[{path:"",component:(()=>{class n{constructor(){this.textoBuscar="",this.texto=""}Buscarip(){this.esIPv4(this.textoBuscar)?this.texto=this.textoBuscar:(this.textoBuscar="",this.texto="",_V().fire({icon:"error",title:"Error",text:" Ingrese un ip valido v4 "}))}esIPv4(t){const s=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/.exec(t);if(!s)return!1;for(let u=1;u<=4;u++){const p=parseInt(s[u],10);if(isNaN(p)||p<0||p>255)return!1}return!0}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Mo({type:n,selectors:[["app-inicio"]],decls:13,vars:5,consts:[[1,"p-3","text-bg-dark"],[1,"container"],[1,"d-flex","flex-wrap","align-items-center","justify-content-center","justify-content-lg-start"],["routerLink","/",1,"d-flex","align-items-center","mb-2","mb-lg-0","text-white","text-decoration-none"],[1,"nav","col-12","col-lg-auto","me-lg-auto","mb-2","justify-content-center","mb-md-0"],[1,"col-12","col-lg-auto","mb-3","mb-lg-0","me-lg-3"],["type","search",1,"form-control","form-control-dark","text-bg-dark",3,"ngModel","ngModelChange"],[1,"text-end"],["type","button",1,"btn","btn-outline-light","me-2",3,"click"],[3,"ip"]],template:function(t,i){1&t&&(Qt(0,"header",0)(1,"div",1)(2,"div",2)(3,"a",3),No(4),xw(5,"uppercase"),bn(),gi(6,"ul",4),Qt(7,"div",5)(8,"input",6),Un("ngModelChange",function(u){return i.textoBuscar=u}),bn()(),Qt(9,"div",7)(10,"button",8),Un("click",function(){return i.Buscarip()}),No(11,"Buscar"),bn()()()()(),gi(12,"app-detalle",9)),2&t&&(qo(4),ch(" ",iT(5,3,"Ip-Localize")," "),qo(4),zn("ngModel",i.textoBuscar),qo(4),zn("ip",i.texto))},dependencies:[ox,sx,jA,mE,r5,MS]}),n})()},{path:"",redirectTo:"",pathMatch:"full"}];let s5=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({imports:[mA.forRoot(o5,{useHash:!0}),mA]}),n})(),a5=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=Mo({type:n,selectors:[["app-root"]],decls:1,vars:0,template:function(t,i){1&t&&gi(0,"router-outlet")},dependencies:[j1],styles:[".tamanio[_ngcontent-%COMP%]{height:500px}"]}),n})();function X2(n){return new Le(3e3,!1)}function j5(){return typeof window<"u"&&typeof window.document<"u"}function KE(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function Od(n){switch(n.length){case 0:return new _y;case 1:return n[0];default:return new D2(n)}}function K2(n,e,t,i,s=new Map,u=new Map){const p=[],v=[];let C=-1,M=null;if(i.forEach(O=>{const U=O.get("offset"),Q=U==C,se=Q&&M||new Map;O.forEach((fe,Ee)=>{let Be=Ee,Xe=fe;if("offset"!==Ee)switch(Be=e.normalizePropertyName(Be,p),Xe){case jE:Xe=s.get(Ee);break;case mh:Xe=u.get(Ee);break;default:Xe=e.normalizeStyleValue(Ee,Be,Xe,p)}se.set(Be,Xe)}),Q||v.push(se),M=se,C=U}),p.length)throw function I5(n){return new Le(3502,!1)}();return v}function YE(n,e,t,i){switch(e){case"start":n.onStart(()=>i(t&&JE(t,"start",n)));break;case"done":n.onDone(()=>i(t&&JE(t,"done",n)));break;case"destroy":n.onDestroy(()=>i(t&&JE(t,"destroy",n)))}}function JE(n,e,t){const u=QE(n.element,n.triggerName,n.fromState,n.toState,e||n.phaseName,t.totalTime??n.totalTime,!!t.disabled),p=n._data;return null!=p&&(u._data=p),u}function QE(n,e,t,i,s="",u=0,p){return{element:n,triggerName:e,fromState:t,toState:i,phaseName:s,totalTime:u,disabled:!!p}}function pl(n,e,t){let i=n.get(e);return i||n.set(e,i=t),i}function Y2(n){const e=n.indexOf(":");return[n.substring(1,e),n.slice(e+1)]}let eC=(n,e)=>!1,J2=(n,e,t)=>[],Q2=null;function tC(n){const e=n.parentNode||n.host;return e===Q2?null:e}(KE()||typeof Element<"u")&&(j5()?(Q2=(()=>document.documentElement)(),eC=(n,e)=>{for(;e;){if(e===n)return!0;e=tC(e)}return!1}):eC=(n,e)=>n.contains(e),J2=(n,e,t)=>{if(t)return Array.from(n.querySelectorAll(e));const i=n.querySelector(e);return i?[i]:[]});let Uf=null,eP=!1;const tP=eC,nP=J2;let iP=(()=>{class n{validateStyleProperty(t){return function H5(n){Uf||(Uf=function G5(){return typeof document<"u"?document.body:null}()||{},eP=!!Uf.style&&"WebkitAppearance"in Uf.style);let e=!0;return Uf.style&&!function $5(n){return"ebkit"==n.substring(1,6)}(n)&&(e=n in Uf.style,!e&&eP&&(e="Webkit"+n.charAt(0).toUpperCase()+n.slice(1)in Uf.style)),e}(t)}matchesElement(t,i){return!1}containsElement(t,i){return tP(t,i)}getParentElement(t){return tC(t)}query(t,i,s){return nP(t,i,s)}computeStyle(t,i,s){return s||""}animate(t,i,s,u,p,v=[],C){return new _y(s,u)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),nC=(()=>{class n{}return n.NOOP=new iP,n})();const q5=1e3,iC="ng-enter",Fx="ng-leave",Lx="ng-trigger",Nx=".ng-trigger",oP="ng-animating",rC=".ng-animating";function _h(n){if("number"==typeof n)return n;const e=n.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:oC(parseFloat(e[1]),e[2])}function oC(n,e){return"s"===e?n*q5:n}function Bx(n,e,t){return n.hasOwnProperty("duration")?n:function Z5(n,e,t){let s,u=0,p="";if("string"==typeof n){const v=n.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===v)return e.push(X2()),{duration:0,delay:0,easing:""};s=oC(parseFloat(v[1]),v[2]);const C=v[3];null!=C&&(u=oC(parseFloat(C),v[4]));const M=v[5];M&&(p=M)}else s=n;if(!t){let v=!1,C=e.length;s<0&&(e.push(function l5(){return new Le(3100,!1)}()),v=!0),u<0&&(e.push(function c5(){return new Le(3101,!1)}()),v=!0),v&&e.splice(C,0,X2())}return{duration:s,delay:u,easing:p}}(n,e,t)}function xy(n,e={}){return Object.keys(n).forEach(t=>{e[t]=n[t]}),e}function sP(n){const e=new Map;return Object.keys(n).forEach(t=>{e.set(t,n[t])}),e}function Fd(n,e=new Map,t){if(t)for(let[i,s]of t)e.set(i,s);for(let[i,s]of n)e.set(i,s);return e}function lP(n,e,t){return t?e+":"+t+";":""}function cP(n){let e="";for(let t=0;t<n.style.length;t++){const i=n.style.item(t);e+=lP(0,i,n.style.getPropertyValue(i))}for(const t in n.style)n.style.hasOwnProperty(t)&&!t.startsWith("_")&&(e+=lP(0,J5(t),n.style[t]));n.setAttribute("style",e)}function xu(n,e,t){n.style&&(e.forEach((i,s)=>{const u=aC(s);t&&!t.has(s)&&t.set(s,n.style[u]),n.style[u]=i}),KE()&&cP(n))}function jf(n,e){n.style&&(e.forEach((t,i)=>{const s=aC(i);n.style[s]=""}),KE()&&cP(n))}function by(n){return Array.isArray(n)?1==n.length?n[0]:v2(n):n}const sC=new RegExp("{{\\s*(.+?)\\s*}}","g");function uP(n){let e=[];if("string"==typeof n){let t;for(;t=sC.exec(n);)e.push(t[1]);sC.lastIndex=0}return e}function wy(n,e,t){const i=n.toString(),s=i.replace(sC,(u,p)=>{let v=e[p];return null==v&&(t.push(function h5(n){return new Le(3003,!1)}()),v=""),v.toString()});return s==i?n:s}function zx(n){const e=[];let t=n.next();for(;!t.done;)e.push(t.value),t=n.next();return e}const Y5=/-+([a-z0-9])/g;function aC(n){return n.replace(Y5,(...e)=>e[1].toUpperCase())}function J5(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ml(n,e,t){switch(e.type){case 7:return n.visitTrigger(e,t);case 0:return n.visitState(e,t);case 1:return n.visitTransition(e,t);case 2:return n.visitSequence(e,t);case 3:return n.visitGroup(e,t);case 4:return n.visitAnimate(e,t);case 5:return n.visitKeyframes(e,t);case 6:return n.visitStyle(e,t);case 8:return n.visitReference(e,t);case 9:return n.visitAnimateChild(e,t);case 10:return n.visitAnimateRef(e,t);case 11:return n.visitQuery(e,t);case 12:return n.visitStagger(e,t);default:throw function d5(n){return new Le(3004,!1)}()}}function hP(n,e){return window.getComputedStyle(n)[e]}const jx="*";function r4(n,e){const t=[];return"string"==typeof n?n.split(/\s*,\s*/).forEach(i=>function o4(n,e,t){if(":"==n[0]){const C=function s4(n,e){switch(n){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,i)=>parseFloat(i)>parseFloat(t);case":decrement":return(t,i)=>parseFloat(i)<parseFloat(t);default:return e.push(function T5(n){return new Le(3016,!1)}()),"* => *"}}(n,t);if("function"==typeof C)return void e.push(C);n=C}const i=n.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return t.push(function D5(n){return new Le(3015,!1)}()),e;const s=i[1],u=i[2],p=i[3];e.push(dP(s,p));"<"==u[0]&&!(s==jx&&p==jx)&&e.push(dP(p,s))}(i,t,e)):t.push(n),t}const $x=new Set(["true","1"]),Hx=new Set(["false","0"]);function dP(n,e){const t=$x.has(n)||Hx.has(n),i=$x.has(e)||Hx.has(e);return(s,u)=>{let p=n==jx||n==s,v=e==jx||e==u;return!p&&t&&"boolean"==typeof s&&(p=s?$x.has(n):Hx.has(n)),!v&&i&&"boolean"==typeof u&&(v=u?$x.has(e):Hx.has(e)),p&&v}}const a4=new RegExp("s*:selfs*,?","g");function lC(n,e,t,i){return new l4(n).build(e,t,i)}class l4{constructor(e){this._driver=e}build(e,t,i){const s=new h4(t);return this._resetContextStyleTimingState(s),ml(this,by(e),s)}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles=new Map,e.collectedStyles.set("",new Map),e.currentTime=0}visitTrigger(e,t){let i=t.queryCount=0,s=t.depCount=0;const u=[],p=[];return"@"==e.name.charAt(0)&&t.errors.push(function p5(){return new Le(3006,!1)}()),e.definitions.forEach(v=>{if(this._resetContextStyleTimingState(t),0==v.type){const C=v,M=C.name;M.toString().split(/\s*,\s*/).forEach(O=>{C.name=O,u.push(this.visitState(C,t))}),C.name=M}else if(1==v.type){const C=this.visitTransition(v,t);i+=C.queryCount,s+=C.depCount,p.push(C)}else t.errors.push(function m5(){return new Le(3007,!1)}())}),{type:7,name:e.name,states:u,transitions:p,queryCount:i,depCount:s,options:null}}visitState(e,t){const i=this.visitStyle(e.styles,t),s=e.options&&e.options.params||null;if(i.containsDynamicStyles){const u=new Set,p=s||{};i.styles.forEach(v=>{v instanceof Map&&v.forEach(C=>{uP(C).forEach(M=>{p.hasOwnProperty(M)||u.add(M)})})}),u.size&&(zx(u.values()),t.errors.push(function g5(n,e){return new Le(3008,!1)}()))}return{type:0,name:e.name,style:i,options:s?{params:s}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;const i=ml(this,by(e.animation),t);return{type:1,matchers:r4(e.expr,t.errors),animation:i,queryCount:t.queryCount,depCount:t.depCount,options:$f(e.options)}}visitSequence(e,t){return{type:2,steps:e.steps.map(i=>ml(this,i,t)),options:$f(e.options)}}visitGroup(e,t){const i=t.currentTime;let s=0;const u=e.steps.map(p=>{t.currentTime=i;const v=ml(this,p,t);return s=Math.max(s,t.currentTime),v});return t.currentTime=s,{type:3,steps:u,options:$f(e.options)}}visitAnimate(e,t){const i=function f4(n,e){if(n.hasOwnProperty("duration"))return n;if("number"==typeof n)return cC(Bx(n,e).duration,0,"");const t=n;if(t.split(/\s+/).some(u=>"{"==u.charAt(0)&&"{"==u.charAt(1))){const u=cC(0,0,"");return u.dynamic=!0,u.strValue=t,u}const s=Bx(t,e);return cC(s.duration,s.delay,s.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;let s,u=e.styles?e.styles:Pm({});if(5==u.type)s=this.visitKeyframes(u,t);else{let p=e.styles,v=!1;if(!p){v=!0;const M={};i.easing&&(M.easing=i.easing),p=Pm(M)}t.currentTime+=i.duration+i.delay;const C=this.visitStyle(p,t);C.isEmptyStep=v,s=C}return t.currentAnimateTimings=null,{type:4,timings:i,style:s,options:null}}visitStyle(e,t){const i=this._makeStyleAst(e,t);return this._validateStyleAst(i,t),i}_makeStyleAst(e,t){const i=[],s=Array.isArray(e.styles)?e.styles:[e.styles];for(let v of s)"string"==typeof v?v===mh?i.push(v):t.errors.push(new Le(3002,!1)):i.push(sP(v));let u=!1,p=null;return i.forEach(v=>{if(v instanceof Map&&(v.has("easing")&&(p=v.get("easing"),v.delete("easing")),!u))for(let C of v.values())if(C.toString().indexOf("{{")>=0){u=!0;break}}),{type:6,styles:i,easing:p,offset:e.offset,containsDynamicStyles:u,options:null}}_validateStyleAst(e,t){const i=t.currentAnimateTimings;let s=t.currentTime,u=t.currentTime;i&&u>0&&(u-=i.duration+i.delay),e.styles.forEach(p=>{"string"!=typeof p&&p.forEach((v,C)=>{const M=t.collectedStyles.get(t.currentQuerySelector),O=M.get(C);let U=!0;O&&(u!=s&&u>=O.startTime&&s<=O.endTime&&(t.errors.push(function y5(n,e,t,i,s){return new Le(3010,!1)}()),U=!1),u=O.startTime),U&&M.set(C,{startTime:u,endTime:s}),t.options&&function K5(n,e,t){const i=e.params||{},s=uP(n);s.length&&s.forEach(u=>{i.hasOwnProperty(u)||t.push(function u5(n){return new Le(3001,!1)}())})}(v,t.options,t.errors)})})}visitKeyframes(e,t){const i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(function v5(){return new Le(3011,!1)}()),i;let u=0;const p=[];let v=!1,C=!1,M=0;const O=e.steps.map(Xe=>{const ft=this._makeStyleAst(Xe,t);let Ye=null!=ft.offset?ft.offset:function d4(n){if("string"==typeof n)return null;let e=null;if(Array.isArray(n))n.forEach(t=>{if(t instanceof Map&&t.has("offset")){const i=t;e=parseFloat(i.get("offset")),i.delete("offset")}});else if(n instanceof Map&&n.has("offset")){const t=n;e=parseFloat(t.get("offset")),t.delete("offset")}return e}(ft.styles),Tt=0;return null!=Ye&&(u++,Tt=ft.offset=Ye),C=C||Tt<0||Tt>1,v=v||Tt<M,M=Tt,p.push(Tt),ft});C&&t.errors.push(function x5(){return new Le(3012,!1)}()),v&&t.errors.push(function b5(){return new Le(3200,!1)}());const U=e.steps.length;let Q=0;u>0&&u<U?t.errors.push(function w5(){return new Le(3202,!1)}()):0==u&&(Q=1/(U-1));const se=U-1,fe=t.currentTime,Ee=t.currentAnimateTimings,Be=Ee.duration;return O.forEach((Xe,ft)=>{const Ye=Q>0?ft==se?1:Q*ft:p[ft],Tt=Ye*Be;t.currentTime=fe+Ee.delay+Tt,Ee.duration=Tt,this._validateStyleAst(Xe,t),Xe.offset=Ye,i.styles.push(Xe)}),i}visitReference(e,t){return{type:8,animation:ml(this,by(e.animation),t),options:$f(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:9,options:$f(e.options)}}visitAnimateRef(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:$f(e.options)}}visitQuery(e,t){const i=t.currentQuerySelector,s=e.options||{};t.queryCount++,t.currentQuery=e;const[u,p]=function c4(n){const e=!!n.split(/\s*,\s*/).find(t=>":self"==t);return e&&(n=n.replace(a4,"")),n=n.replace(/@\*/g,Nx).replace(/@\w+/g,t=>Nx+"-"+t.slice(1)).replace(/:animating/g,rC),[n,e]}(e.selector);t.currentQuerySelector=i.length?i+" "+u:u,pl(t.collectedStyles,t.currentQuerySelector,new Map);const v=ml(this,by(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=i,{type:11,selector:u,limit:s.limit||0,optional:!!s.optional,includeSelf:p,animation:v,originalSelector:e.selector,options:$f(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(function E5(){return new Le(3013,!1)}());const i="full"===e.timings?{duration:0,delay:0,easing:"full"}:Bx(e.timings,t.errors,!0);return{type:12,animation:ml(this,by(e.animation),t),timings:i,options:null}}}class h4{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function $f(n){return n?(n=xy(n)).params&&(n.params=function u4(n){return n?xy(n):null}(n.params)):n={},n}function cC(n,e,t){return{duration:n,delay:e,easing:t}}function uC(n,e,t,i,s,u,p=null,v=!1){return{type:1,element:n,keyframes:e,preStyleProps:t,postStyleProps:i,duration:s,delay:u,totalTime:s+u,easing:p,subTimeline:v}}class Gx{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let i=this._map.get(e);i||this._map.set(e,i=[]),i.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const g4=new RegExp(":enter","g"),y4=new RegExp(":leave","g");function hC(n,e,t,i,s,u=new Map,p=new Map,v,C,M=[]){return(new v4).buildKeyframes(n,e,t,i,s,u,p,v,C,M)}class v4{buildKeyframes(e,t,i,s,u,p,v,C,M,O=[]){M=M||new Gx;const U=new dC(e,t,M,s,u,O,[]);U.options=C;const Q=C.delay?_h(C.delay):0;U.currentTimeline.delayNextStep(Q),U.currentTimeline.setStyles([p],null,U.errors,C),ml(this,i,U);const se=U.timelines.filter(fe=>fe.containsAnimation());if(se.length&&v.size){let fe;for(let Ee=se.length-1;Ee>=0;Ee--){const Be=se[Ee];if(Be.element===t){fe=Be;break}}fe&&!fe.allowOnlyTimelineStyles()&&fe.setStyles([v],null,U.errors,C)}return se.length?se.map(fe=>fe.buildKeyframes()):[uC(t,[],[],[],0,Q,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){const i=t.subInstructions.get(t.element);if(i){const s=t.createSubContext(e.options),u=t.currentTimeline.currentTime,p=this._visitSubInstructions(i,s,s.options);u!=p&&t.transformIntoNewTimeline(p)}t.previousNode=e}visitAnimateRef(e,t){const i=t.createSubContext(e.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,i),this.visitReference(e.animation,i),t.transformIntoNewTimeline(i.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,i){for(const s of e){const u=s?.delay;if(u){const p="number"==typeof u?u:_h(wy(u,s?.params??{},t.errors));i.delayNextStep(p)}}}_visitSubInstructions(e,t,i){let u=t.currentTimeline.currentTime;const p=null!=i.duration?_h(i.duration):null,v=null!=i.delay?_h(i.delay):null;return 0!==p&&e.forEach(C=>{const M=t.appendInstructionToTimeline(C,p,v);u=Math.max(u,M.duration+M.delay)}),u}visitReference(e,t){t.updateOptions(e.options,!0),ml(this,e.animation,t),t.previousNode=e}visitSequence(e,t){const i=t.subContextCount;let s=t;const u=e.options;if(u&&(u.params||u.delay)&&(s=t.createSubContext(u),s.transformIntoNewTimeline(),null!=u.delay)){6==s.previousNode.type&&(s.currentTimeline.snapshotCurrentStyles(),s.previousNode=qx);const p=_h(u.delay);s.delayNextStep(p)}e.steps.length&&(e.steps.forEach(p=>ml(this,p,s)),s.currentTimeline.applyStylesToKeyframe(),s.subContextCount>i&&s.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){const i=[];let s=t.currentTimeline.currentTime;const u=e.options&&e.options.delay?_h(e.options.delay):0;e.steps.forEach(p=>{const v=t.createSubContext(e.options);u&&v.delayNextStep(u),ml(this,p,v),s=Math.max(s,v.currentTimeline.currentTime),i.push(v.currentTimeline)}),i.forEach(p=>t.currentTimeline.mergeTimelineCollectedStyles(p)),t.transformIntoNewTimeline(s),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){const i=e.strValue;return Bx(t.params?wy(i,t.params,t.errors):i,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){const i=t.currentAnimateTimings=this._visitTiming(e.timings,t),s=t.currentTimeline;i.delay&&(t.incrementTime(i.delay),s.snapshotCurrentStyles());const u=e.style;5==u.type?this.visitKeyframes(u,t):(t.incrementTime(i.duration),this.visitStyle(u,t),s.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){const i=t.currentTimeline,s=t.currentAnimateTimings;!s&&i.hasCurrentStyleProperties()&&i.forwardFrame();const u=s&&s.easing||e.easing;e.isEmptyStep?i.applyEmptyStep(u):i.setStyles(e.styles,u,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){const i=t.currentAnimateTimings,s=t.currentTimeline.duration,u=i.duration,v=t.createSubContext().currentTimeline;v.easing=i.easing,e.styles.forEach(C=>{v.forwardTime((C.offset||0)*u),v.setStyles(C.styles,C.easing,t.errors,t.options),v.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(v),t.transformIntoNewTimeline(s+u),t.previousNode=e}visitQuery(e,t){const i=t.currentTimeline.currentTime,s=e.options||{},u=s.delay?_h(s.delay):0;u&&(6===t.previousNode.type||0==i&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=qx);let p=i;const v=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!s.optional,t.errors);t.currentQueryTotal=v.length;let C=null;v.forEach((M,O)=>{t.currentQueryIndex=O;const U=t.createSubContext(e.options,M);u&&U.delayNextStep(u),M===t.element&&(C=U.currentTimeline),ml(this,e.animation,U),U.currentTimeline.applyStylesToKeyframe(),p=Math.max(p,U.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(p),C&&(t.currentTimeline.mergeTimelineCollectedStyles(C),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){const i=t.parentContext,s=t.currentTimeline,u=e.timings,p=Math.abs(u.duration),v=p*(t.currentQueryTotal-1);let C=p*t.currentQueryIndex;switch(u.duration<0?"reverse":u.easing){case"reverse":C=v-C;break;case"full":C=i.currentStaggerTime}const O=t.currentTimeline;C&&O.delayNextStep(C);const U=O.currentTime;ml(this,e.animation,t),t.previousNode=e,i.currentStaggerTime=s.currentTime-U+(s.startTime-i.currentTimeline.startTime)}}const qx={};class dC{constructor(e,t,i,s,u,p,v,C){this._driver=e,this.element=t,this.subInstructions=i,this._enterClassName=s,this._leaveClassName=u,this.errors=p,this.timelines=v,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=qx,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=C||new Wx(this._driver,t,0),v.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;const i=e;let s=this.options;null!=i.duration&&(s.duration=_h(i.duration)),null!=i.delay&&(s.delay=_h(i.delay));const u=i.params;if(u){let p=s.params;p||(p=this.options.params={}),Object.keys(u).forEach(v=>{(!t||!p.hasOwnProperty(v))&&(p[v]=wy(u[v],p,this.errors))})}}_copyOptions(){const e={};if(this.options){const t=this.options.params;if(t){const i=e.params={};Object.keys(t).forEach(s=>{i[s]=t[s]})}}return e}createSubContext(e=null,t,i){const s=t||this.element,u=new dC(this._driver,s,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(s,i||0));return u.previousNode=this.previousNode,u.currentAnimateTimings=this.currentAnimateTimings,u.options=this._copyOptions(),u.updateOptions(e),u.currentQueryIndex=this.currentQueryIndex,u.currentQueryTotal=this.currentQueryTotal,u.parentContext=this,this.subContextCount++,u}transformIntoNewTimeline(e){return this.previousNode=qx,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,i){const s={duration:t??e.duration,delay:this.currentTimeline.currentTime+(i??0)+e.delay,easing:""},u=new x4(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,s,e.stretchStartingKeyframe);return this.timelines.push(u),s}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,i,s,u,p){let v=[];if(s&&v.push(this.element),e.length>0){e=(e=e.replace(g4,"."+this._enterClassName)).replace(y4,"."+this._leaveClassName);let M=this._driver.query(this.element,e,1!=i);0!==i&&(M=i<0?M.slice(M.length+i,M.length):M.slice(0,i)),v.push(...M)}return!u&&0==v.length&&p.push(function C5(n){return new Le(3014,!1)}()),v}}class Wx{constructor(e,t,i,s){this._driver=e,this.element=t,this.startTime=i,this._elementTimelineStylesLookup=s,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const t=1===this._keyframes.size&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new Wx(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,i]of this._globalTimelineStyles)this._backFill.set(t,i||mh),this._currentKeyframe.set(t,mh);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,i,s){t&&this._previousKeyframe.set("easing",t);const u=s&&s.params||{},p=function b4(n,e){const t=new Map;let i;return n.forEach(s=>{if("*"===s){i=i||e.keys();for(let u of i)t.set(u,mh)}else Fd(s,t)}),t}(e,this._globalTimelineStyles);for(let[v,C]of p){const M=wy(C,u,i);this._pendingStyles.set(v,M),this._localTimelineStyles.has(v)||this._backFill.set(v,this._globalTimelineStyles.get(v)??mh),this._updateStyle(v,M)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,i)=>{const s=this._styleSummary.get(i);(!s||t.time>s.time)&&this._updateStyle(i,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,t=new Set,i=1===this._keyframes.size&&0===this.duration;let s=[];this._keyframes.forEach((v,C)=>{const M=Fd(v,new Map,this._backFill);M.forEach((O,U)=>{O===jE?e.add(U):O===mh&&t.add(U)}),i||M.set("offset",C/this.duration),s.push(M)});const u=e.size?zx(e.values()):[],p=t.size?zx(t.values()):[];if(i){const v=s[0],C=new Map(v);v.set("offset",0),C.set("offset",1),s=[v,C]}return uC(this.element,s,u,p,this.duration,this.startTime,this.easing,!1)}}class x4 extends Wx{constructor(e,t,i,s,u,p,v=!1){super(e,t,p.delay),this.keyframes=i,this.preStyleProps=s,this.postStyleProps=u,this._stretchStartingKeyframe=v,this.timings={duration:p.duration,delay:p.delay,easing:p.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:i,easing:s}=this.timings;if(this._stretchStartingKeyframe&&t){const u=[],p=i+t,v=t/p,C=Fd(e[0]);C.set("offset",0),u.push(C);const M=Fd(e[0]);M.set("offset",mP(v)),u.push(M);const O=e.length-1;for(let U=1;U<=O;U++){let Q=Fd(e[U]);const se=Q.get("offset");Q.set("offset",mP((t+se*i)/p)),u.push(Q)}i=p,t=0,s="",e=u}return uC(this.element,e,this.preStyleProps,this.postStyleProps,i,t,s,!0)}}function mP(n,e=3){const t=Math.pow(10,e-1);return Math.round(n*t)/t}class fC{}const w4=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class E4 extends fC{normalizePropertyName(e,t){return aC(e)}normalizeStyleValue(e,t,i,s){let u="";const p=i.toString().trim();if(w4.has(t)&&0!==i&&"0"!==i)if("number"==typeof i)u="px";else{const v=i.match(/^[+-]?[\d\.]+([a-z]*)$/);v&&0==v[1].length&&s.push(function f5(n,e){return new Le(3005,!1)}())}return p+u}}function gP(n,e,t,i,s,u,p,v,C,M,O,U,Q){return{type:0,element:n,triggerName:e,isRemovalTransition:s,fromState:t,fromStyles:u,toState:i,toStyles:p,timelines:v,queriedElements:C,preStyleProps:M,postStyleProps:O,totalTime:U,errors:Q}}const pC={};class _P{constructor(e,t,i){this._triggerName=e,this.ast=t,this._stateStyles=i}match(e,t,i,s){return function C4(n,e,t,i,s){return n.some(u=>u(e,t,i,s))}(this.ast.matchers,e,t,i,s)}buildStyles(e,t,i){let s=this._stateStyles.get("*");return void 0!==e&&(s=this._stateStyles.get(e?.toString())||s),s?s.buildStyles(t,i):new Map}build(e,t,i,s,u,p,v,C,M,O){const U=[],Q=this.ast.options&&this.ast.options.params||pC,fe=this.buildStyles(i,v&&v.params||pC,U),Ee=C&&C.params||pC,Be=this.buildStyles(s,Ee,U),Xe=new Set,ft=new Map,Ye=new Map,Tt="void"===s,Kn={params:D4(Ee,Q),delay:this.ast.options?.delay},wi=O?[]:hC(e,t,this.ast.animation,u,p,fe,Be,Kn,M,U);let Ss=0;if(wi.forEach(vh=>{Ss=Math.max(vh.duration+vh.delay,Ss)}),U.length)return gP(t,this._triggerName,i,s,Tt,fe,Be,[],[],ft,Ye,Ss,U);wi.forEach(vh=>{const xh=vh.element,NP=pl(ft,xh,new Set);vh.preStyleProps.forEach(Hf=>NP.add(Hf));const Dy=pl(Ye,xh,new Set);vh.postStyleProps.forEach(Hf=>Dy.add(Hf)),xh!==t&&Xe.add(xh)});const yh=zx(Xe.values());return gP(t,this._triggerName,i,s,Tt,fe,Be,wi,yh,ft,Ye,Ss)}}function D4(n,e){const t=xy(e);for(const i in n)n.hasOwnProperty(i)&&null!=n[i]&&(t[i]=n[i]);return t}class T4{constructor(e,t,i){this.styles=e,this.defaultParams=t,this.normalizer=i}buildStyles(e,t){const i=new Map,s=xy(this.defaultParams);return Object.keys(e).forEach(u=>{const p=e[u];null!==p&&(s[u]=p)}),this.styles.styles.forEach(u=>{"string"!=typeof u&&u.forEach((p,v)=>{p&&(p=wy(p,s,t));const C=this.normalizer.normalizePropertyName(v,t);p=this.normalizer.normalizeStyleValue(v,C,p,t),i.set(v,p)})}),i}}class M4{constructor(e,t,i){this.name=e,this.ast=t,this._normalizer=i,this.transitionFactories=[],this.states=new Map,t.states.forEach(s=>{this.states.set(s.name,new T4(s.style,s.options&&s.options.params||{},i))}),yP(this.states,"true","1"),yP(this.states,"false","0"),t.transitions.forEach(s=>{this.transitionFactories.push(new _P(e,s,this.states))}),this.fallbackTransition=function A4(n,e,t){return new _P(n,{type:1,animation:{type:2,steps:[],options:null},matchers:[(p,v)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,i,s){return this.transitionFactories.find(p=>p.match(e,t,i,s))||null}matchStyles(e,t,i){return this.fallbackTransition.buildStyles(e,t,i)}}function yP(n,e,t){n.has(e)?n.has(t)||n.set(t,n.get(e)):n.has(t)&&n.set(e,n.get(t))}const I4=new Gx;class P4{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){const i=[],s=[],u=lC(this._driver,t,i,s);if(i.length)throw function P5(n){return new Le(3503,!1)}();this._animations.set(e,u)}_buildPlayer(e,t,i){const s=e.element,u=K2(0,this._normalizer,0,e.keyframes,t,i);return this._driver.animate(s,u,e.duration,e.delay,e.easing,[],!0)}create(e,t,i={}){const s=[],u=this._animations.get(e);let p;const v=new Map;if(u?(p=hC(this._driver,t,u,iC,Fx,new Map,new Map,i,I4,s),p.forEach(O=>{const U=pl(v,O.element,new Map);O.postStyleProps.forEach(Q=>U.set(Q,null))})):(s.push(function k5(){return new Le(3300,!1)}()),p=[]),s.length)throw function R5(n){return new Le(3504,!1)}();v.forEach((O,U)=>{O.forEach((Q,se)=>{O.set(se,this._driver.computeStyle(U,se,mh))})});const M=Od(p.map(O=>{const U=v.get(O.element);return this._buildPlayer(O,new Map,U)}));return this._playersById.set(e,M),M.onDestroy(()=>this.destroy(e)),this.players.push(M),M}destroy(e){const t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);const i=this.players.indexOf(t);i>=0&&this.players.splice(i,1)}_getPlayer(e){const t=this._playersById.get(e);if(!t)throw function O5(n){return new Le(3301,!1)}();return t}listen(e,t,i,s){const u=QE(t,"","","");return YE(this._getPlayer(e),i,u,s),()=>{}}command(e,t,i,s){if("register"==i)return void this.register(e,s[0]);if("create"==i)return void this.create(e,t,s[0]||{});const u=this._getPlayer(e);switch(i){case"play":u.play();break;case"pause":u.pause();break;case"reset":u.reset();break;case"restart":u.restart();break;case"finish":u.finish();break;case"init":u.init();break;case"setPosition":u.setPosition(parseFloat(s[0]));break;case"destroy":this.destroy(e)}}}const vP="ng-animate-queued",mC="ng-animate-disabled",L4=[],xP={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},N4={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Kl="__ng_removed";class gC{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;const i=e&&e.hasOwnProperty("value");if(this.value=function U4(n){return n??null}(i?e.value:e),i){const u=xy(e);delete u.value,this.options=u}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){const t=e.params;if(t){const i=this.options.params;Object.keys(t).forEach(s=>{null==i[s]&&(i[s]=t[s])})}}}const Ey="void",_C=new gC(Ey);class B4{constructor(e,t,i){this.id=e,this.hostElement=t,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Yl(t,this._hostClassName)}listen(e,t,i,s){if(!this._triggers.has(t))throw function F5(n,e){return new Le(3302,!1)}();if(null==i||0==i.length)throw function L5(n){return new Le(3303,!1)}();if(!function j4(n){return"start"==n||"done"==n}(i))throw function N5(n,e){return new Le(3400,!1)}();const u=pl(this._elementListeners,e,[]),p={name:t,phase:i,callback:s};u.push(p);const v=pl(this._engine.statesByElement,e,new Map);return v.has(t)||(Yl(e,Lx),Yl(e,Lx+"-"+t),v.set(t,_C)),()=>{this._engine.afterFlush(()=>{const C=u.indexOf(p);C>=0&&u.splice(C,1),this._triggers.has(t)||v.delete(t)})}}register(e,t){return!this._triggers.has(e)&&(this._triggers.set(e,t),!0)}_getTrigger(e){const t=this._triggers.get(e);if(!t)throw function B5(n){return new Le(3401,!1)}();return t}trigger(e,t,i,s=!0){const u=this._getTrigger(t),p=new yC(this.id,t,e);let v=this._engine.statesByElement.get(e);v||(Yl(e,Lx),Yl(e,Lx+"-"+t),this._engine.statesByElement.set(e,v=new Map));let C=v.get(t);const M=new gC(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&C&&M.absorbOptions(C.options),v.set(t,M),C||(C=_C),M.value!==Ey&&C.value===M.value){if(!function G4(n,e){const t=Object.keys(n),i=Object.keys(e);if(t.length!=i.length)return!1;for(let s=0;s<t.length;s++){const u=t[s];if(!e.hasOwnProperty(u)||n[u]!==e[u])return!1}return!0}(C.params,M.params)){const Ee=[],Be=u.matchStyles(C.value,C.params,Ee),Xe=u.matchStyles(M.value,M.params,Ee);Ee.length?this._engine.reportError(Ee):this._engine.afterFlush(()=>{jf(e,Be),xu(e,Xe)})}return}const Q=pl(this._engine.playersByElement,e,[]);Q.forEach(Ee=>{Ee.namespaceId==this.id&&Ee.triggerName==t&&Ee.queued&&Ee.destroy()});let se=u.matchTransition(C.value,M.value,e,M.params),fe=!1;if(!se){if(!s)return;se=u.fallbackTransition,fe=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:se,fromState:C,toState:M,player:p,isFallbackTransition:fe}),fe||(Yl(e,vP),p.onStart(()=>{Rm(e,vP)})),p.onDone(()=>{let Ee=this.players.indexOf(p);Ee>=0&&this.players.splice(Ee,1);const Be=this._engine.playersByElement.get(e);if(Be){let Xe=Be.indexOf(p);Xe>=0&&Be.splice(Xe,1)}}),this.players.push(p),Q.push(p),p}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,i)=>{this._elementListeners.set(i,t.filter(s=>s.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const t=this._engine.playersByElement.get(e);t&&(t.forEach(i=>i.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){const i=this._engine.driver.query(e,Nx,!0);i.forEach(s=>{if(s[Kl])return;const u=this._engine.fetchNamespacesByElement(s);u.size?u.forEach(p=>p.triggerLeaveAnimation(s,t,!1,!0)):this.clearElementCache(s)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(s=>this.clearElementCache(s)))}triggerLeaveAnimation(e,t,i,s){const u=this._engine.statesByElement.get(e),p=new Map;if(u){const v=[];if(u.forEach((C,M)=>{if(p.set(M,C.value),this._triggers.has(M)){const O=this.trigger(e,M,Ey,s);O&&v.push(O)}}),v.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,p),i&&Od(v).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const t=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(t&&i){const s=new Set;t.forEach(u=>{const p=u.name;if(s.has(p))return;s.add(p);const C=this._triggers.get(p).fallbackTransition,M=i.get(p)||_C,O=new gC(Ey),U=new yC(this.id,p,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:p,transition:C,fromState:M,toState:O,player:U,isFallbackTransition:!0})})}}removeNode(e,t){const i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let s=!1;if(i.totalAnimations){const u=i.players.length?i.playersByQueriedElement.get(e):[];if(u&&u.length)s=!0;else{let p=e;for(;p=p.parentNode;)if(i.statesByElement.get(p)){s=!0;break}}}if(this.prepareLeaveAnimationListeners(e),s)i.markElementAsRemoved(this.id,e,!1,t);else{const u=e[Kl];(!u||u===xP)&&(i.afterFlush(()=>this.clearElementCache(e)),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}insertNode(e,t){Yl(e,this._hostClassName)}drainQueuedTransitions(e){const t=[];return this._queue.forEach(i=>{const s=i.player;if(s.destroyed)return;const u=i.element,p=this._elementListeners.get(u);p&&p.forEach(v=>{if(v.name==i.triggerName){const C=QE(u,i.triggerName,i.fromState.value,i.toState.value);C._data=e,YE(i.player,v.phase,C,v.callback)}}),s.markedForDestroy?this._engine.afterFlush(()=>{s.destroy()}):t.push(i)}),this._queue=[],t.sort((i,s)=>{const u=i.transition.ast.depCount,p=s.transition.ast.depCount;return 0==u||0==p?u-p:this._engine.driver.containsElement(i.element,s.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(i=>i.element===e)||t,t}}class z4{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,i){this.bodyNode=e,this.driver=t,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(s,u)=>{}}get queuedPlayers(){const e=[];return this._namespaceList.forEach(t=>{t.players.forEach(i=>{i.queued&&e.push(i)})}),e}createNamespace(e,t){const i=new B4(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(i,t):(this.newHostElements.set(t,i),this.collectEnterElement(t)),this._namespaceLookup[e]=i}_balanceNamespaceList(e,t){const i=this._namespaceList,s=this.namespacesByHostElement;if(i.length-1>=0){let p=!1,v=this.driver.getParentElement(t);for(;v;){const C=s.get(v);if(C){const M=i.indexOf(C);i.splice(M+1,0,e),p=!0;break}v=this.driver.getParentElement(v)}p||i.unshift(e)}else i.push(e);return s.set(t,e),e}register(e,t){let i=this._namespaceLookup[e];return i||(i=this.createNamespace(e,t)),i}registerTrigger(e,t,i){let s=this._namespaceLookup[e];s&&s.register(t,i)&&this.totalAnimations++}destroy(e,t){if(!e)return;const i=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[e];const s=this._namespaceList.indexOf(i);s>=0&&this._namespaceList.splice(s,1)}),this.afterFlushAnimationsDone(()=>i.destroy(t))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const t=new Set,i=this.statesByElement.get(e);if(i)for(let s of i.values())if(s.namespaceId){const u=this._fetchNamespace(s.namespaceId);u&&t.add(u)}return t}trigger(e,t,i,s){if(Zx(t)){const u=this._fetchNamespace(e);if(u)return u.trigger(t,i,s),!0}return!1}insertNode(e,t,i,s){if(!Zx(t))return;const u=t[Kl];if(u&&u.setForRemoval){u.setForRemoval=!1,u.setForMove=!0;const p=this.collectedLeaveElements.indexOf(t);p>=0&&this.collectedLeaveElements.splice(p,1)}if(e){const p=this._fetchNamespace(e);p&&p.insertNode(t,i)}s&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Yl(e,mC)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Rm(e,mC))}removeNode(e,t,i,s){if(Zx(t)){const u=e?this._fetchNamespace(e):null;if(u?u.removeNode(t,s):this.markElementAsRemoved(e,t,!1,s),i){const p=this.namespacesByHostElement.get(t);p&&p.id!==e&&p.removeNode(t,s)}}else this._onRemovalComplete(t,s)}markElementAsRemoved(e,t,i,s,u){this.collectedLeaveElements.push(t),t[Kl]={namespaceId:e,setForRemoval:s,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:u}}listen(e,t,i,s,u){return Zx(t)?this._fetchNamespace(e).listen(t,i,s,u):()=>{}}_buildInstruction(e,t,i,s,u){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,i,s,e.fromState.options,e.toState.options,t,u)}destroyInnerAnimations(e){let t=this.driver.query(e,Nx,!0);t.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(t=this.driver.query(e,rC,!0),t.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(e){const t=this.playersByElement.get(e);t&&t.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(e){const t=this.playersByQueriedElement.get(e);t&&t.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Od(this.players).onDone(()=>e());e()})}processLeaveNode(e){const t=e[Kl];if(t&&t.setForRemoval){if(e[Kl]=xP,t.namespaceId){this.destroyInnerAnimations(e);const i=this._fetchNamespace(t.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(mC)&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,s)=>this._balanceNamespaceList(i,s)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Yl(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{t=this._flushAnimations(i,e)}finally{for(let s=0;s<i.length;s++)i[s]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],t.length?Od(t).onDone(()=>{i.forEach(s=>s())}):i.forEach(s=>s())}}reportError(e){throw function z5(n){return new Le(3402,!1)}()}_flushAnimations(e,t){const i=new Gx,s=[],u=new Map,p=[],v=new Map,C=new Map,M=new Map,O=new Set;this.disabledNodes.forEach(Ft=>{O.add(Ft);const en=this.driver.query(Ft,".ng-animate-queued",!0);for(let hn=0;hn<en.length;hn++)O.add(en[hn])});const U=this.bodyNode,Q=Array.from(this.statesByElement.keys()),se=EP(Q,this.collectedEnterElements),fe=new Map;let Ee=0;se.forEach((Ft,en)=>{const hn=iC+Ee++;fe.set(en,hn),Ft.forEach(_i=>Yl(_i,hn))});const Be=[],Xe=new Set,ft=new Set;for(let Ft=0;Ft<this.collectedLeaveElements.length;Ft++){const en=this.collectedLeaveElements[Ft],hn=en[Kl];hn&&hn.setForRemoval&&(Be.push(en),Xe.add(en),hn.hasAnimation?this.driver.query(en,".ng-star-inserted",!0).forEach(_i=>Xe.add(_i)):ft.add(en))}const Ye=new Map,Tt=EP(Q,Array.from(Xe));Tt.forEach((Ft,en)=>{const hn=Fx+Ee++;Ye.set(en,hn),Ft.forEach(_i=>Yl(_i,hn))}),e.push(()=>{se.forEach((Ft,en)=>{const hn=fe.get(en);Ft.forEach(_i=>Rm(_i,hn))}),Tt.forEach((Ft,en)=>{const hn=Ye.get(en);Ft.forEach(_i=>Rm(_i,hn))}),Be.forEach(Ft=>{this.processLeaveNode(Ft)})});const Kn=[],wi=[];for(let Ft=this._namespaceList.length-1;Ft>=0;Ft--)this._namespaceList[Ft].drainQueuedTransitions(t).forEach(hn=>{const _i=hn.player,Zo=hn.element;if(Kn.push(_i),this.collectedEnterElements.length){const Ms=Zo[Kl];if(Ms&&Ms.setForMove){if(Ms.previousTriggersValues&&Ms.previousTriggersValues.has(hn.triggerName)){const Gf=Ms.previousTriggersValues.get(hn.triggerName),Jl=this.statesByElement.get(hn.element);if(Jl&&Jl.has(hn.triggerName)){const Jx=Jl.get(hn.triggerName);Jx.value=Gf,Jl.set(hn.triggerName,Jx)}}return void _i.destroy()}}const bu=!U||!this.driver.containsElement(U,Zo),gl=Ye.get(Zo),Nd=fe.get(Zo),wr=this._buildInstruction(hn,i,Nd,gl,bu);if(wr.errors&&wr.errors.length)return void wi.push(wr);if(bu)return _i.onStart(()=>jf(Zo,wr.fromStyles)),_i.onDestroy(()=>xu(Zo,wr.toStyles)),void s.push(_i);if(hn.isFallbackTransition)return _i.onStart(()=>jf(Zo,wr.fromStyles)),_i.onDestroy(()=>xu(Zo,wr.toStyles)),void s.push(_i);const VP=[];wr.timelines.forEach(Ms=>{Ms.stretchStartingKeyframe=!0,this.disabledNodes.has(Ms.element)||VP.push(Ms)}),wr.timelines=VP,i.append(Zo,wr.timelines),p.push({instruction:wr,player:_i,element:Zo}),wr.queriedElements.forEach(Ms=>pl(v,Ms,[]).push(_i)),wr.preStyleProps.forEach((Ms,Gf)=>{if(Ms.size){let Jl=C.get(Gf);Jl||C.set(Gf,Jl=new Set),Ms.forEach((Jx,wC)=>Jl.add(wC))}}),wr.postStyleProps.forEach((Ms,Gf)=>{let Jl=M.get(Gf);Jl||M.set(Gf,Jl=new Set),Ms.forEach((Jx,wC)=>Jl.add(wC))})});if(wi.length){const Ft=[];wi.forEach(en=>{Ft.push(function V5(n,e){return new Le(3505,!1)}())}),Kn.forEach(en=>en.destroy()),this.reportError(Ft)}const Ss=new Map,yh=new Map;p.forEach(Ft=>{const en=Ft.element;i.has(en)&&(yh.set(en,en),this._beforeAnimationBuild(Ft.player.namespaceId,Ft.instruction,Ss))}),s.forEach(Ft=>{const en=Ft.element;this._getPreviousPlayers(en,!1,Ft.namespaceId,Ft.triggerName,null).forEach(_i=>{pl(Ss,en,[]).push(_i),_i.destroy()})});const vh=Be.filter(Ft=>DP(Ft,C,M)),xh=new Map;wP(xh,this.driver,ft,M,mh).forEach(Ft=>{DP(Ft,C,M)&&vh.push(Ft)});const Dy=new Map;se.forEach((Ft,en)=>{wP(Dy,this.driver,new Set(Ft),C,jE)}),vh.forEach(Ft=>{const en=xh.get(Ft),hn=Dy.get(Ft);xh.set(Ft,new Map([...Array.from(en?.entries()??[]),...Array.from(hn?.entries()??[])]))});const Hf=[],BP=[],zP={};p.forEach(Ft=>{const{element:en,player:hn,instruction:_i}=Ft;if(i.has(en)){if(O.has(en))return hn.onDestroy(()=>xu(en,_i.toStyles)),hn.disabled=!0,hn.overrideTotalTime(_i.totalTime),void s.push(hn);let Zo=zP;if(yh.size>1){let gl=en;const Nd=[];for(;gl=gl.parentNode;){const wr=yh.get(gl);if(wr){Zo=wr;break}Nd.push(gl)}Nd.forEach(wr=>yh.set(wr,Zo))}const bu=this._buildAnimation(hn.namespaceId,_i,Ss,u,Dy,xh);if(hn.setRealPlayer(bu),Zo===zP)Hf.push(hn);else{const gl=this.playersByElement.get(Zo);gl&&gl.length&&(hn.parentPlayer=Od(gl)),s.push(hn)}}else jf(en,_i.fromStyles),hn.onDestroy(()=>xu(en,_i.toStyles)),BP.push(hn),O.has(en)&&s.push(hn)}),BP.forEach(Ft=>{const en=u.get(Ft.element);if(en&&en.length){const hn=Od(en);Ft.setRealPlayer(hn)}}),s.forEach(Ft=>{Ft.parentPlayer?Ft.syncPlayerEvents(Ft.parentPlayer):Ft.destroy()});for(let Ft=0;Ft<Be.length;Ft++){const en=Be[Ft],hn=en[Kl];if(Rm(en,Fx),hn&&hn.hasAnimation)continue;let _i=[];if(v.size){let bu=v.get(en);bu&&bu.length&&_i.push(...bu);let gl=this.driver.query(en,rC,!0);for(let Nd=0;Nd<gl.length;Nd++){let wr=v.get(gl[Nd]);wr&&wr.length&&_i.push(...wr)}}const Zo=_i.filter(bu=>!bu.destroyed);Zo.length?$4(this,en,Zo):this.processLeaveNode(en)}return Be.length=0,Hf.forEach(Ft=>{this.players.push(Ft),Ft.onDone(()=>{Ft.destroy();const en=this.players.indexOf(Ft);this.players.splice(en,1)}),Ft.play()}),Hf}elementContainsData(e,t){let i=!1;const s=t[Kl];return s&&s.setForRemoval&&(i=!0),this.playersByElement.has(t)&&(i=!0),this.playersByQueriedElement.has(t)&&(i=!0),this.statesByElement.has(t)&&(i=!0),this._fetchNamespace(e).elementContainsData(t)||i}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,i,s,u){let p=[];if(t){const v=this.playersByQueriedElement.get(e);v&&(p=v)}else{const v=this.playersByElement.get(e);if(v){const C=!u||u==Ey;v.forEach(M=>{M.queued||!C&&M.triggerName!=s||p.push(M)})}}return(i||s)&&(p=p.filter(v=>!(i&&i!=v.namespaceId||s&&s!=v.triggerName))),p}_beforeAnimationBuild(e,t,i){const u=t.element,p=t.isRemovalTransition?void 0:e,v=t.isRemovalTransition?void 0:t.triggerName;for(const C of t.timelines){const M=C.element,O=M!==u,U=pl(i,M,[]);this._getPreviousPlayers(M,O,p,v,t.toState).forEach(se=>{const fe=se.getRealPlayer();fe.beforeDestroy&&fe.beforeDestroy(),se.destroy(),U.push(se)})}jf(u,t.fromStyles)}_buildAnimation(e,t,i,s,u,p){const v=t.triggerName,C=t.element,M=[],O=new Set,U=new Set,Q=t.timelines.map(fe=>{const Ee=fe.element;O.add(Ee);const Be=Ee[Kl];if(Be&&Be.removedBeforeQueried)return new _y(fe.duration,fe.delay);const Xe=Ee!==C,ft=function H4(n){const e=[];return CP(n,e),e}((i.get(Ee)||L4).map(Ss=>Ss.getRealPlayer())).filter(Ss=>!!Ss.element&&Ss.element===Ee),Ye=u.get(Ee),Tt=p.get(Ee),Kn=K2(0,this._normalizer,0,fe.keyframes,Ye,Tt),wi=this._buildPlayer(fe,Kn,ft);if(fe.subTimeline&&s&&U.add(Ee),Xe){const Ss=new yC(e,v,Ee);Ss.setRealPlayer(wi),M.push(Ss)}return wi});M.forEach(fe=>{pl(this.playersByQueriedElement,fe.element,[]).push(fe),fe.onDone(()=>function V4(n,e,t){let i=n.get(e);if(i){if(i.length){const s=i.indexOf(t);i.splice(s,1)}0==i.length&&n.delete(e)}return i}(this.playersByQueriedElement,fe.element,fe))}),O.forEach(fe=>Yl(fe,oP));const se=Od(Q);return se.onDestroy(()=>{O.forEach(fe=>Rm(fe,oP)),xu(C,t.toStyles)}),U.forEach(fe=>{pl(s,fe,[]).push(se)}),se}_buildPlayer(e,t,i){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,i):new _y(e.duration,e.delay)}}class yC{constructor(e,t,i){this.namespaceId=e,this.triggerName=t,this.element=i,this._player=new _y,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,i)=>{t.forEach(s=>YE(e,i,void 0,s))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){pl(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const t=this._player;t.triggerCallback&&t.triggerCallback(e)}}function Zx(n){return n&&1===n.nodeType}function bP(n,e){const t=n.style.display;return n.style.display=e??"none",t}function wP(n,e,t,i,s){const u=[];t.forEach(C=>u.push(bP(C)));const p=[];i.forEach((C,M)=>{const O=new Map;C.forEach(U=>{const Q=e.computeStyle(M,U,s);O.set(U,Q),(!Q||0==Q.length)&&(M[Kl]=N4,p.push(M))}),n.set(M,O)});let v=0;return t.forEach(C=>bP(C,u[v++])),p}function EP(n,e){const t=new Map;if(n.forEach(v=>t.set(v,[])),0==e.length)return t;const i=1,s=new Set(e),u=new Map;function p(v){if(!v)return i;let C=u.get(v);if(C)return C;const M=v.parentNode;return C=t.has(M)?M:s.has(M)?i:p(M),u.set(v,C),C}return e.forEach(v=>{const C=p(v);C!==i&&t.get(C).push(v)}),t}function Yl(n,e){n.classList?.add(e)}function Rm(n,e){n.classList?.remove(e)}function $4(n,e,t){Od(t).onDone(()=>n.processLeaveNode(e))}function CP(n,e){for(let t=0;t<n.length;t++){const i=n[t];i instanceof D2?CP(i.players,e):e.push(i)}}function DP(n,e,t){const i=t.get(n);if(!i)return!1;let s=e.get(n);return s?i.forEach(u=>s.add(u)):e.set(n,i),t.delete(n),!0}class Xx{constructor(e,t,i){this.bodyNode=e,this._driver=t,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(s,u)=>{},this._transitionEngine=new z4(e,t,i),this._timelineEngine=new P4(e,t,i),this._transitionEngine.onRemovalComplete=(s,u)=>this.onRemovalComplete(s,u)}registerTrigger(e,t,i,s,u){const p=e+"-"+s;let v=this._triggerCache[p];if(!v){const C=[],M=[],O=lC(this._driver,u,C,M);if(C.length)throw function A5(n,e){return new Le(3404,!1)}();v=function S4(n,e,t){return new M4(n,e,t)}(s,O,this._normalizer),this._triggerCache[p]=v}this._transitionEngine.registerTrigger(t,s,v)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,i,s){this._transitionEngine.insertNode(e,t,i,s)}onRemove(e,t,i,s){this._transitionEngine.removeNode(e,t,s||!1,i)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,i,s){if("@"==i.charAt(0)){const[u,p]=Y2(i);this._timelineEngine.command(u,t,p,s)}else this._transitionEngine.trigger(e,t,i,s)}listen(e,t,i,s,u){if("@"==i.charAt(0)){const[p,v]=Y2(i);return this._timelineEngine.listen(p,t,v,u)}return this._transitionEngine.listen(e,t,i,s,u)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let W4=(()=>{class n{constructor(t,i,s){this._element=t,this._startStyles=i,this._endStyles=s,this._state=0;let u=n.initialStylesByElement.get(t);u||n.initialStylesByElement.set(t,u=new Map),this._initialStyles=u}start(){this._state<1&&(this._startStyles&&xu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(xu(this._element,this._initialStyles),this._endStyles&&(xu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(n.initialStylesByElement.delete(this._element),this._startStyles&&(jf(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(jf(this._element,this._endStyles),this._endStyles=null),xu(this._element,this._initialStyles),this._state=3)}}return n.initialStylesByElement=new WeakMap,n})();function vC(n){let e=null;return n.forEach((t,i)=>{(function Z4(n){return"display"===n||"position"===n})(i)&&(e=e||new Map,e.set(i,t))}),e}class TP{constructor(e,t,i,s){this.element=e,this.keyframes=t,this.options=i,this._specialStyles=s,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){const t=[];return e.forEach(i=>{t.push(Object.fromEntries(i))}),t}_triggerWebAnimation(e,t,i){return e.animate(this._convertKeyframesToObject(t),i)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,s)=>{"offset"!==s&&e.set(s,this._finished?i:hP(this.element,s))}),this.currentSnapshot=e}triggerCallback(e){const t="start"===e?this._onStartFns:this._onDoneFns;t.forEach(i=>i()),t.length=0}}class X4{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}matchesElement(e,t){return!1}containsElement(e,t){return tP(e,t)}getParentElement(e){return tC(e)}query(e,t,i){return nP(e,t,i)}computeStyle(e,t,i){return window.getComputedStyle(e)[t]}animate(e,t,i,s,u,p=[]){const C={duration:i,delay:s,fill:0==s?"both":"forwards"};u&&(C.easing=u);const M=new Map,O=p.filter(se=>se instanceof TP);(function Q5(n,e){return 0===n||0===e})(i,s)&&O.forEach(se=>{se.currentSnapshot.forEach((fe,Ee)=>M.set(Ee,fe))});let U=function X5(n){return n.length?n[0]instanceof Map?n:n.map(e=>sP(e)):[]}(t).map(se=>Fd(se));U=function e4(n,e,t){if(t.size&&e.length){let i=e[0],s=[];if(t.forEach((u,p)=>{i.has(p)||s.push(p),i.set(p,u)}),s.length)for(let u=1;u<e.length;u++){let p=e[u];s.forEach(v=>p.set(v,hP(n,v)))}}return e}(e,U,M);const Q=function q4(n,e){let t=null,i=null;return Array.isArray(e)&&e.length?(t=vC(e[0]),e.length>1&&(i=vC(e[e.length-1]))):e instanceof Map&&(t=vC(e)),t||i?new W4(n,t,i):null}(e,U);return new TP(e,U,C,Q)}}let K4=(()=>{class n extends g2{constructor(t,i){super(),this._nextAnimationId=0,this._renderer=t.createRenderer(i.body,{id:"0",encapsulation:So.None,styles:[],data:{animation:[]}})}build(t){const i=this._nextAnimationId.toString();this._nextAnimationId++;const s=Array.isArray(t)?v2(t):t;return SP(this._renderer,null,i,"register",[s]),new Y4(i,this._renderer)}}return n.\u0275fac=function(t){return new(t||n)(ze(mf),ze(ei))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();class Y4 extends gj{constructor(e,t){super(),this._id=e,this._renderer=t}create(e,t){return new J4(this._id,e,t||{},this._renderer)}}class J4{constructor(e,t,i,s){this.id=e,this.element=t,this._renderer=s,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(e,t){return this._renderer.listen(this.element,`@@${this.id}:${e}`,t)}_command(e,...t){return SP(this._renderer,this.element,this.id,e,t)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function SP(n,e,t,i,s){return n.setProperty(e,`@@${t}:${i}`,s)}const MP="@.disabled";let Q4=(()=>{class n{constructor(t,i,s){this.delegate=t,this.engine=i,this._zone=s,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(u,p)=>{const v=p?.parentNode(u);v&&p.removeChild(v,u)}}createRenderer(t,i){const u=this.delegate.createRenderer(t,i);if(!(t&&i&&i.data&&i.data.animation)){let O=this._rendererCache.get(u);return O||(O=new AP("",u,this.engine,()=>this._rendererCache.delete(u)),this._rendererCache.set(u,O)),O}const p=i.id,v=i.id+"-"+this._currentId;this._currentId++,this.engine.register(v,t);const C=O=>{Array.isArray(O)?O.forEach(C):this.engine.registerTrigger(p,v,t,O.name,O)};return i.data.animation.forEach(C),new e$(this,v,u,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(t,i,s){t>=0&&t<this._microtaskId?this._zone.run(()=>i(s)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(u=>{const[p,v]=u;p(v)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,s]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return n.\u0275fac=function(t){return new(t||n)(ze(mf),ze(Xx),ze(On))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();class AP{constructor(e,t,i,s){this.namespaceId=e,this.delegate=t,this.engine=i,this._onDestroy=s,this.destroyNode=this.delegate.destroyNode?u=>t.destroyNode(u):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,i,s=!0){this.delegate.insertBefore(e,t,i),this.engine.onInsert(this.namespaceId,t,e,s)}removeChild(e,t,i){this.engine.onRemove(this.namespaceId,t,this.delegate,i)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,i,s){this.delegate.setAttribute(e,t,i,s)}removeAttribute(e,t,i){this.delegate.removeAttribute(e,t,i)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,i,s){this.delegate.setStyle(e,t,i,s)}removeStyle(e,t,i){this.delegate.removeStyle(e,t,i)}setProperty(e,t,i){"@"==t.charAt(0)&&t==MP?this.disableAnimations(e,!!i):this.delegate.setProperty(e,t,i)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,i){return this.delegate.listen(e,t,i)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}}class e$ extends AP{constructor(e,t,i,s,u){super(t,i,s,u),this.factory=e,this.namespaceId=t}setProperty(e,t,i){"@"==t.charAt(0)?"."==t.charAt(1)&&t==MP?this.disableAnimations(e,i=void 0===i||!!i):this.engine.process(this.namespaceId,e,t.slice(1),i):this.delegate.setProperty(e,t,i)}listen(e,t,i){if("@"==t.charAt(0)){const s=function t$(n){switch(n){case"body":return document.body;case"document":return document;case"window":return window;default:return n}}(e);let u=t.slice(1),p="";return"@"!=u.charAt(0)&&([u,p]=function n$(n){const e=n.indexOf(".");return[n.substring(0,e),n.slice(e+1)]}(u)),this.engine.listen(this.namespaceId,s,u,p,v=>{this.factory.scheduleListenerCallback(v._data||-1,i,v)})}return this.delegate.listen(e,t,i)}}const IP=[{provide:g2,useClass:K4},{provide:fC,useFactory:function r$(){return new E4}},{provide:Xx,useClass:(()=>{class n extends Xx{constructor(t,i,s,u){super(t.body,i,s)}ngOnDestroy(){this.flush()}}return n.\u0275fac=function(t){return new(t||n)(ze(ei),ze(nC),ze(fC),ze(Pf))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})()},{provide:mf,useFactory:function o$(n,e,t){return new Q4(n,e,t)},deps:[L0,Xx,On]}],xC=[{provide:nC,useFactory:()=>new X4},{provide:O_,useValue:"BrowserAnimations"},...IP],PP=[{provide:nC,useClass:iP},{provide:O_,useValue:"NoopAnimations"},...IP];let s$=(()=>{class n{static withConfig(t){return{ngModule:n,providers:t.disableAnimations?PP:xC}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:xC,imports:[tM]}),n})();const Ld=new Lt(er),l$={connector:()=>new mn};function kP(n,e=l$){const{connector:t}=e;return ni((i,s)=>{const u=t();It(n(function a$(n){return new Lt(e=>n.subscribe(e))}(u))).subscribe(s),s.add(i.subscribe(u))})}function RP(n,e){return e?t=>cm(e.pipe(mo(1),function h$(){return ni((n,e)=>{n.subscribe(Ln(e,er))})}()),t.pipe(RP(n))):pi((t,i)=>n(t,i).pipe(mo(1),hM(t)))}const Cy="Service workers are disabled or not supported by this browser";class Yx{constructor(e){if(this.serviceWorker=e,e){const i=Dm(e,"controllerchange").pipe(gt(()=>e.controller)),u=cm(um(()=>Ut(e.controller)),i);this.worker=u.pipe(Br(O=>!!O)),this.registration=this.worker.pipe(Sa(()=>e.getRegistration()));const M=Dm(e,"message").pipe(gt(O=>O.data)).pipe(Br(O=>O&&O.type)).pipe(function u$(n){return n?e=>kP(n)(e):e=>function c$(n,e){const t=pn(n)?n:()=>n;return pn(e)?kP(e,{connector:t}):i=>new D1(i,t)}(new mn)(e)}());M.connect(),this.events=M}else this.worker=this.events=this.registration=function f$(n){return um(()=>hm(new Error(n)))}(Cy)}postMessage(e,t){return this.worker.pipe(mo(1),us(i=>{i.postMessage({action:e,...t})})).toPromise().then(()=>{})}postMessageWithOperation(e,t,i){const s=this.waitForOperationCompleted(i),u=this.postMessage(e,t);return Promise.all([u,s]).then(([,p])=>p)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(e){let t;return t="string"==typeof e?i=>i.type===e:i=>e.includes(i.type),this.events.pipe(Br(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(mo(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(Br(t=>t.nonce===e),mo(1),gt(t=>{if(void 0!==t.result)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let p$=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,this.pushManager=null,this.subscriptionChanges=new mn,!t.isEnabled)return this.messages=Ld,this.notificationClicks=Ld,void(this.subscription=Ld);this.messages=this.sw.eventsOfType("PUSH").pipe(gt(s=>s.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(gt(s=>s.data)),this.pushManager=this.sw.registration.pipe(gt(s=>s.pushManager));const i=this.pushManager.pipe(Sa(s=>s.getSubscription()));this.subscription=io(i,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(Cy));const i={userVisibleOnly:!0};let s=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),u=new Uint8Array(new ArrayBuffer(s.length));for(let p=0;p<s.length;p++)u[p]=s.charCodeAt(p);return i.applicationServerKey=u,this.pushManager.pipe(Sa(p=>p.subscribe(i)),mo(1)).toPromise().then(p=>(this.subscriptionChanges.next(p),p))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(mo(1),Sa(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(s=>{if(!s)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Cy))}decodeBase64(t){return atob(t)}}return n.\u0275fac=function(t){return new(t||n)(ze(Yx))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})(),m$=(()=>{class n{get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled)return this.versionUpdates=Ld,this.available=Ld,this.activated=Ld,void(this.unrecoverable=Ld);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(Br(i=>"VERSION_READY"===i.type),gt(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Cy));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(Cy));const t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}}return n.\u0275fac=function(t){return new(t||n)(ze(Yx))},n.\u0275prov=pt({token:n,factory:n.\u0275fac}),n})();class bC{}const OP=new xt("NGSW_REGISTER_SCRIPT");function g$(n,e,t,i){return()=>{if(!d1(i)||!("serviceWorker"in navigator)||!1===t.enabled)return;let s;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof t.registrationStrategy)s=t.registrationStrategy();else{const[p,...v]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(p){case"registerImmediately":s=Ut(null);break;case"registerWithDelay":s=FP(+v[0]||0);break;case"registerWhenStable":s=v[0]?io(LP(n),FP(+v[0])):LP(n);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}n.get(On).runOutsideAngular(()=>s.pipe(mo(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(p=>console.error("Service worker registration failed with:",p))))}}function FP(n){return Ut(null).pipe(function d$(n,e=bx){const t=DI(n,e);return RP(()=>t)}(n))}function LP(n){return n.get(Pf).isStable.pipe(Br(t=>t))}function _$(n,e){return new Yx(d1(e)&&!1!==n.enabled?navigator.serviceWorker:void 0)}let y$=(()=>{class n{static register(t,i={}){return{ngModule:n,providers:[{provide:OP,useValue:t},{provide:bC,useValue:i},{provide:Yx,useFactory:_$,deps:[bC,am]},{provide:k_,useFactory:g$,deps:[Or,OP,bC,am],multi:!0}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n}),n.\u0275inj=mi({providers:[p$,m$]}),n})(),v$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=li({type:n,bootstrap:[a5]}),n.\u0275inj=mi({imports:[tM,s5,s$,Qj,Aj,b3,y$.register("ngsw-worker.js",{enabled:true,registrationStrategy:"registerWhenStable:30000"})]}),n})();IN().bootstrapModule(v$).catch(n=>console.error(n))},898:function(Bd){Bd.exports=function(){"use strict";var Ma,qt,pn;function Oc(f,Ke){if(Ma)if(qt){var je="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ma+")(sharedChunk); ("+qt+")(sharedChunk); self.onerror = null;",Xo={};Ma(Xo),pn=Ke(Xo),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(pn.workerUrl=window.URL.createObjectURL(new Blob([je],{type:"text/javascript"})))}else qt=Ke;else Ma=Ke}return Oc(0,function(f){var Ke=typeof self<"u"?self:{},je="2.15.0";let Xo;const $t={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==Xo){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{Xo=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{Xo=o}}return Xo},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!$t.API_URL)return null;try{const o=new URL($t.API_URL);return"api.mapbox.cn"===o.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===o.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Wt={supported:!1,testSupport:function(o){!er&&si&&(ds?Ql(o):zi=o)}};let zi,si,er=!1,ds=!1;function Ql(o){const r=o.createTexture();o.bindTexture(o.TEXTURE_2D,r);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,si),o.isContextLost())return;Wt.supported=!0}catch{}o.deleteTexture(r),er=!0}Ke.document&&(si=Ke.document.createElement("img"),si.onload=function(){zi&&Ql(zi),zi=null,ds=!0},si.onerror=function(){er=!0,zi=null},si.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _l="01";function Er(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Qr=ur;function ur(o,r,a,c){this.cx=3*o,this.bx=3*(a-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*r,this.by=3*(c-r)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=r,this.p2x=a,this.p2y=c}ur.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,r){if(void 0===r&&(r=1e-6),o<0)return 0;if(o>1)return 1;for(var a=o,c=0;c<8;c++){var d=this.sampleCurveX(a)-o;if(Math.abs(d)<r)return a;var g=this.sampleCurveDerivativeX(a);if(Math.abs(g)<1e-6)break;a-=d/g}var y=0,b=1;for(a=o,c=0;c<20&&(d=this.sampleCurveX(a),!(Math.abs(d-o)<r));c++)o>d?y=a:b=a,a=.5*(b-y)+y;return a},solve:function(o,r){return this.sampleCurveY(this.solveCurveX(o,r))}};var As=Er(Qr),ki=zr;function zr(o,r){this.x=o,this.y=r}zr.prototype={clone:function(){return new zr(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,r){return this.clone()._rotateAround(o,r)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var r=o.x-this.x,a=o.y-this.y;return r*r+a*a},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,r){return Math.atan2(this.x*r-this.y*o,this.x*o+this.y*r)},_matMult:function(o){var r=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=r,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var r=Math.cos(o),a=Math.sin(o),c=a*this.x+r*this.y;return this.x=r*this.x-a*this.y,this.y=c,this},_rotateAround:function(o,r){var a=Math.cos(o),c=Math.sin(o),d=r.y+c*(this.x-r.x)+a*(this.y-r.y);return this.x=r.x+a*(this.x-r.x)-c*(this.y-r.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},zr.convert=function(o){return o instanceof zr?o:Array.isArray(o)?new zr(o[0],o[1]):o};var ct=Er(ki);const ti=Math.PI/180,Ko=180/Math.PI;function cn(o){return o*ti}function tr(o){return o*Ko}const ra=[[0,0],[1,0],[1,1],[0,1]];function ec(o){if(o<=0)return 0;if(o>=1)return 1;const r=o*o,a=r*o;return 4*(o<.5?a:3*(o-r)+a-.75)}function Is(o,r,a,c){const d=new As(o,r,a,c);return function(g){return d.solve(g)}}const eo=Is(.25,.1,.25,1);function zt(o,r,a){return Math.min(a,Math.max(r,o))}function yo(o,r,a){return(a=zt((a-o)/(r-o),0,1))*a*(3-2*a)}function Lt(o,r,a){const c=a-r,d=((o-r)%c+c)%c+r;return d===r?a:d}function nr(o,r,a){if(!o.length)return a(null,[]);let c=o.length;const d=new Array(o.length);let g=null;o.forEach((y,b)=>{r(y,(E,D)=>{E&&(g=E),d[b]=D,0==--c&&a(g,d)})})}function vo(o){const r=[];for(const a in o)r.push(o[a]);return r}function Ei(o,...r){for(const a of r)for(const c in a)o[c]=a[c];return o}let Ps=1;function mn(){return Ps++}function Yo(){return function o(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function fs(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function ni(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function Ln(o,r){o.forEach(a=>{r[a]&&(r[a]=r[a].bind(r))})}function ks(o,r){return-1!==o.indexOf(r,o.length-r.length)}function gt(o,r,a){const c={};for(const d in o)c[d]=r.call(a||this,o[d],d,o);return c}function Zi(o,r,a){const c={};for(const d in o)r.call(a||this,o[d],d,o)&&(c[d]=o[d]);return c}function Vi(o){return Array.isArray(o)?o.map(Vi):"object"==typeof o&&o?gt(o,Vi):o}const Aa={};function Tn(o){Aa[o]||(typeof console<"u"&&console.warn(o),Aa[o]=!0)}function to(o,r,a){return(a.y-o.y)*(r.x-o.x)>(r.y-o.y)*(a.x-o.x)}function tc(o){let r=0;for(let a,c,d=0,g=o.length,y=g-1;d<g;y=d++)a=o[d],c=o[y],r+=(c.x-a.x)*(a.y+c.y);return r}function Rs(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function an(o){const r={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(a,c,d,g)=>{const y=d||g;return r[c]=!y||y.toLowerCase(),""}),r["max-age"]){const a=parseInt(r["max-age"],10);isNaN(a)?delete r["max-age"]:r["max-age"]=a}return r}let xo=null;function zo(o){if(null==xo){const r=o.navigator?o.navigator.userAgent:null;xo=!!o.safari||!(!r||!(/\b(iPad|iPhone|iPod)\b/.test(r)||r.match("Safari")&&!r.match("Chrome")))}return xo}function Jo(o){try{const r=Ke[o];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ci(o,r){return[o[4*r],o[4*r+1],o[4*r+2],o[4*r+3]]}const Ui="mapbox-tiles";let yi,Os,Ia=500,Pa=50;function yl(){try{return Ke.caches}catch{}}function oa(){yl()&&!yi&&(yi=Ke.caches.open(Ui))}function sa(o){const r=o.indexOf("?");if(r<0)return o;const c=function(d){const g=d.indexOf("?");return g>0?d.slice(g+1).split("&"):[]}(o).filter(d=>{const g=d.split("=");return"language"===g[0]||"worldview"===g[0]});return c.length?`${o.slice(0,r)}?${c.join("&")}`:o.slice(0,r)}let Vo=1/0;const Fs={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Fs);class aa extends Error{constructor(r,a,c){401===a&&Te(c)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=a,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const la=Rs()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Ke.location.protocol?Ke.parent:Ke).location.href,bo=function(o,r){if(!(/^file:/.test(a=o.url)||/^file:/.test(la())&&!/^\w+:/.test(a))){if(Ke.fetch&&Ke.Request&&Ke.AbortController&&Ke.Request.prototype.hasOwnProperty("signal"))return function(c,d){const g=new Ke.AbortController,y=new Ke.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:la(),referrerPolicy:c.referrerPolicy,signal:g.signal});let b=!1,E=!1;const D=(I=y.url).indexOf("sku=")>0&&Te(I);var I;"json"===c.type&&y.headers.set("Accept","application/json");const k=(z,V,H)=>{if(E)return;if(z&&"SecurityError"!==z.message&&Tn(z.toString()),V&&H)return L(V);const K=Date.now();Ke.fetch(y).then(ie=>{if(ie.ok){const ue=D?ie.clone():null;return L(ie,ue,K)}return d(new aa(ie.statusText,ie.status,c.url))}).catch(ie=>{"AbortError"!==ie.name&&d(new Error(`${ie.message} ${c.url}`))})},L=(z,V,H)=>{("arrayBuffer"===c.type?z.arrayBuffer():"json"===c.type?z.json():z.text()).then(K=>{E||(V&&H&&function(ie,ue,ne){if(oa(),!yi)return;const ce={status:ue.status,statusText:ue.statusText,headers:new Ke.Headers};ue.headers.forEach((Ae,Me)=>ce.headers.set(Me,Ae));const me=an(ue.headers.get("Cache-Control")||"");if(me["no-store"])return;me["max-age"]&&ce.headers.set("Expires",new Date(ne+1e3*me["max-age"]).toUTCString());const pe=ce.headers.get("Expires");pe&&(new Date(pe).getTime()-ne<42e4||function(Ae,Me){if(void 0===Os)try{new Response(new ReadableStream),Os=!0}catch{Os=!1}Os?Me(Ae.body):Ae.blob().then(Me)}(ue,Ae=>{const Me=new Ke.Response(Ae,ce);oa(),yi&&yi.then(Ve=>Ve.put(sa(ie.url),Me)).catch(Ve=>Tn(Ve.message))}))}(y,V,H),b=!0,d(null,K,z.headers.get("Cache-Control"),z.headers.get("Expires")))}).catch(K=>{E||d(new Error(K.message))})};return D?function(z,V){if(oa(),!yi)return V(null);const H=sa(z.url);yi.then(K=>{K.match(H).then(ie=>{const ue=function(ne){if(!ne)return!1;const ce=new Date(ne.headers.get("Expires")||0),me=an(ne.headers.get("Cache-Control")||"");return ce>Date.now()&&!me["no-cache"]}(ie);K.delete(H),ue&&K.put(H,ie.clone()),V(null,ie,ue)}).catch(V)}).catch(V)}(y,k):k(null,null),{cancel:()=>{E=!0,b||g.abort()}}}(o,r);if(Rs()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,r,void 0,!0)}var a;return function(c,d){const g=new Ke.XMLHttpRequest;g.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(g.responseType="arraybuffer");for(const y in c.headers)g.setRequestHeader(y,c.headers[y]);return"json"===c.type&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials="include"===c.credentials,g.onerror=()=>{d(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||0===g.status)&&null!==g.response){let y=g.response;if("json"===c.type)try{y=JSON.parse(g.response)}catch(b){return d(b)}d(null,y,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else d(new aa(g.statusText,g.status,c.url))},g.send(c.body),{cancel:()=>g.abort()}}(o,r)},vl=function(o,r){return bo(Ei(o,{type:"arrayBuffer"}),r)};function Fc(o){const r=Ke.document.createElement("a");return r.href=o,r.protocol===Ke.document.location.protocol&&r.host===Ke.document.location.host}const he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let q,W;q=[],W=0;const le=function(o,r){if(Wt.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),W>=$t.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:o,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return q.push(g),g}W++;let a=!1;const c=()=>{if(!a)for(a=!0,W--;q.length&&W<$t.MAX_PARALLEL_IMAGE_REQUESTS;){const g=q.shift(),{requestParameters:y,callback:b,cancelled:E}=g;E||(g.cancel=le(y,b).cancel)}},d=vl(o,(g,y,b,E)=>{c(),g?r(g):y&&(Ke.createImageBitmap?function(D,I){const k=new Ke.Blob([new Uint8Array(D)],{type:"image/png"});Ke.createImageBitmap(k).then(L=>{I(null,L)}).catch(L=>{I(new Error(`Could not load image because of ${L.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(D,I)=>r(D,I,b,E)):function(D,I){const k=new Ke.Image,L=Ke.URL;k.onload=()=>{I(null,k),L.revokeObjectURL(k.src),k.onload=null,Ke.requestAnimationFrame(()=>{k.src=he})},k.onerror=()=>I(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const z=new Ke.Blob([new Uint8Array(D)],{type:"image/png"});k.src=D.byteLength?L.createObjectURL(z):he}(y,(D,I)=>r(D,I,b,E)))});return{cancel:()=>{d.cancel(),c()}}},ge="NO_ACCESS_TOKEN";function xe(o){return 0===o.indexOf("mapbox:")}function Te(o){return $t.API_URL_REGEX.test(o)}function Se(o){return $t.API_CDN_URL_REGEX.test(o)}function be(o){return $t.API_STYLE_REGEX.test(o)&&!Oe(o)}function Oe(o){return $t.API_SPRITE_REGEX.test(o)}const st=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ut(o){const r=o.match(st);if(!r)throw new Error("Unable to parse URL object");return{protocol:r[1],authority:r[2],path:r[3]||"/",params:r[4]?r[4].split("&"):[]}}function ot(o){const r=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${r}`}const Ht="mapbox.eventData";function nn(o){if(!o)return null;const r=o.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(Ke.atob(r[1]).split("").map(a=>"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class It{constructor(r){this.type=r,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(r){const a=nn($t.ACCESS_TOKEN);let c="";return c=a&&a.u?Ke.btoa(encodeURIComponent(a.u).replace(/%([0-9A-F]{2})/g,(d,g)=>String.fromCharCode(Number("0x"+g)))):$t.ACCESS_TOKEN||"",r?`${Ht}.${r}:${c}`:`${Ht}:${c}`}fetchEventData(){const r=Jo("localStorage"),a=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{const d=Ke.localStorage.getItem(a);d&&(this.eventData=JSON.parse(d));const g=Ke.localStorage.getItem(c);g&&(this.anonId=g)}catch{Tn("Unable to read from LocalStorage")}}saveEventData(){const r=Jo("localStorage"),a=this.getStorageKey(),c=this.getStorageKey("uuid");if(r)try{Ke.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&Ke.localStorage.setItem(a,JSON.stringify(this.eventData))}catch{Tn("Unable to write to LocalStorage")}}processRequests(r){}postEvent(r,a,c,d){if(!$t.EVENTS_URL)return;const g=ut($t.EVENTS_URL);g.params.push(`access_token=${d||$t.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(r).toISOString()},b=a?Ei(y,a):y,E={url:ot(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};var I;this.pendingRequest=(I=D=>{this.pendingRequest=null,c(D),this.saveEventData(),this.processRequests(d)},bo(Ei(E,{method:"POST"}),I))}queueRequest(r,a){this.queue.push(r),this.processRequests(a)}}const ln=new class extends It{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,r){$t.EVENTS_URL&&$t.ACCESS_TOKEN&&Array.isArray(o)&&o.some(a=>xe(a)||Te(a))&&this.queueRequest(Date.now(),r)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const r=nn($t.ACCESS_TOKEN),a=r?r.u:$t.ACCESS_TOKEN;let c=a!==this.eventData.tokenU;ni(this.anonId)||(this.anonId=Yo(),c=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const g=new Date(this.eventData.lastSuccess),y=new Date(d),b=(d-this.eventData.lastSuccess)/864e5;c=c||b>=1||b<-1||g.getDate()!==y.getDate()}else c=!0;c?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:je,skuId:_l,"enabled.telemetry":!1,userId:this.anonId},g=>{g||(this.eventData.lastSuccess=d,this.eventData.tokenU=a)},o):this.processRequests()}},_n=ln.postTurnstileEvent.bind(ln),Di=new class extends It{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,r,a,c){this.skuToken=r,this.errorCb=c,$t.EVENTS_URL&&(a||$t.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(ge)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||(this.anonId||this.fetchEventData(),ni(this.anonId)||(this.anonId=Yo()),this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:je,skuId:_l,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},o))}},ji=Di.postMapLoadEvent.bind(Di),mr=new class extends It{constructor(){super("gljs.performance")}postPerformanceEvent(o,r){$t.EVENTS_URL&&(o||$t.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:r},o)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:r,performanceData:a}=this.queue.shift(),c=function(d){const g=Ke.performance.getEntriesByType("resource"),y=Ke.performance.getEntriesByType("mark"),b=function(L){const z={};if(L)for(const V in L)if("other"!==V)for(const H of L[V]){const K=`${V}ResolveRangeMin`,ie=`${V}ResolveRangeMax`,ue=`${V}RequestCount`,ne=`${V}RequestCachedCount`;z[K]=Math.min(z[K]||1/0,H.startTime),z[ie]=Math.max(z[ie]||-1/0,H.responseEnd);const ce=me=>{void 0===z[me]&&(z[me]=0),++z[me]};void 0!==H.transferSize&&0===H.transferSize&&ce(ne),ce(ue)}return z}(function(L,z){const V={};if(L)for(const H of L){const K=z(H);void 0===V[K]&&(V[K]=[]),V[K].push(H)}return V}(g,Qo)),E=Ke.devicePixelRatio,D=Ke.navigator.connection||Ke.navigator.mozConnection||Ke.navigator.webkitConnection,I={counters:[],metadata:[],attributes:[]},k=(L,z,V)=>{null!=V&&L.push({name:z,value:V.toString()})};for(const L in b)k(I.counters,L,b[L]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(k(I.counters,"interactionRangeMin",d.interactionRange[0]),k(I.counters,"interactionRangeMax",d.interactionRange[1])),y)for(const L of Object.keys(pi)){const z=pi[L],V=y.find(H=>H.name===z);V&&k(I.counters,z,V.startTime)}return k(I.counters,"visibilityHidden",d.visibilityHidden),k(I.attributes,"style",function(L){if(L)for(const z of L){const V=z.name.split("?")[0];if(be(V)){const H=V.split("/").slice(-2);if(2===H.length)return`mapbox://styles/${H[0]}/${H[1]}`}}}(g)),k(I.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),k(I.attributes,"fogEnabled",d.fogEnabled?"true":"false"),k(I.attributes,"projection",d.projection),k(I.attributes,"zoom",d.zoom),k(I.metadata,"devicePixelRatio",E),k(I.metadata,"connectionEffectiveType",D?D.effectiveType:void 0),k(I.metadata,"navigatorUserAgent",Ke.navigator.userAgent),k(I.metadata,"screenWidth",Ke.screen.width),k(I.metadata,"screenHeight",Ke.screen.height),k(I.metadata,"windowWidth",Ke.innerWidth),k(I.metadata,"windowHeight",Ke.innerHeight),k(I.metadata,"mapWidth",d.width/E),k(I.metadata,"mapHeight",d.height/E),k(I.metadata,"webglRenderer",d.renderer),k(I.metadata,"webglVendor",d.vendor),k(I.metadata,"sdkVersion",je),k(I.metadata,"sdkIdentifier","mapbox-gl-js"),I}(a);for(const d of c.metadata);for(const d of c.counters);for(const d of c.attributes);this.postEvent(r,c,()=>{},o)}},Xi=mr.postPerformanceEvent.bind(mr),Uo=new class extends It{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,r,a,c){if(!$t.API_URL||!$t.SESSION_PATH)return;const d=ut($t.API_URL+$t.SESSION_PATH);d.params.push(`sku=${r||""}`),d.params.push(`access_token=${c||$t.ACCESS_TOKEN||""}`);const g={url:ot(d),headers:{"Content-Type":"text/plain"}};var b;this.pendingRequest=(b=y=>{this.pendingRequest=null,a(y),this.saveEventData(),this.processRequests(c)},bo(Ei(g,{method:"GET"}),b))}getSessionAPI(o,r,a,c){this.skuToken=r,this.errorCb=c,$t.SESSION_PATH&&$t.API_URL&&(a||$t.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},a):this.errorCb(new Error(ge)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:r,timestamp:a}=this.queue.shift();r&&this.success[r]||this.getSession(a,this.skuToken,c=>{c?this.errorCb(c):r&&(this.success[r]=!0)},o)}},Qn=Uo.getSessionAPI.bind(Uo),Cr=new Set,pi={create:"create",load:"load",fullLoad:"fullLoad"},ir={mark(o){Ke.performance.mark(o)},measure(o,r,a){Ke.performance.measure(o,r,a)}};function Qo(o){const r=o.name.split("?")[0];return Se(r)&&r.includes("mapbox-gl.js")?"javascript":Se(r)&&r.includes("mapbox-gl.css")?"css":$t.API_FONTS_REGEX.test(r)?"fontRange":Oe(r)?"sprite":be(r)?"style":$t.API_TILEJSON_REGEX.test(r)?"tilejson":"other"}const Nn=Ke.performance;function wu(o){const r=o?o.url.toString():void 0;return Nn.getEntriesByName(r)}let ka,nc,ic,no;const ps={now:()=>void 0!==ic?ic:Ke.performance.now(),setNow(o){ic=o},restoreNow(){ic=void 0},frame(o){const r=Ke.requestAnimationFrame(o);return{cancel:()=>Ke.cancelAnimationFrame(r)}},getImageData(o,r=0){const{width:a,height:c}=o;no||(no=Ke.document.createElement("canvas"));const d=no.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(a>no.width||c>no.height)&&(no.width=a,no.height=c),d.clearRect(-r,-r,a+2*r,c+2*r),d.drawImage(o,0,0,a,c),d.getImageData(-r,-r,a+2*r,c+2*r)},resolveURL:o=>(ka||(ka=Ke.document.createElement("a")),ka.href=o,ka.href),get devicePixelRatio(){return Ke.devicePixelRatio},get prefersReducedMotion(){return!!Ke.matchMedia&&(null==nc&&(nc=Ke.matchMedia("(prefers-reduced-motion: reduce)")),nc.matches)}};function Lc(o,r,a){a[o]&&-1!==a[o].indexOf(r)||(a[o]=a[o]||[],a[o].push(r))}function rc(o,r,a){if(a&&a[o]){const c=a[o].indexOf(r);-1!==c&&a[o].splice(c,1)}}class Ra{constructor(r,a={}){Ei(this,a),this.type=r}}class Ls extends Ra{constructor(r,a={}){super("error",Ei({error:r},a))}}class oc{on(r,a){return this._listeners=this._listeners||{},Lc(r,a,this._listeners),this}off(r,a){return rc(r,a,this._listeners),rc(r,a,this._oneTimeListeners),this}once(r,a){return a?(this._oneTimeListeners=this._oneTimeListeners||{},Lc(r,a,this._oneTimeListeners),this):new Promise(c=>this.once(r,c))}fire(r,a){"string"==typeof r&&(r=new Ra(r,a||{}));const c=r.type;if(this.listens(c)){r.target=this;const d=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const b of d)b.call(this,r);const g=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const b of g)rc(c,b,this._oneTimeListeners),b.call(this,r);const y=this._eventedParent;y&&(Ei(r,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(r))}else r instanceof Ls&&console.error(r.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,a){return this._eventedParent=r,this._eventedParentData=a,this}}var Ue=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ms(o,...r){for(const a of r)for(const c in a)o[c]=a[c];return o}function $i(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function hr(o){if(Array.isArray(o))return o.map(hr);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const r={};for(const a in o)r[a]=hr(o[a]);return r}return $i(o)}class Li extends Error{constructor(r,a){super(a),this.message=a,this.key=r}}var io=Li;class Nc{constructor(r,a=[]){this.parent=r,this.bindings={};for(const[c,d]of a)this.bindings[c]=d}concat(r){return new Nc(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}var Bc=Nc;const $n={kind:"null"},ht={kind:"number"},Dt={kind:"string"},rn={kind:"boolean"},Vr={kind:"color"},wn={kind:"object"},dt={kind:"value"},Ur={kind:"collator"},Oa={kind:"formatted"},xl={kind:"resolvedImage"};function wo(o,r){return{kind:"array",itemType:o,N:r}}function Le(o){if("array"===o.kind){const r=Le(o.itemType);return"number"==typeof o.N?`array<${r}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${r}>`}return o.kind}const Ns=[$n,ht,Dt,rn,Vr,Oa,wn,wo(dt),xl];function Vt(o,r){if("error"===r.kind)return null;if("array"===o.kind){if("array"===r.kind&&(0===r.N&&"value"===r.itemType.kind||!Vt(o.itemType,r.itemType))&&("number"!=typeof o.N||o.N===r.N))return null}else{if(o.kind===r.kind)return null;if("value"===o.kind)for(const a of Ns)if(!Vt(a,r))return null}return`Expected ${Le(o)} but found ${Le(r)} instead.`}function An(o,r){return r.some(a=>a.kind===o.kind)}function bl(o,r){return r.some(a=>"null"===a?null===o:"array"===a?Array.isArray(o):"object"===a?o&&!Array.isArray(o)&&"object"==typeof o:a===typeof o)}var bh,wh={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ca(o){return(o=Math.round(o))<0?0:o>255?255:o}function gr(o){return ca("%"===o[o.length-1]?parseFloat(o)/100*255:parseInt(o))}function Eu(o){return(r="%"===o[o.length-1]?parseFloat(o)/100:parseFloat(o))<0?0:r>1?1:r;var r}function wl(o,r,a){return a<0?a+=1:a>1&&(a-=1),6*a<1?o+(r-o)*a*6:2*a<1?r:3*a<2?o+(r-o)*(2/3-a)*6:o}try{bh={}.parseCSSColor=function(o){var r,a=o.replace(/ /g,"").toLowerCase();if(a in wh)return wh[a].slice();if("#"===a[0])return 4===a.length?(r=parseInt(a.substr(1),16))>=0&&r<=4095?[(3840&r)>>4|(3840&r)>>8,240&r|(240&r)>>4,15&r|(15&r)<<4,1]:null:7===a.length&&(r=parseInt(a.substr(1),16))>=0&&r<=16777215?[(16711680&r)>>16,(65280&r)>>8,255&r,1]:null;var c=a.indexOf("("),d=a.indexOf(")");if(-1!==c&&d+1===a.length){var g=a.substr(0,c),y=a.substr(c+1,d-(c+1)).split(","),b=1;switch(g){case"rgba":if(4!==y.length)return null;b=Eu(y.pop());case"rgb":return 3!==y.length?null:[gr(y[0]),gr(y[1]),gr(y[2]),b];case"hsla":if(4!==y.length)return null;b=Eu(y.pop());case"hsl":if(3!==y.length)return null;var E=(parseFloat(y[0])%360+360)%360/360,D=Eu(y[1]),I=Eu(y[2]),k=I<=.5?I*(D+1):I+D-I*D,L=2*I-k;return[ca(255*wl(L,k,E+1/3)),ca(255*wl(L,k,E)),ca(255*wl(L,k,E-1/3)),b];default:return null}}return null}}catch{}class Eo{constructor(r,a,c,d=1){this.r=r,this.g=a,this.b=c,this.a=d}static parse(r){if(!r)return;if(r instanceof Eo)return r;if("string"!=typeof r)return;const a=bh(r);return a?new Eo(a[0]/255*a[3],a[1]/255*a[3],a[2]/255*a[3],a[3]):void 0}toString(){const[r,a,c,d]=this.toArray();return`rgba(${Math.round(r)},${Math.round(a)},${Math.round(c)},${d})`}toArray(){const{r,g:a,b:c,a:d}=this;return 0===d?[0,0,0,0]:[255*r/d,255*a/d,255*c/d,d]}toArray01(){const{r,g:a,b:c,a:d}=this;return 0===d?[0,0,0,0]:[r/d,a/d,c/d,d]}toArray01PremultipliedAlpha(){const{r,g:a,b:c,a:d}=this;return[r,a,c,d]}}Eo.black=new Eo(0,0,0,1),Eo.white=new Eo(1,1,1,1),Eo.transparent=new Eo(0,0,0,0),Eo.red=new Eo(1,0,0,1),Eo.blue=new Eo(0,0,1,1);var kn=Eo;class Eh{constructor(r,a,c){this.sensitivity=r?a?"variant":"case":a?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,a){return this.collator.compare(r,a)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ch{constructor(r,a,c,d,g){this.text=r.normalize?r.normalize():r,this.image=a,this.scale=c,this.fontStack=d,this.textColor=g}}class ro{constructor(r){this.sections=r}static fromString(r){return new ro([new Ch(r,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(r=>0!==r.text.length||r.image&&0!==r.image.name.length)}static factory(r){return r instanceof ro?r:ro.fromString(r)}toString(){return 0===this.sections.length?"":this.sections.map(r=>r.text).join("")}serialize(){const r=["format"];for(const a of this.sections){if(a.image){r.push(["image",a.image.name]);continue}r.push(a.text);const c={};a.fontStack&&(c["text-font"]=["literal",a.fontStack.split(",")]),a.scale&&(c["font-scale"]=a.scale),a.textColor&&(c["text-color"]=["rgba"].concat(a.textColor.toArray())),r.push(c)}return r}}class es{constructor(r){this.name=r.name,this.available=r.available}toString(){return this.name}static fromString(r){return r?new es({name:r,available:!1}):null}serialize(){return["image",this.name]}}function Bs(o,r,a,c){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof r&&r>=0&&r<=255&&"number"==typeof a&&a>=0&&a<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:`Invalid rgba value [${[o,r,a,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof c?[o,r,a,c]:[o,r,a]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function zc(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof kn||o instanceof Eh||o instanceof ro||o instanceof es)return!0;if(Array.isArray(o)){for(const r of o)if(!zc(r))return!1;return!0}if("object"==typeof o){for(const r in o)if(!zc(o[r]))return!1;return!0}return!1}function Mi(o){if(null===o)return $n;if("string"==typeof o)return Dt;if("boolean"==typeof o)return rn;if("number"==typeof o)return ht;if(o instanceof kn)return Vr;if(o instanceof Eh)return Ur;if(o instanceof ro)return Oa;if(o instanceof es)return xl;if(Array.isArray(o)){const r=o.length;let a;for(const c of o){const d=Mi(c);if(a){if(a===d)continue;a=dt;break}a=d}return wo(a||dt,r)}return wn}function ua(o){const r=typeof o;return null===o?"":"string"===r||"number"===r||"boolean"===r?String(o):o instanceof kn||o instanceof ro||o instanceof es?o.toString():JSON.stringify(o)}class oo{constructor(r,a){this.type=r,this.value=a}static parse(r,a){if(2!==r.length)return a.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!zc(r[1]))return a.error("invalid value");const c=r[1];let d=Mi(c);const g=a.expectedType;return"array"!==d.kind||0!==d.N||!g||"array"!==g.kind||"number"==typeof g.N&&0!==g.N||(d=g),new oo(d,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof kn?["rgba"].concat(this.value.toArray()):this.value instanceof ro?this.value.serialize():this.value}}var Sn=oo,Dr=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const Cu={string:Dt,number:ht,boolean:rn,object:wn};class Fa{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");let c,d=1;const g=r[0];if("array"===g){let b,E;if(r.length>2){const D=r[1];if("string"!=typeof D||!(D in Cu)||"object"===D)return a.error('The item type argument of "array" must be one of string, number, boolean',1);b=Cu[D],d++}else b=dt;if(r.length>3){if(null!==r[2]&&("number"!=typeof r[2]||r[2]<0||r[2]!==Math.floor(r[2])))return a.error('The length argument to "array" must be a positive integer literal',2);E=r[2],d++}c=wo(b,E)}else c=Cu[g];const y=[];for(;d<r.length;d++){const b=a.parse(r[d],d,dt);if(!b)return null;y.push(b)}return new Fa(c,y)}evaluate(r){for(let a=0;a<this.args.length;a++){const c=this.args[a].evaluate(r);if(!Vt(this.type,Mi(c)))return c;if(a===this.args.length-1)throw new Dr(`Expected value to be of type ${Le(this.type)}, but found ${Le(Mi(c))} instead.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=this.type,a=[r.kind];if("array"===r.kind){const c=r.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){a.push(c.kind);const d=r.N;("number"==typeof d||this.args.length>1)&&a.push(d)}}return a.concat(this.args.map(c=>c.serialize()))}}var pt=Fa;class La{constructor(r){this.type=Oa,this.sections=r}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const c=r[1];if(!Array.isArray(c)&&"object"==typeof c)return a.error("First argument must be an image or text section.");const d=[];let g=!1;for(let y=1;y<=r.length-1;++y){const b=r[y];if(g&&"object"==typeof b&&!Array.isArray(b)){g=!1;let E=null;if(b["font-scale"]&&(E=a.parse(b["font-scale"],1,ht),!E))return null;let D=null;if(b["text-font"]&&(D=a.parse(b["text-font"],1,wo(Dt)),!D))return null;let I=null;if(b["text-color"]&&(I=a.parse(b["text-color"],1,Vr),!I))return null;const k=d[d.length-1];k.scale=E,k.font=D,k.textColor=I}else{const E=a.parse(r[y],1,dt);if(!E)return null;const D=E.type.kind;if("string"!==D&&"value"!==D&&"null"!==D&&"resolvedImage"!==D)return a.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,d.push({content:E,scale:null,font:null,textColor:null})}}return new La(d)}evaluate(r){return new ro(this.sections.map(a=>{const c=a.content.evaluate(r);return Mi(c)===xl?new Ch("",c,null,null,null):new Ch(ua(c),null,a.scale?a.scale.evaluate(r):null,a.font?a.font.evaluate(r).join(","):null,a.textColor?a.textColor.evaluate(r):null)}))}eachChild(r){for(const a of this.sections)r(a.content),a.scale&&r(a.scale),a.font&&r(a.font),a.textColor&&r(a.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const a of this.sections){r.push(a.content.serialize());const c={};a.scale&&(c["font-scale"]=a.scale.serialize()),a.font&&(c["text-font"]=a.font.serialize()),a.textColor&&(c["text-color"]=a.textColor.serialize()),r.push(c)}return r}}class mi{constructor(r){this.type=xl,this.input=r}static parse(r,a){if(2!==r.length)return a.error("Expected two arguments.");const c=a.parse(r[1],1,Dt);return c?new mi(c):a.error("No image name provided.")}evaluate(r){const a=this.input.evaluate(r),c=es.fromString(a);return c&&r.availableImages&&(c.available=r.availableImages.indexOf(a)>-1),c}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Vc={"to-boolean":rn,"to-color":Vr,"to-number":ht,"to-string":Dt};class Du{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expected at least one argument.");const c=r[0];if(("to-boolean"===c||"to-string"===c)&&2!==r.length)return a.error("Expected one argument.");const d=Vc[c],g=[];for(let y=1;y<r.length;y++){const b=a.parse(r[y],y,dt);if(!b)return null;g.push(b)}return new Du(d,g)}evaluate(r){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(r));if("color"===this.type.kind){let a,c;for(const d of this.args){if(a=d.evaluate(r),c=null,a instanceof kn)return a;if("string"==typeof a){const g=r.parseColor(a);if(g)return g}else if(Array.isArray(a)&&(c=a.length<3||a.length>4?`Invalid rbga value ${JSON.stringify(a)}: expected an array containing either three or four numeric values.`:Bs(a[0],a[1],a[2],a[3]),!c))return new kn(a[0]/255,a[1]/255,a[2]/255,a[3])}throw new Dr(c||`Could not parse color from value '${"string"==typeof a?a:String(JSON.stringify(a))}'`)}if("number"===this.type.kind){let a=null;for(const c of this.args){if(a=c.evaluate(r),null===a)return 0;const d=Number(a);if(!isNaN(d))return d}throw new Dr(`Could not convert ${JSON.stringify(a)} to number.`)}return"formatted"===this.type.kind?ro.fromString(ua(this.args[0].evaluate(r))):"resolvedImage"===this.type.kind?es.fromString(ua(this.args[0].evaluate(r))):ua(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){if("formatted"===this.type.kind)return new La([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new mi(this.args[0]).serialize();const r=[`to-${this.type.kind}`];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Na=Du;const gs=["Unknown","Point","LineString","Polygon"];var Uc=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?gs[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,r=this.featureDistanceData.scale,{x:a,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(a*r-o[0])+this.featureDistanceData.bearing[1]*(c*r-o[1])}return 0}parseColor(o){let r=this._parseColorCache[o];return r||(r=this._parseColorCache[o]=kn.parse(o)),r}};class _s{constructor(r,a,c,d){this.name=r,this.type=a,this._evaluate=c,this.args=d}evaluate(r){return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(r=>r.serialize()))}static parse(r,a){const c=r[0],d=_s.definitions[c];if(!d)return a.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,b=y.filter(([D])=>!Array.isArray(D)||D.length===r.length-1);let E=null;for(const[D,I]of b){E=new $a(a.registry,a.path,null,a.scope);const k=[];let L=!1;for(let z=1;z<r.length;z++){const V=r[z],H=Array.isArray(D)?D[z-1]:D.type,K=E.parse(V,1+k.length,H);if(!K){L=!0;break}k.push(K)}if(!L)if(Array.isArray(D)&&D.length!==k.length)E.error(`Expected ${D.length} arguments, but found ${k.length} instead.`);else{for(let z=0;z<k.length;z++){const V=Array.isArray(D)?D[z]:D.type,H=k[z];E.concat(z+1).checkSubtype(V,H.type)}if(0===E.errors.length)return new _s(c,g,I,k)}}if(1===b.length)a.errors.push(...E.errors);else{const D=(b.length?b:y).map(([k])=>{return L=k,Array.isArray(L)?`(${L.map(Le).join(", ")})`:`(${Le(L.type)}...)`;var L}).join(" | "),I=[];for(let k=1;k<r.length;k++){const L=a.parse(r[k],1+I.length);if(!L)return null;I.push(Le(L.type))}a.error(`Expected arguments of type ${D}, but found (${I.join(", ")}) instead.`)}return null}static register(r,a){_s.definitions=a;for(const c in a)r[c]=_s}}var Co=_s;class Ba{constructor(r,a,c){this.type=Ur,this.locale=c,this.caseSensitive=r,this.diacriticSensitive=a}static parse(r,a){if(2!==r.length)return a.error("Expected one argument.");const c=r[1];if("object"!=typeof c||Array.isArray(c))return a.error("Collator options argument must be an object.");const d=a.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,rn);if(!d)return null;const g=a.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,rn);if(!g)return null;let y=null;return c.locale&&(y=a.parse(c.locale,1,Dt),!y)?null:new Ba(d,g,y)}evaluate(r){return new Eh(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}const zs=8192;function Bt(o,r){o[0]=Math.min(o[0],r[0]),o[1]=Math.min(o[1],r[1]),o[2]=Math.max(o[2],r[0]),o[3]=Math.max(o[3],r[1])}function ha(o,r){return!(o[0]<=r[0]||o[2]>=r[2]||o[1]<=r[1]||o[3]>=r[3])}function El(o,r){const a=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,d=Math.pow(2,r.z);return[Math.round(a*d*zs),Math.round(c*d*zs)]}function Do(o,r,a){const c=o[0]-r[0],d=o[1]-r[1],g=o[0]-a[0],y=o[1]-a[1];return c*y-g*d==0&&c*g<=0&&d*y<=0}function za(o,r){let a=!1;for(let y=0,b=r.length;y<b;y++){const E=r[y];for(let D=0,I=E.length;D<I-1;D++){if(Do(o,E[D],E[D+1]))return!1;(d=E[D])[1]>(c=o)[1]!=(g=E[D+1])[1]>c[1]&&c[0]<(g[0]-d[0])*(c[1]-d[1])/(g[1]-d[1])+d[0]&&(a=!a)}}var c,d,g;return a}function Tu(o,r){for(let a=0;a<r.length;a++)if(za(o,r[a]))return!0;return!1}function ai(o,r,a,c){const d=c[0]-a[0],g=c[1]-a[1],y=(o[0]-a[0])*g-d*(o[1]-a[1]),b=(r[0]-a[0])*g-d*(r[1]-a[1]);return y>0&&b<0||y<0&&b>0}function Va(o,r,a){for(const D of a)for(let I=0;I<D.length-1;++I)if((b=[(y=D[I+1])[0]-(g=D[I])[0],y[1]-g[1]])[0]*(E=[(d=r)[0]-(c=o)[0],d[1]-c[1]])[1]-b[1]*E[0]!=0&&ai(c,d,g,y)&&ai(g,y,c,d))return!0;var c,d,g,y,b,E;return!1}function Mn(o,r){for(let a=0;a<o.length;++a)if(!za(o[a],r))return!1;for(let a=0;a<o.length-1;++a)if(Va(o[a],o[a+1],r))return!1;return!0}function qf(o,r){for(let a=0;a<r.length;a++)if(Mn(o,r[a]))return!0;return!1}function da(o,r,a){const c=[];for(let d=0;d<o.length;d++){const g=[];for(let y=0;y<o[d].length;y++){const b=El(o[d][y],a);Bt(r,b),g.push(b)}c.push(g)}return c}function sc(o,r,a){const c=[];for(let d=0;d<o.length;d++){const g=da(o[d],r,a);c.push(g)}return c}function Ua(o,r,a,c){if(o[0]<a[0]||o[0]>a[2]){const d=.5*c;let g=o[0]-a[0]>d?-c:a[0]-o[0]>d?c:0;0===g&&(g=o[0]-a[2]>d?-c:a[2]-o[0]>d?c:0),o[0]+=g}Bt(r,o)}function Su(o,r,a,c){const d=Math.pow(2,c.z)*zs,g=[c.x*zs,c.y*zs],y=[];if(!o)return y;for(const b of o)for(const E of b){const D=[E.x+g[0],E.y+g[1]];Ua(D,r,a,d),y.push(D)}return y}function jc(o,r,a,c){const d=Math.pow(2,c.z)*zs,g=[c.x*zs,c.y*zs],y=[];if(!o)return y;for(const E of o){const D=[];for(const I of E){const k=[I.x+g[0],I.y+g[1]];Bt(r,k),D.push(k)}y.push(D)}if(r[2]-r[0]<=d/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of y)for(const D of E)Ua(D,r,a,d)}var b;return y}class ja{constructor(r,a){this.type=rn,this.geojson=r,this.geometries=a}static parse(r,a){if(2!==r.length)return a.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(zc(r[1])){const c=r[1];if("FeatureCollection"===c.type)for(let d=0;d<c.features.length;++d){const g=c.features[d].geometry.type;if("Polygon"===g||"MultiPolygon"===g)return new ja(c,c.features[d].geometry)}else if("Feature"===c.type){const d=c.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new ja(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new ja(c,c)}return a.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(null!=r.geometry()&&null!=r.canonicalID()){if("Point"===r.geometryType())return function(a,c){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if("Polygon"===c.type){const b=da(c.coordinates,g,y),E=Su(a.geometry(),d,g,y);if(!ha(d,g))return!1;for(const D of E)if(!za(D,b))return!1}if("MultiPolygon"===c.type){const b=sc(c.coordinates,g,y),E=Su(a.geometry(),d,g,y);if(!ha(d,g))return!1;for(const D of E)if(!Tu(D,b))return!1}return!0}(r,this.geometries);if("LineString"===r.geometryType())return function(a,c){const d=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],y=a.canonicalID();if(!y)return!1;if("Polygon"===c.type){const b=da(c.coordinates,g,y),E=jc(a.geometry(),d,g,y);if(!ha(d,g))return!1;for(const D of E)if(!Mn(D,b))return!1}if("MultiPolygon"===c.type){const b=sc(c.coordinates,g,y),E=jc(a.geometry(),d,g,y);if(!ha(d,g))return!1;for(const D of E)if(!qf(D,b))return!1}return!0}(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Cl=ja;function ts(o){if(o instanceof Co&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof Cl)return!1;let r=!0;return o.eachChild(a=>{r&&!ts(a)&&(r=!1)}),r}function jr(o){if(o instanceof Co&&"feature-state"===o.name)return!1;let r=!0;return o.eachChild(a=>{r&&!jr(a)&&(r=!1)}),r}function jo(o,r){if(o instanceof Co&&r.indexOf(o.name)>=0)return!1;let a=!0;return o.eachChild(c=>{a&&!jo(c,r)&&(a=!1)}),a}class ze{constructor(r,a){this.type=a.type,this.name=r,this.boundExpression=a}static parse(r,a){if(2!==r.length||"string"!=typeof r[1])return a.error("'var' expression requires exactly one string literal argument.");const c=r[1];return a.scope.has(c)?new ze(c,a.scope.get(c)):a.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Mu=ze;class Zt{constructor(r,a=[],c,d=new Bc,g=[]){this.registry=r,this.path=a,this.key=a.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=g,this.expectedType=c}parse(r,a,c,d,g={}){return a?this.concat(a,c,d)._parse(r,g):this._parse(r,g)}_parse(r,a){function c(d,g,y){return"assert"===y?new pt(g,[d]):"coerce"===y?new Na(g,[d]):d}if(null!==r&&"string"!=typeof r&&"boolean"!=typeof r&&"number"!=typeof r||(r=["literal",r]),Array.isArray(r)){if(0===r.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=r[0];if("string"!=typeof d)return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const g=this.registry[d];if(g){let y=g.parse(r,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,E=y.type;if("string"!==b.kind&&"number"!==b.kind&&"boolean"!==b.kind&&"object"!==b.kind&&"array"!==b.kind||"value"!==E.kind)if("color"!==b.kind&&"formatted"!==b.kind&&"resolvedImage"!==b.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(b,E))return null}else y=c(y,b,a.typeAnnotation||"coerce");else y=c(y,b,a.typeAnnotation||"assert")}if(!(y instanceof Sn)&&"resolvedImage"!==y.type.kind&&Dl(y)){const b=new Uc;try{y=new Sn(y.type,y.evaluate(b))}catch(E){return this.error(E.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===r?"'undefined' value invalid. Use null instead.":"object"==typeof r?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,a,c){const d="number"==typeof r?this.path.concat(r):this.path,g=c?this.scope.concat(c):this.scope;return new Zt(this.registry,d,a||null,g,this.errors)}error(r,...a){const c=`${this.key}${a.map(d=>`[${d}]`).join("")}`;this.errors.push(new io(c,r))}checkSubtype(r,a){const c=Vt(r,a);return c&&this.error(c),c}}var $a=Zt;function Dl(o){if(o instanceof Mu)return Dl(o.boundExpression);if(o instanceof Co&&"error"===o.name||o instanceof Ba||o instanceof Cl)return!1;const r=o instanceof Na||o instanceof pt;let a=!0;return o.eachChild(c=>{a=r?a&&Dl(c):a&&c instanceof Sn}),!!a&&ts(o)&&jo(o,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Vs(o,r){const a=o.length-1;let c,d,g=0,y=a,b=0;for(;g<=y;)if(b=Math.floor((g+y)/2),c=o[b],d=o[b+1],c<=r){if(b===a||r<d)return b;g=b+1}else{if(!(c>r))throw new Dr("Input is not a number.");y=b-1}return 0}class $c{constructor(r,a,c){this.type=r,this.input=a,this.labels=[],this.outputs=[];for(const[d,g]of c)this.labels.push(d),this.outputs.push(g)}static parse(r,a){if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");const c=a.parse(r[1],1,ht);if(!c)return null;const d=[];let g=null;a.expectedType&&"value"!==a.expectedType.kind&&(g=a.expectedType);for(let y=1;y<r.length;y+=2){const b=1===y?-1/0:r[y],E=r[y+1],D=y,I=y+1;if("number"!=typeof b)return a.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(d.length&&d[d.length-1][0]>=b)return a.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const k=a.parse(E,I,g);if(!k)return null;g=g||k.type,d.push([b,k])}return new $c(g,c,d)}evaluate(r){const a=this.labels,c=this.outputs;if(1===a.length)return c[0].evaluate(r);const d=this.input.evaluate(r);if(d<=a[0])return c[0].evaluate(r);const g=a.length;return d>=a[g-1]?c[g-1].evaluate(r):c[Vs(a,d)].evaluate(r)}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){const r=["step",this.input.serialize()];for(let a=0;a<this.labels.length;a++)a>0&&r.push(this.labels[a]),r.push(this.outputs[a].serialize());return r}}var Au=$c;function En(o,r,a){return o*(1-a)+r*a}var To=Object.freeze({__proto__:null,array:function(o,r,a){return o.map((c,d)=>En(c,r[d],a))},color:function(o,r,a){return new kn(En(o.r,r.r,a),En(o.g,r.g,a),En(o.b,r.b,a),En(o.a,r.a,a))},number:En});const $o=.95047,So=1.08883,ns=4/29,Cn=6/29,Ha=3*Cn*Cn,ac=Cn*Cn*Cn,Iu=Math.PI/180,Dh=180/Math.PI;function is(o){return o>ac?Math.pow(o,1/3):o/Ha+ns}function Ga(o){return o>Cn?o*o*o:Ha*(o-ns)}function Tl(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function Mo(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Th(o){const r=Mo(o.r),a=Mo(o.g),c=Mo(o.b),d=is((.4124564*r+.3575761*a+.1804375*c)/$o),g=is((.2126729*r+.7151522*a+.072175*c)/1);return{l:116*g-16,a:500*(d-g),b:200*(g-is((.0193339*r+.119192*a+.9503041*c)/So)),alpha:o.a}}function Sh(o){let r=(o.l+16)/116,a=isNaN(o.a)?r:r+o.a/500,c=isNaN(o.b)?r:r-o.b/200;return r=1*Ga(r),a=$o*Ga(a),c=So*Ga(c),new kn(Tl(3.2404542*a-1.5371385*r-.4985314*c),Tl(-.969266*a+1.8760108*r+.041556*c),Tl(.0556434*a-.2040259*r+1.0572252*c),o.alpha)}function zd(o,r,a){const c=r-o;return o+a*(c>180||c<-180?c-360*Math.round(c/360):c)}const li={forward:Th,reverse:Sh,interpolate:function(o,r,a){return{l:En(o.l,r.l,a),a:En(o.a,r.a,a),b:En(o.b,r.b,a),alpha:En(o.alpha,r.alpha,a)}}},Sl={forward:function(o){const{l:r,a,b:c}=Th(o),d=Math.atan2(c,a)*Dh;return{h:d<0?d+360:d,c:Math.sqrt(a*a+c*c),l:r,alpha:o.a}},reverse:function(o){const r=o.h*Iu,a=o.c;return Sh({l:o.l,a:Math.cos(r)*a,b:Math.sin(r)*a,alpha:o.alpha})},interpolate:function(o,r,a){return{h:zd(o.h,r.h,a),c:En(o.c,r.c,a),l:En(o.l,r.l,a),alpha:En(o.alpha,r.alpha,a)}}};var Hc=Object.freeze({__proto__:null,hcl:Sl,lab:li});class Nt{constructor(r,a,c,d,g){this.type=r,this.operator=a,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(const[y,b]of g)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(r,a,c,d){let g=0;if("exponential"===r.name)g=Tr(a,r.base,c,d);else if("linear"===r.name)g=Tr(a,1,c,d);else if("cubic-bezier"===r.name){const y=r.controlPoints;g=new As(y[0],y[1],y[2],y[3]).solve(Tr(a,1,c,d))}return g}static parse(r,a){let[c,d,g,...y]=r;if(!Array.isArray(d)||0===d.length)return a.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const D=d[1];if("number"!=typeof D)return a.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:D}}else{if("cubic-bezier"!==d[0])return a.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const D=d.slice(1);if(4!==D.length||D.some(I=>"number"!=typeof I||I<0||I>1))return a.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:D}}}if(r.length-1<4)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return a.error("Expected an even number of arguments.");if(g=a.parse(g,2,ht),!g)return null;const b=[];let E=null;"interpolate-hcl"===c||"interpolate-lab"===c?E=Vr:a.expectedType&&"value"!==a.expectedType.kind&&(E=a.expectedType);for(let D=0;D<y.length;D+=2){const I=y[D],k=y[D+1],L=D+3,z=D+4;if("number"!=typeof I)return a.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(b.length&&b[b.length-1][0]>=I)return a.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const V=a.parse(k,z,E);if(!V)return null;E=E||V.type,b.push([I,V])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Nt(E,c,d,g,b):a.error(`Type ${Le(E)} is not interpolatable.`)}evaluate(r){const a=this.labels,c=this.outputs;if(1===a.length)return c[0].evaluate(r);const d=this.input.evaluate(r);if(d<=a[0])return c[0].evaluate(r);const g=a.length;if(d>=a[g-1])return c[g-1].evaluate(r);const y=Vs(a,d),b=Nt.interpolationFactor(this.interpolation,d,a[y],a[y+1]),E=c[y].evaluate(r),D=c[y+1].evaluate(r);return"interpolate"===this.operator?To[this.type.kind.toLowerCase()](E,D,b):"interpolate-hcl"===this.operator?Sl.reverse(Sl.interpolate(Sl.forward(E),Sl.forward(D),b)):li.reverse(li.interpolate(li.forward(E),li.forward(D),b))}eachChild(r){r(this.input);for(const a of this.outputs)r(a)}outputDefined(){return this.outputs.every(r=>r.outputDefined())}serialize(){let r;r="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const a=[this.operator,r,this.input.serialize()];for(let c=0;c<this.labels.length;c++)a.push(this.labels[c],this.outputs[c].serialize());return a}}function Tr(o,r,a,c){const d=c-a,g=o-a;return 0===d?0:1===r?g/d:(Math.pow(r,g)-1)/(Math.pow(r,d)-1)}var yn=Nt;class Ki{constructor(r,a){this.type=r,this.args=a}static parse(r,a){if(r.length<2)return a.error("Expectected at least one argument.");let c=null;const d=a.expectedType;d&&"value"!==d.kind&&(c=d);const g=[];for(const b of r.slice(1)){const E=a.parse(b,1+g.length,c,void 0,{typeAnnotation:"omit"});if(!E)return null;c=c||E.type,g.push(E)}const y=d&&g.some(b=>Vt(d,b.type));return new Ki(y?dt:c,g)}evaluate(r){let a,c=null,d=0;for(const g of this.args){if(d++,c=g.evaluate(r),c&&c instanceof es&&!c.available&&(a||(a=c),c=null,d===this.args.length))return a;if(null!==c)break}return c}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every(r=>r.outputDefined())}serialize(){const r=["coalesce"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var Sr=Ki;class Us{constructor(r,a){this.type=a.type,this.bindings=[].concat(r),this.result=a}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const a of this.bindings)r(a[1]);r(this.result)}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const c=[];for(let g=1;g<r.length-1;g+=2){const y=r[g];if("string"!=typeof y)return a.error(`Expected string, but found ${typeof y} instead.`,g);if(/[^a-zA-Z0-9_]/.test(y))return a.error("Variable names must contain only alphanumeric characters or '_'.",g);const b=a.parse(r[g+1],g+1);if(!b)return null;c.push([y,b])}const d=a.parse(r[r.length-1],r.length-1,a.expectedType,c);return d?new Us(c,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[a,c]of this.bindings)r.push(a,c.serialize());return r.push(this.result.serialize()),r}}var so=Us;class lc{constructor(r,a,c){this.type=r,this.index=a,this.input=c}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=a.parse(r[1],1,ht),d=a.parse(r[2],2,wo(a.expectedType||dt));return c&&d?new lc(d.type.itemType,c,d):null}evaluate(r){const a=this.index.evaluate(r),c=this.input.evaluate(r);if(a<0)throw new Dr(`Array index out of bounds: ${a} < 0.`);if(a>=c.length)throw new Dr(`Array index out of bounds: ${a} > ${c.length-1}.`);if(a!==Math.floor(a))throw new Dr(`Array index must be an integer, but found ${a} instead.`);return c[a]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Gc=lc;class Ml{constructor(r,a){this.type=rn,this.needle=r,this.haystack=a}static parse(r,a){if(3!==r.length)return a.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const c=a.parse(r[1],1,dt),d=a.parse(r[2],2,dt);return c&&d?An(c.type,[rn,Dt,ht,$n,dt])?new Ml(c,d):a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Le(c.type)} instead`):null}evaluate(r){const a=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(null==c)return!1;if(!bl(a,["boolean","string","number","null"]))throw new Dr(`Expected first argument to be of type boolean, string, number or null, but found ${Le(Mi(a))} instead.`);if(!bl(c,["string","array"]))throw new Dr(`Expected second argument to be of type array or string, but found ${Le(Mi(c))} instead.`);return c.indexOf(a)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Ho=Ml;class Et{constructor(r,a,c){this.type=ht,this.needle=r,this.haystack=a,this.fromIndex=c}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=a.parse(r[1],1,dt),d=a.parse(r[2],2,dt);if(!c||!d)return null;if(!An(c.type,[rn,Dt,ht,$n,dt]))return a.error(`Expected first argument to be of type boolean, string, number or null, but found ${Le(c.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,ht);return g?new Et(c,d,g):null}return new Et(c,d)}evaluate(r){const a=this.needle.evaluate(r),c=this.haystack.evaluate(r);if(!bl(a,["boolean","string","number","null"]))throw new Dr(`Expected first argument to be of type boolean, string, number or null, but found ${Le(Mi(a))} instead.`);if(!bl(c,["string","array"]))throw new Dr(`Expected second argument to be of type array or string, but found ${Le(Mi(c))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(r);return c.indexOf(a,d)}return c.indexOf(a)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var dn=Et;class Ti{constructor(r,a,c,d,g,y){this.inputType=r,this.type=a,this.input=c,this.cases=d,this.outputs=g,this.otherwise=y}static parse(r,a){if(r.length<5)return a.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return a.error("Expected an even number of arguments.");let c,d;a.expectedType&&"value"!==a.expectedType.kind&&(d=a.expectedType);const g={},y=[];for(let D=2;D<r.length-1;D+=2){let I=r[D];const k=r[D+1];Array.isArray(I)||(I=[I]);const L=a.concat(D);if(0===I.length)return L.error("Expected at least one branch label.");for(const V of I){if("number"!=typeof V&&"string"!=typeof V)return L.error("Branch labels must be numbers or strings.");if("number"==typeof V&&Math.abs(V)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof V&&Math.floor(V)!==V)return L.error("Numeric branch labels must be integer values.");if(c){if(L.checkSubtype(c,Mi(V)))return null}else c=Mi(V);if(void 0!==g[String(V)])return L.error("Branch labels must be unique.");g[String(V)]=y.length}const z=a.parse(k,D,d);if(!z)return null;d=d||z.type,y.push(z)}const b=a.parse(r[1],1,dt);if(!b)return null;const E=a.parse(r[r.length-1],r.length-1,d);return E?"value"!==b.type.kind&&a.concat(1).checkSubtype(c,b.type)?null:new Ti(c,d,b,g,y,E):null}evaluate(r){const a=this.input.evaluate(r);return(Mi(a)===this.inputType&&this.outputs[this.cases[a]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every(r=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],a=Object.keys(this.cases).sort(),c=[],d={};for(const y of a){const b=d[this.cases[y]];void 0===b?(d[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[b][1].push(y)}const g=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,b]of c)r.push(1===b.length?g(b[0]):b.map(g)),r.push(this.outputs[y].serialize());return r.push(this.otherwise.serialize()),r}}var rs=Ti;class js{constructor(r,a,c){this.type=r,this.branches=a,this.otherwise=c}static parse(r,a){if(r.length<4)return a.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return a.error("Expected an odd number of arguments.");let c;a.expectedType&&"value"!==a.expectedType.kind&&(c=a.expectedType);const d=[];for(let y=1;y<r.length-1;y+=2){const b=a.parse(r[y],y,rn);if(!b)return null;const E=a.parse(r[y+1],y+1,c);if(!E)return null;d.push([b,E]),c=c||E.type}const g=a.parse(r[r.length-1],r.length-1,c);return g?new js(c,d,g):null}evaluate(r){for(const[a,c]of this.branches)if(a.evaluate(r))return c.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[a,c]of this.branches)r(a),r(c);r(this.otherwise)}outputDefined(){return this.branches.every(([r,a])=>a.outputDefined())&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild(a=>{r.push(a.serialize())}),r}}var _r=js;class ys{constructor(r,a,c,d){this.type=r,this.input=a,this.beginIndex=c,this.endIndex=d}static parse(r,a){if(r.length<=2||r.length>=5)return a.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const c=a.parse(r[1],1,dt),d=a.parse(r[2],2,ht);if(!c||!d)return null;if(!An(c.type,[wo(dt),Dt,dt]))return a.error(`Expected first argument to be of type array or string, but found ${Le(c.type)} instead`);if(4===r.length){const g=a.parse(r[3],3,ht);return g?new ys(c.type,c,d,g):null}return new ys(c.type,c,d)}evaluate(r){const a=this.input.evaluate(r),c=this.beginIndex.evaluate(r);if(!bl(a,["string","array"]))throw new Dr(`Expected first argument to be of type array or string, but found ${Le(Mi(a))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(r);return a.slice(c,d)}return a.slice(c)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Ni=ys;function qa(o,r){return"=="===o||"!="===o?"boolean"===r.kind||"string"===r.kind||"number"===r.kind||"null"===r.kind||"value"===r.kind:"string"===r.kind||"number"===r.kind||"value"===r.kind}function cc(o,r,a,c){return 0===c.compare(r,a)}function on(o,r,a){const c="=="!==o&&"!="!==o;return class UP{constructor(g,y,b){this.type=rn,this.lhs=g,this.rhs=y,this.collator=b,this.hasUntypedArgument="value"===g.type.kind||"value"===y.type.kind}static parse(g,y){if(3!==g.length&&4!==g.length)return y.error("Expected two or three arguments.");const b=g[0];let E=y.parse(g[1],1,dt);if(!E)return null;if(!qa(b,E.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${Le(E.type)}'.`);let D=y.parse(g[2],2,dt);if(!D)return null;if(!qa(b,D.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${Le(D.type)}'.`);if(E.type.kind!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return y.error(`Cannot compare types '${Le(E.type)}' and '${Le(D.type)}'.`);c&&("value"===E.type.kind&&"value"!==D.type.kind?E=new pt(D.type,[E]):"value"!==E.type.kind&&"value"===D.type.kind&&(D=new pt(E.type,[D])));let I=null;if(4===g.length){if("string"!==E.type.kind&&"string"!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return y.error("Cannot use collator to compare non-string types.");if(I=y.parse(g[3],3,Ur),!I)return null}return new UP(E,D,I)}evaluate(g){const y=this.lhs.evaluate(g),b=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){const E=Mi(y),D=Mi(b);if(E.kind!==D.kind||"string"!==E.kind&&"number"!==E.kind)throw new Dr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${E.kind}, ${D.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const E=Mi(y),D=Mi(b);if("string"!==E.kind||"string"!==D.kind)return r(g,y,b)}return this.collator?a(g,y,b,this.collator.evaluate(g)):r(g,y,b)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[o];return this.eachChild(y=>{g.push(y.serialize())}),g}}}const Pu=on("==",function(o,r,a){return r===a},cc),os=on("!=",function(o,r,a){return r!==a},function(o,r,a,c){return!cc(0,r,a,c)}),ku=on("<",function(o,r,a){return r<a},function(o,r,a,c){return c.compare(r,a)<0}),Al=on(">",function(o,r,a){return r>a},function(o,r,a,c){return c.compare(r,a)>0}),yr=on("<=",function(o,r,a){return r<=a},function(o,r,a,c){return c.compare(r,a)<=0}),Il=on(">=",function(o,r,a){return r>=a},function(o,r,a,c){return c.compare(r,a)>=0});class $s{constructor(r,a,c,d,g,y){this.type=Dt,this.number=r,this.locale=a,this.currency=c,this.unit=d,this.minFractionDigits=g,this.maxFractionDigits=y}static parse(r,a){if(3!==r.length)return a.error("Expected two arguments.");const c=a.parse(r[1],1,ht);if(!c)return null;const d=r[2];if("object"!=typeof d||Array.isArray(d))return a.error("NumberFormat options argument must be an object.");let g=null;if(d.locale&&(g=a.parse(d.locale,1,Dt),!g))return null;let y=null;if(d.currency&&(y=a.parse(d.currency,1,Dt),!y))return null;let b=null;if(d.unit&&(b=a.parse(d.unit,1,Dt),!b))return null;let E=null;if(d["min-fraction-digits"]&&(E=a.parse(d["min-fraction-digits"],1,ht),!E))return null;let D=null;return d["max-fraction-digits"]&&(D=a.parse(d["max-fraction-digits"],1,ht),!D)?null:new $s(c,g,y,b,E,D)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class $r{constructor(r){this.type=ht,this.input=r}static parse(r,a){if(2!==r.length)return a.error(`Expected 1 argument, but found ${r.length-1} instead.`);const c=a.parse(r[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?a.error(`Expected argument of type string or array, but found ${Le(c.type)} instead.`):new $r(c):null}evaluate(r){const a=this.input.evaluate(r);if("string"==typeof a||Array.isArray(a))return a.length;throw new Dr(`Expected value to be of type string or array, but found ${Le(Mi(a))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild(a=>{r.push(a.serialize())}),r}}const Wa={"==":Pu,"!=":os,">":Al,"<":ku,">=":Il,"<=":yr,array:pt,at:Gc,boolean:pt,case:_r,coalesce:Sr,collator:Ba,format:La,image:mi,in:Ho,"index-of":dn,interpolate:yn,"interpolate-hcl":yn,"interpolate-lab":yn,length:$r,let:so,literal:Sn,match:rs,number:pt,"number-format":$s,object:pt,slice:Ni,step:Au,string:pt,"to-boolean":Na,"to-color":Na,"to-number":Na,"to-string":Na,var:Mu,within:Cl};function Ru(o,[r,a,c,d]){r=r.evaluate(o),a=a.evaluate(o),c=c.evaluate(o);const g=d?d.evaluate(o):1,y=Bs(r,a,c,g);if(y)throw new Dr(y);return new kn(r/255*g,a/255*g,c/255*g,g)}function Bn(o,r){return o in r}function Ou(o,r){const a=r[o];return void 0===a?null:a}function Ai(o){return{type:o}}Co.register(Wa,{error:[{kind:"error"},[Dt],(o,[r])=>{throw new Dr(r.evaluate(o))}],typeof:[Dt,[dt],(o,[r])=>Le(Mi(r.evaluate(o)))],"to-rgba":[wo(ht,4),[Vr],(o,[r])=>r.evaluate(o).toArray()],rgb:[Vr,[ht,ht,ht],Ru],rgba:[Vr,[ht,ht,ht,ht],Ru],has:{type:rn,overloads:[[[Dt],(o,[r])=>Bn(r.evaluate(o),o.properties())],[[Dt,wn],(o,[r,a])=>Bn(r.evaluate(o),a.evaluate(o))]]},get:{type:dt,overloads:[[[Dt],(o,[r])=>Ou(r.evaluate(o),o.properties())],[[Dt,wn],(o,[r,a])=>Ou(r.evaluate(o),a.evaluate(o))]]},"feature-state":[dt,[Dt],(o,[r])=>Ou(r.evaluate(o),o.featureState||{})],properties:[wn,[],o=>o.properties()],"geometry-type":[Dt,[],o=>o.geometryType()],id:[dt,[],o=>o.id()],zoom:[ht,[],o=>o.globals.zoom],pitch:[ht,[],o=>o.globals.pitch||0],"distance-from-center":[ht,[],o=>o.distanceFromCenter()],"heatmap-density":[ht,[],o=>o.globals.heatmapDensity||0],"line-progress":[ht,[],o=>o.globals.lineProgress||0],"sky-radial-progress":[ht,[],o=>o.globals.skyRadialProgress||0],accumulated:[dt,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[ht,Ai(ht),(o,r)=>{let a=0;for(const c of r)a+=c.evaluate(o);return a}],"*":[ht,Ai(ht),(o,r)=>{let a=1;for(const c of r)a*=c.evaluate(o);return a}],"-":{type:ht,overloads:[[[ht,ht],(o,[r,a])=>r.evaluate(o)-a.evaluate(o)],[[ht],(o,[r])=>-r.evaluate(o)]]},"/":[ht,[ht,ht],(o,[r,a])=>r.evaluate(o)/a.evaluate(o)],"%":[ht,[ht,ht],(o,[r,a])=>r.evaluate(o)%a.evaluate(o)],ln2:[ht,[],()=>Math.LN2],pi:[ht,[],()=>Math.PI],e:[ht,[],()=>Math.E],"^":[ht,[ht,ht],(o,[r,a])=>Math.pow(r.evaluate(o),a.evaluate(o))],sqrt:[ht,[ht],(o,[r])=>Math.sqrt(r.evaluate(o))],log10:[ht,[ht],(o,[r])=>Math.log(r.evaluate(o))/Math.LN10],ln:[ht,[ht],(o,[r])=>Math.log(r.evaluate(o))],log2:[ht,[ht],(o,[r])=>Math.log(r.evaluate(o))/Math.LN2],sin:[ht,[ht],(o,[r])=>Math.sin(r.evaluate(o))],cos:[ht,[ht],(o,[r])=>Math.cos(r.evaluate(o))],tan:[ht,[ht],(o,[r])=>Math.tan(r.evaluate(o))],asin:[ht,[ht],(o,[r])=>Math.asin(r.evaluate(o))],acos:[ht,[ht],(o,[r])=>Math.acos(r.evaluate(o))],atan:[ht,[ht],(o,[r])=>Math.atan(r.evaluate(o))],min:[ht,Ai(ht),(o,r)=>Math.min(...r.map(a=>a.evaluate(o)))],max:[ht,Ai(ht),(o,r)=>Math.max(...r.map(a=>a.evaluate(o)))],abs:[ht,[ht],(o,[r])=>Math.abs(r.evaluate(o))],round:[ht,[ht],(o,[r])=>{const a=r.evaluate(o);return a<0?-Math.round(-a):Math.round(a)}],floor:[ht,[ht],(o,[r])=>Math.floor(r.evaluate(o))],ceil:[ht,[ht],(o,[r])=>Math.ceil(r.evaluate(o))],"filter-==":[rn,[Dt,dt],(o,[r,a])=>o.properties()[r.value]===a.value],"filter-id-==":[rn,[dt],(o,[r])=>o.id()===r.value],"filter-type-==":[rn,[Dt],(o,[r])=>o.geometryType()===r.value],"filter-<":[rn,[Dt,dt],(o,[r,a])=>{const c=o.properties()[r.value],d=a.value;return typeof c==typeof d&&c<d}],"filter-id-<":[rn,[dt],(o,[r])=>{const a=o.id(),c=r.value;return typeof a==typeof c&&a<c}],"filter->":[rn,[Dt,dt],(o,[r,a])=>{const c=o.properties()[r.value],d=a.value;return typeof c==typeof d&&c>d}],"filter-id->":[rn,[dt],(o,[r])=>{const a=o.id(),c=r.value;return typeof a==typeof c&&a>c}],"filter-<=":[rn,[Dt,dt],(o,[r,a])=>{const c=o.properties()[r.value],d=a.value;return typeof c==typeof d&&c<=d}],"filter-id-<=":[rn,[dt],(o,[r])=>{const a=o.id(),c=r.value;return typeof a==typeof c&&a<=c}],"filter->=":[rn,[Dt,dt],(o,[r,a])=>{const c=o.properties()[r.value],d=a.value;return typeof c==typeof d&&c>=d}],"filter-id->=":[rn,[dt],(o,[r])=>{const a=o.id(),c=r.value;return typeof a==typeof c&&a>=c}],"filter-has":[rn,[dt],(o,[r])=>r.value in o.properties()],"filter-has-id":[rn,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[rn,[wo(Dt)],(o,[r])=>r.value.indexOf(o.geometryType())>=0],"filter-id-in":[rn,[wo(dt)],(o,[r])=>r.value.indexOf(o.id())>=0],"filter-in-small":[rn,[Dt,wo(dt)],(o,[r,a])=>a.value.indexOf(o.properties()[r.value])>=0],"filter-in-large":[rn,[Dt,wo(dt)],(o,[r,a])=>function(c,d,g,y){for(;g<=y;){const b=g+y>>1;if(d[b]===c)return!0;d[b]>c?y=b-1:g=b+1}return!1}(o.properties()[r.value],a.value,0,a.value.length-1)],all:{type:rn,overloads:[[[rn,rn],(o,[r,a])=>r.evaluate(o)&&a.evaluate(o)],[Ai(rn),(o,r)=>{for(const a of r)if(!a.evaluate(o))return!1;return!0}]]},any:{type:rn,overloads:[[[rn,rn],(o,[r,a])=>r.evaluate(o)||a.evaluate(o)],[Ai(rn),(o,r)=>{for(const a of r)if(a.evaluate(o))return!0;return!1}]]},"!":[rn,[rn],(o,[r])=>!r.evaluate(o)],"is-supported-script":[rn,[Dt],(o,[r])=>{const a=o.globals&&o.globals.isSupportedScript;return!a||a(r.evaluate(o))}],upcase:[Dt,[Dt],(o,[r])=>r.evaluate(o).toUpperCase()],downcase:[Dt,[Dt],(o,[r])=>r.evaluate(o).toLowerCase()],concat:[Dt,Ai(dt),(o,r)=>r.map(a=>ua(a.evaluate(o))).join("")],"resolved-locale":[Dt,[Ur],(o,[r])=>r.evaluate(o).resolvedLocale()]});var vi=Wa;function uc(o){return{result:"success",value:o}}function vs(o){return{result:"error",value:o}}function ss(o){return"data-driven"===o["property-type"]}function dr(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function Fu(o){return!!o.expression&&o.expression.interpolated}function Xt(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}function Hr(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Za(o){return o}function R(o,r){const a="color"===r.type,c=o.stops&&"object"==typeof o.stops[0][0],d=c||!(c||void 0!==o.property),g=o.type||(Fu(r)?"exponential":"interval");if(a&&((o=ms({},o)).stops&&(o.stops=o.stops.map(D=>[D[0],kn.parse(D[1])])),o.default=kn.parse(o.default?o.default:r.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!Hc[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let y,b,E;if("exponential"===g)y=Ge;else if("interval"===g)y=de;else if("categorical"===g){y=G,b=Object.create(null);for(const D of o.stops)b[D[0]]=D[1];E=typeof o.stops[0][0]}else{if("identity"!==g)throw new Error(`Unknown function type "${g}"`);y=Rt}if(c){const D={},I=[];for(let z=0;z<o.stops.length;z++){const V=o.stops[z],H=V[0].zoom;void 0===D[H]&&(D[H]={zoom:H,type:o.type,property:o.property,default:o.default,stops:[]},I.push(H)),D[H].stops.push([V[0].value,V[1]])}const k=[];for(const z of I)k.push([D[z].zoom,R(D[z],r)]);const L={name:"linear"};return{kind:"composite",interpolationType:L,interpolationFactor:yn.interpolationFactor.bind(void 0,L),zoomStops:k.map(z=>z[0]),evaluate:({zoom:z},V)=>Ge({stops:k,base:o.base},r,z).evaluate(z,V)}}if(d){const D="exponential"===g?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:yn.interpolationFactor.bind(void 0,D),zoomStops:o.stops.map(I=>I[0]),evaluate:({zoom:I})=>y(o,r,I,b,E)}}return{kind:"source",evaluate(D,I){const k=I&&I.properties?I.properties[o.property]:void 0;return void 0===k?F(o.default,r.default):y(o,r,k,b,E)}}}function F(o,r,a){return void 0!==o?o:void 0!==r?r:void 0!==a?a:void 0}function G(o,r,a,c,d){return F(typeof a===d?c[a]:void 0,o.default,r.default)}function de(o,r,a){if("number"!==Xt(a))return F(o.default,r.default);const c=o.stops.length;if(1===c||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[c-1][0])return o.stops[c-1][1];const d=Vs(o.stops.map(g=>g[0]),a);return o.stops[d][1]}function Ge(o,r,a){const c=void 0!==o.base?o.base:1;if("number"!==Xt(a))return F(o.default,r.default);const d=o.stops.length;if(1===d||a<=o.stops[0][0])return o.stops[0][1];if(a>=o.stops[d-1][0])return o.stops[d-1][1];const g=Vs(o.stops.map(I=>I[0]),a),y=function(I,k,L,z){const V=z-L,H=I-L;return 0===V?0:1===k?H/V:(Math.pow(k,H)-1)/(Math.pow(k,V)-1)}(a,c,o.stops[g][0],o.stops[g+1][0]),b=o.stops[g][1],E=o.stops[g+1][1];let D=To[r.type]||Za;if(o.colorSpace&&"rgb"!==o.colorSpace){const I=Hc[o.colorSpace];D=(k,L)=>I.reverse(I.interpolate(I.forward(k),I.forward(L),y))}return"function"==typeof b.evaluate?{evaluate(...I){const k=b.evaluate.apply(void 0,I),L=E.evaluate.apply(void 0,I);if(void 0!==k&&void 0!==L)return D(k,L,y)}}:D(b,E,y)}function Rt(o,r,a){return"color"===r.type?a=kn.parse(a):"formatted"===r.type?a=ro.fromString(a.toString()):"resolvedImage"===r.type?a=es.fromString(a.toString()):Xt(a)===r.type||"enum"===r.type&&r.values[a]||(a=void 0),F(a,o.default,r.default)}class Hn{constructor(r,a){var c;this.expression=r,this._warningHistory={},this._evaluator=new Uc,this._defaultValue=a?"color"===(c=a).type&&(Hr(c.default)||Array.isArray(c.default))?new kn(0,0,0,0):"color"===c.type?kn.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=a&&"enum"===a.type?a.values:null}evaluateWithoutErrorHandling(r,a,c,d,g,y,b,E){return this._evaluator.globals=r,this._evaluator.feature=a,this._evaluator.featureState=c,this._evaluator.canonical=d||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(r,a,c,d,g,y,b,E){this._evaluator.globals=r,this._evaluator.feature=a||null,this._evaluator.featureState=c||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null;try{const D=this.expression.evaluate(this._evaluator);if(null==D||"number"==typeof D&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Dr(`Expected value to be one of ${Object.keys(this._enumValues).map(I=>JSON.stringify(I)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function Ri(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in vi}function Ii(o,r){const a=new $a(vi,[],r?function(d){const g={color:Vr,string:Dt,number:ht,enum:Dt,boolean:rn,formatted:Oa,resolvedImage:xl};return"array"===d.type?wo(g[d.value]||dt,d.length):g[d.type]}(r):void 0),c=a.parse(o,void 0,void 0,void 0,r&&"string"===r.type?{typeAnnotation:"coerce"}:void 0);return c?uc(new Hn(c,r)):vs(a.errors)}class Xa{constructor(r,a){this.kind=r,this._styleExpression=a,this.isStateDependent="constant"!==r&&!jr(a.expression)}evaluateWithoutErrorHandling(r,a,c,d,g,y){return this._styleExpression.evaluateWithoutErrorHandling(r,a,c,d,g,y)}evaluate(r,a,c,d,g,y){return this._styleExpression.evaluate(r,a,c,d,g,y)}}class Pl{constructor(r,a,c,d){this.kind=r,this.zoomStops=c,this._styleExpression=a,this.isStateDependent="camera"!==r&&!jr(a.expression),this.interpolationType=d}evaluateWithoutErrorHandling(r,a,c,d,g,y){return this._styleExpression.evaluateWithoutErrorHandling(r,a,c,d,g,y)}evaluate(r,a,c,d,g,y){return this._styleExpression.evaluate(r,a,c,d,g,y)}interpolationFactor(r,a,c){return this.interpolationType?yn.interpolationFactor(this.interpolationType,r,a,c):0}}function Mh(o,r){if("error"===(o=Ii(o,r)).result)return o;const a=o.value.expression,c=ts(a);if(!c&&!ss(r))return vs([new io("","data expressions not supported")]);const d=jo(a,["zoom","pitch","distance-from-center"]);if(!d&&!dr(r))return vs([new io("","zoom expressions not supported")]);const g=Ud(a);return g||d?g instanceof io?vs([g]):g instanceof yn&&!Fu(r)?vs([new io("",'"interpolate" expressions cannot be used with this property')]):uc(g?new Pl(c?"camera":"composite",o.value,g.labels,g instanceof yn?g.interpolation:void 0):new Xa(c?"constant":"source",o.value)):vs([new io("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Vd{constructor(r,a){this._parameters=r,this._specification=a,ms(this,R(this._parameters,this._specification))}static deserialize(r){return new Vd(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function Ud(o){let r=null;if(o instanceof so)r=Ud(o.result);else if(o instanceof Sr){for(const a of o.args)if(r=Ud(a),r)break}else(o instanceof Au||o instanceof yn)&&o.input instanceof Co&&"zoom"===o.input.name&&(r=o);return r instanceof io||o.eachChild(a=>{const c=Ud(a);c instanceof io?r=c:!r&&c?r=new io("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):r&&c&&r!==c&&(r=new io("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),r}class vt{constructor(r,a,c,d){this.message=(r?`${r}: `:"")+c,d&&(this.identifier=d),null!=a&&a.__line__&&(this.line=a.__line__)}}function fa(o){const r=o.key,a=o.value,c=o.valueSpec||{},d=o.objectElementValidators||{},g=o.style,y=o.styleSpec;let b=[];const E=Xt(a);if("object"!==E)return[new vt(r,a,`object expected, ${E} found`)];for(const D in a){const I=D.split(".")[0];let k;d[I]?k=d[I]:c[I]?k=Hi:d["*"]?k=d["*"]:c["*"]&&(k=Hi),k?b=b.concat(k({key:(r&&`${r}.`)+D,value:a[D],valueSpec:c[I]||c["*"],style:g,styleSpec:y,object:a,objectKey:D},a)):b.push(new vt(r,a[D],`unknown property "${D}"`))}for(const D in c)d[D]||c[D].required&&void 0===c[D].default&&void 0===a[D]&&b.push(new vt(r,a,`missing required property "${D}"`));return b}function Om(o){const r=o.value,a=o.valueSpec,c=o.style,d=o.styleSpec,g=o.key,y=o.arrayElementValidator||Hi;if("array"!==Xt(r))return[new vt(g,r,`array expected, ${Xt(r)} found`)];if(a.length&&r.length!==a.length)return[new vt(g,r,`array length ${a.length} expected, length ${r.length} found`)];if(a["min-length"]&&r.length<a["min-length"])return[new vt(g,r,`array length at least ${a["min-length"]} expected, length ${r.length} found`)];let b={type:a.value,values:a.values,minimum:a.minimum,maximum:a.maximum,function:void 0};d.$version<7&&(b.function=a.function),"object"===Xt(a.value)&&(b=a.value);let E=[];for(let D=0;D<r.length;D++)E=E.concat(y({array:r,arrayIndex:D,value:r[D],valueSpec:b,style:c,styleSpec:d,key:`${g}[${D}]`}));return E}function Ah(o){const r=o.key,a=o.value,c=o.valueSpec;let d=Xt(a);if("number"===d&&a!=a&&(d="NaN"),"number"!==d)return[new vt(r,a,`number expected, ${d} found`)];if("minimum"in c){let g=c.minimum;if("array"===Xt(c.minimum)&&(g=c.minimum[o.arrayIndex]),a<g)return[new vt(r,a,`${a} is less than the minimum value ${g}`)]}if("maximum"in c){let g=c.maximum;if("array"===Xt(c.maximum)&&(g=c.maximum[o.arrayIndex]),a>g)return[new vt(r,a,`${a} is greater than the maximum value ${g}`)]}return[]}function Ih(o){const r=o.valueSpec,a=$i(o.value.type);let c,d,g,y={};const b="categorical"!==a&&void 0===o.value.property,E=!b,D="array"===Xt(o.value.stops)&&"array"===Xt(o.value.stops[0])&&"object"===Xt(o.value.stops[0][0]),I=fa({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(z){if("identity"===a)return[new vt(z.key,z.value,'identity function may not have a "stops" property')];let V=[];const H=z.value;return V=V.concat(Om({key:z.key,value:H,valueSpec:z.valueSpec,style:z.style,styleSpec:z.styleSpec,arrayElementValidator:k})),"array"===Xt(H)&&0===H.length&&V.push(new vt(z.key,H,"array must have at least one stop")),V},default:function(z){return Hi({key:z.key,value:z.value,valueSpec:r,style:z.style,styleSpec:z.styleSpec})}}});return"identity"===a&&b&&I.push(new vt(o.key,o.value,'missing required property "property"')),"identity"===a||o.value.stops||I.push(new vt(o.key,o.value,'missing required property "stops"')),"exponential"===a&&o.valueSpec.expression&&!Fu(o.valueSpec)&&I.push(new vt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(E&&!ss(o.valueSpec)?I.push(new vt(o.key,o.value,"property functions not supported")):b&&!dr(o.valueSpec)&&I.push(new vt(o.key,o.value,"zoom functions not supported"))),"categorical"!==a&&!D||void 0!==o.value.property||I.push(new vt(o.key,o.value,'"property" property is required')),I;function k(z){let V=[];const H=z.value,K=z.key;if("array"!==Xt(H))return[new vt(K,H,`array expected, ${Xt(H)} found`)];if(2!==H.length)return[new vt(K,H,`array length 2 expected, length ${H.length} found`)];if(D){if("object"!==Xt(H[0]))return[new vt(K,H,`object expected, ${Xt(H[0])} found`)];if(void 0===H[0].zoom)return[new vt(K,H,"object stop key must have zoom")];if(void 0===H[0].value)return[new vt(K,H,"object stop key must have value")];const ie=$i(H[0].zoom);if("number"!=typeof ie)return[new vt(K,H[0].zoom,"stop zoom values must be numbers")];if(g&&g>ie)return[new vt(K,H[0].zoom,"stop zoom values must appear in ascending order")];ie!==g&&(g=ie,d=void 0,y={}),V=V.concat(fa({key:`${K}[0]`,value:H[0],valueSpec:{zoom:{}},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{zoom:Ah,value:L}}))}else V=V.concat(L({key:`${K}[0]`,value:H[0],valueSpec:{},style:z.style,styleSpec:z.styleSpec},H));return Ri(hr(H[1]))?V.concat([new vt(`${K}[1]`,H[1],"expressions are not allowed in function stops.")]):V.concat(Hi({key:`${K}[1]`,value:H[1],valueSpec:r,style:z.style,styleSpec:z.styleSpec}))}function L(z,V){const H=Xt(z.value),K=$i(z.value),ie=null!==z.value?z.value:V;if(c){if(H!==c)return[new vt(z.key,ie,`${H} stop domain type must match previous stop domain type ${c}`)]}else c=H;if("number"!==H&&"string"!==H&&"boolean"!==H&&"number"!=typeof K&&"string"!=typeof K&&"boolean"!=typeof K)return[new vt(z.key,ie,"stop domain value must be a number, string, or boolean")];if("number"!==H&&"categorical"!==a){let ue=`number expected, ${H} found`;return ss(r)&&void 0===a&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new vt(z.key,ie,ue)]}return"categorical"!==a||"number"!==H||"number"==typeof K&&isFinite(K)&&Math.floor(K)===K?"categorical"!==a&&"number"===H&&"number"==typeof K&&"number"==typeof d&&void 0!==d&&K<d?[new vt(z.key,ie,"stop domain values must appear in ascending order")]:(d=K,"categorical"===a&&K in y?[new vt(z.key,ie,"stop domain values must be unique")]:(y[K]=!0,[])):[new vt(z.key,ie,`integer expected, found ${String(K)}`)]}}function vr(o){const r=("property"===o.expressionContext?Mh:Ii)(hr(o.value),o.valueSpec);if("error"===r.result)return r.value.map(c=>new vt(`${o.key}${c.key}`,o.value,c.message));const a=r.value.expression||r.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!a.outputDefined())return[new vt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!jr(a))return[new vt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext)return qc(a,o);if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!jo(a,["zoom","feature-state"]))return[new vt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!ts(a))return[new vt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function qc(o,r){const a=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(r.valueSpec&&r.valueSpec.expression)for(const d of r.valueSpec.expression.parameters)a.delete(d);if(0===a.size)return[];const c=[];return o instanceof Co&&a.has(o.name)?[new vt(r.key,r.value,`["${o.name}"] expression is not supported in a filter for a ${r.object.type} layer with id: ${r.object.id}`)]:(o.eachChild(d=>{c.push(...qc(d,r))}),c)}function jd(o){const r=o.key,a=o.value,c=o.valueSpec,d=[];return Array.isArray(c.values)?-1===c.values.indexOf($i(a))&&d.push(new vt(r,a,`expected one of [${c.values.join(", ")}], ${JSON.stringify(a)} found`)):-1===Object.keys(c.values).indexOf($i(a))&&d.push(new vt(r,a,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(a)} found`)),d}function Wf(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const r of o.slice(1))if(!Wf(r)&&"boolean"!=typeof r)return!1;return!0;default:return!0}}function $d(o,r="fill"){if(null==o)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Wf(o)||(o=hc(o));const a=o;let c=!0;try{c=function(D){if(!Mr(D))return D;let I=hr(D);return Ph(I),I=kl(I),I}(a)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(a,null,2)}\n        `)}const d=Ue[`filter_${r}`],g=Ii(c,d);let y=null;if("error"===g.result)throw new Error(g.value.map(D=>`${D.key}: ${D.message}`).join(", "));y=(D,I,k)=>g.value.evaluate(D,I,{},k);let b=null,E=null;if(c!==a){const D=Ii(a,d);if("error"===D.result)throw new Error(D.value.map(I=>`${I.key}: ${I.message}`).join(", "));b=(I,k,L,z,V)=>D.value.evaluate(I,k,{},L,void 0,void 0,z,V),E=!ts(D.value.expression)}return{filter:y,dynamicFilter:b||void 0,needGeometry:Zf(c),needFeature:!!E}}function kl(o){if(!Array.isArray(o))return o;const r=function(a){if(kh.has(a[0]))for(let c=1;c<a.length;c++)if(Mr(a[c]))return!0;return a}(o);return!0===r?r:r.map(a=>kl(a))}function Ph(o){let r=!1;const a=[];if("case"===o[0]){for(let c=1;c<o.length-1;c+=2)r=r||Mr(o[c]),a.push(o[c+1]);a.push(o[o.length-1])}else if("match"===o[0]){r=r||Mr(o[1]);for(let c=2;c<o.length-1;c+=2)a.push(o[c+1]);a.push(o[o.length-1])}else if("step"===o[0]){r=r||Mr(o[1]);for(let c=1;c<o.length-1;c+=2)a.push(o[c+1])}r&&(o.length=0,o.push("any",...a));for(let c=1;c<o.length;c++)Ph(o[c])}function Mr(o){if(!Array.isArray(o))return!1;if("pitch"===(r=o[0])||"distance-from-center"===r)return!0;var r;for(let a=1;a<o.length;a++)if(Mr(o[a]))return!0;return!1}const kh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Fm(o,r){return o<r?-1:o>r?1:0}function Zf(o){if(!Array.isArray(o))return!1;if("within"===o[0])return!0;for(let r=1;r<o.length;r++)if(Zf(o[r]))return!0;return!1}function hc(o){if(!o)return!0;const r=o[0];return o.length<=1?"any"!==r:"=="===r?Rh(o[1],o[2],"=="):"!="===r?Oh(Rh(o[1],o[2],"==")):"<"===r||">"===r||"<="===r||">="===r?Rh(o[1],o[2],r):"any"===r?(a=o.slice(1),["any"].concat(a.map(hc))):"all"===r?["all"].concat(o.slice(1).map(hc)):"none"===r?["all"].concat(o.slice(1).map(hc).map(Oh)):"in"===r?Hd(o[1],o.slice(2)):"!in"===r?Oh(Hd(o[1],o.slice(2))):"has"===r?Lu(o[1]):"!has"===r?Oh(Lu(o[1])):"within"!==r||o;var a}function Rh(o,r,a){switch(o){case"$type":return[`filter-type-${a}`,r];case"$id":return[`filter-id-${a}`,r];default:return[`filter-${a}`,o,r]}}function Hd(o,r){if(0===r.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some(a=>typeof a!=typeof r[0])?["filter-in-large",o,["literal",r.sort(Fm)]]:["filter-in-small",o,["literal",r]]}}function Lu(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Oh(o){return["!",o]}function ao(o){return Wf(hr(o.value))?vr(ms({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):Wc(o)}function Wc(o){const r=o.value,a=o.key;if("array"!==Xt(r))return[new vt(a,r,`array expected, ${Xt(r)} found`)];const c=o.styleSpec;let d,g=[];if(r.length<1)return[new vt(a,r,"filter array must have at least 1 element")];switch(g=g.concat(jd({key:`${a}[0]`,value:r[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),$i(r[0])){case"<":case"<=":case">":case">=":r.length>=2&&"$type"===$i(r[1])&&g.push(new vt(a,r,`"$type" cannot be use with operator "${r[0]}"`));case"==":case"!=":3!==r.length&&g.push(new vt(a,r,`filter array for operator "${r[0]}" must have 3 elements`));case"in":case"!in":r.length>=2&&(d=Xt(r[1]),"string"!==d&&g.push(new vt(`${a}[1]`,r[1],`string expected, ${d} found`)));for(let y=2;y<r.length;y++)d=Xt(r[y]),"$type"===$i(r[1])?g=g.concat(jd({key:`${a}[${y}]`,value:r[y],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&g.push(new vt(`${a}[${y}]`,r[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<r.length;y++)g=g.concat(Wc({key:`${a}[${y}]`,value:r[y],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":d=Xt(r[1]),2!==r.length?g.push(new vt(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"string"!==d&&g.push(new vt(`${a}[1]`,r[1],`string expected, ${d} found`));break;case"within":d=Xt(r[1]),2!==r.length?g.push(new vt(a,r,`filter array for "${r[0]}" operator must have 2 elements`)):"object"!==d&&g.push(new vt(`${a}[1]`,r[1],`object expected, ${d} found`))}return g}function Fh(o,r){const a=o.key,c=o.style,d=o.styleSpec,g=o.value,y=o.objectKey,b=d[`${r}_${o.layerType}`];if(!b)return[];const E=y.match(/^(.*)-transition$/);if("paint"===r&&E&&b[E[1]]&&b[E[1]].transition)return Hi({key:a,value:g,valueSpec:d.transition,style:c,styleSpec:d});const D=o.valueSpec||b[y];if(!D)return[new vt(a,g,`unknown property "${y}"`)];let I;if("string"===Xt(g)&&ss(D)&&!D.tokens&&(I=/^{([^}]+)}$/.exec(g))){const L=`\`{ "type": "identity", "property": ${I?JSON.stringify(I[1]):'"_"'} }\``;return[new vt(a,g,`"${y}" does not support interpolation syntax\nUse an identity property function instead: ${L}.`)]}const k=[];return"symbol"===o.layerType&&("text-field"===y&&c&&!c.glyphs&&k.push(new vt(a,g,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&Hr(hr(g))&&"identity"===$i(g.type)&&k.push(new vt(a,g,'"text-font" does not support identity functions'))),k.concat(Hi({key:o.key,value:g,valueSpec:D,style:c,styleSpec:d,expressionContext:"property",propertyType:r,propertyKey:y}))}function Ar(o){return Fh(o,"paint")}function Gd(o){return Fh(o,"layout")}function Nu(o){let r=[];const a=o.value,c=o.key,d=o.style,g=o.styleSpec;a.type||a.ref||r.push(new vt(c,a,'either "type" or "ref" is required'));let y=$i(a.type);const b=$i(a.ref);if(a.id){const E=$i(a.id);for(let D=0;D<o.arrayIndex;D++){const I=d.layers[D];$i(I.id)===E&&r.push(new vt(c,a.id,`duplicate layer id "${a.id}", previously used at line ${I.id.__line__}`))}}if("ref"in a){let E;["type","source","source-layer","filter","layout"].forEach(D=>{D in a&&r.push(new vt(c,a[D],`"${D}" is prohibited for ref layers`))}),d.layers.forEach(D=>{$i(D.id)===b&&(E=D)}),E?E.ref?r.push(new vt(c,a.ref,"ref cannot reference another ref layer")):y=$i(E.type):"string"==typeof b&&r.push(new vt(c,a.ref,`ref layer "${b}" not found`))}else if("background"!==y&&"sky"!==y)if(a.source){const E=d.sources&&d.sources[a.source],D=E&&$i(E.type);E?"vector"===D&&"raster"===y?r.push(new vt(c,a.source,`layer "${a.id}" requires a raster source`)):"raster"===D&&"raster"!==y?r.push(new vt(c,a.source,`layer "${a.id}" requires a vector source`)):"vector"!==D||a["source-layer"]?"raster-dem"===D&&"hillshade"!==y?r.push(new vt(c,a.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!a.paint||!a.paint["line-gradient"]&&!a.paint["line-trim-offset"]||"geojson"===D&&E.lineMetrics||r.push(new vt(c,a,`layer "${a.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):r.push(new vt(c,a,`layer "${a.id}" must specify a "source-layer"`)):r.push(new vt(c,a.source,`source "${a.source}" not found`))}else r.push(new vt(c,a,'missing required property "source"'));return r=r.concat(fa({key:c,value:a,valueSpec:g.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Hi({key:`${c}.type`,value:a.type,valueSpec:g.layer.type,style:o.style,styleSpec:o.styleSpec,object:a,objectKey:"type"}),filter:E=>ao(ms({layerType:y},E)),layout:E=>fa({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>Gd(ms({layerType:y},D))}}),paint:E=>fa({layer:a,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>Ar(ms({layerType:y},D))}})}})),r}function fr(o){const r=o.value,a=o.key,c=Xt(r);return"string"!==c?[new vt(a,r,`string expected, ${c} found`)]:[]}const Xf={promoteId:function({key:o,value:r}){if("string"===Xt(r))return fr({key:o,value:r});{const a=[];for(const c in r)a.push(...fr({key:`${o}.${c}`,value:r[c]}));return a}}};function qd(o){const r=o.value,a=o.key,c=o.styleSpec,d=o.style;if(!r.type)return[new vt(a,r,'"type" is required')];const g=$i(r.type);let y;switch(g){case"vector":case"raster":case"raster-dem":return y=fa({key:a,value:r,valueSpec:c[`source_${g.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Xf}),y;case"geojson":if(y=fa({key:a,value:r,valueSpec:c.source_geojson,style:d,styleSpec:c,objectElementValidators:Xf}),r.cluster)for(const b in r.clusterProperties){const[E,D]=r.clusterProperties[b],I="string"==typeof E?[E,["accumulated"],["get",b]]:E;y.push(...vr({key:`${a}.${b}.map`,value:D,expressionContext:"cluster-map"})),y.push(...vr({key:`${a}.${b}.reduce`,value:I,expressionContext:"cluster-reduce"}))}return y;case"video":return fa({key:a,value:r,valueSpec:c.source_video,style:d,styleSpec:c});case"image":return fa({key:a,value:r,valueSpec:c.source_image,style:d,styleSpec:c});case"canvas":return[new vt(a,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return jd({key:`${a}.type`,value:r.type,valueSpec:{values:Zc(c)},style:d,styleSpec:c})}}function Zc(o){return o.source.reduce((r,a)=>{const c=o[a];return"enum"===c.type.type&&(r=r.concat(Object.keys(c.type.values))),r},[])}function Ao(o){const r=o.value,a=o.styleSpec,c=a.light,d=o.style;let g=[];const y=Xt(r);if(void 0===r)return g;if("object"!==y)return g=g.concat([new vt("light",r,`object expected, ${y} found`)]),g;for(const b in r){const E=b.match(/^(.*)-transition$/);g=g.concat(E&&c[E[1]]&&c[E[1]].transition?Hi({key:b,value:r[b],valueSpec:a.transition,style:d,styleSpec:a}):c[b]?Hi({key:b,value:r[b],valueSpec:c[b],style:d,styleSpec:a}):[new vt(b,r[b],`unknown property "${b}"`)])}return g}function Wd(o){const r=o.value,a=o.key,c=o.style,d=o.styleSpec,g=d.terrain;let y=[];const b=Xt(r);if(void 0===r)return y;if("object"!==b)return y=y.concat([new vt("terrain",r,`object expected, ${b} found`)]),y;for(const E in r){const D=E.match(/^(.*)-transition$/);y=y.concat(D&&g[D[1]]&&g[D[1]].transition?Hi({key:E,value:r[E],valueSpec:d.transition,style:c,styleSpec:d}):g[E]?Hi({key:E,value:r[E],valueSpec:g[E],style:c,styleSpec:d}):[new vt(E,r[E],`unknown property "${E}"`)])}if(r.source){const E=c.sources&&c.sources[r.source],D=E&&$i(E.type);E?"raster-dem"!==D&&y.push(new vt(a,r.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):y.push(new vt(a,r.source,`source "${r.source}" not found`))}else y.push(new vt(a,r,'terrain is missing required property "source"'));return y}function Bu(o){const r=o.value,a=o.style,c=o.styleSpec,d=c.fog;let g=[];const y=Xt(r);if(void 0===r)return g;if("object"!==y)return g=g.concat([new vt("fog",r,`object expected, ${y} found`)]),g;for(const b in r){const E=b.match(/^(.*)-transition$/);g=g.concat(E&&d[E[1]]&&d[E[1]].transition?Hi({key:b,value:r[b],valueSpec:c.transition,style:a,styleSpec:c}):d[b]?Hi({key:b,value:r[b],valueSpec:d[b],style:a,styleSpec:c}):[new vt(b,r[b],`unknown property "${b}"`)])}return g}const Kf={"*":()=>[],array:Om,boolean:function(o){const r=o.value,a=o.key,c=Xt(r);return"boolean"!==c?[new vt(a,r,`boolean expected, ${c} found`)]:[]},number:Ah,color:function(o){const r=o.key,a=o.value,c=Xt(a);return"string"!==c?[new vt(r,a,`color expected, ${c} found`)]:null===bh(a)?[new vt(r,a,`color expected, "${a}" found`)]:[]},enum:jd,filter:ao,function:Ih,layer:Nu,object:fa,source:qd,light:Ao,terrain:Wd,fog:Bu,string:fr,formatted:function(o){return 0===fr(o).length?[]:vr(o)},resolvedImage:function(o){return 0===fr(o).length?[]:vr(o)},projection:function(o){const r=o.value,a=o.styleSpec,c=a.projection,d=o.style;let g=[];const y=Xt(r);if("object"===y)for(const b in r)g=g.concat(Hi({key:b,value:r[b],valueSpec:c[b],style:d,styleSpec:a}));else"string"!==y&&(g=g.concat([new vt("projection",r,`object or string expected, ${y} found`)]));return g}};function Hi(o){const r=o.value,a=o.valueSpec,c=o.styleSpec;return a.expression&&Hr($i(r))?Ih(o):a.expression&&Ri(hr(r))?vr(o):a.type&&Kf[a.type]?Kf[a.type](o):fa(ms({},o,{valueSpec:a.type?c[a.type]:a}))}function Yf(o){const r=o.value,a=o.key,c=fr(o);return c.length||(-1===r.indexOf("{fontstack}")&&c.push(new vt(a,r,'"glyphs" url must include a "{fontstack}" token')),-1===r.indexOf("{range}")&&c.push(new vt(a,r,'"glyphs" url must include a "{range}" token'))),c}function Lh(o,r=Ue){return Hs(Hi({key:"",value:o,valueSpec:r.$root,styleSpec:r,style:o,objectElementValidators:{glyphs:Yf,"*":()=>[]}}))}const fn=o=>Hs(Ar(o)),Jf=o=>Hs(Gd(o));function Hs(o){return o.slice().sort((r,a)=>r.line&&a.line?r.line-a.line:0)}function Qf(o,r){let a=!1;if(r&&r.length)for(const c of r)o.fire(new Ls(new Error(c.message))),a=!0;return a}var Lm=qs,Gs=3;function qs(o,r,a){var c=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var d=new Int32Array(this.arrayBuffer);o=d[0],this.d=(r=d[1])+2*(a=d[2]);for(var g=0;g<this.d*this.d;g++){var y=d[Gs+g],b=d[Gs+g+1];c.push(y===b?null:d.subarray(y,b))}var E=d[Gs+c.length+1];this.keys=d.subarray(d[Gs+c.length],E),this.bboxes=d.subarray(E),this.insert=this._insertReadonly}else{this.d=r+2*a;for(var D=0;D<this.d*this.d;D++)c.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=o,this.padding=a,this.scale=r/o,this.uid=0;var I=a/r*o;this.min=-I,this.max=o+I}qs.prototype.insert=function(o,r,a,c,d){this._forEachCell(r,a,c,d,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(c),this.bboxes.push(d)},qs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},qs.prototype._insertCell=function(o,r,a,c,d,g){this.cells[d].push(g)},qs.prototype.query=function(o,r,a,c,d){var g=this.min,y=this.max;if(o<=g&&r<=g&&y<=a&&y<=c&&!d)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(o,r,a,c,this._queryCell,b,{},d),b},qs.prototype._queryCell=function(o,r,a,c,d,g,y,b){var E=this.cells[d];if(null!==E)for(var D=this.keys,I=this.bboxes,k=0;k<E.length;k++){var L=E[k];if(void 0===y[L]){var z=4*L;(b?b(I[z+0],I[z+1],I[z+2],I[z+3]):o<=I[z+2]&&r<=I[z+3]&&a>=I[z+0]&&c>=I[z+1])?(y[L]=!0,g.push(D[L])):y[L]=!1}}},qs.prototype._forEachCell=function(o,r,a,c,d,g,y,b){for(var E=this._convertToCellCoord(o),D=this._convertToCellCoord(r),I=this._convertToCellCoord(a),k=this._convertToCellCoord(c),L=E;L<=I;L++)for(var z=D;z<=k;z++){var V=this.d*z+L;if((!b||b(this._convertFromCellCoord(L),this._convertFromCellCoord(z),this._convertFromCellCoord(L+1),this._convertFromCellCoord(z+1)))&&d.call(this,o,r,a,c,V,g,y,b))return}},qs.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},qs.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},qs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,r=Gs+this.cells.length+1+1,a=0,c=0;c<this.cells.length;c++)a+=this.cells[c].length;var d=new Int32Array(r+a+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var g=r,y=0;y<o.length;y++){var b=o[y];d[Gs+y]=g,d.set(b,g),g+=b.length}return d[Gs+o.length]=g,d.set(this.keys,g),d[Gs+o.length+1]=g+=this.keys.length,d.set(this.bboxes,g),g+=this.bboxes.length,d.buffer};var dc=Er(Lm);const Nh={};function De(o,r,a={}){Object.defineProperty(o,"_classRegistryKey",{value:r,writeable:!1}),Nh[r]={klass:o,omit:a.omit||[]}}De(Object,"Object"),dc.serialize=function(o,r){const a=o.toArrayBuffer();return r&&r.push(a),{buffer:a}},dc.deserialize=function(o){return new dc(o.buffer)},Object.defineProperty(dc,"name",{value:"Grid"}),De(dc,"Grid"),De(kn,"Color"),De(Error,"Error"),De(aa,"AJAXError"),De(es,"ResolvedImage"),De(Vd,"StylePropertyFunction"),De(Hn,"StyleExpression",{omit:["_evaluator"]}),De(Pl,"ZoomDependentExpression"),De(Xa,"ZoomConstantExpression"),De(Co,"CompoundExpression",{omit:["_evaluate"]});for(const o in vi)Nh[vi[o]._classRegistryKey]||De(vi[o],`Expression${o}`);function Rn(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function Zd(o){return Ke.ImageBitmap&&o instanceof Ke.ImageBitmap}function Xc(o,r){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(Rn(o)||Zd(o))return r&&r.push(o),o;if(ArrayBuffer.isView(o)){const a=o;return r&&r.push(a.buffer),a}if(o instanceof Ke.ImageData)return r&&r.push(o.data.buffer),o;if(Array.isArray(o)){const a=[];for(const c of o)a.push(Xc(c,r));return a}if("object"==typeof o){const a=o.constructor,c=a._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const d=a.serialize?a.serialize(o,r):{};if(!a.serialize){for(const g in o)o.hasOwnProperty(g)&&(Nh[c].omit.indexOf(g)>=0||(d[g]=Xc(o[g],r)));o instanceof Error&&(d.message=o.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof o)}function Gi(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||Rn(o)||Zd(o)||ArrayBuffer.isView(o)||o instanceof Ke.ImageData)return o;if(Array.isArray(o))return o.map(Gi);if("object"==typeof o){const r=o.$name||"Object",{klass:a}=Nh[r];if(!a)throw new Error(`can't deserialize unregistered class ${r}`);if(a.deserialize)return a.deserialize(o);const c=Object.create(a.prototype);for(const d of Object.keys(o))"$name"!==d&&(c[d]=Gi(o[d]));return c}throw new Error("can't deserialize object of type "+typeof o)}const yt={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function fc(o){for(const r of o)if(zu(r.charCodeAt(0)))return!0;return!1}function pa(o){for(const r of o)if(!Bh(r.charCodeAt(0)))return!1;return!0}function Bh(o){return!(yt.Arabic(o)||yt["Arabic Supplement"](o)||yt["Arabic Extended-A"](o)||yt["Arabic Presentation Forms-A"](o)||yt["Arabic Presentation Forms-B"](o))}function zu(o){return!(746!==o&&747!==o&&(o<4352||!(yt["Bopomofo Extended"](o)||yt.Bopomofo(o)||yt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||yt["CJK Compatibility Ideographs"](o)||yt["CJK Compatibility"](o)||yt["CJK Radicals Supplement"](o)||yt["CJK Strokes"](o)||!(!yt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||yt["CJK Unified Ideographs Extension A"](o)||yt["CJK Unified Ideographs"](o)||yt["Enclosed CJK Letters and Months"](o)||yt["Hangul Compatibility Jamo"](o)||yt["Hangul Jamo Extended-A"](o)||yt["Hangul Jamo Extended-B"](o)||yt["Hangul Jamo"](o)||yt["Hangul Syllables"](o)||yt.Hiragana(o)||yt["Ideographic Description Characters"](o)||yt.Kanbun(o)||yt["Kangxi Radicals"](o)||yt["Katakana Phonetic Extensions"](o)||yt.Katakana(o)&&12540!==o||!(!yt["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!yt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||yt["Unified Canadian Aboriginal Syllabics"](o)||yt["Unified Canadian Aboriginal Syllabics Extended"](o)||yt["Vertical Forms"](o)||yt["Yijing Hexagram Symbols"](o)||yt["Yi Syllables"](o)||yt["Yi Radicals"](o))))}function ep(o){return!(zu(o)||(r=o,yt["Latin-1 Supplement"](r)&&(167===r||169===r||174===r||177===r||188===r||189===r||190===r||215===r||247===r)||yt["General Punctuation"](r)&&(8214===r||8224===r||8225===r||8240===r||8241===r||8251===r||8252===r||8258===r||8263===r||8264===r||8265===r||8273===r)||yt["Letterlike Symbols"](r)||yt["Number Forms"](r)||yt["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||9003===r||r>=9085&&r<=9114||r>=9150&&r<=9165||9167===r||r>=9169&&r<=9179||r>=9186&&r<=9215)||yt["Control Pictures"](r)&&9251!==r||yt["Optical Character Recognition"](r)||yt["Enclosed Alphanumerics"](r)||yt["Geometric Shapes"](r)||yt["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||yt["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||yt["CJK Symbols and Punctuation"](r)||yt.Katakana(r)||yt["Private Use Area"](r)||yt["CJK Compatibility Forms"](r)||yt["Small Form Variants"](r)||yt["Halfwidth and Fullwidth Forms"](r)||8734===r||8756===r||8757===r||r>=9984&&r<=10087||r>=10102&&r<=10131||65532===r||65533===r));var r}function Nm(o){return o>=1424&&o<=2303||yt["Arabic Presentation Forms-A"](o)||yt["Arabic Presentation Forms-B"](o)}function tp(o,r){return!(!r&&Nm(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||yt.Khmer(o))}function Io(o){for(const r of o)if(Nm(r.charCodeAt(0)))return!0;return!1}const Ws="deferred",zh="loading",Rl="loaded";let Go=null,m="unavailable",l=null;const h=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(m="error"),Go&&Go(o)};function _(){x.fire(new Ra("pluginStateChange",{pluginStatus:m,pluginURL:l}))}const x=new oc,w=function(){return m},T=function(){if(m!==Ws||!l)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");m=zh,_(),l&&vl({url:l},o=>{o?h(o):(m=Rl,_())})},S={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>m===Rl||null!=S.applyArabicShaping,isLoading:()=>m===zh,setState(o){m=o.pluginStatus,l=o.pluginURL},isParsed:()=>null!=S.applyArabicShaping&&null!=S.processBidirectionalText&&null!=S.processStyledBidirectionalText,getPluginURL:()=>l};class P{constructor(r,a){this.zoom=r,a?(this.now=a.now,this.fadeDuration=a.fadeDuration,this.transition=a.transition,this.pitch=a.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(r){return function(a,c){for(const d of a)if(!tp(d.charCodeAt(0),c))return!1;return!0}(r,S.isLoaded())}}class B{constructor(r,a){this.property=r,this.value=a,this.expression=function(c,d){if(Hr(c))return new Vd(c,d);if(Ri(c)){const g=Mh(c,d);if("error"===g.result)throw new Error(g.value.map(y=>`${y.key}: ${y.message}`).join(", "));return g.value}{let g=c;return"string"==typeof c&&"color"===d.type&&(g=kn.parse(c)),{kind:"constant",evaluate:()=>g}}}(void 0===a?r.specification.default:a,r.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(r,a,c){return this.property.possiblyEvaluate(this,r,a,c)}}class N{constructor(r){this.property=r,this.value=new B(r,void 0)}transitioned(r,a){return new X(this.property,this.value,a,Ei({},r.transition,this.transition),r.now)}untransitioned(){return new X(this.property,this.value,null,{},0)}}class j{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues)}getValue(r){return Vi(this._values[r].value.value)}setValue(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new N(this._values[r].property)),this._values[r].value=new B(this._values[r].property,null===a?void 0:Vi(a))}getTransition(r){return Vi(this._values[r].transition)}setTransition(r,a){this._values.hasOwnProperty(r)||(this._values[r]=new N(this._values[r].property)),this._values[r].transition=Vi(a)||void 0}serialize(){const r={};for(const a of Object.keys(this._values)){const c=this.getValue(a);void 0!==c&&(r[a]=c);const d=this.getTransition(a);void 0!==d&&(r[`${a}-transition`]=d)}return r}transitioned(r,a){const c=new J(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].transitioned(r,a._values[d]);return c}untransitioned(){const r=new J(this._properties);for(const a of Object.keys(this._values))r._values[a]=this._values[a].untransitioned();return r}}class X{constructor(r,a,c,d,g){const y=d.delay||0,b=d.duration||0;g=g||0,this.property=r,this.value=a,this.begin=g+y,this.end=this.begin+b,r.specification.transition&&(d.delay||d.duration)&&(this.prior=c)}possiblyEvaluate(r,a,c){const d=r.now||0,g=this.value.possiblyEvaluate(r,a,c),y=this.prior;if(y){if(d>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(d<this.begin)return y.possiblyEvaluate(r,a,c);{const b=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(r,a,c),g,ec(b))}}return g}}class J{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,a,c){const d=new re(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(r,a,c);return d}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class te{constructor(r){this._properties=r,this._values=Object.create(r.defaultPropertyValues)}getValue(r){return Vi(this._values[r].value)}setValue(r,a){this._values[r]=new B(this._values[r].property,null===a?void 0:Vi(a))}serialize(){const r={};for(const a of Object.keys(this._values)){const c=this.getValue(a);void 0!==c&&(r[a]=c)}return r}possiblyEvaluate(r,a,c){const d=new re(this._properties);for(const g of Object.keys(this._values))d._values[g]=this._values[g].possiblyEvaluate(r,a,c);return d}}class ee{constructor(r,a,c){this.property=r,this.value=a,this.parameters=c}isConstant(){return"constant"===this.value.kind}constantOr(r){return"constant"===this.value.kind?this.value.value:r}evaluate(r,a,c,d){return this.property.evaluate(this.value,this.parameters,r,a,c,d)}}class re{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class ${constructor(r){this.specification=r}possiblyEvaluate(r,a){return r.expression.evaluate(a)}interpolate(r,a,c){const d=To[this.specification.type];return d?d(r,a,c):r}}class Y{constructor(r,a){this.specification=r,this.overrides=a}possiblyEvaluate(r,a,c,d){return new ee(this,"constant"===r.expression.kind||"camera"===r.expression.kind?{kind:"constant",value:r.expression.evaluate(a,null,{},c,d)}:r.expression,a)}interpolate(r,a,c){if("constant"!==r.value.kind||"constant"!==a.value.kind)return r;if(void 0===r.value.value||void 0===a.value.value)return new ee(this,{kind:"constant",value:void 0},r.parameters);const d=To[this.specification.type];return d?new ee(this,{kind:"constant",value:d(r.value.value,a.value.value,c)},r.parameters):r}evaluate(r,a,c,d,g,y){return"constant"===r.kind?r.value:r.evaluate(a,c,d,g,y)}}class ae{constructor(r){this.specification=r}possiblyEvaluate(r,a,c,d){return!!r.expression.evaluate(a,null,{},c,d)}interpolate(){return!1}}class oe{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const a=new P(0,{});for(const c in r){const d=r[c];d.specification.overridable&&this.overridableProperties.push(c);const g=this.defaultPropertyValues[c]=new B(d,void 0),y=this.defaultTransitionablePropertyValues[c]=new N(d);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=g.possiblyEvaluate(a)}}}function _e(o,r){return 256*(o=zt(Math.floor(o),0,255))+zt(Math.floor(r),0,255)}De(Y,"DataDrivenProperty"),De($,"DataConstantProperty"),De(ae,"ColorRampProperty");const ve={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ye{constructor(r,a){this._structArray=r,this._pos1=a*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ce{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(r,a){return r._trim(),a&&(r.isTransferred=!0,a.push(r.arrayBuffer)),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const a=Object.create(this.prototype);return a.arrayBuffer=r.arrayBuffer,a.length=r.length,a.capacity=r.arrayBuffer.byteLength/a.bytesPerElement,a._refreshViews(),a}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const a=this.uint8;this._refreshViews(),a&&this.uint8.set(a)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function we(o,r=1){let a=0,c=0;return{members:o.map(d=>{const g=ve[d.type].BYTES_PER_ELEMENT,y=a=ke(a,Math.max(r,g)),b=d.components||1;return c=Math.max(c,g),a+=g*b,{name:d.name,type:d.type,components:b,offset:y}}),size:ke(a,Math.max(c,r)),alignment:r}}function ke(o,r){return Math.ceil(o/r)*r}class tt extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a){const c=this.length;return this.resize(c+1),this.emplace(c,r,a)}emplace(r,a,c){const d=2*r;return this.int16[d+0]=a,this.int16[d+1]=c,r}}tt.prototype.bytesPerElement=4,De(tt,"StructArrayLayout2i4");class Ie extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,c){const d=this.length;return this.resize(d+1),this.emplace(d,r,a,c)}emplace(r,a,c,d){const g=3*r;return this.int16[g+0]=a,this.int16[g+1]=c,this.int16[g+2]=d,r}}Ie.prototype.bytesPerElement=6,De(Ie,"StructArrayLayout3i6");class qe extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,c,d)}emplace(r,a,c,d,g){const y=4*r;return this.int16[y+0]=a,this.int16[y+1]=c,this.int16[y+2]=d,this.int16[y+3]=g,r}}qe.prototype.bytesPerElement=8,De(qe,"StructArrayLayout4i8");class Fe extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,c,d,g,y,b)}emplace(r,a,c,d,g,y,b,E){const D=6*r,I=12*r,k=3*r;return this.int16[D+0]=a,this.int16[D+1]=c,this.uint8[I+4]=d,this.uint8[I+5]=g,this.uint8[I+6]=y,this.uint8[I+7]=b,this.float32[k+2]=E,r}}Fe.prototype.bytesPerElement=12,De(Fe,"StructArrayLayout2i4ub1f12");class nt extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,c,d)}emplace(r,a,c,d,g){const y=4*r;return this.float32[y+0]=a,this.float32[y+1]=c,this.float32[y+2]=d,this.float32[y+3]=g,r}}nt.prototype.bytesPerElement=16,De(nt,"StructArrayLayout4f16");class Pe extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,c,d,g)}emplace(r,a,c,d,g,y){const b=6*r,E=3*r;return this.uint16[b+0]=a,this.uint16[b+1]=c,this.uint16[b+2]=d,this.uint16[b+3]=g,this.float32[E+2]=y,r}}Pe.prototype.bytesPerElement=12,De(Pe,"StructArrayLayout4ui1f12");class He extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,c,d)}emplace(r,a,c,d,g){const y=4*r;return this.uint16[y+0]=a,this.uint16[y+1]=c,this.uint16[y+2]=d,this.uint16[y+3]=g,r}}He.prototype.bytesPerElement=8,De(He,"StructArrayLayout4ui8");class it extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,a,c,d,g,y)}emplace(r,a,c,d,g,y,b){const E=6*r;return this.int16[E+0]=a,this.int16[E+1]=c,this.int16[E+2]=d,this.int16[E+3]=g,this.int16[E+4]=y,this.int16[E+5]=b,r}}it.prototype.bytesPerElement=12,De(it,"StructArrayLayout6i12");class Je extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b,E,D,I,k,L){const z=this.length;return this.resize(z+1),this.emplace(z,r,a,c,d,g,y,b,E,D,I,k,L)}emplace(r,a,c,d,g,y,b,E,D,I,k,L,z){const V=12*r;return this.int16[V+0]=a,this.int16[V+1]=c,this.int16[V+2]=d,this.int16[V+3]=g,this.uint16[V+4]=y,this.uint16[V+5]=b,this.uint16[V+6]=E,this.uint16[V+7]=D,this.int16[V+8]=I,this.int16[V+9]=k,this.int16[V+10]=L,this.int16[V+11]=z,r}}Je.prototype.bytesPerElement=24,De(Je,"StructArrayLayout4i4ui4i24");class at extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y){const b=this.length;return this.resize(b+1),this.emplace(b,r,a,c,d,g,y)}emplace(r,a,c,d,g,y,b){const E=10*r,D=5*r;return this.int16[E+0]=a,this.int16[E+1]=c,this.int16[E+2]=d,this.float32[D+2]=g,this.float32[D+3]=y,this.float32[D+4]=b,r}}at.prototype.bytesPerElement=20,De(at,"StructArrayLayout3i3f20");class St extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint32[1*r+0]=a,r}}St.prototype.bytesPerElement=4,De(St,"StructArrayLayout1ul4");class Gt extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b,E,D,I,k,L,z){const V=this.length;return this.resize(V+1),this.emplace(V,r,a,c,d,g,y,b,E,D,I,k,L,z)}emplace(r,a,c,d,g,y,b,E,D,I,k,L,z,V){const H=20*r,K=10*r;return this.int16[H+0]=a,this.int16[H+1]=c,this.int16[H+2]=d,this.int16[H+3]=g,this.int16[H+4]=y,this.float32[K+3]=b,this.float32[K+4]=E,this.float32[K+5]=D,this.float32[K+6]=I,this.int16[H+14]=k,this.uint32[K+8]=L,this.uint16[H+18]=z,this.uint16[H+19]=V,r}}Gt.prototype.bytesPerElement=40,De(Gt,"StructArrayLayout5i4f1i1ul2ui40");class wt extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b){const E=this.length;return this.resize(E+1),this.emplace(E,r,a,c,d,g,y,b)}emplace(r,a,c,d,g,y,b,E){const D=8*r;return this.int16[D+0]=a,this.int16[D+1]=c,this.int16[D+2]=d,this.int16[D+4]=g,this.int16[D+5]=y,this.int16[D+6]=b,this.int16[D+7]=E,r}}wt.prototype.bytesPerElement=16,De(wt,"StructArrayLayout3i2i2i16");class kt extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,c,d,g)}emplace(r,a,c,d,g,y){const b=4*r,E=8*r;return this.float32[b+0]=a,this.float32[b+1]=c,this.float32[b+2]=d,this.int16[E+6]=g,this.int16[E+7]=y,r}}kt.prototype.bytesPerElement=16,De(kt,"StructArrayLayout2f1f2i16");class vn extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,c,d)}emplace(r,a,c,d,g){const y=12*r,b=3*r;return this.uint8[y+0]=a,this.uint8[y+1]=c,this.float32[b+1]=d,this.float32[b+2]=g,r}}vn.prototype.bytesPerElement=12,De(vn,"StructArrayLayout2ub2f12");class gn extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c){const d=this.length;return this.resize(d+1),this.emplace(d,r,a,c)}emplace(r,a,c,d){const g=3*r;return this.float32[g+0]=a,this.float32[g+1]=c,this.float32[g+2]=d,r}}gn.prototype.bytesPerElement=12,De(gn,"StructArrayLayout3f12");class Ct extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,c){const d=this.length;return this.resize(d+1),this.emplace(d,r,a,c)}emplace(r,a,c,d){const g=3*r;return this.uint16[g+0]=a,this.uint16[g+1]=c,this.uint16[g+2]=d,r}}Ct.prototype.bytesPerElement=6,De(Ct,"StructArrayLayout3ui6");class Gn extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me){const pe=this.length;return this.resize(pe+1),this.emplace(pe,r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me)}emplace(r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me,pe){const Ae=30*r,Me=15*r,Ve=60*r;return this.int16[Ae+0]=a,this.int16[Ae+1]=c,this.int16[Ae+2]=d,this.float32[Me+2]=g,this.float32[Me+3]=y,this.uint16[Ae+8]=b,this.uint16[Ae+9]=E,this.uint32[Me+5]=D,this.uint32[Me+6]=I,this.uint32[Me+7]=k,this.uint16[Ae+16]=L,this.uint16[Ae+17]=z,this.uint16[Ae+18]=V,this.float32[Me+10]=H,this.float32[Me+11]=K,this.uint8[Ve+48]=ie,this.uint8[Ve+49]=ue,this.uint8[Ve+50]=ne,this.uint32[Me+13]=ce,this.int16[Ae+28]=me,this.uint8[Ve+58]=pe,r}}Gn.prototype.bytesPerElement=60,De(Gn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ii extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me,pe,Ae,Me,Ve,et,Re,We,Ze,Qe){const rt=this.length;return this.resize(rt+1),this.emplace(rt,r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me,pe,Ae,Me,Ve,et,Re,We,Ze,Qe)}emplace(r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K,ie,ue,ne,ce,me,pe,Ae,Me,Ve,et,Re,We,Ze,Qe,rt){const Ne=38*r,mt=19*r;return this.int16[Ne+0]=a,this.int16[Ne+1]=c,this.int16[Ne+2]=d,this.float32[mt+2]=g,this.float32[mt+3]=y,this.int16[Ne+8]=b,this.int16[Ne+9]=E,this.int16[Ne+10]=D,this.int16[Ne+11]=I,this.int16[Ne+12]=k,this.int16[Ne+13]=L,this.uint16[Ne+14]=z,this.uint16[Ne+15]=V,this.uint16[Ne+16]=H,this.uint16[Ne+17]=K,this.uint16[Ne+18]=ie,this.uint16[Ne+19]=ue,this.uint16[Ne+20]=ne,this.uint16[Ne+21]=ce,this.uint16[Ne+22]=me,this.uint16[Ne+23]=pe,this.uint16[Ne+24]=Ae,this.uint16[Ne+25]=Me,this.uint16[Ne+26]=Ve,this.uint16[Ne+27]=et,this.uint16[Ne+28]=Re,this.uint32[mt+15]=We,this.float32[mt+16]=Ze,this.float32[mt+17]=Qe,this.float32[mt+18]=rt,r}}ii.prototype.bytesPerElement=76,De(ii,"StructArrayLayout3i2f6i15ui1ul3f76");class qn extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.float32[1*r+0]=a,r}}qn.prototype.bytesPerElement=4,De(qn,"StructArrayLayout1f4");class ri extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a,c,d,g){const y=this.length;return this.resize(y+1),this.emplace(y,r,a,c,d,g)}emplace(r,a,c,d,g,y){const b=5*r;return this.float32[b+0]=a,this.float32[b+1]=c,this.float32[b+2]=d,this.float32[b+3]=g,this.float32[b+4]=y,r}}ri.prototype.bytesPerElement=20,De(ri,"StructArrayLayout5f20");class Gr extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a,c,d){const g=this.length;return this.resize(g+1),this.emplace(g,r,a,c,d)}emplace(r,a,c,d,g){const y=6*r;return this.uint32[3*r+0]=a,this.uint16[y+2]=c,this.uint16[y+3]=d,this.uint16[y+4]=g,r}}Gr.prototype.bytesPerElement=12,De(Gr,"StructArrayLayout1ul3ui12");class rr extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,a){const c=this.length;return this.resize(c+1),this.emplace(c,r,a)}emplace(r,a,c){const d=2*r;return this.uint16[d+0]=a,this.uint16[d+1]=c,r}}rr.prototype.bytesPerElement=4,De(rr,"StructArrayLayout2ui4");class xs extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const a=this.length;return this.resize(a+1),this.emplace(a,r)}emplace(r,a){return this.uint16[1*r+0]=a,r}}xs.prototype.bytesPerElement=2,De(xs,"StructArrayLayout1ui2");class as extends Ce{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,a){const c=this.length;return this.resize(c+1),this.emplace(c,r,a)}emplace(r,a,c){const d=2*r;return this.float32[d+0]=a,this.float32[d+1]=c,r}}as.prototype.bytesPerElement=8,De(as,"StructArrayLayout2f8");class xi extends ye{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}xi.prototype.size=40;class Yn extends Gt{get(r){return new xi(this,r)}}De(Yn,"CollisionBoxArray");class Wn extends ye{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}Wn.prototype.size=60;class Yi extends Gn{get(r){return new Wn(this,r)}}De(Yi,"PlacedSymbolArray");class lo extends ye{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(r){this._structArray.uint32[this._pos4+15]=r}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}lo.prototype.size=76;class Si extends ii{get(r){return new lo(this,r)}}De(Si,"SymbolInstanceArray");class qi extends qn{getoffsetX(r){return this.float32[1*r+0]}}De(qi,"GlyphOffsetArray");class Vh extends tt{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}De(Vh,"SymbolLineVertexArray");class ma extends ye{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ma.prototype.size=12;class pc extends Gr{get(r){return new ma(this,r)}}De(pc,"FeatureIndexArray");class ga extends rr{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}De(ga,"FillExtrusionCentroidArray");const _a=we([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ka=we([{name:"a_dash",components:4,type:"Uint16"}]);var Uh={exports:{}},zm=function(o,r){var a,c,d,g,y,b,E,D;for(c=o.length-(a=3&o.length),d=r,y=3432918353,b=461845907,D=0;D<c;)E=255&o.charCodeAt(D)|(255&o.charCodeAt(++D))<<8|(255&o.charCodeAt(++D))<<16|(255&o.charCodeAt(++D))<<24,++D,d=27492+(65535&(g=5*(65535&(d=(d^=E=(65535&(E=(E=(65535&E)*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(E=0,a){case 3:E^=(255&o.charCodeAt(D+2))<<16;case 2:E^=(255&o.charCodeAt(D+1))<<8;case 1:d^=E=(65535&(E=(E=(65535&(E^=255&o.charCodeAt(D)))*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return d^=o.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0},Qx=function(o,r){for(var a,c=o.length,d=r^c,g=0;c>=4;)a=1540483477*(65535&(a=255&o.charCodeAt(g)|(255&o.charCodeAt(++g))<<8|(255&o.charCodeAt(++g))<<16|(255&o.charCodeAt(++g))<<24))+((1540483477*(a>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(a=1540483477*(65535&(a^=a>>>24))+((1540483477*(a>>>16)&65535)<<16)),c-=4,++g;switch(c){case 3:d^=(255&o.charCodeAt(g+2))<<16;case 2:d^=(255&o.charCodeAt(g+1))<<8;case 1:d=1540483477*(65535&(d^=255&o.charCodeAt(g)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};Uh.exports=zm,Uh.exports.murmur3=zm,Uh.exports.murmur2=Qx;var $h=Er(Uh.exports);class Ol{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(r,a,c,d){this.ids.push(Ty(r)),this.positions.push(a,c,d)}getPositions(r){const a=Ty(r);let c=0,d=this.ids.length-1;for(;c<d;){const y=c+d>>1;this.ids[y]>=a?d=y:c=y+1}const g=[];for(;this.ids[c]===a;)g.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return g}static serialize(r,a){const c=new Float64Array(r.ids),d=new Uint32Array(r.positions);return np(c,d,0,c.length-1),a&&a.push(c.buffer,d.buffer),{ids:c,positions:d}}static deserialize(r){const a=new Ol;return a.ids=r.ids,a.positions=r.positions,a.indexed=!0,a}}function Ty(o){const r=+o;return!isNaN(r)&&Number.MIN_SAFE_INTEGER<=r&&r<=Number.MAX_SAFE_INTEGER?r:$h(String(o))}function np(o,r,a,c){for(;a<c;){const d=o[a+c>>1];let g=a-1,y=c+1;for(;;){do{g++}while(o[g]<d);do{y--}while(o[y]>d);if(g>=y)break;Xd(o,g,y),Xd(r,3*g,3*y),Xd(r,3*g+1,3*y+1),Xd(r,3*g+2,3*y+2)}y-a<c-y?(np(o,r,a,y),a=y+1):(np(o,r,y+1,c),c=y)}}function Xd(o,r,a){const c=o[r];o[r]=o[a],o[a]=c}De(Ol,"FeaturePositionMap");class bs{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,a){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,a),this.initialized=!0),!!this.location}}class ip extends bs{constructor(r){super(r),this.current=0}set(r,a,c){this.fetchUniformLocation(r,a)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class co extends bs{constructor(r){super(r),this.current=[0,0,0,0]}set(r,a,c){this.fetchUniformLocation(r,a)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class rp extends bs{constructor(r){super(r),this.current=kn.transparent}set(r,a,c){this.fetchUniformLocation(r,a)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const eb=new Float32Array(16),Sy=new Float32Array(9),op=new Float32Array(4);function Yc(o){return[_e(255*o.r,255*o.g),_e(255*o.b,255*o.a)]}class Fl{constructor(r,a,c){this.value=r,this.uniformNames=a.map(d=>`u_${d}`),this.type=c}setUniform(r,a,c,d,g){a.set(r,g,d.constantOr(this.value))}getBinding(r,a){return"color"===this.type?new rp(r):new ip(r)}}class Ya{constructor(r,a){this.uniformNames=a.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(r){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br)}setUniform(r,a,c,d,g){const y="u_pattern"===g||"u_dash"===g?this.pattern:"u_pixel_ratio"===g?this.pixelRatio:null;y&&a.set(r,g,y)}getBinding(r,a){return"u_pattern"===a||"u_dash"===a?new co(r):new ip(r)}}class Ll{constructor(r,a,c,d){this.expression=r,this.type=c,this.maxValue=0,this.paintVertexAttributes=a.map(g=>({name:`a_${g}`,type:"Float32",components:"color"===c?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(r,a,c,d,g,y){const b=this.paintVertexArray.length,E=this.expression.evaluate(new P(0),a,{},g,d,y);this.paintVertexArray.resize(r),this._setPaintValue(b,r,E)}updatePaintArray(r,a,c,d,g){const y=this.expression.evaluate({zoom:0},c,d,void 0,g);this._setPaintValue(r,a,y)}_setPaintValue(r,a,c){if("color"===this.type){const d=Yc(c);for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,d[0],d[1])}else{for(let d=r;d<a;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Zs{constructor(r,a,c,d,g,y){this.expression=r,this.uniformNames=a.map(b=>`u_${b}_t`),this.type=c,this.useIntegerZoom=d,this.zoom=g,this.maxValue=0,this.paintVertexAttributes=a.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===c?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(r,a,c,d,g,y){const b=this.expression.evaluate(new P(this.zoom),a,{},g,d,y),E=this.expression.evaluate(new P(this.zoom+1),a,{},g,d,y),D=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(D,r,b,E)}updatePaintArray(r,a,c,d,g){const y=this.expression.evaluate({zoom:this.zoom},c,d,void 0,g),b=this.expression.evaluate({zoom:this.zoom+1},c,d,void 0,g);this._setPaintValue(r,a,y,b)}_setPaintValue(r,a,c,d){if("color"===this.type){const g=Yc(c),y=Yc(d);for(let b=r;b<a;b++)this.paintVertexArray.emplace(b,g[0],g[1],y[0],y[1])}else{for(let g=r;g<a;g++)this.paintVertexArray.emplace(g,c,d);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(d))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,a,c,d,g){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,b=zt(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);a.set(r,g,b)}getBinding(r,a){return new ip(r)}}class Xs{constructor(r,a,c,d,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=("array"===c?Ka:_a).members;for(let y=0;y<a.length;++y);this.paintVertexArray=new d}populatePaintArray(r,a,c){const d=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(d,r,a.patterns&&a.patterns[this.layerId],c)}updatePaintArray(r,a,c,d,g,y){this._setPaintValues(r,a,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(r,a,c,d){if(!d||!c)return;const g=d[c];if(!g)return;const{tl:y,br:b,pixelRatio:E}=g;for(let D=r;D<a;D++)this.paintVertexArray.emplace(D,y[0],y[1],b[0],b[1],E)}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Vu{constructor(r,a,c=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const g in r.paint._values){if(!c(g))continue;const y=r.paint.get(g);if(!(y instanceof ee&&ss(y.property.specification)))continue;const b=EC(g,r.type),E=y.value,D=y.property.specification.type,I=!!y.property.useIntegerZoom,k="line-dasharray"===g||g.endsWith("pattern"),L="line-dasharray"===g&&"constant"!==r.layout.get("line-cap").value.kind;if("constant"!==E.kind||L)if("source"===E.kind||L||k){const z=tb(g,D,"source");this.binders[g]=k?new Xs(E,b,D,z,r.id):new Ll(E,b,D,z),d.push(`/a_${g}`)}else{const z=tb(g,D,"composite");this.binders[g]=new Zs(E,b,D,I,a,z),d.push(`/z_${g}`)}else this.binders[g]=k?new Ya(E.value,b):new Fl(E.value,b,D),d.push(`/u_${g}`)}this.cacheKey=d.sort().join("")}getMaxValue(r){const a=this.binders[r];return a instanceof Ll||a instanceof Zs?a.maxValue:0}populatePaintArrays(r,a,c,d,g,y){for(const b in this.binders){const E=this.binders[b];(E instanceof Ll||E instanceof Zs||E instanceof Xs)&&E.populatePaintArray(r,a,c,d,g,y)}}setConstantPatternPositions(r){for(const a in this.binders){const c=this.binders[a];c instanceof Ya&&c.setConstantPatternPositions(r)}}updatePaintArrays(r,a,c,d,g,y){let b=!1;for(const E in r){const D=a.getPositions(E);for(const I of D){const k=c.feature(I.index);for(const L in this.binders){const z=this.binders[L];if((z instanceof Ll||z instanceof Zs||z instanceof Xs)&&!0===z.expression.isStateDependent){const V=d.paint.get(L);z.expression=V.value,z.updatePaintArray(I.start,I.end,k,r[E],g,y),b=!0}}}}return b}defines(){const r=[];for(const a in this.binders){const c=this.binders[a];(c instanceof Fl||c instanceof Ya)&&r.push(...c.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return r}getBinderAttributes(){const r=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof Ll||c instanceof Zs||c instanceof Xs)for(let d=0;d<c.paintVertexAttributes.length;d++)r.push(c.paintVertexAttributes[d].name)}return r}getBinderUniforms(){const r=[];for(const a in this.binders){const c=this.binders[a];if(c instanceof Fl||c instanceof Ya||c instanceof Zs)for(const d of c.uniformNames)r.push(d)}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const a=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof Fl||d instanceof Ya||d instanceof Zs)for(const g of d.uniformNames)a.push({name:g,property:c,binding:d.getBinding(r,g)})}return a}setUniforms(r,a,c,d,g){for(const{name:y,property:b,binding:E}of c)this.binders[b].setUniform(r,E,g,d.get(b),y)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const a=this.binders[r];(a instanceof Ll||a instanceof Zs||a instanceof Xs)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(r){for(const a in this.binders){const c=this.binders[a];(c instanceof Ll||c instanceof Zs||c instanceof Xs)&&c.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const a=this.binders[r];(a instanceof Ll||a instanceof Zs||a instanceof Xs)&&a.destroy()}}}class Uu{constructor(r,a,c=(()=>!0)){this.programConfigurations={};for(const d of r)this.programConfigurations[d.id]=new Vu(d,a,c);this.needsUpload=!1,this._featureMap=new Ol,this._bufferOffset=0}populatePaintArrays(r,a,c,d,g,y,b){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(r,a,d,g,y,b);void 0!==a.id&&this._featureMap.add(a.id,c,this._bufferOffset,r),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,a,c,d,g){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(r,this._featureMap,a,y,d,g)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const a in this.programConfigurations)this.programConfigurations[a].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const xt={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function EC(o,r){return xt[o]||[o.replace(`${r}-`,"").replace(/-/g,"_")]}const CC={"line-pattern":{source:Pe,composite:Pe},"fill-pattern":{source:Pe,composite:Pe},"fill-extrusion-pattern":{source:Pe,composite:Pe},"line-dasharray":{source:He,composite:He}},DC={color:{source:as,composite:nt},number:{source:qn,composite:as}};function tb(o,r,a){const c=CC[o];return c&&c[a]||DC[r][a]}De(Fl,"ConstantBinder"),De(Ya,"PatternConstantBinder"),De(Ll,"SourceExpressionBinder"),De(Xs,"PatternCompositeBinder"),De(Zs,"CompositeExpressionBinder"),De(Vu,"ProgramConfiguration",{omit:["_buffers"]}),De(Uu,"ProgramConfigurationSet");const nb="-transition";class Nl extends oc{constructor(r,a){if(super(),this.id=r.id,this.type=r.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==r.type&&(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,"background"!==r.type&&"sky"!==r.type&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),a.layout&&(this._unevaluatedLayout=new te(a.layout)),a.paint)){this._transitionablePaint=new j(a.paint);for(const c in r.paint)this.setPaintProperty(c,r.paint[c],{validate:!1});for(const c in r.layout)this.setLayoutProperty(c,r.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new re(a.paint)}}getLayoutProperty(r){return"visibility"===r?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,a,c={}){null!=a&&this._validate(Jf,`layers.${this.id}.layout.${r}`,r,a,c)||("visibility"!==r?this._unevaluatedLayout.setValue(r,a):this.visibility=a)}getPaintProperty(r){return ks(r,nb)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,a,c={}){if(null!=a&&this._validate(fn,`layers.${this.id}.paint.${r}`,r,a,c))return!1;if(ks(r,nb))return this._transitionablePaint.setTransition(r.slice(0,-11),a||void 0),!1;{const d=this._transitionablePaint._values[r],g=d.value.isDataDriven(),y=d.value;this._transitionablePaint.setValue(r,a),this._handleSpecialPaintPropertyUpdate(r);const b=this._transitionablePaint._values[r].value,E=b.isDataDriven(),D=ks(r,"pattern")||"line-dasharray"===r;return E||g||D||this._handleOverridablePaintPropertyUpdate(r,y,b)}}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getProgramConfiguration(r){return null}_handleOverridablePaintPropertyUpdate(r,a,c){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||"none"===this.visibility}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,a){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,a)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,a)}serialize(){const r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Zi(r,(a,c)=>!(void 0===a||"layout"===c&&!Object.keys(a).length||"paint"===c&&!Object.keys(a).length))}_validate(r,a,c,d,g={}){return(!g||!1!==g.validate)&&Qf(this,r.call(Lh,{key:a,layerType:this.type,objectKey:c,value:d,styleSpec:Ue,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const r in this.paint._values){const a=this.paint.get(r);if(a instanceof ee&&ss(a.property.specification)&&("source"===a.value.kind||"composite"===a.value.kind)&&a.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=$d(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const TC=we([{name:"a_pos",components:2,type:"Int16"}],4),Kd=we([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class pr{constructor(r=[]){this.segments=r}prepareSegment(r,a,c,d){let g=this.segments[this.segments.length-1];return r>pr.MAX_VERTEX_ARRAY_LENGTH&&Tn(`Max vertices per segment is ${pr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>pr.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==d)&&(g={vertexOffset:a.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==d&&(g.sortKey=d),this.segments.push(g)),g}get(){return this.segments}destroy(){for(const r of this.segments)for(const a in r.vaos)r.vaos[a].destroy()}static simpleSegment(r,a,c,d){return new pr([{vertexOffset:r,primitiveOffset:a,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])}}pr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,De(pr,"SegmentVector");var Pt=8192;class Bi{constructor(r,a){r&&(a?this.setSouthWest(r).setNorthEast(a):4===r.length?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof Zn?new Zn(r.lng,r.lat):Zn.convert(r),this}setSouthWest(r){return this._sw=r instanceof Zn?new Zn(r.lng,r.lat):Zn.convert(r),this}extend(r){const a=this._sw,c=this._ne;let d,g;if(r instanceof Zn)d=r,g=r;else{if(!(r instanceof Bi))return Array.isArray(r)?4===r.length||r.every(Array.isArray)?this.extend(Bi.convert(r)):this.extend(Zn.convert(r)):"object"==typeof r&&null!==r&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(Zn.convert(r)):this;if(d=r._sw,g=r._ne,!d||!g)return this}return a||c?(a.lng=Math.min(d.lng,a.lng),a.lat=Math.min(d.lat,a.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new Zn(d.lng,d.lat),this._ne=new Zn(g.lng,g.lat)),this}getCenter(){return new Zn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Zn(this.getWest(),this.getNorth())}getSouthEast(){return new Zn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:a,lat:c}=Zn.convert(r);let d=this._sw.lng<=a&&a<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=a&&a>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(r){return!r||r instanceof Bi?r:new Bi(r)}}var Hh=1e-6,uo=typeof Float32Array<"u"?Float32Array:Array;function My(){var o=new uo(9);return uo!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function Ks(o,r,a){var c=r[0],d=r[1],g=r[2],y=r[3],b=r[4],E=r[5],D=r[6],I=r[7],k=r[8],L=a[0],z=a[1],V=a[2],H=a[3],K=a[4],ie=a[5],ue=a[6],ne=a[7],ce=a[8];return o[0]=L*c+z*y+V*D,o[1]=L*d+z*b+V*I,o[2]=L*g+z*E+V*k,o[3]=H*c+K*y+ie*D,o[4]=H*d+K*b+ie*I,o[5]=H*g+K*E+ie*k,o[6]=ue*c+ne*y+ce*D,o[7]=ue*d+ne*b+ce*I,o[8]=ue*g+ne*E+ce*k,o}function Po(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function sp(o,r){var a=r[0],c=r[1],d=r[2],g=r[3],y=r[4],b=r[5],E=r[6],D=r[7],I=r[8],k=r[9],L=r[10],z=r[11],V=r[12],H=r[13],K=r[14],ie=r[15],ue=a*b-c*y,ne=a*E-d*y,ce=a*D-g*y,me=c*E-d*b,pe=c*D-g*b,Ae=d*D-g*E,Me=I*H-k*V,Ve=I*K-L*V,et=I*ie-z*V,Re=k*K-L*H,We=k*ie-z*H,Ze=L*ie-z*K,Qe=ue*Ze-ne*We+ce*Re+me*et-pe*Ve+Ae*Me;return Qe?(o[0]=(b*Ze-E*We+D*Re)*(Qe=1/Qe),o[1]=(d*We-c*Ze-g*Re)*Qe,o[2]=(H*Ae-K*pe+ie*me)*Qe,o[3]=(L*pe-k*Ae-z*me)*Qe,o[4]=(E*et-y*Ze-D*Ve)*Qe,o[5]=(a*Ze-d*et+g*Ve)*Qe,o[6]=(K*ce-V*Ae-ie*ne)*Qe,o[7]=(I*Ae-L*ce+z*ne)*Qe,o[8]=(y*We-b*et+D*Me)*Qe,o[9]=(c*et-a*We-g*Me)*Qe,o[10]=(V*pe-H*ce+ie*ue)*Qe,o[11]=(k*ce-I*pe-z*ue)*Qe,o[12]=(b*Ve-y*Re-E*Me)*Qe,o[13]=(a*Re-c*Ve+d*Me)*Qe,o[14]=(H*ne-V*me-K*ue)*Qe,o[15]=(I*me-k*ne+L*ue)*Qe,o):null}function Bl(o,r,a){var c=r[0],d=r[1],g=r[2],y=r[3],b=r[4],E=r[5],D=r[6],I=r[7],k=r[8],L=r[9],z=r[10],V=r[11],H=r[12],K=r[13],ie=r[14],ue=r[15],ne=a[0],ce=a[1],me=a[2],pe=a[3];return o[0]=ne*c+ce*b+me*k+pe*H,o[1]=ne*d+ce*E+me*L+pe*K,o[2]=ne*g+ce*D+me*z+pe*ie,o[3]=ne*y+ce*I+me*V+pe*ue,o[4]=(ne=a[4])*c+(ce=a[5])*b+(me=a[6])*k+(pe=a[7])*H,o[5]=ne*d+ce*E+me*L+pe*K,o[6]=ne*g+ce*D+me*z+pe*ie,o[7]=ne*y+ce*I+me*V+pe*ue,o[8]=(ne=a[8])*c+(ce=a[9])*b+(me=a[10])*k+(pe=a[11])*H,o[9]=ne*d+ce*E+me*L+pe*K,o[10]=ne*g+ce*D+me*z+pe*ie,o[11]=ne*y+ce*I+me*V+pe*ue,o[12]=(ne=a[12])*c+(ce=a[13])*b+(me=a[14])*k+(pe=a[15])*H,o[13]=ne*d+ce*E+me*L+pe*K,o[14]=ne*g+ce*D+me*z+pe*ie,o[15]=ne*y+ce*I+me*V+pe*ue,o}function mc(o,r,a){var c,d,g,y,b,E,D,I,k,L,z,V,H=a[0],K=a[1],ie=a[2];return r===o?(o[12]=r[0]*H+r[4]*K+r[8]*ie+r[12],o[13]=r[1]*H+r[5]*K+r[9]*ie+r[13],o[14]=r[2]*H+r[6]*K+r[10]*ie+r[14],o[15]=r[3]*H+r[7]*K+r[11]*ie+r[15]):(d=r[1],g=r[2],y=r[3],b=r[4],E=r[5],D=r[6],I=r[7],k=r[8],L=r[9],z=r[10],V=r[11],o[0]=c=r[0],o[1]=d,o[2]=g,o[3]=y,o[4]=b,o[5]=E,o[6]=D,o[7]=I,o[8]=k,o[9]=L,o[10]=z,o[11]=V,o[12]=c*H+b*K+k*ie+r[12],o[13]=d*H+E*K+L*ie+r[13],o[14]=g*H+D*K+z*ie+r[14],o[15]=y*H+I*K+V*ie+r[15]),o}function ju(o,r,a){var c=a[0],d=a[1],g=a[2];return o[0]=r[0]*c,o[1]=r[1]*c,o[2]=r[2]*c,o[3]=r[3]*c,o[4]=r[4]*d,o[5]=r[5]*d,o[6]=r[6]*d,o[7]=r[7]*d,o[8]=r[8]*g,o[9]=r[9]*g,o[10]=r[10]*g,o[11]=r[11]*g,o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15],o}function Ay(o,r,a){var c=Math.sin(a),d=Math.cos(a),g=r[4],y=r[5],b=r[6],E=r[7],D=r[8],I=r[9],k=r[10],L=r[11];return r!==o&&(o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[3],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[4]=g*d+D*c,o[5]=y*d+I*c,o[6]=b*d+k*c,o[7]=E*d+L*c,o[8]=D*d-g*c,o[9]=I*d-y*c,o[10]=k*d-b*c,o[11]=L*d-E*c,o}function ap(o,r,a){var c=Math.sin(a),d=Math.cos(a),g=r[0],y=r[1],b=r[2],E=r[3],D=r[8],I=r[9],k=r[10],L=r[11];return r!==o&&(o[4]=r[4],o[5]=r[5],o[6]=r[6],o[7]=r[7],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=g*d-D*c,o[1]=y*d-I*c,o[2]=b*d-k*c,o[3]=E*d-L*c,o[8]=g*c+D*d,o[9]=y*c+I*d,o[10]=b*c+k*d,o[11]=E*c+L*d,o}function ib(o,r){return o[0]=r[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=r[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=r[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function ws(o,r,a){var c,d,g,y=a[0],b=a[1],E=a[2],D=Math.hypot(y,b,E);return D<Hh?null:(y*=D=1/D,b*=D,E*=D,c=Math.sin(r),d=Math.cos(r),o[0]=y*y*(g=1-d)+d,o[1]=b*y*g+E*c,o[2]=E*y*g-b*c,o[3]=0,o[4]=y*b*g-E*c,o[5]=b*b*g+d,o[6]=E*b*g+y*c,o[7]=0,o[8]=y*E*g+b*c,o[9]=b*E*g-y*c,o[10]=E*E*g+d,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)}Math.hypot||(Math.hypot=function(){for(var o=0,r=arguments.length;r--;)o+=arguments[r]*arguments[r];return Math.sqrt(o)});var Vm=Bl;function Jc(){var o=new uo(3);return uo!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function rb(o){var r=new uo(3);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r}function Gh(o){return Math.hypot(o[0],o[1],o[2])}function qh(o,r,a){var c=new uo(3);return c[0]=o,c[1]=r,c[2]=a,c}function gc(o,r,a){return o[0]=r[0]+a[0],o[1]=r[1]+a[1],o[2]=r[2]+a[2],o}function Um(o,r,a){return o[0]=r[0]-a[0],o[1]=r[1]-a[1],o[2]=r[2]-a[2],o}function Iy(o,r,a){return o[0]=r[0]*a[0],o[1]=r[1]*a[1],o[2]=r[2]*a[2],o}function Yd(o,r,a){return o[0]=Math.min(r[0],a[0]),o[1]=Math.min(r[1],a[1]),o[2]=Math.min(r[2],a[2]),o}function Jd(o,r,a){return o[0]=Math.max(r[0],a[0]),o[1]=Math.max(r[1],a[1]),o[2]=Math.max(r[2],a[2]),o}function ls(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o}function Qc(o,r,a,c){return o[0]=r[0]+a[0]*c,o[1]=r[1]+a[1]*c,o[2]=r[2]+a[2]*c,o}function qr(o,r){var a=r[0],c=r[1],d=r[2],g=a*a+c*c+d*d;return g>0&&(g=1/Math.sqrt(g)),o[0]=r[0]*g,o[1]=r[1]*g,o[2]=r[2]*g,o}function ko(o,r){return o[0]*r[0]+o[1]*r[1]+o[2]*r[2]}function lp(o,r,a){var c=r[0],d=r[1],g=r[2],y=a[0],b=a[1],E=a[2];return o[0]=d*E-g*b,o[1]=g*y-c*E,o[2]=c*b-d*y,o}function Pi(o,r,a){var c=r[0],d=r[1],g=r[2],y=a[3]*c+a[7]*d+a[11]*g+a[15];return o[0]=(a[0]*c+a[4]*d+a[8]*g+a[12])/(y=y||1),o[1]=(a[1]*c+a[5]*d+a[9]*g+a[13])/y,o[2]=(a[2]*c+a[6]*d+a[10]*g+a[14])/y,o}function Py(o,r,a){var c=a[0],d=a[1],g=a[2],y=r[0],b=r[1],E=r[2],D=d*E-g*b,I=g*y-c*E,k=c*b-d*y,L=d*k-g*I,z=g*D-c*k,V=c*I-d*D,H=2*a[3];return I*=H,k*=H,z*=2,V*=2,o[0]=y+(D*=H)+(L*=2),o[1]=b+I+z,o[2]=E+k+V,o}var Wh,cs=Um,cp=Iy,ky=Gh;function Ry(o,r,a){return o[0]=r[0]*a,o[1]=r[1]*a,o[2]=r[2]*a,o[3]=r[3]*a,o}function Oy(o,r){var a=r[0],c=r[1],d=r[2],g=r[3],y=a*a+c*c+d*d+g*g;return y>0&&(y=1/Math.sqrt(y)),o[0]=a*y,o[1]=c*y,o[2]=d*y,o[3]=g*y,o}function ya(o,r,a){var c=r[0],d=r[1],g=r[2],y=r[3];return o[0]=a[0]*c+a[4]*d+a[8]*g+a[12]*y,o[1]=a[1]*c+a[5]*d+a[9]*g+a[13]*y,o[2]=a[2]*c+a[6]*d+a[10]*g+a[14]*y,o[3]=a[3]*c+a[7]*d+a[11]*g+a[15]*y,o}function Zh(){var o=new uo(4);return uo!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function Fy(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function ob(o,r,a){a*=.5;var c=r[0],d=r[1],g=r[2],y=r[3],b=Math.sin(a),E=Math.cos(a);return o[0]=c*E+y*b,o[1]=d*E+g*b,o[2]=g*E-d*b,o[3]=y*E-c*b,o}function jm(o,r,a){a*=.5;var c=r[0],d=r[1],g=r[2],y=r[3],b=Math.sin(a),E=Math.cos(a);return o[0]=c*E-g*b,o[1]=d*E+y*b,o[2]=g*E+c*b,o[3]=y*E-d*b,o}Jc(),Wh=new uo(4),uo!=Float32Array&&(Wh[0]=0,Wh[1]=0,Wh[2]=0,Wh[3]=0);var sb=Oy;Jc(),qh(1,0,0),qh(0,1,0),Zh(),Zh(),My();const SC=we([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Ly}=SC,Ny=we([{name:"a_pos_3",components:3,type:"Int16"}]);var Qd=we([{name:"a_pos",type:"Int16",components:2}]);class Xh{constructor(r,a){this.pos=r,this.dir=a}intersectsPlane(r,a,c){const d=ko(a,this.dir);if(Math.abs(d)<1e-6)return!1;const g=((r[0]-this.pos[0])*a[0]+(r[1]-this.pos[1])*a[1]+(r[2]-this.pos[2])*a[2])/d;return c[0]=this.pos[0]+this.dir[0]*g,c[1]=this.pos[1]+this.dir[1]*g,c[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,a,c){if(H=(z=this.pos)[0],K=z[1],ie=z[2],ue=(V=r)[0],ne=V[1],ce=V[2],Math.abs(H-ue)<=Hh*Math.max(1,Math.abs(H),Math.abs(ue))&&Math.abs(K-ne)<=Hh*Math.max(1,Math.abs(K),Math.abs(ne))&&Math.abs(ie-ce)<=Hh*Math.max(1,Math.abs(ie),Math.abs(ce))||0===a)return c[0]=c[1]=c[2]=0,!1;var z,V,H,K,ie,ue,ne,ce;const[d,g,y]=this.dir,b=this.pos[0]-r[0],E=this.pos[1]-r[1],D=this.pos[2]-r[2],I=d*d+g*g+y*y,k=2*(b*d+E*g+D*y),L=k*k-4*I*(b*b+E*E+D*D-a*a);if(L<0){const z=Math.max(-k/2,0),V=b+d*z,H=E+g*z,K=D+y*z,ie=Math.hypot(V,H,K);return c[0]=V*a/ie,c[1]=H*a/ie,c[2]=K*a/ie,!1}{const z=(-k-Math.sqrt(L))/(2*I);if(z<0){const V=Math.hypot(b,E,D);return c[0]=b*a/V,c[1]=E*a/V,c[2]=D*a/V,!1}return c[0]=b+d*z,c[1]=E+g*z,c[2]=D+y*z,!0}}}class up{constructor(r,a,c,d,g){this.TL=r,this.TR=a,this.BR=c,this.BL=d,this.horizon=g}static fromInvProjectionMatrix(r,a,c){const d=[-1,1,1],g=[1,1,1],y=[1,-1,1],b=[-1,-1,1],E=Pi(d,d,r),D=Pi(g,g,r),I=Pi(y,y,r),k=Pi(b,b,r);return new up(E,D,I,k,a/c)}}class $m{constructor(r,a){this.points=r,this.planes=a}static fromInvProjectionMatrix(r,a,c,d){const g=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const D=ya([],E,r),I=1/D[3]/a*g;return(k=D)[0]=(L=D)[0]*(z=[I,I,d?1/D[3]:I,I])[0],k[1]=L[1]*z[1],k[2]=L[2]*z[2],k[3]=L[3]*z[3],k;var k,L,z}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const D=qr([],lp([],cs([],y[E[0]],y[E[1]]),cs([],y[E[2]],y[E[1]]))),I=-ko(D,y[E[1]]);return D.concat(I)});return new $m(y,b)}}class Ro{static fromPoints(r){const a=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const d of r)Yd(a,a,d),Jd(c,c,d);return new Ro(a,c)}static applyTransform(r,a){const c=r.getCorners();for(let d=0;d<c.length;++d)Pi(c[d],c[d],a);return Ro.fromPoints(c)}constructor(r,a){this.min=r,this.max=a,this.center=ls([],gc([],this.min,this.max),.5)}quadrant(r){const a=[r%2==0,r<2],c=rb(this.min),d=rb(this.max);for(let g=0;g<a.length;g++)c[g]=a[g]?this.min[g]:this.center[g],d[g]=a[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new Ro(c,d)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,a=this.max;return[[r[0],r[1],r[2]],[a[0],r[1],r[2]],[a[0],a[1],r[2]],[r[0],a[1],r[2]],[r[0],r[1],a[2]],[a[0],r[1],a[2]],[a[0],a[1],a[2]],[r[0],a[1],a[2]]]}intersects(r){const a=this.getCorners();let c=!0;for(let d=0;d<r.planes.length;d++){const g=r.planes[d];let y=0;for(let b=0;b<a.length;b++)y+=ko(g,a[b])+g[3]>=0;if(0===y)return 0;y!==a.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let g=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let b=0;b<r.points.length;b++){const E=r.points[b][d]-this.min[d];g=Math.min(g,E),y=Math.max(y,E)}if(y<0||g>this.max[d]-this.min[d])return 0}return 1}}const By=5,Hm=6,_c=Pt/Math.PI/2,ab=16383,Hu=[64,32,16],Ja=-_c,Qa=_c,Gm=[new Ro([Ja,Ja,Ja],[Qa,Qa,Qa]),new Ro([Ja,Ja,Ja],[0,0,Qa]),new Ro([0,Ja,Ja],[Qa,0,Qa]),new Ro([Ja,0,Ja],[0,Qa,Qa]),new Ro([0,0,Ja],[Qa,Qa,Qa])];function qm(o){return o*_c/Jh}function lb(o,r,a,c=!0){const d=ls([],o._camera.position,o.worldSize),g=[r,a,1,1];ya(g,g,o.pixelMatrixInverse),Ry(g,g,1/g[3]);const y=qr([],cs([],g,d)),b=o.globeMatrix,E=[b[12],b[13],b[14]],D=cs([],E,d),I=Gh(D),k=qr([],D),L=o.worldSize/(2*Math.PI),z=ko(k,y),V=Math.asin(L/I);if(V<Math.acos(z)){if(!c)return null;const et=[],Re=[];ls(et,y,I/z),qr(Re,cs(Re,et,D)),qr(y,gc(y,D,ls(y,Re,Math.tan(V)*I)))}const H=[];new Xh(d,y).closestPointOnSphere(E,L,H);const K=qr([],Ci(b,0)),ie=qr([],Ci(b,1)),ue=qr([],Ci(b,2)),ne=ko(K,H),ce=ko(ie,H),me=ko(ue,H),pe=tr(Math.asin(-ce/L));let Ae=tr(Math.atan2(ne,me));Ae=o.center.lng+function(et,Re){const We=(Re-et+180)%360-180;return We<-180?We+360:We}(o.center.lng,Ae);const Me=el(Ae),Ve=zt(zl(pe),0,1);return new Qh(Me,Ve)}class MC{constructor(r,a,c){this.a=cs([],r,c),this.b=cs([],a,c),this.center=c;const d=qr([],this.a),g=qr([],this.b);this.angle=Math.acos(ko(d,g))}}function zy(o,r){if(0===o.angle)return null;let a;return a=0===o.a[r]?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[r]/o.a[r]/Math.sin(o.angle)-1/Math.tan(o.angle)),a<0||a>1?null:function(c,d,g,y){const b=Math.sin(g);return c*(Math.sin((1-y)*g)/b)+d*(Math.sin(y*g)/b)}(o.a[r],o.b[r],o.angle,zt(a,0,1))+o.center[r]}function yc(o){if(o.z<=1)return Gm[o.z+2*o.y+o.x];const r=dp(ef(o));return Ro.fromPoints(r)}function Gu(o,r,a){return ls(o,o,1-a),Qc(o,o,r,a)}function Wm(o,r){const a=Yh(r.zoom);if(0===a)return yc(o);const c=ef(o),d=dp(c),g=el(c.getWest())*r.worldSize,y=el(c.getEast())*r.worldSize,b=zl(c.getNorth())*r.worldSize,E=zl(c.getSouth())*r.worldSize,D=[g,b,0],I=[y,b,0],k=[g,E,0],L=[y,E,0],z=sp([],r.globeMatrix);return Pi(D,D,z),Pi(I,I,z),Pi(k,k,z),Pi(L,L,z),d[0]=Gu(d[0],k,a),d[1]=Gu(d[1],L,a),d[2]=Gu(d[2],I,a),d[3]=Gu(d[3],D,a),Ro.fromPoints(d)}function hp(o,r,a){for(const c of o)Pi(c,c,r),ls(c,c,a)}function ef({x:o,y:r,z:a}){const c=1/(1<<a),d=new Zn(Ys(o*c),Zr((r+1)*c)),g=new Zn(Ys((o+1)*c),Zr(r*c));return new Bi(d,g)}function dp(o){const r=cn(o.getNorth()),a=cn(o.getSouth()),c=Math.cos(r),d=Math.cos(a),g=Math.sin(r),y=Math.sin(a),b=o.getWest(),E=o.getEast();return[Wr(d,y,b),Wr(d,y,E),Wr(c,g,E),Wr(c,g,b)]}function Wr(o,r,a,c=_c){return a=cn(a),[o*Math.sin(a)*c,-r*c,o*Math.cos(a)*c]}function Kh(o,r,a){return Wr(Math.cos(cn(o)),Math.sin(cn(o)),r,a)}function tf(o,r,a,c){const d=1<<a.z,g=(o/Pt+a.x)/d;return Kh(Zr((r/Pt+a.y)/d),Ys(g),c)}function fp({min:o,max:r}){return ab/Math.max(r[0]-o[0],r[1]-o[1],r[2]-o[2])}const Zm=new Float64Array(16);function qu(o){const r=fp(o),a=ib(Zm,[r,r,r]);return mc(a,a,((c=[])[0]=-(d=o.min)[0],c[1]=-d[1],c[2]=-d[2],c));var c,d}function Xm(o){const r=(c=o.min,(a=Zm)[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a);var a,c;const d=1/fp(o);return ju(r,r,[d,d,d])}function Uy(o,r,a,c,d){const g=function(E){const D=Pt/(2*Math.PI);return E/(2*Math.PI)/D}(a),y=[o,r,-a/(2*Math.PI)],b=Po(new Float64Array(16));return mc(b,b,y),ju(b,b,[g,g,g]),Ay(b,b,cn(-d)),ap(b,b,cn(-c)),b}function Yh(o){return yo(By,Hm,o)}function Km(o,r){const a=Kh(r.lat,r.lng);return y=(d=Um([],function(V){const H=Kh(V._center.lat,V._center.lng);let K=lp([],qh(0,1,0),H);const ie=ws([],-V.angle,H);K=Pi(K,K,ie),ws(ie,-V._pitch,K);const ue=qr([],H);return ls(ue,ue,qm(V.cameraToCenterDistance/V.pixelsPerMeter)),Pi(ue,ue,ie),gc([],H,ue)}(o),a))[0],b=d[1],E=d[2],D=(g=a)[0],I=g[1],k=g[2],z=(L=Math.sqrt(y*y+b*b+E*E)*Math.sqrt(D*D+I*I+k*k))&&ko(d,g)/L,Math.acos(Math.min(Math.max(z,-1),1));var d,g,y,b,E,D,I,k,L,z}function Ym(o,r){return Km(o,r)>Math.PI/2*1.01}const jy=cn(85),Es=Math.cos(jy),Jm=Math.sin(jy),Jh=6371008.8,pp=2*Math.PI*Jh;class or{constructor(r,a){if(isNaN(r)||isNaN(a))throw new Error(`Invalid LngLat object: (${r}, ${a})`);if(this.lng=+r,this.lat=+a,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new or(Lt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const a=Math.PI/180,c=this.lat*a,d=r.lat*a,g=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((r.lng-this.lng)*a);return Jh*Math.acos(Math.min(g,1))}toBounds(r=0){const a=360*r/40075017,c=a/Math.cos(Math.PI/180*this.lat);return new Bi(new or(this.lng-c,this.lat-a),new or(this.lng+c,this.lat+a))}toEcef(r){const a=qm(r);return Kh(this.lat,this.lng,_c+a)}static convert(r){if(r instanceof or)return r;if(Array.isArray(r)&&(2===r.length||3===r.length))return new or(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&"object"==typeof r&&null!==r)return new or(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Zn=or;function mp(o){return pp*Math.cos(o*Math.PI/180)}function el(o){return(180+o)/360}function zl(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function va(o,r){return o/mp(r)}function Ys(o){return 360*o-180}function Zr(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function $y(o,r){return o*mp(Zr(r))}const Xr=85.051129;function Hy(o){return 1/Math.cos(o*Math.PI/180)}class Qh{constructor(r,a,c=0){this.x=+r,this.y=+a,this.z=+c}static fromLngLat(r,a=0){const c=Zn.convert(r);return new Qh(el(c.lng),zl(c.lat),va(a,c.lat))}toLngLat(){return new Zn(Ys(this.x),Zr(this.y))}toAltitude(){return $y(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/pp*Hy(Zr(this.y))}}function nf(o,r,a,c,d,g,y,b,E){const D=(r+c)/2,I=(a+d)/2,k=new ct(D,I);b(k),function(L,z,V,H,K,ie){const ue=V-K,ne=H-ie;return Math.abs((H-z)*ue-(V-L)*ne)/Math.hypot(ue,ne)}(k.x,k.y,g.x,g.y,y.x,y.y)>=E?(nf(o,r,a,D,I,g,k,b,E),nf(o,D,I,c,d,k,y,b,E)):o.push(y)}function gp(o,r,a){let c=o[0],d=c.x,g=c.y;r(c);const y=[c];for(let b=1;b<o.length;b++){const E=o[b],{x:D,y:I}=E;r(E),nf(y,d,g,D,I,c,E,r,a),d=D,g=I,c=E}return y}function Qm(o,r,a,c){if(c(r,a)){const d=r.add(a)._mult(.5);Qm(o,r,d,c),Qm(o,d,a,c)}else o.push(a)}function rf(o,r){let a=o[0];const c=[a];for(let d=1;d<o.length;d++){const g=o[d];Qm(c,a,g,r),a=g}return c}const eg=Math.pow(2,14)-1,Gy=-eg-1;function tg(o,r){const a=Math.round(o.x*r),c=Math.round(o.y*r);return o.x=zt(a,Gy,eg),o.y=zt(c,Gy,eg),(a<o.x||a>o.x+1||c<o.y||c>o.y+1)&&Tn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function tl(o,r,a){const c=o.loadGeometry(),d=o.extent,g=Pt/d;if(r&&a&&a.projection.isReprojectedInTileSpace){const y=1<<r.z,{scale:b,x:E,y:D,projection:I}=a,k=L=>{const z=Ys((r.x+L.x/d)/y),V=Zr((r.y+L.y/d)/y),H=I.project(z,V);L.x=(H.x*b-E)*d,L.y=(H.y*b-D)*d};for(let L=0;L<c.length;L++)if(1!==o.type)c[L]=gp(c[L],k,1);else{const z=[];for(const V of c[L])V.x<0||V.x>=d||V.y<0||V.y>=d||(k(V),z.push(V));c[L]=z}}for(const y of c)for(const b of y)tg(b,g);return c}function eu(o,r){return{type:o.type,id:o.id,properties:o.properties,geometry:r?tl(o):[]}}function vc(o,r,a,c,d){o.emplaceBack(2*r+(c+1)/2,2*a+(d+1)/2)}function ed(o,r,a){o.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class _p{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new tt,this.indexArray=new Ct,this.segments=new pr,this.programConfigurations=new Uu(r.layers,r.zoom),this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,c,d){const g=this.layers[0],y=[];let b=null;"circle"===g.type&&(b=g.layout.get("circle-sort-key"));for(const{feature:D,id:I,index:k,sourceLayerIndex:L}of r){const z=this.layers[0]._featureFilter.needGeometry,V=eu(D,z);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),V,c))continue;const H=b?b.evaluate(V,{},c):void 0,K={id:I,properties:D.properties,type:D.type,sourceLayerIndex:L,index:k,geometry:z?V.geometry:tl(D,c,d),patterns:{},sortKey:H};y.push(K)}b&&y.sort((D,I)=>D.sortKey-I.sortKey);let E=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new it,E=d.projection);for(const D of y){const{geometry:I,index:k,sourceLayerIndex:L}=D,z=r[k].feature;this.addFeature(D,I,k,a.availableImages,c,E),a.featureIndex.insert(z,I,k,L,this.index)}}update(r,a,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,TC.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,Kd.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(r,a,c,d,g,y){for(const b of a)for(const E of b){const D=E.x,I=E.y;if(D<0||D>=Pt||I<0||I>=Pt)continue;if(y){const z=y.projectTilePoint(D,I,g),V=y.upVector(g,D,I),H=this.globeExtVertexArray;ed(H,z,V),ed(H,z,V),ed(H,z,V),ed(H,z,V)}const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),L=k.vertexLength;vc(this.layoutVertexArray,D,I,-1,-1),vc(this.layoutVertexArray,D,I,1,-1),vc(this.layoutVertexArray,D,I,1,1),vc(this.layoutVertexArray,D,I,-1,1),this.indexArray.emplaceBack(L,L+1,L+2),this.indexArray.emplaceBack(L,L+2,L+3),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,{},d,g)}}function qy(o,r){for(let a=0;a<o.length;a++)if(xc(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(xc(o,r[a]))return!0;return!!ig(o,r)}function ng(o,r,a){return!!xc(o,r)||!!rg(r,o,a)}function Wy(o,r){if(1===o.length)return og(r,o[0]);for(let a=0;a<r.length;a++){const c=r[a];for(let d=0;d<c.length;d++)if(xc(o,c[d]))return!0}for(let a=0;a<o.length;a++)if(og(r,o[a]))return!0;for(let a=0;a<r.length;a++)if(ig(o,r[a]))return!0;return!1}function cb(o,r,a){if(o.length>1){if(ig(o,r))return!0;for(let c=0;c<r.length;c++)if(rg(r[c],o,a))return!0}for(let c=0;c<o.length;c++)if(rg(o[c],r,a))return!0;return!1}function ig(o,r){if(0===o.length||0===r.length)return!1;for(let a=0;a<o.length-1;a++){const c=o[a],d=o[a+1];for(let g=0;g<r.length-1;g++)if(ub(c,d,r[g],r[g+1]))return!0}return!1}function ub(o,r,a,c){return to(o,a,c)!==to(r,a,c)&&to(o,r,a)!==to(o,r,c)}function rg(o,r,a){const c=a*a;if(1===r.length)return o.distSqr(r[0])<c;for(let d=1;d<r.length;d++)if(Zy(o,r[d-1],r[d])<c)return!0;return!1}function Zy(o,r,a){const c=r.distSqr(a);if(0===c)return o.distSqr(r);const d=((o.x-r.x)*(a.x-r.x)+(o.y-r.y)*(a.y-r.y))/c;return o.distSqr(d<0?r:d>1?a:a.sub(r)._mult(d)._add(r))}function og(o,r){let a,c,d,g=!1;for(let y=0;y<o.length;y++){a=o[y];for(let b=0,E=a.length-1;b<a.length;E=b++)c=a[b],d=a[E],c.y>r.y!=d.y>r.y&&r.x<(d.x-c.x)*(r.y-c.y)/(d.y-c.y)+c.x&&(g=!g)}return g}function xc(o,r){let a=!1;for(let c=0,d=o.length-1;c<o.length;d=c++){const g=o[c],y=o[d];g.y>r.y!=y.y>r.y&&r.x<(y.x-g.x)*(r.y-g.y)/(y.y-g.y)+g.x&&(a=!a)}return a}function sg(o,r,a,c,d){for(const y of o)if(r<=y.x&&a<=y.y&&c>=y.x&&d>=y.y)return!0;const g=[new ct(r,a),new ct(r,d),new ct(c,d),new ct(c,a)];if(o.length>2)for(const y of g)if(xc(o,y))return!0;for(let y=0;y<o.length-1;y++)if(ag(o[y],o[y+1],g))return!0;return!1}function ag(o,r,a){const c=a[0],d=a[2];if(o.x<c.x&&r.x<c.x||o.x>d.x&&r.x>d.x||o.y<c.y&&r.y<c.y||o.y>d.y&&r.y>d.y)return!1;const g=to(o,r,a[0]);return g!==to(o,r,a[1])||g!==to(o,r,a[2])||g!==to(o,r,a[3])}function td(o,r,a){const c=r.paint.get(o).value;return"constant"===c.kind?c.value:a.programConfigurations.get(r.id).getMaxValue(o)}function yp(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function lg(o,r,a,c,d){if(!r[0]&&!r[1])return o;const g=ct.convert(r)._mult(d);"viewport"===a&&g._rotate(-c);const y=[];for(let b=0;b<o.length;b++)y.push(o[b].sub(g));return y}function cg(o,r,a,c){const d=ct.convert(o)._mult(c);return"viewport"===r&&d._rotate(-a),d}De(_p,"CircleBucket",{omit:["layers"]});const Wu=new oe({"circle-sort-key":new Y(Ue.layout_circle["circle-sort-key"])});var Xy={paint:new oe({"circle-radius":new Y(Ue.paint_circle["circle-radius"]),"circle-color":new Y(Ue.paint_circle["circle-color"]),"circle-blur":new Y(Ue.paint_circle["circle-blur"]),"circle-opacity":new Y(Ue.paint_circle["circle-opacity"]),"circle-translate":new $(Ue.paint_circle["circle-translate"]),"circle-translate-anchor":new $(Ue.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $(Ue.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $(Ue.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Y(Ue.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Y(Ue.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Y(Ue.paint_circle["circle-stroke-opacity"])}),layout:Wu};function ug(o,r,a,c,d,g,y,b,E){if(g&&o.queryGeometry.isAboveHorizon)return!1;g&&(E*=o.pixelToTileUnitsFactor);const D=o.tileID.canonical,I=a.projection.upVectorScale(D,a.center.lat,a.worldSize).metersToTile;for(const k of r)for(const L of k){const z=L.add(b),V=d&&a.elevation?a.elevation.exaggeration()*d.getElevationAt(z.x,z.y,!0):0,H=a.projection.projectTilePoint(z.x,z.y,D);if(V>0){const ne=a.projection.upVector(D,z.x,z.y);H.x+=ne[0]*I*V,H.y+=ne[1]*I*V,H.z+=ne[2]*I*V}const K=g?z:hb(H.x,H.y,H.z,c),ie=g?o.tilespaceRays.map(ne=>fb(ne,V)):o.queryGeometry.screenGeometry,ue=ya([],[H.x,H.y,H.z,1],c);if(!y&&g?E*=ue[3]/a.cameraToCenterDistance:y&&!g&&(E*=a.cameraToCenterDistance/ue[3]),g){const ne=Zr((L.y/Pt+D.y)/(1<<D.z));E/=a.projection.pixelsPerMeter(ne,1)/va(1,ne)}if(ng(ie,K,E))return!0}return!1}function hb(o,r,a,c){const d=ya([],[o,r,a,1],c);return new ct(d[0]/d[3],d[1]/d[3])}const db=qh(0,0,0),vp=qh(0,0,1);function fb(o,r){const a=Jc();return db[2]=r,o.intersectsPlane(db,vp,a),new ct(a[0],a[1])}class hg extends _p{}function dg(o,{width:r,height:a},c,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==r*a*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(r*a*c);return o.width=r,o.height=a,o.data=d,o}function fg(o,r,a){const{width:c,height:d}=r;c===o.width&&d===o.height||(sf(o,r,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,c),height:Math.min(o.height,d)},a),o.width=c,o.height=d,o.data=r.data)}function sf(o,r,a,c,d,g){if(0===d.width||0===d.height)return r;if(d.width>o.width||d.height>o.height||a.x>o.width-d.width||a.y>o.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>r.width||d.height>r.height||c.x>r.width-d.width||c.y>r.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=o.data,b=r.data;for(let E=0;E<d.height;E++){const D=((a.y+E)*o.width+a.x)*g,I=((c.y+E)*r.width+c.x)*g;for(let k=0;k<d.width*g;k++)b[I+k]=y[D+k]}return r}De(hg,"HeatmapBucket",{omit:["layers"]});class Vl{constructor(r,a){dg(this,r,1,a)}resize(r){fg(this,new Vl(r),1)}clone(){return new Vl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,c,d,g){sf(r,a,c,d,g,1)}}class Oo{constructor(r,a){dg(this,r,4,a)}resize(r){fg(this,new Oo(r),4)}replace(r,a){a?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new Oo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,a,c,d,g){sf(r,a,c,d,g,4)}}De(Vl,"AlphaImage"),De(Oo,"RGBAImage");var xp={paint:new oe({"heatmap-radius":new Y(Ue.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Y(Ue.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $(Ue.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ae(Ue.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $(Ue.paint_heatmap["heatmap-opacity"])})};function bp(o){const r={},a=o.resolution||256,c=o.clips?o.clips.length:1,d=o.image||new Oo({width:a,height:c}),g=(y,b,E)=>{r[o.evaluationKey]=E;const D=o.expression.evaluate(r);d.data[y+b+0]=Math.floor(255*D.r/D.a),d.data[y+b+1]=Math.floor(255*D.g/D.a),d.data[y+b+2]=Math.floor(255*D.b/D.a),d.data[y+b+3]=Math.floor(255*D.a)};if(o.clips)for(let y=0,b=0;y<c;++y,b+=4*a)for(let E=0,D=0;E<a;E++,D+=4){const I=E/(a-1),{start:k,end:L}=o.clips[y];g(b,D,k*(1-I)+L*I)}else for(let y=0,b=0;y<a;y++,b+=4)g(0,b,y/(a-1));return d}var pg={paint:new oe({"hillshade-illumination-direction":new $(Ue.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new $(Ue.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $(Ue.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $(Ue.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $(Ue.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $(Ue.paint_hillshade["hillshade-accent-color"])})};const mg=we([{name:"a_pos",components:2,type:"Int16"}],4),{members:gg}=mg;var Zu={exports:{}};function wp(o,r,a){a=a||2;var c,d,g,y,b,E,D,I=r&&r.length,k=I?r[0]*a:o.length,L=_g(o,0,k,a,!0),z=[];if(!L||L.next===L.prev)return z;if(I&&(L=function(H,K,ie,ue){var ne,ce,me,pe=[];for(ne=0,ce=K.length;ne<ce;ne++)(me=_g(H,K[ne]*ue,ne<ce-1?K[ne+1]*ue:H.length,ue,!1))===me.next&&(me.steiner=!0),pe.push(AC(me));for(pe.sort(yg),ne=0;ne<pe.length;ne++)ie=nd(pe[ne],ie);return ie}(o,r,L,a)),o.length>80*a){c=g=o[0],d=y=o[1];for(var V=a;V<k;V+=a)(b=o[V])<c&&(c=b),(E=o[V+1])<d&&(d=E),b>g&&(g=b),E>y&&(y=E);D=0!==(D=Math.max(g-c,y-d))?32767/D:0}return af(L,z,a,c,d,D,0),z}function _g(o,r,a,c,d){var g,y;if(d===Cg(o,r,a,c)>0)for(g=r;g<a;g+=c)y=wg(g,o[g],o[g+1],y);else for(g=a-c;g>=r;g-=c)y=wg(g,o[g],o[g+1],y);return y&&lf(y,y.next)&&(hf(y),y=y.next),y}function Xu(o,r){if(!o)return o;r||(r=o);var a,c=o;do{if(a=!1,c.steiner||!lf(c,c.next)&&0!==sr(c.prev,c,c.next))c=c.next;else{if(hf(c),(c=r=c.prev)===c.next)break;a=!0}}while(a||c!==r);return r}function af(o,r,a,c,d,g,y){if(o){!y&&g&&function(I,k,L,z){var V=I;do{0===V.z&&(V.z=vg(V.x,V.y,k,L,z)),V.prevZ=V.prev,V.nextZ=V.next,V=V.next}while(V!==I);V.prevZ.nextZ=null,V.prevZ=null,function(H){var K,ie,ue,ne,ce,me,pe,Ae,Me=1;do{for(ie=H,H=null,ce=null,me=0;ie;){for(me++,ue=ie,pe=0,K=0;K<Me&&(pe++,ue=ue.nextZ);K++);for(Ae=Me;pe>0||Ae>0&&ue;)0!==pe&&(0===Ae||!ue||ie.z<=ue.z)?(ne=ie,ie=ie.nextZ,pe--):(ne=ue,ue=ue.nextZ,Ae--),ce?ce.nextZ=ne:H=ne,ne.prevZ=ce,ce=ne;ie=ue}ce.nextZ=null,Me*=2}while(me>1)}(V)}(o,c,d,g);for(var b,E,D=o;o.prev!==o.next;)if(b=o.prev,E=o.next,g?Ky(o,c,d,g):pb(o))r.push(b.i/a|0),r.push(o.i/a|0),r.push(E.i/a|0),hf(o),o=E.next,D=E.next;else if((o=E)===D){y?1===y?af(o=Yy(Xu(o),r,a),r,a,c,d,g,2):2===y&&Ep(o,r,a,c,d,g):af(Xu(o),r,a,c,d,g,1);break}}}function pb(o){var r=o.prev,a=o,c=o.next;if(sr(r,a,c)>=0)return!1;for(var d=r.x,g=a.x,y=c.x,b=r.y,E=a.y,D=c.y,I=d<g?d<y?d:y:g<y?g:y,k=b<E?b<D?b:D:E<D?E:D,L=d>g?d>y?d:y:g>y?g:y,z=b>E?b>D?b:D:E>D?E:D,V=c.next;V!==r;){if(V.x>=I&&V.x<=L&&V.y>=k&&V.y<=z&&id(d,b,g,E,y,D,V.x,V.y)&&sr(V.prev,V,V.next)>=0)return!1;V=V.next}return!0}function Ky(o,r,a,c){var d=o.prev,g=o,y=o.next;if(sr(d,g,y)>=0)return!1;for(var b=d.x,E=g.x,D=y.x,I=d.y,k=g.y,L=y.y,z=b<E?b<D?b:D:E<D?E:D,V=I<k?I<L?I:L:k<L?k:L,H=b>E?b>D?b:D:E>D?E:D,K=I>k?I>L?I:L:k>L?k:L,ie=vg(z,V,r,a,c),ue=vg(H,K,r,a,c),ne=o.prevZ,ce=o.nextZ;ne&&ne.z>=ie&&ce&&ce.z<=ue;){if(ne.x>=z&&ne.x<=H&&ne.y>=V&&ne.y<=K&&ne!==d&&ne!==y&&id(b,I,E,k,D,L,ne.x,ne.y)&&sr(ne.prev,ne,ne.next)>=0||(ne=ne.prevZ,ce.x>=z&&ce.x<=H&&ce.y>=V&&ce.y<=K&&ce!==d&&ce!==y&&id(b,I,E,k,D,L,ce.x,ce.y)&&sr(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;ne&&ne.z>=ie;){if(ne.x>=z&&ne.x<=H&&ne.y>=V&&ne.y<=K&&ne!==d&&ne!==y&&id(b,I,E,k,D,L,ne.x,ne.y)&&sr(ne.prev,ne,ne.next)>=0)return!1;ne=ne.prevZ}for(;ce&&ce.z<=ue;){if(ce.x>=z&&ce.x<=H&&ce.y>=V&&ce.y<=K&&ce!==d&&ce!==y&&id(b,I,E,k,D,L,ce.x,ce.y)&&sr(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function Yy(o,r,a){var c=o;do{var d=c.prev,g=c.next.next;!lf(d,g)&&cf(d,c,c.next,g)&&od(d,g)&&od(g,d)&&(r.push(d.i/a|0),r.push(c.i/a|0),r.push(g.i/a|0),hf(c),hf(c.next),c=o=g),c=c.next}while(c!==o);return Xu(c)}function Ep(o,r,a,c,d,g){var y=o;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&xg(y,b)){var E=bg(y,b);return y=Xu(y,y.next),E=Xu(E,E.next),af(y,r,a,c,d,g,0),void af(E,r,a,c,d,g,0)}b=b.next}y=y.next}while(y!==o)}function yg(o,r){return o.x-r.x}function nd(o,r){var a=function(d,g){var y,b=g,E=d.x,D=d.y,I=-1/0;do{if(D<=b.y&&D>=b.next.y&&b.next.y!==b.y){var k=b.x+(D-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(k<=E&&k>I&&(I=k,y=b.x<b.next.x?b:b.next,k===E))return y}b=b.next}while(b!==g);if(!y)return null;var L,z=y,V=y.x,H=y.y,K=1/0;b=y;do{E>=b.x&&b.x>=V&&E!==b.x&&id(D<H?E:I,D,V,H,D<H?I:E,D,b.x,b.y)&&(L=Math.abs(D-b.y)/(E-b.x),od(b,d)&&(L<K||L===K&&(b.x>y.x||b.x===y.x&&mb(y,b)))&&(y=b,K=L)),b=b.next}while(b!==z);return y}(o,r);if(!a)return r;var c=bg(a,o);return Xu(c,c.next),Xu(a,a.next)}function mb(o,r){return sr(o.prev,o,r.prev)<0&&sr(r.next,o,o.next)<0}function vg(o,r,a,c,d){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-a)*d|0)|o<<8))|o<<4))|o<<2))|o<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-c)*d|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function AC(o){var r=o,a=o;do{(r.x<a.x||r.x===a.x&&r.y<a.y)&&(a=r),r=r.next}while(r!==o);return a}function id(o,r,a,c,d,g,y,b){return(d-y)*(r-b)>=(o-y)*(g-b)&&(o-y)*(c-b)>=(a-y)*(r-b)&&(a-y)*(g-b)>=(d-y)*(c-b)}function xg(o,r){return o.next.i!==r.i&&o.prev.i!==r.i&&!function(a,c){var d=a;do{if(d.i!==a.i&&d.next.i!==a.i&&d.i!==c.i&&d.next.i!==c.i&&cf(d,d.next,a,c))return!0;d=d.next}while(d!==a);return!1}(o,r)&&(od(o,r)&&od(r,o)&&function(a,c){var d=a,g=!1,y=(a.x+c.x)/2,b=(a.y+c.y)/2;do{d.y>b!=d.next.y>b&&d.next.y!==d.y&&y<(d.next.x-d.x)*(b-d.y)/(d.next.y-d.y)+d.x&&(g=!g),d=d.next}while(d!==a);return g}(o,r)&&(sr(o.prev,o,r.prev)||sr(o,r.prev,r))||lf(o,r)&&sr(o.prev,o,o.next)>0&&sr(r.prev,r,r.next)>0)}function sr(o,r,a){return(r.y-o.y)*(a.x-r.x)-(r.x-o.x)*(a.y-r.y)}function lf(o,r){return o.x===r.x&&o.y===r.y}function cf(o,r,a,c){var d=uf(sr(o,r,a)),g=uf(sr(o,r,c)),y=uf(sr(a,c,o)),b=uf(sr(a,c,r));return d!==g&&y!==b||!(0!==d||!rd(o,a,r))||!(0!==g||!rd(o,c,r))||!(0!==y||!rd(a,o,c))||!(0!==b||!rd(a,r,c))}function rd(o,r,a){return r.x<=Math.max(o.x,a.x)&&r.x>=Math.min(o.x,a.x)&&r.y<=Math.max(o.y,a.y)&&r.y>=Math.min(o.y,a.y)}function uf(o){return o>0?1:o<0?-1:0}function od(o,r){return sr(o.prev,o,o.next)<0?sr(o,r,o.next)>=0&&sr(o,o.prev,r)>=0:sr(o,r,o.prev)<0||sr(o,o.next,r)<0}function bg(o,r){var a=new Eg(o.i,o.x,o.y),c=new Eg(r.i,r.x,r.y),d=o.next,g=r.prev;return o.next=r,r.prev=o,a.next=d,d.prev=a,c.next=a,a.prev=c,g.next=c,c.prev=g,c}function wg(o,r,a,c){var d=new Eg(o,r,a);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function hf(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function Eg(o,r,a){this.i=o,this.x=r,this.y=a,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cg(o,r,a,c){for(var d=0,g=r,y=a-c;g<a;g+=c)d+=(o[y]-o[g])*(o[g+1]+o[y+1]),y=g;return d}Zu.exports=wp,Zu.exports.default=wp,wp.deviation=function(o,r,a,c){var d=r&&r.length,g=Math.abs(Cg(o,0,d?r[0]*a:o.length,a));if(d)for(var y=0,b=r.length;y<b;y++)g-=Math.abs(Cg(o,r[y]*a,y<b-1?r[y+1]*a:o.length,a));var E=0;for(y=0;y<c.length;y+=3){var D=c[y]*a,I=c[y+1]*a,k=c[y+2]*a;E+=Math.abs((o[D]-o[k])*(o[I+1]-o[D+1])-(o[D]-o[I])*(o[k+1]-o[D+1]))}return 0===g&&0===E?0:Math.abs((E-g)/g)},wp.flatten=function(o){for(var r=o[0][0].length,a={vertices:[],holes:[],dimensions:r},c=0,d=0;d<o.length;d++){for(var g=0;g<o[d].length;g++)for(var y=0;y<r;y++)a.vertices.push(o[d][g][y]);d>0&&a.holes.push(c+=o[d-1].length)}return a};var Dg=Er(Zu.exports);function gb(o,r,a,c,d){bc(o,r,a||0,c||o.length-1,d||_b)}function bc(o,r,a,c,d){for(;c>a;){if(c-a>600){var g=c-a+1,y=r-a+1,b=Math.log(g),E=.5*Math.exp(2*b/3),D=.5*Math.sqrt(b*E*(g-E)/g)*(y-g/2<0?-1:1);bc(o,r,Math.max(a,Math.floor(r-y*E/g+D)),Math.min(c,Math.floor(r+(g-y)*E/g+D)),d)}var I=o[r],k=a,L=c;for(wc(o,a,r),d(o[c],I)>0&&wc(o,a,c);k<L;){for(wc(o,k,L),k++,L--;d(o[k],I)<0;)k++;for(;d(o[L],I)>0;)L--}0===d(o[a],I)?wc(o,a,L):wc(o,++L,c),L<=r&&(a=L+1),r<=L&&(c=L-1)}}function wc(o,r,a){var c=o[r];o[r]=o[a],o[a]=c}function _b(o,r){return o<r?-1:o>r?1:0}function Jy(o,r){const a=o.length;if(a<=1)return[o];const c=[];let d,g;for(let y=0;y<a;y++){const b=tc(o[y]);0!==b&&(o[y].area=Math.abs(b),void 0===g&&(g=b<0),g===b<0?(d&&c.push(d),d=[o[y]]):d.push(o[y]))}if(d&&c.push(d),r>1)for(let y=0;y<c.length;y++)c[y].length<=r||(gb(c[y],r,1,c[y].length-1,IC),c[y]=c[y].slice(0,r));return c}function IC(o,r){return r.area-o.area}function Qy(o,r,a){const c=a.patternDependencies;let d=!1;for(const g of r){const y=g.paint.get(`${o}-pattern`);y.isConstant()||(d=!0);const b=y.constantOr(null);b&&(d=!0,c[b]=!0)}return d}function ev(o,r,a,c,d){const g=d.patternDependencies;for(const y of r){const b=y.paint.get(`${o}-pattern`).value;if("constant"!==b.kind){let E=b.evaluate({zoom:c},a,{},d.availableImages);E=E&&E.name?E.name:E,g[E]=!0,a.patterns[y.id]=E}}return a}class Tg{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new tt,this.indexArray=new Ct,this.indexArray2=new rr,this.programConfigurations=new Uu(r.layers,r.zoom),this.segments=new pr,this.segments2=new pr,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.projection=r.projection}populate(r,a,c,d){this.hasPattern=Qy("fill",this.layers,a);const g=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:b,id:E,index:D,sourceLayerIndex:I}of r){const k=this.layers[0]._featureFilter.needGeometry,L=eu(b,k);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),L,c))continue;const z=g?g.evaluate(L,{},c,a.availableImages):void 0,V={id:E,properties:b.properties,type:b.type,sourceLayerIndex:I,index:D,geometry:k?L.geometry:tl(b,c,d),patterns:{},sortKey:z};y.push(V)}g&&y.sort((b,E)=>b.sortKey-E.sortKey);for(const b of y){const{geometry:E,index:D,sourceLayerIndex:I}=b;if(this.hasPattern){const k=ev("fill",this.layers,b,this.zoom,a);this.patternFeatures.push(k)}else this.addFeature(b,E,D,c,{},a.availableImages);a.featureIndex.insert(r[D].feature,E,D,I,this.index)}}update(r,a,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,c,d)}addFeatures(r,a,c,d,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,gg),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.indexBuffer2=r.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(r,a,c,d,g,y=[]){for(const b of Jy(a,500)){let E=0;for(const V of b)E+=V.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),I=D.vertexLength,k=[],L=[];for(const V of b){if(0===V.length)continue;V!==b[0]&&L.push(k.length/2);const H=this.segments2.prepareSegment(V.length,this.layoutVertexArray,this.indexArray2),K=H.vertexLength;this.layoutVertexArray.emplaceBack(V[0].x,V[0].y),this.indexArray2.emplaceBack(K+V.length-1,K),k.push(V[0].x),k.push(V[0].y);for(let ie=1;ie<V.length;ie++)this.layoutVertexArray.emplaceBack(V[ie].x,V[ie].y),this.indexArray2.emplaceBack(K+ie-1,K+ie),k.push(V[ie].x),k.push(V[ie].y);H.vertexLength+=V.length,H.primitiveLength+=V.length}const z=Dg(k,L);for(let V=0;V<z.length;V+=3)this.indexArray.emplaceBack(I+z[V],I+z[V+1],I+z[V+2]);D.vertexLength+=E,D.primitiveLength+=z.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,g,y,d)}}De(Tg,"FillBucket",{omit:["layers","patternFeatures"]});const tv=new oe({"fill-sort-key":new Y(Ue.layout_fill["fill-sort-key"])});var yb={paint:new oe({"fill-antialias":new $(Ue.paint_fill["fill-antialias"]),"fill-opacity":new Y(Ue.paint_fill["fill-opacity"]),"fill-color":new Y(Ue.paint_fill["fill-color"]),"fill-outline-color":new Y(Ue.paint_fill["fill-outline-color"]),"fill-translate":new $(Ue.paint_fill["fill-translate"]),"fill-translate-anchor":new $(Ue.paint_fill["fill-translate-anchor"]),"fill-pattern":new Y(Ue.paint_fill["fill-pattern"])}),layout:tv};const vb=we([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),xb=we([{name:"a_centroid_pos",components:2,type:"Uint16"}]),bb=we([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Sg}=vb;var xa={},df=ki,Mg=Ku;function Ku(o,r,a,c,d){this.properties={},this.extent=a,this.type=0,this._pbf=o,this._geometry=-1,this._keys=c,this._values=d,o.readFields(nv,this,r)}function nv(o,r,a){1==o?r.id=a.readVarint():2==o?function(c,d){for(var g=c.readVarint()+c.pos;c.pos<g;){var y=d._keys[c.readVarint()],b=d._values[c.readVarint()];d.properties[y]=b}}(a,r):3==o?r.type=a.readVarint():4==o&&(r._geometry=a.pos)}function PC(o){for(var r,a,c=0,d=0,g=o.length,y=g-1;d<g;y=d++)c+=((a=o[y]).x-(r=o[d]).x)*(r.y+a.y);return c}Ku.types=["Unknown","Point","LineString","Polygon"],Ku.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var r,a=o.readVarint()+o.pos,c=1,d=0,g=0,y=0,b=[];o.pos<a;){if(d<=0){var E=o.readVarint();c=7&E,d=E>>3}if(d--,1===c||2===c)g+=o.readSVarint(),y+=o.readSVarint(),1===c&&(r&&b.push(r),r=[]),r.push(new df(g,y));else{if(7!==c)throw new Error("unknown command "+c);r&&r.push(r[0].clone())}}return r&&b.push(r),b},Ku.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var r=o.readVarint()+o.pos,a=1,c=0,d=0,g=0,y=1/0,b=-1/0,E=1/0,D=-1/0;o.pos<r;){if(c<=0){var I=o.readVarint();a=7&I,c=I>>3}if(c--,1===a||2===a)(d+=o.readSVarint())<y&&(y=d),d>b&&(b=d),(g+=o.readSVarint())<E&&(E=g),g>D&&(D=g);else if(7!==a)throw new Error("unknown command "+a)}return[y,E,b,D]},Ku.prototype.toGeoJSON=function(o,r,a){var c,d,g=this.extent*Math.pow(2,a),y=this.extent*o,b=this.extent*r,E=this.loadGeometry(),D=Ku.types[this.type];function I(z){for(var V=0;V<z.length;V++){var H=z[V];z[V]=[360*(H.x+y)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(H.y+b)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var k=[];for(c=0;c<E.length;c++)k[c]=E[c][0];I(E=k);break;case 2:for(c=0;c<E.length;c++)I(E[c]);break;case 3:for(E=function(z){var V=z.length;if(V<=1)return[z];for(var H,K,ie=[],ue=0;ue<V;ue++){var ne=PC(z[ue]);0!==ne&&(void 0===K&&(K=ne<0),K===ne<0?(H&&ie.push(H),H=[z[ue]]):H.push(z[ue]))}return H&&ie.push(H),ie}(E),c=0;c<E.length;c++)for(d=0;d<E[c].length;d++)I(E[c][d])}1===E.length?E=E[0]:D="Multi"+D;var L={type:"Feature",geometry:{type:D,coordinates:E},properties:this.properties};return"id"in this&&(L.id=this.id),L};var kC=Mg,wb=Cp;function Cp(o,r){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(Ag,this,r),this.length=this._features.length}function Ag(o,r,a){15===o?r.version=a.readVarint():1===o?r.name=a.readString():5===o?r.extent=a.readVarint():2===o?r._features.push(a.pos):3===o?r._keys.push(a.readString()):4===o&&r._values.push(function(c){for(var d=null,g=c.readVarint()+c.pos;c.pos<g;){var y=c.readVarint()>>3;d=1===y?c.readString():2===y?c.readFloat():3===y?c.readDouble():4===y?c.readVarint64():5===y?c.readVarint():6===y?c.readSVarint():7===y?c.readBoolean():null}return d}(a))}Cp.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var r=this._pbf.readVarint()+this._pbf.pos;return new kC(this._pbf,r,this.extent,this._keys,this._values)};var RC=wb;function OC(o,r,a){if(3===o){var c=new RC(a,a.readVarint()+a.pos);c.length&&(r[c.name]=c)}}var Dp=xa.VectorTile=function(o,r){this.layers=o.readFields(OC,{},r)},Tp=xa.VectorTileFeature=Mg;function Sp(o,r,a,c){const d=[],g=0===c?(y,b,E,D,I,k)=>{y.push(new ct(k,E+(k-b)/(D-b)*(I-E)))}:(y,b,E,D,I,k)=>{y.push(new ct(b+(k-E)/(I-E)*(D-b),k))};for(const y of o){const b=[];for(const E of y){if(E.length<=2)continue;const D=[];for(let L=0;L<E.length-1;L++){const z=E[L].x,V=E[L].y,H=E[L+1].x,K=E[L+1].y,ie=0===c?z:V,ue=0===c?H:K;ie<r?ue>r&&g(D,z,V,H,K,r):ie>a?ue<a&&g(D,z,V,H,K,a):D.push(E[L]),ue<r&&ie>=r&&g(D,z,V,H,K,r),ue>a&&ie<=a&&g(D,z,V,H,K,a)}let I=E[E.length-1];const k=0===c?I.x:I.y;k>=r&&k<=a&&D.push(I),D.length&&(I=D[D.length-1],D[0].x===I.x&&D[0].y===I.y||D.push(D[0]),b.push(D))}b.length&&d.push(b)}return d}xa.VectorTileLayer=wb;const Eb=Tp.types,Cb=Math.pow(2,13);function sd(o,r,a,c,d,g,y,b){o.emplaceBack((r<<1)+y,(a<<1)+g,(Math.floor(c*Cb)<<1)+d,Math.round(b))}function tu(o,r,a){o.emplaceBack(r.x,r.y,r.z,16384*a[0],16384*a[1],16384*a[2])}class iv{constructor(){this.acc=new ct(0,0),this.polyCount=[]}startRing(r){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ct(r.x,r.y),this.max=new ct(r.x,r.y))}append(r,a){this.currentPolyCount.edges++,this.acc._add(r);const c=this.min,d=this.max;r.x<c.x?c.x=r.x:r.x>d.x&&(d.x=r.x),r.y<c.y?c.y=r.y:r.y>d.y&&(d.y=r.y),((0===r.x||r.x===Pt)&&r.x===a.x)!=((0===r.y||r.y===Pt)&&r.y===a.y)&&this.processBorderOverlap(r,a),a.x<0!=r.x<0&&this.addBorderIntersection(0,En(a.y,r.y,(0-a.x)/(r.x-a.x))),a.x>Pt!=r.x>Pt&&this.addBorderIntersection(1,En(a.y,r.y,(Pt-a.x)/(r.x-a.x))),a.y<0!=r.y<0&&this.addBorderIntersection(2,En(a.x,r.x,(0-a.y)/(r.y-a.y))),a.y>Pt!=r.y>Pt&&this.addBorderIntersection(3,En(a.x,r.x,(Pt-a.y)/(r.y-a.y)))}addBorderIntersection(r,a){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[r];a<c[0]&&(c[0]=a),a>c[1]&&(c[1]=a)}processBorderOverlap(r,a){if(r.x===a.x){if(r.y===a.y)return;const c=0===r.x?0:1;this.addBorderIntersection(c,a.y),this.addBorderIntersection(c,r.y)}else{const c=0===r.y?2:3;this.addBorderIntersection(c,a.x),this.addBorderIntersection(c,r.x)}}centroid(){const r=this.polyCount.reduce((a,c)=>a+c.edges,0);return 0!==r?this.acc.div(r)._round():new ct(0,0)}span(){return new ct(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((r,a)=>r+ +(a[0]!==Number.MAX_VALUE),0)}}class Yu{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.layoutVertexArray=new qe,this.centroidVertexArray=new ga,this.indexArray=new Ct,this.programConfigurations=new Uu(r.layers,r.zoom),this.segments=new pr,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id),this.enableTerrain=r.enableTerrain}populate(r,a,c,d){this.features=[],this.hasPattern=Qy("fill-extrusion",this.layers,a),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(g){const y=Math.exp(Math.PI*(1-g.y/(1<<g.z)*2));return 80150034*y/(y*y+1)/Pt/(1<<g.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:g,id:y,index:b,sourceLayerIndex:E}of r){const D=this.layers[0]._featureFilter.needGeometry,I=eu(g,D);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),I,c))continue;const k={id:y,sourceLayerIndex:E,index:b,geometry:D?I.geometry:tl(g,c,d),properties:g.properties,type:g.type,patterns:{}},L=this.layoutVertexArray.length;this.hasPattern?this.features.push(ev("fill-extrusion",this.layers,k,this.zoom,a)):this.addFeature(k,k.geometry,b,c,{},a.availableImages,d),a.featureIndex.insert(g,k.geometry,b,E,this.index,L)}this.sortBorders()}addFeatures(r,a,c,d,g){for(const y of this.features){const{geometry:b}=y;this.addFeature(y,b,y.index,a,c,d,g)}this.sortBorders()}update(r,a,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Sg),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,bb.members,!0))),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,xb.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,a,c,d,g,y,b){const E=[new ct(0,0),new ct(Pt,Pt)],D=b.projection,I="globe"===D.name,k=this.enableTerrain&&!I?new iv:null,L="Polygon"===Eb[r.type];I&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new it);const z=Jy(a,500);for(let ie=z.length-1;ie>=0;ie--){const ue=z[ie];(0===ue.length||(V=ue[0]).every(ne=>ne.x<=0)||V.every(ne=>ne.x>=Pt)||V.every(ne=>ne.y<=0)||V.every(ne=>ne.y>=Pt))&&z.splice(ie,1)}var V;let H;if(I)H=lv(z,E,d);else{H=[];for(const ie of z)H.push({polygon:ie,bounds:E})}const K=L?this.edgeRadius:0;for(const{polygon:ie,bounds:ue}of H){let ne=0,ce=0;for(const pe of ie)L&&!pe[0].equals(pe[pe.length-1])&&pe.push(pe[0]),ce+=L?pe.length-1:pe.length;const me=this.segments.prepareSegment((L?5:4)*ce,this.layoutVertexArray,this.indexArray);if(L){const pe=[],Ae=[];ne=me.vertexLength;for(const Ve of ie){let et,Re;Ve.length&&Ve!==ie[0]&&Ae.push(pe.length/2),et=Ve[1].sub(Ve[0])._perp()._unit();for(let We=1;We<Ve.length;We++){const Ze=Ve[We],Qe=Ve[We===Ve.length-1?1:We+1];let{x:rt,y:Ne}=Ze;if(K){Re=Qe.sub(Ze)._perp()._unit();const mt=et.add(Re)._unit(),bt=K*Math.min(4,1/(et.x*mt.x+et.y*mt.y));rt+=bt*mt.x,Ne+=bt*mt.y,et=Re}sd(this.layoutVertexArray,rt,Ne,0,0,1,1,0),me.vertexLength++,pe.push(Ze.x,Ze.y),I&&tu(this.layoutVertexExtArray,D.projectTilePoint(rt,Ne,d),D.upVector(d,rt,Ne))}}const Me=Dg(pe,Ae);for(let Ve=0;Ve<Me.length;Ve+=3)this.indexArray.emplaceBack(ne+Me[Ve],ne+Me[Ve+2],ne+Me[Ve+1]),me.primitiveLength++}for(const pe of ie){k&&pe.length&&k.startRing(pe[0]);let Ae,Me,Ve,et=pe.length>4&&Mp(pe[pe.length-2],pe[0],pe[1]),Re=K?Ir(pe[pe.length-2],pe[0],pe[1],K):0;Me=pe[1].sub(pe[0])._perp()._unit();let We=!0;for(let Ze=1,Qe=0;Ze<pe.length;Ze++){let rt=pe[Ze-1],Ne=pe[Ze];const mt=pe[Ze===pe.length-1?1:Ze+1];if(k&&L&&k.currentPolyCount.top++,sv(Ne,rt,ue)){K&&(Me=mt.sub(Ne)._perp()._unit(),We=!We);continue}k&&k.append(Ne,rt);const bt=Ne.sub(rt)._perp(),_t=bt.x/(Math.abs(bt.x)+Math.abs(bt.y)),Kt=bt.y>0?1:0,lt=rt.dist(Ne);if(Qe+lt>32768&&(Qe=0),K){Ve=mt.sub(Ne)._perp()._unit();let Jt=ov(rt,Ne,mt,rv(Me,Ve),K);isNaN(Jt)&&(Jt=0);const Ot=Ne.sub(rt)._unit();rt=rt.add(Ot.mult(Re))._round(),Ne=Ne.add(Ot.mult(-Jt))._round(),Re=Jt,Me=Ve}const At=me.vertexLength,Yt=pe.length>4&&Mp(rt,Ne,mt);let In=Ig(Qe,et,We);if(sd(this.layoutVertexArray,rt.x,rt.y,_t,Kt,0,0,In),sd(this.layoutVertexArray,rt.x,rt.y,_t,Kt,0,1,In),Qe+=lt,In=Ig(Qe,Yt,!We),et=Yt,sd(this.layoutVertexArray,Ne.x,Ne.y,_t,Kt,0,0,In),sd(this.layoutVertexArray,Ne.x,Ne.y,_t,Kt,0,1,In),me.vertexLength+=4,this.indexArray.emplaceBack(At+0,At+1,At+2),this.indexArray.emplaceBack(At+1,At+3,At+2),me.primitiveLength+=2,K){const Jt=ne+(1===Ze?pe.length-2:Ze-2),Ot=1===Ze?ne:Jt+1;if(this.indexArray.emplaceBack(At+1,Jt,At+3),this.indexArray.emplaceBack(Jt,Ot,At+3),me.primitiveLength+=2,void 0===Ae&&(Ae=At),!sv(mt,pe[Ze],ue)){const bi=Ze===pe.length-1?Ae:me.vertexLength;this.indexArray.emplaceBack(At+2,At+3,bi),this.indexArray.emplaceBack(At+3,bi+1,bi),this.indexArray.emplaceBack(At+3,Ot,bi+1),me.primitiveLength+=3}We=!We}if(I){const Jt=this.layoutVertexExtArray,Ot=D.projectTilePoint(rt.x,rt.y,d),bi=D.projectTilePoint(Ne.x,Ne.y,d),jt=D.upVector(d,rt.x,rt.y),tn=D.upVector(d,Ne.x,Ne.y);tu(Jt,Ot,jt),tu(Jt,Ot,jt),tu(Jt,bi,tn),tu(Jt,bi,tn)}}L&&(ne+=pe.length-1)}}if(k&&k.polyCount.length>0){if(k.borders){k.vertexArrayOffset=this.centroidVertexArray.length;const ie=k.borders,ue=this.featuresOnBorder.push(k)-1;for(let ne=0;ne<4;ne++)ie[ne][0]!==Number.MAX_VALUE&&this.borders[ne].push(ue)}this.encodeCentroid(k.borders?void 0:k.centroid(),k)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,g,y,d)}sortBorders(){for(let r=0;r<4;r++)this.borders[r].sort((a,c)=>this.featuresOnBorder[a].borders[r][0]-this.featuresOnBorder[c].borders[r][0])}encodeCentroid(r,a,c=!0){let d,g;if(r)if(0!==r.y){const b=a.span()._mult(this.tileToMeter);d=(Math.max(r.x,1)<<3)+Math.min(7,Math.round(b.x/10)),g=(Math.max(r.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else d=Math.ceil(7*(r.x+450)),g=0;else d=0,g=+c;let y=c?this.centroidVertexArray.length:a.vertexArrayOffset;for(const b of a.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let E=0;E<b.top;E++)this.centroidVertexArray.emplace(y++,d,g);for(let E=0;E<2*b.edges;E++)this.centroidVertexArray.emplace(y++,0,g),this.centroidVertexArray.emplace(y++,d,g)}}}function rv(o,r){const a=o.add(r)._unit();return o.x*a.x+o.y*a.y}function Ir(o,r,a,c){const d=r.sub(o)._perp()._unit(),g=a.sub(r)._perp()._unit();return ov(o,r,a,rv(d,g),c)}function ov(o,r,a,c,d){const g=Math.sqrt(1-c*c);return Math.min(o.dist(r)/3,r.dist(a)/3,d*g/c)}function sv(o,r,a){return o.x<a[0].x&&r.x<a[0].x||o.x>a[1].x&&r.x>a[1].x||o.y<a[0].y&&r.y<a[0].y||o.y>a[1].y&&r.y>a[1].y}function Mp(o,r,a){if(o.x<0||o.x>=Pt||r.x<0||r.x>=Pt||a.x<0||a.x>=Pt)return!1;const c=a.sub(r),d=c.perp(),g=o.sub(r);return(c.x*g.x+c.y*g.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(g.x*g.x+g.y*g.y))>-.866&&d.x*g.x+d.y*g.y<0}function Ig(o,r,a){const c=r?2|o:-3&o;return a?1|c:-2&c}function av(){const o=Math.PI/32,r=Math.tan(o),a=Jh;return a*Math.sqrt(1+2*r*r)-a}function lv(o,r,a){const c=1<<a.z,d=Ys(a.x/c),g=Ys((a.x+1)/c),y=Zr(a.y/c),b=Zr((a.y+1)/c);return function(E,D,I,k,L=0,z){const V=[];if(!E.length||!I||!k)return V;const H=(pe,Ae)=>{for(const Me of pe)V.push({polygon:Me,bounds:Ae})},K=Math.ceil(Math.log2(I)),ie=Math.ceil(Math.log2(k)),ue=K-ie,ne=[];for(let pe=0;pe<Math.abs(ue);pe++)ne.push(ue>0?0:1);for(let pe=0;pe<Math.min(K,ie);pe++)ne.push(0),ne.push(1);let ce=E;if(ce=Sp(ce,D[0].y-L,D[1].y+L,1),ce=Sp(ce,D[0].x-L,D[1].x+L,0),!ce.length)return V;const me=[];for(ne.length?me.push({polygons:ce,bounds:D,depth:0}):H(ce,D);me.length;){const pe=me.pop(),Ae=pe.depth,Me=ne[Ae],Ve=pe.bounds[0],et=pe.bounds[1],Re=0===Me?Ve.x:Ve.y,We=0===Me?et.x:et.y,Ze=z?z(Me,Re,We):.5*(Re+We),Qe=Sp(pe.polygons,Re-L,Ze+L,Me),rt=Sp(pe.polygons,Ze-L,We+L,Me);if(Qe.length){const Ne=[Ve,new ct(0===Me?Ze:et.x,1===Me?Ze:et.y)];ne.length>Ae+1?me.push({polygons:Qe,bounds:Ne,depth:Ae+1}):H(Qe,Ne)}if(rt.length){const Ne=[new ct(0===Me?Ze:Ve.x,1===Me?Ze:Ve.y),et];ne.length>Ae+1?me.push({polygons:rt,bounds:Ne,depth:Ae+1}):H(rt,Ne)}}return V}(o,r,Math.ceil((g-d)/11.25),Math.ceil((y-b)/11.25),1,(E,D,I)=>{if(0===E)return.5*(D+I);{const k=Zr((a.y+D/Pt)/c);return(zl(.5*(Zr((a.y+I/Pt)/c)+k))*c-a.y)*Pt}})}De(Yu,"FillExtrusionBucket",{omit:["layers","features"]}),De(iv,"PartMetadata");const Db=new oe({"fill-extrusion-edge-radius":new $(Ue["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Tb={paint:new oe({"fill-extrusion-opacity":new $(Ue["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Y(Ue["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $(Ue["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $(Ue["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Y(Ue["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Y(Ue["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Y(Ue["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $(Ue["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new $(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new $(Ue["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new $(Ue["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Db};function Pg(o,r,a){var c=2*Math.PI*6378137/256/Math.pow(2,a);return[o*c-2*Math.PI*6378137/2,r*c-2*Math.PI*6378137/2]}class kg{constructor(r,a,c){this.z=r,this.x=a,this.y=c,this.key=nu(0,r,r,a,c)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}url(r,a){const c=(y=this.y,b=this.z,E=Pg(256*(g=this.x),256*(y=Math.pow(2,b)-y-1),b),D=Pg(256*(g+1),256*(y+1),b),E[0]+","+E[1]+","+D[0]+","+D[1]),d=function(g,y,b){let E,D="";for(let I=g;I>0;I--)E=1<<I-1,D+=(y&E?1:0)+(b&E?2:0);return D}(this.z,this.x,this.y);var g,y,b,E,D;return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===a?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Sb{constructor(r,a){this.wrap=r,this.canonical=a,this.key=nu(r,a.z,a.z,a.x,a.y)}}class Pr{constructor(r,a,c,d,g){this.overscaledZ=r,this.wrap=a,this.canonical=new kg(c,+d,+g),this.key=0===a&&r===c?this.canonical.key:nu(a,r,c,d,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const a=this.canonical.z-r;return r>this.canonical.z?new Pr(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Pr(r,this.wrap,r,this.canonical.x>>a,this.canonical.y>>a)}calculateScaledKey(r,a=!0){if(this.overscaledZ===r&&a)return this.key;if(r>this.canonical.z)return nu(this.wrap*+a,r,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-r;return nu(this.wrap*+a,r,r,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const a=this.canonical.z-r.canonical.z;return 0===r.overscaledZ||r.overscaledZ<this.overscaledZ&&r.canonical.x===this.canonical.x>>a&&r.canonical.y===this.canonical.y>>a}children(r){if(this.overscaledZ>=r)return[new Pr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const a=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new Pr(a,this.wrap,a,c,d),new Pr(a,this.wrap,a,c+1,d),new Pr(a,this.wrap,a,c,d+1),new Pr(a,this.wrap,a,c+1,d+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Pr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Pr(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Sb(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nu(o,r,a,c,d){const g=1<<Math.min(a,22);let y=g*(d%g)+c%g;return o&&a<22&&(y+=g*g*((o<0?-2*o-1:2*o)%(1<<2*(22-a)))),16*(32*y+a)+(r-a)}De(kg,"CanonicalTileID"),De(Pr,"OverscaledTileID",{omit:["projMatrix"]});class Ju extends ct{constructor(r,a,c){super(r,a),this.z=c}}function ad(o,r){return o.x*r.x+o.y*r.y}function Rg(o,r){if(1===o.length){let a=0;const c=r[a++];let d;for(;!d||c.equals(d);)if(d=r[a++],!d)return 1/0;for(;a<r.length;a++){const g=r[a],y=o[0],b=d.sub(c),E=g.sub(c),D=y.sub(c),I=ad(b,b),k=ad(b,E),L=ad(E,E),z=ad(D,b),V=ad(D,E),H=I*L-k*k,K=(L*z-k*V)/H,ie=(I*V-k*z)/H,ue=c.z*(1-K-ie)+d.z*K+g.z*ie;if(isFinite(ue))return ue}return 1/0}{let a=1/0;for(const c of r)a=Math.min(a,c.z);return a}}function cv(o,r,a,c,d,g,y,b){const E=y*d.getElevationAt(o,r,!0,!0),D=0!==g[0],I=D?0===g[1]?y*(g[0]/7-450):y*function(k,L,z){const V=Math.floor(L[0]/8),H=Math.floor(L[1]/8),K=10*(L[0]-8*V),ie=10*(L[1]-8*H),ue=k.getElevationAt(V,H,!0,!0),ne=k.getMeterToDEM(z),ce=Math.floor(.5*(K*ne-1)),me=Math.floor(.5*(ie*ne-1)),pe=k.tileCoordToPixel(V,H),Ae=2*ce+1,Me=2*me+1,Ve=(bt=Ae,_t=Me,[(rt=k).getElevationAtPixel(Ne=pe.x-ce,mt=pe.y-me,!0),rt.getElevationAtPixel(Ne+_t,mt,!0),rt.getElevationAtPixel(Ne,mt+_t,!0),rt.getElevationAtPixel(Ne+bt,mt+_t,!0)]),et=Math.abs(Ve[0]-Ve[1]),Re=Math.abs(Ve[2]-Ve[3]),We=Math.abs(Ve[0]-Ve[2])+Math.abs(Ve[1]-Ve[3]),Ze=Math.min(.25,.5*ne*(et+Re)/Ae),Qe=Math.min(.25,.5*ne*We/Me);var rt,Ne,mt,bt,_t;return ue+Math.max(Ze*K,Qe*ie)}(d,g,b):E;return{base:E+(0===a)?-1:a,top:D?Math.max(I+c,E+a+2):E+c}}const Mb=we([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:uv}=Mb,hv=we([{name:"a_packed",components:4,type:"Float32"}]),{members:Og}=hv,FC=Tp.types,Fg=Math.cos(Math.PI/180*37.5);class Ap{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(a=>a.id),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(a=>{this.gradients[a.id]={}}),this.layoutVertexArray=new Fe,this.layoutVertexArray2=new nt,this.indexArray=new Ct,this.programConfigurations=new Uu(r.layers,r.zoom),this.segments=new pr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(a=>a.isStateDependent()).map(a=>a.id)}populate(r,a,c,d){this.hasPattern=Qy("line",this.layers,a);const g=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:I,id:k,index:L,sourceLayerIndex:z}of r){const V=this.layers[0]._featureFilter.needGeometry,H=eu(I,V);if(!this.layers[0]._featureFilter.filter(new P(this.zoom),H,c))continue;const K=g?g.evaluate(H,{},c):void 0,ie={id:k,properties:I.properties,type:I.type,sourceLayerIndex:z,index:L,geometry:V?H.geometry:tl(I,c,d),patterns:{},sortKey:K};y.push(ie)}g&&y.sort((I,k)=>I.sortKey-k.sortKey);const{lineAtlas:b,featureIndex:E}=a,D=this.addConstantDashes(b);for(const I of y){const{geometry:k,index:L,sourceLayerIndex:z}=I;if(D&&this.addFeatureDashes(I,b),this.hasPattern){const V=ev("line",this.layers,I,this.zoom,a);this.patternFeatures.push(V)}else this.addFeature(I,k,L,c,b.positions,a.availableImages);E.insert(r[L].feature,k,L,z,this.index)}}addConstantDashes(r){let a=!1;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,g=c.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==g.kind)a=!0;else{const y=g.value,b=d.value;if(!b)continue;r.addDash(b,y)}}return a}addFeatureDashes(r,a){const c=this.zoom;for(const d of this.layers){const g=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if("constant"===g.kind&&"constant"===y.kind)continue;let b,E;if("constant"===g.kind){if(b=g.value,!b)continue}else b=g.evaluate({zoom:c},r);E="constant"===y.kind?y.value:y.evaluate({zoom:c},r),a.addDash(b,E),r.patterns[d.id]=a.getKey(b,E)}}update(r,a,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(r,a,this.stateDependentLayers,c,d)}addFeatures(r,a,c,d,g){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,a,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,Og)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,uv),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r){if(r.properties&&r.properties.hasOwnProperty("mapbox_clip_start")&&r.properties.hasOwnProperty("mapbox_clip_end"))return{start:+r.properties.mapbox_clip_start,end:+r.properties.mapbox_clip_end}}addFeature(r,a,c,d,g,y){const b=this.layers[0].layout,E=b.get("line-join").evaluate(r,{}),D=b.get("line-cap").evaluate(r,{}),I=b.get("line-miter-limit"),k=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(r);for(const L of a)this.addLine(L,r,E,D,I,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,c,g,y,d)}addLine(r,a,c,d,g,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ie=0;ie<r.length-1;ie++)this.totalDistance+=r[ie].dist(r[ie+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b="Polygon"===FC[a.type];let E=r.length;for(;E>=2&&r[E-1].equals(r[E-2]);)E--;let D=0;for(;D<E-1&&r[D].equals(r[D+1]);)D++;if(E<(b?3:2))return;"bevel"===c&&(g=1.05);const I=this.overscaling<=16?15*Pt/(512*this.overscaling):0,k=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let L,z,V,H,K;this.e1=this.e2=-1,b&&(L=r[E-2],K=r[D].sub(L)._unit()._perp());for(let ie=D;ie<E;ie++){if(V=ie===E-1?b?r[D+1]:void 0:r[ie+1],V&&r[ie].equals(V))continue;K&&(H=K),L&&(z=L),L=r[ie],K=V?V.sub(L)._unit()._perp():H,H=H||K;let ue=H.add(K);0===ue.x&&0===ue.y||ue._unit();const ne=H.x*K.x+H.y*K.y,ce=ue.x*K.x+ue.y*K.y,me=0!==ce?1/ce:1/0,pe=2*Math.sqrt(2-2*ce),Ae=ce<Fg&&z&&V,Me=H.x*K.y-H.y*K.x>0;if(Ae&&ie>D){const Re=L.dist(z);if(Re>2*I){const We=L.sub(L.sub(z)._mult(I/Re)._round());this.updateDistance(z,We),this.addCurrentVertex(We,H,0,0,k),z=We}}const Ve=z&&V;let et=Ve?c:b?"butt":d;if(Ve&&"round"===et&&(me<y?et="miter":me<=2&&(et="fakeround")),"miter"===et&&me>g&&(et="bevel"),"bevel"===et&&(me>2&&(et="flipbevel"),me<g&&(et="miter")),z&&this.updateDistance(z,L),"miter"===et)ue._mult(me),this.addCurrentVertex(L,ue,0,0,k);else if("flipbevel"===et){if(me>100)ue=K.mult(-1);else{const Re=me*H.add(K).mag()/H.sub(K).mag();ue._perp()._mult(Re*(Me?-1:1))}this.addCurrentVertex(L,ue,0,0,k),this.addCurrentVertex(L,ue.mult(-1),0,0,k)}else if("bevel"===et||"fakeround"===et){const Re=-Math.sqrt(me*me-1),We=Me?Re:0,Ze=Me?0:Re;if(z&&this.addCurrentVertex(L,H,We,Ze,k),"fakeround"===et){const Qe=Math.round(180*pe/Math.PI/20);for(let rt=1;rt<Qe;rt++){let Ne=rt/Qe;if(.5!==Ne){const bt=Ne-.5;Ne+=Ne*bt*(Ne-1)*((1.0904+ne*(ne*(3.55645-1.43519*ne)-3.2452))*bt*bt+(.848013+ne*(.215638*ne-1.06021)))}const mt=K.sub(H)._mult(Ne)._add(H)._unit()._mult(Me?-1:1);this.addHalfVertex(L,mt.x,mt.y,!1,Me,0,k)}}V&&this.addCurrentVertex(L,K,-We,-Ze,k)}else if("butt"===et)this.addCurrentVertex(L,ue,0,0,k);else if("square"===et){const Re=z?1:-1;z||this.addCurrentVertex(L,ue,Re,Re,k),this.addCurrentVertex(L,ue,0,0,k),z&&this.addCurrentVertex(L,ue,Re,Re,k)}else"round"===et&&(z&&(this.addCurrentVertex(L,H,0,0,k),this.addCurrentVertex(L,H,1,1,k,!0)),V&&(this.addCurrentVertex(L,K,-1,-1,k,!0),this.addCurrentVertex(L,K,0,0,k)));if(Ae&&ie<E-1){const Re=L.dist(V);if(Re>2*I){const We=L.add(V.sub(L)._mult(I/Re)._round());this.updateDistance(L,We),this.addCurrentVertex(We,K,0,0,k),L=We}}}}addCurrentVertex(r,a,c,d,g,y=!1){const b=a.y*d-a.x,E=-a.y-a.x*d;this.addHalfVertex(r,a.x+a.y*c,a.y-a.x*c,y,!1,c,g),this.addHalfVertex(r,b,E,y,!0,-d,g)}addHalfVertex({x:r,y:a},c,d,g,y,b,E){this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(a<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*d)+128,1+(0===b?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),E.primitiveLength++),y?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const r=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=r*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(r,a){this.distance+=r.dist(a),this.updateScaledDistance()}}De(Ap,"LineBucket",{omit:["layers","patternFeatures"]});const Lg=new oe({"line-cap":new Y(Ue.layout_line["line-cap"]),"line-join":new Y(Ue.layout_line["line-join"]),"line-miter-limit":new $(Ue.layout_line["line-miter-limit"]),"line-round-limit":new $(Ue.layout_line["line-round-limit"]),"line-sort-key":new Y(Ue.layout_line["line-sort-key"])});var Ng={paint:new oe({"line-opacity":new Y(Ue.paint_line["line-opacity"]),"line-color":new Y(Ue.paint_line["line-color"]),"line-translate":new $(Ue.paint_line["line-translate"]),"line-translate-anchor":new $(Ue.paint_line["line-translate-anchor"]),"line-width":new Y(Ue.paint_line["line-width"]),"line-gap-width":new Y(Ue.paint_line["line-gap-width"]),"line-offset":new Y(Ue.paint_line["line-offset"]),"line-blur":new Y(Ue.paint_line["line-blur"]),"line-dasharray":new Y(Ue.paint_line["line-dasharray"]),"line-pattern":new Y(Ue.paint_line["line-pattern"]),"line-gradient":new ae(Ue.paint_line["line-gradient"]),"line-trim-offset":new $(Ue.paint_line["line-trim-offset"])}),layout:Lg};const Bg=new class extends Y{possiblyEvaluate(o,r){return r=new P(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,transition:r.transition}),super.possiblyEvaluate(o,r)}evaluate(o,r,a,c){return r=Ei({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(o,r,a,c)}}(Ng.paint.properties["line-width"].specification);function iu(o,r){return r>0?r+2*o:o}Bg.useIntegerZoom=!0;const Ab=we([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),zg=we([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Ip=we([{name:"a_projected_pos",components:4,type:"Float32"}],4);we([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ib=we([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Vg=we([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);we([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const ff=we([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ul=we([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);we([{name:"triangle",components:3,type:"Uint16"}]),we([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),we([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),we([{type:"Float32",name:"offsetX"}]),we([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var kr=24;const Js=128;function Ug(o,r){const{expression:a}=r;if("constant"===a.kind)return{kind:"constant",layoutSize:a.evaluate(new P(o+1))};if("source"===a.kind)return{kind:"source"};{const{zoomStops:c,interpolationType:d}=a;let g=0;for(;g<c.length&&c[g]<=o;)g++;g=Math.max(0,g-1);let y=g;for(;y<c.length&&c[y]<o+1;)y++;y=Math.min(c.length-1,y);const b=c[g],E=c[y];return"composite"===a.kind?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:d}:{kind:"camera",minZoom:b,maxZoom:E,minSize:a.evaluate(new P(b)),maxSize:a.evaluate(new P(E)),interpolationType:d}}}function Pp(o,{uSize:r,uSizeT:a},{lowerSize:c,upperSize:d}){return"source"===o.kind?c/Js:"composite"===o.kind?En(c/Js,d/Js,a):r}function Qu(o,r){let a=0,c=0;if("constant"===o.kind)c=o.layoutSize;else if("source"!==o.kind){const{interpolationType:d,minZoom:g,maxZoom:y}=o,b=d?zt(yn.interpolationFactor(d,r,g,y),0,1):0;"camera"===o.kind?c=En(o.minSize,o.maxSize,b):a=b}return{uSizeT:a,uSize:c}}var ld=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Js,evaluateSizeForFeature:Pp,evaluateSizeForZoom:Qu,getSizeData:Ug});function Pb(o,r,a){return o.sections.forEach(c=>{c.text=function(d,g,y){const b=g.layout.get("text-transform").evaluate(y,{});return"uppercase"===b?d=d.toLocaleUpperCase():"lowercase"===b&&(d=d.toLocaleLowerCase()),S.applyArabicShaping&&(d=S.applyArabicShaping(d)),d}(c.text,r,a)}),o}const pf={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function kb(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function jg(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}var dv=ci,$g=function(o,r,a,c,d){var g,y,b=8*d-c-1,E=(1<<b)-1,D=E>>1,I=-7,k=a?d-1:0,L=a?-1:1,z=o[r+k];for(k+=L,g=z&(1<<-I)-1,z>>=-I,I+=b;I>0;g=256*g+o[r+k],k+=L,I-=8);for(y=g&(1<<-I)-1,g>>=-I,I+=c;I>0;y=256*y+o[r+k],k+=L,I-=8);if(0===g)g=1-D;else{if(g===E)return y?NaN:1/0*(z?-1:1);y+=Math.pow(2,c),g-=D}return(z?-1:1)*y*Math.pow(2,g-c)},fv=function(o,r,a,c,d,g){var y,b,E,D=8*g-d-1,I=(1<<D)-1,k=I>>1,L=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,z=c?0:g-1,V=c?1:-1,H=r<0||0===r&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(b=isNaN(r)?1:0,y=I):(y=Math.floor(Math.log(r)/Math.LN2),r*(E=Math.pow(2,-y))<1&&(y--,E*=2),(r+=y+k>=1?L/E:L*Math.pow(2,1-k))*E>=2&&(y++,E/=2),y+k>=I?(b=0,y=I):y+k>=1?(b=(r*E-1)*Math.pow(2,d),y+=k):(b=r*Math.pow(2,k-1)*Math.pow(2,d),y=0));d>=8;o[a+z]=255&b,z+=V,b/=256,d-=8);for(y=y<<d|b,D+=d;D>0;o[a+z]=255&y,z+=V,y/=256,D-=8);o[a+z-V]|=128*H};function ci(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}ci.Varint=0,ci.Fixed64=1,ci.Bytes=2,ci.Fixed32=5;var pv=4294967296,mv=1/pv,ru=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ec(o){return o.type===ci.Bytes?o.readVarint()+o.pos:o.pos+1}function ar(o,r,a){var c=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));a.realloc(c);for(var d=a.pos-1;d>=o;d--)a.buf[d+c]=a.buf[d]}function Rb(o,r){for(var a=0;a<o.length;a++)r.writeVarint(o[a])}function mf(o,r){for(var a=0;a<o.length;a++)r.writeSVarint(o[a])}function Cc(o,r){for(var a=0;a<o.length;a++)r.writeFloat(o[a])}function Ob(o,r){for(var a=0;a<o.length;a++)r.writeDouble(o[a])}function Fb(o,r){for(var a=0;a<o.length;a++)r.writeBoolean(o[a])}function eh(o,r){for(var a=0;a<o.length;a++)r.writeFixed32(o[a])}function Lb(o,r){for(var a=0;a<o.length;a++)r.writeSFixed32(o[a])}function Hg(o,r){for(var a=0;a<o.length;a++)r.writeFixed64(o[a])}function Gg(o,r){for(var a=0;a<o.length;a++)r.writeSFixed64(o[a])}function kp(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+16777216*o[r+3]}function ou(o,r,a){o[a]=r,o[a+1]=r>>>8,o[a+2]=r>>>16,o[a+3]=r>>>24}function th(o,r){return(o[r]|o[r+1]<<8|o[r+2]<<16)+(o[r+3]<<24)}ci.prototype={destroy:function(){this.buf=null},readFields:function(o,r,a){for(a=a||this.length;this.pos<a;){var c=this.readVarint(),d=c>>3,g=this.pos;this.type=7&c,o(d,r,this),this.pos===g&&this.skip(c)}return r},readMessage:function(o,r){return this.readFields(o,r,this.readVarint()+this.pos)},readFixed32:function(){var o=kp(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=th(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=kp(this.buf,this.pos)+kp(this.buf,this.pos+4)*pv;return this.pos+=8,o},readSFixed64:function(){var o=kp(this.buf,this.pos)+th(this.buf,this.pos+4)*pv;return this.pos+=8,o},readFloat:function(){var o=$g(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=$g(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var r,a,c=this.buf;return r=127&(a=c[this.pos++]),a<128?r:(r|=(127&(a=c[this.pos++]))<<7,a<128?r:(r|=(127&(a=c[this.pos++]))<<14,a<128?r:(r|=(127&(a=c[this.pos++]))<<21,a<128?r:function(d,g,y){var b,E,D=y.buf;if(b=(112&(E=D[y.pos++]))>>4,E<128||(b|=(127&(E=D[y.pos++]))<<3,E<128)||(b|=(127&(E=D[y.pos++]))<<10,E<128)||(b|=(127&(E=D[y.pos++]))<<17,E<128)||(b|=(127&(E=D[y.pos++]))<<24,E<128)||(b|=(1&(E=D[y.pos++]))<<31,E<128))return function nl(o,r,a){return a?4294967296*r+(o>>>0):4294967296*(r>>>0)+(o>>>0)}(d,b,g);throw new Error("Expected varint not more than 10 bytes")}(r|=(15&(a=c[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,r=this.pos;return this.pos=o,o-r>=12&&ru?ru.decode(this.buf.subarray(r,o)):function(a,c,d){for(var g="",y=c;y<d;){var b,E,D,I=a[y],k=null,L=I>239?4:I>223?3:I>191?2:1;if(y+L>d)break;1===L?I<128&&(k=I):2===L?128==(192&(b=a[y+1]))&&(k=(31&I)<<6|63&b)<=127&&(k=null):3===L?(E=a[y+2],128==(192&(b=a[y+1]))&&128==(192&E)&&((k=(15&I)<<12|(63&b)<<6|63&E)<=2047||k>=55296&&k<=57343)&&(k=null)):4===L&&(E=a[y+2],D=a[y+3],128==(192&(b=a[y+1]))&&128==(192&E)&&128==(192&D)&&((k=(15&I)<<18|(63&b)<<12|(63&E)<<6|63&D)<=65535||k>=1114112)&&(k=null)),null===k?(k=65533,L=1):k>65535&&(k-=65536,g+=String.fromCharCode(k>>>10&1023|55296),k=56320|1023&k),g+=String.fromCharCode(k),y+=L}return g}(this.buf,r,o)},readBytes:function(){var o=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,o);return this.pos=o,r},readPackedVarint:function(o,r){if(this.type!==ci.Bytes)return o.push(this.readVarint(r));var a=Ec(this);for(o=o||[];this.pos<a;)o.push(this.readVarint(r));return o},readPackedSVarint:function(o){if(this.type!==ci.Bytes)return o.push(this.readSVarint());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==ci.Bytes)return o.push(this.readBoolean());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==ci.Bytes)return o.push(this.readFloat());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==ci.Bytes)return o.push(this.readDouble());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==ci.Bytes)return o.push(this.readFixed32());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==ci.Bytes)return o.push(this.readSFixed32());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==ci.Bytes)return o.push(this.readFixed64());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==ci.Bytes)return o.push(this.readSFixed64());var r=Ec(this);for(o=o||[];this.pos<r;)o.push(this.readSFixed64());return o},skip:function(o){var r=7&o;if(r===ci.Varint)for(;this.buf[this.pos++]>127;);else if(r===ci.Bytes)this.pos=this.readVarint()+this.pos;else if(r===ci.Fixed32)this.pos+=4;else{if(r!==ci.Fixed64)throw new Error("Unimplemented type: "+r);this.pos+=8}},writeTag:function(o,r){this.writeVarint(o<<3|r)},realloc:function(o){for(var r=this.length||16;r<this.pos+o;)r*=2;if(r!==this.length){var a=new Uint8Array(r);a.set(this.buf),this.buf=a,this.length=r}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),ou(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),ou(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),ou(this.buf,-1&o,this.pos),ou(this.buf,Math.floor(o*mv),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),ou(this.buf,-1&o,this.pos),ou(this.buf,Math.floor(o*mv),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(r,a){var c,d,g,b;if(r>=0?(c=r%4294967296|0,d=r/4294967296|0):(d=~(-r/4294967296),4294967295^(c=~(-r%4294967296))?c=c+1|0:(c=0,d=d+1|0)),r>=0x10000000000000000||r<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");a.realloc(10),g=c,(b=a).buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,b.buf[b.pos]=127&(g>>>=7),function(g,y){var b=(7&g)<<4;y.buf[y.pos++]|=b|((g>>>=3)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g|((g>>>=7)?128:0),g&&(y.buf[y.pos++]=127&g)))))}(d,a)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var r=this.pos;this.pos=function(c,d,g){for(var y,b,E=0;E<d.length;E++){if((y=d.charCodeAt(E))>55295&&y<57344){if(!b){y>56319||E+1===d.length?(c[g++]=239,c[g++]=191,c[g++]=189):b=y;continue}if(y<56320){c[g++]=239,c[g++]=191,c[g++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(c[g++]=239,c[g++]=191,c[g++]=189,b=null);y<128?c[g++]=y:(y<2048?c[g++]=y>>6|192:(y<65536?c[g++]=y>>12|224:(c[g++]=y>>18|240,c[g++]=y>>12&63|128),c[g++]=y>>6&63|128),c[g++]=63&y|128)}return g}(this.buf,o,this.pos);var a=this.pos-r;a>=128&&ar(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeFloat:function(o){this.realloc(4),fv(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),fv(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var r=o.length;this.writeVarint(r),this.realloc(r);for(var a=0;a<r;a++)this.buf[this.pos++]=o[a]},writeRawMessage:function(o,r){this.pos++;var a=this.pos;o(r,this);var c=this.pos-a;c>=128&&ar(a,c,this),this.pos=a-1,this.writeVarint(c),this.pos+=c},writeMessage:function(o,r,a){this.writeTag(o,ci.Bytes),this.writeRawMessage(r,a)},writePackedVarint:function(o,r){r.length&&this.writeMessage(o,Rb,r)},writePackedSVarint:function(o,r){r.length&&this.writeMessage(o,mf,r)},writePackedBoolean:function(o,r){r.length&&this.writeMessage(o,Fb,r)},writePackedFloat:function(o,r){r.length&&this.writeMessage(o,Cc,r)},writePackedDouble:function(o,r){r.length&&this.writeMessage(o,Ob,r)},writePackedFixed32:function(o,r){r.length&&this.writeMessage(o,eh,r)},writePackedSFixed32:function(o,r){r.length&&this.writeMessage(o,Lb,r)},writePackedFixed64:function(o,r){r.length&&this.writeMessage(o,Hg,r)},writePackedSFixed64:function(o,r){r.length&&this.writeMessage(o,Gg,r)},writeBytesField:function(o,r){this.writeTag(o,ci.Bytes),this.writeBytes(r)},writeFixed32Field:function(o,r){this.writeTag(o,ci.Fixed32),this.writeFixed32(r)},writeSFixed32Field:function(o,r){this.writeTag(o,ci.Fixed32),this.writeSFixed32(r)},writeFixed64Field:function(o,r){this.writeTag(o,ci.Fixed64),this.writeFixed64(r)},writeSFixed64Field:function(o,r){this.writeTag(o,ci.Fixed64),this.writeSFixed64(r)},writeVarintField:function(o,r){this.writeTag(o,ci.Varint),this.writeVarint(r)},writeSVarintField:function(o,r){this.writeTag(o,ci.Varint),this.writeSVarint(r)},writeStringField:function(o,r){this.writeTag(o,ci.Bytes),this.writeString(r)},writeFloatField:function(o,r){this.writeTag(o,ci.Fixed32),this.writeFloat(r)},writeDoubleField:function(o,r){this.writeTag(o,ci.Fixed64),this.writeDouble(r)},writeBooleanField:function(o,r){this.writeVarintField(o,Boolean(r))}};var Rp=Er(dv);const qg=3;function Nb(o,r,a){r.glyphs=[],1===o&&a.readMessage(Bb,r)}function Bb(o,r,a){if(3===o){const{id:c,bitmap:d,width:g,height:y,left:b,top:E,advance:D}=a.readMessage(zb,{});r.glyphs.push({id:c,bitmap:new Vl({width:g+2*qg,height:y+2*qg},d),metrics:{width:g,height:y,left:b,top:E,advance:D}})}else 4===o?r.ascender=a.readSVarint():5===o&&(r.descender=a.readSVarint())}function zb(o,r,a){1===o?r.id=a.readVarint():2===o?r.bitmap=a.readBytes():3===o?r.width=a.readVarint():4===o?r.height=a.readVarint():5===o?r.left=a.readSVarint():6===o?r.top=a.readSVarint():7===o&&(r.advance=a.readVarint())}const gv=qg;function Wg(o){let r=0,a=0;for(const y of o)r+=y.w*y.h,a=Math.max(a,y.w);o.sort((y,b)=>b.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),a),h:1/0}];let d=0,g=0;for(const y of o)for(let b=c.length-1;b>=0;b--){const E=c[b];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,g=Math.max(g,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===E.w&&y.h===E.h){const D=c.pop();b<c.length&&(c[b]=D)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(c.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:d,h:g,fill:r/(d*g)||0}}const Rr=1;class il{constructor(r,{pixelRatio:a,version:c,stretchX:d,stretchY:g,content:y}){this.paddedRect=r,this.pixelRatio=a,this.stretchX=d,this.stretchY=g,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+Rr,this.paddedRect.y+Rr]}get br(){return[this.paddedRect.x+this.paddedRect.w-Rr,this.paddedRect.y+this.paddedRect.h-Rr]}get displaySize(){return[(this.paddedRect.w-2*Rr)/this.pixelRatio,(this.paddedRect.h-2*Rr)/this.pixelRatio]}}class _v{constructor(r,a){const c={},d={};this.haveRenderCallbacks=[];const g=[];this.addImages(r,c,g),this.addImages(a,d,g);const{w:y,h:b}=Wg(g),E=new Oo({width:y||1,height:b||1});for(const D in r){const I=r[D],k=c[D].paddedRect;Oo.copy(I.data,E,{x:0,y:0},{x:k.x+Rr,y:k.y+Rr},I.data)}for(const D in a){const I=a[D],k=d[D].paddedRect,L=k.x+Rr,z=k.y+Rr,V=I.data.width,H=I.data.height;Oo.copy(I.data,E,{x:0,y:0},{x:L,y:z},I.data),Oo.copy(I.data,E,{x:0,y:H-1},{x:L,y:z-1},{width:V,height:1}),Oo.copy(I.data,E,{x:0,y:0},{x:L,y:z+H},{width:V,height:1}),Oo.copy(I.data,E,{x:V-1,y:0},{x:L-1,y:z},{width:1,height:H}),Oo.copy(I.data,E,{x:0,y:0},{x:L+V,y:z},{width:1,height:H})}this.image=E,this.iconPositions=c,this.patternPositions=d}addImages(r,a,c){for(const d in r){const g=r[d],y={x:0,y:0,w:g.data.width+2*Rr,h:g.data.height+2*Rr};c.push(y),a[d]=new il(y,g),g.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(r,a){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>r.hasImage(c)),r.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in r.updatedImages)this.patchUpdatedImage(this.iconPositions[c],r.getImage(c),a),this.patchUpdatedImage(this.patternPositions[c],r.getImage(c),a)}patchUpdatedImage(r,a,c){if(!r||!a||r.version===a.version)return;r.version=a.version;const[d,g]=r.tl;c.update(a.data,void 0,{x:d,y:g})}}De(il,"ImagePosition"),De(_v,"ImageAtlas");const Qs={horizontal:1,vertical:2,horizontalOnly:3},Vb=-17;class Op{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(r,a){const c=new Op;return c.scale=r||1,c.fontStack=a,c}static forImage(r){const a=new Op;return a.imageName=r,a}}class nh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,a){const c=new nh;for(let d=0;d<r.sections.length;d++){const g=r.sections[d];g.image?c.addImageSection(g):c.addTextSection(g,a)}return c}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCharCode(r){return this.text.charCodeAt(r)}verticalizePunctuation(r){this.text=function(a,c){let d="";for(let g=0;g<a.length;g++){const y=a.charCodeAt(g+1)||null,b=a.charCodeAt(g-1)||null;d+=!c&&(y&&ep(y)&&!pf[a[g+1]]||b&&ep(b)&&!pf[a[g-1]])||!pf[a[g]]?a[g]:pf[a[g]]}return d}(this.text,r)}trim(){let r=0;for(let c=0;c<this.text.length&&gf[this.text.charCodeAt(c)];c++)r++;let a=this.text.length;for(let c=this.text.length-1;c>=0&&c>=r&&gf[this.text.charCodeAt(c)];c--)a--;this.text=this.text.substring(r,a),this.sectionIndex=this.sectionIndex.slice(r,a)}substring(r,a){const c=new nh;return c.text=this.text.substring(r,a),c.sectionIndex=this.sectionIndex.slice(r,a),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((r,a)=>Math.max(r,this.sections[a].scale),0)}addTextSection(r,a){this.text+=r.text,this.sections.push(Op.forText(r.scale,r.fontStack||a));const c=this.sections.length-1;for(let d=0;d<r.text.length;++d)this.sectionIndex.push(c)}addImageSection(r){const a=r.image?r.image.name:"";if(0===a.length)return void Tn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Op.forImage(a)),this.sectionIndex.push(this.sections.length-1)):Tn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yv(o,r,a,c,d,g,y,b,E,D,I,k,L,z,V){const H=nh.fromFeature(o,d);k===Qs.vertical&&H.verticalizePunctuation(L);let K=[];const ie=function(pe,Ae,Me,Ve,et,Re){if(!pe)return[];const We=[],Ze=function(mt,bt,_t,Kt,lt,At){let Yt=0;for(let In=0;In<mt.length();In++){const Jt=mt.getSection(In);Yt+=xv(mt.getCharCode(In),Jt,Kt,lt,bt,At)}return Yt/Math.max(1,Math.ceil(Yt/_t))}(pe,Ae,Me,Ve,et,Re),Qe=pe.text.indexOf("\u200b")>=0;let rt=0;for(let mt=0;mt<pe.length();mt++){const bt=pe.getSection(mt),_t=pe.getCharCode(mt);if(gf[_t]||(rt+=xv(_t,bt,Ve,et,Ae,Re)),mt<pe.length()-1){const Kt=!((Ne=_t)<11904||!(yt["Bopomofo Extended"](Ne)||yt.Bopomofo(Ne)||yt["CJK Compatibility Forms"](Ne)||yt["CJK Compatibility Ideographs"](Ne)||yt["CJK Compatibility"](Ne)||yt["CJK Radicals Supplement"](Ne)||yt["CJK Strokes"](Ne)||yt["CJK Symbols and Punctuation"](Ne)||yt["CJK Unified Ideographs Extension A"](Ne)||yt["CJK Unified Ideographs"](Ne)||yt["Enclosed CJK Letters and Months"](Ne)||yt["Halfwidth and Fullwidth Forms"](Ne)||yt.Hiragana(Ne)||yt["Ideographic Description Characters"](Ne)||yt["Kangxi Radicals"](Ne)||yt["Katakana Phonetic Extensions"](Ne)||yt.Katakana(Ne)||yt["Vertical Forms"](Ne)||yt["Yi Radicals"](Ne)||yt["Yi Syllables"](Ne)));(vv[_t]||Kt||bt.imageName)&&We.push(bv(mt+1,rt,Ze,We,Ub(_t,pe.getCharCode(mt+1),Kt&&Qe),!1))}}var Ne;return ba(bv(pe.length(),rt,Ze,We,0,!0))}(H,D,g,r,c,z),{processBidirectionalText:ue,processStyledBidirectionalText:ne}=S;if(ue&&1===H.sections.length){const pe=ue(H.toString(),ie);for(const Ae of pe){const Me=new nh;Me.text=Ae,Me.sections=H.sections;for(let Ve=0;Ve<Ae.length;Ve++)Me.sectionIndex.push(0);K.push(Me)}}else if(ne){const pe=ne(H.text,H.sectionIndex,ie);for(const Ae of pe){const Me=new nh;Me.text=Ae[0],Me.sectionIndex=Ae[1],Me.sections=H.sections,K.push(Me)}}else K=function(pe,Ae){const Me=[],Ve=pe.text;let et=0;for(const Re of Ae)Me.push(pe.substring(et,Re)),et=Re;return et<Ve.length&&Me.push(pe.substring(et,Ve.length)),Me}(H,ie);const ce=[],me={positionedLines:ce,text:H.toString(),top:I[1],bottom:I[1],left:I[0],right:I[0],writingMode:k,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(pe,Ae,Me,Ve,et,Re,We,Ze,Qe,rt,Ne,mt){let bt=0,_t=0,Kt=0;const lt="right"===Ze?1:"left"===Ze?0:.5;let At=!1;for(const jt of et){const tn=jt.getSections();for(const ui of tn){if(ui.imageName)continue;const zn=Ae[ui.fontStack];if(zn&&(At=void 0!==zn.ascender&&void 0!==zn.descender,!At))break}if(!At)break}let Yt=0;for(const jt of et){jt.trim();const tn=jt.getMaxScale(),ui=(tn-1)*kr,zn={positionedGlyphs:[],lineOffset:0};pe.positionedLines[Yt]=zn;const oi=zn.positionedGlyphs;let hi=0;if(!jt.length()){_t+=Re,++Yt;continue}let Qt=0,bn=0;for(let di=0;di<jt.length();di++){const Ji=jt.getSection(di),Wi=jt.getSectionIndex(di),Oi=jt.getCharCode(di);let Vn=Ji.scale,Fi=null,fi=null,ho=null,Un=kr,Fr=0;const Lr=!(Qe===Qs.horizontal||!Ne&&!zu(Oi)||Ne&&(gf[Oi]||(In=Oi,yt.Arabic(In)||yt["Arabic Supplement"](In)||yt["Arabic Extended-A"](In)||yt["Arabic Presentation Forms-A"](In)||yt["Arabic Presentation Forms-B"](In))));if(Ji.imageName){const Fo=Ve[Ji.imageName];if(!Fo)continue;ho=Ji.imageName,pe.iconsInText=pe.iconsInText||!0,fi=Fo.paddedRect;const xr=Fo.displaySize;Vn=Vn*kr/mt,Fi={width:xr[0],height:xr[1],left:Rr,top:-gv,advance:Lr?xr[1]:xr[0],localGlyph:!1},Fr=At?-Fi.height*Vn:Vb+tn*kr-xr[1]*Vn,Un=Fi.advance;const Da=(Lr?xr[0]:xr[1])*Vn-kr*tn;Da>0&&Da>hi&&(hi=Da)}else{const Fo=Me[Ji.fontStack];if(!Fo)continue;Fo[Oi]&&(fi=Fo[Oi]);const xr=Ae[Ji.fontStack];if(!xr)continue;const Da=xr.glyphs[Oi];if(!Da)continue;if(Fi=Da.metrics,Un=8203!==Oi?kr:0,At){const hu=void 0!==xr.ascender?Math.abs(xr.ascender):0,Mf=void 0!==xr.descender?Math.abs(xr.descender):0,xd=(hu+Mf)*Vn;Qt<xd&&(Qt=xd,bn=(hu-Mf)/2*Vn),Fr=-hu*Vn}else Fr=Vb+(tn-Vn)*kr}Lr?(pe.verticalizable=!0,oi.push({glyph:Oi,imageName:ho,x:bt,y:_t+Fr,vertical:Lr,scale:Vn,localGlyph:Fi.localGlyph,fontStack:Ji.fontStack,sectionIndex:Wi,metrics:Fi,rect:fi}),bt+=Un*Vn+rt):(oi.push({glyph:Oi,imageName:ho,x:bt,y:_t+Fr,vertical:Lr,scale:Vn,localGlyph:Fi.localGlyph,fontStack:Ji.fontStack,sectionIndex:Wi,metrics:Fi,rect:fi}),bt+=Fi.advance*Vn+rt)}0!==oi.length&&(Kt=Math.max(bt-rt,Kt),At?Kg(oi,lt,hi,bn,Re*tn/2):Kg(oi,lt,hi,0,Re/2)),bt=0;const gi=Re*tn+hi;zn.lineOffset=Math.max(hi,ui),_t+=gi,++Yt}var In;const Jt=_t,{horizontalAlign:Ot,verticalAlign:bi}=Xg(We);(function(jt,tn,ui,zn,oi,hi){const Qt=(tn-ui)*oi,bn=-hi*zn;for(const gi of jt)for(const di of gi.positionedGlyphs)di.x+=Qt,di.y+=bn})(pe.positionedLines,lt,Ot,bi,Kt,Jt),pe.top+=-bi*Jt,pe.bottom=pe.top+Jt,pe.left+=-Ot*Kt,pe.right=pe.left+Kt,pe.hasBaseline=At}(me,r,a,c,K,y,b,E,k,D,L,V),!function(pe){for(const Ae of pe)if(0!==Ae.positionedGlyphs.length)return!1;return!0}(ce)&&me}const gf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},vv={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function xv(o,r,a,c,d,g){if(r.imageName){const y=c[r.imageName];return y?y.displaySize[0]*r.scale*kr/g+d:0}{const y=a[r.fontStack],b=y&&y.glyphs[o];return b?b.metrics.advance*r.scale+d:0}}function Zg(o,r,a,c){const d=Math.pow(o-r,2);return c?o<r?d/2:2*d:d+Math.abs(a)*a}function Ub(o,r,a){let c=0;return 10===o&&(c-=1e4),a&&(c+=150),40!==o&&65288!==o||(c+=50),41!==r&&65289!==r||(c+=50),c}function bv(o,r,a,c,d,g){let y=null,b=Zg(r,a,d,g);for(const E of c){const D=Zg(r-E.x,a,d,g)+E.badness;D<=b&&(y=E,b=D)}return{index:o,x:r,priorBreak:y,badness:b}}function ba(o){return o?ba(o.priorBreak).concat(o.index):[]}function Xg(o){let r=.5,a=.5;switch(o){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":a=1;break;case"top":case"top-right":case"top-left":a=0}return{horizontalAlign:r,verticalAlign:a}}function Kg(o,r,a,c,d){if(!(r||a||c||d))return;const g=o.length-1,y=o[g],b=(y.x+y.metrics.advance*y.scale)*r;for(let E=0;E<=g;E++)o[E].x-=b,o[E].y+=a+c+d}function jb(o,r,a){const{horizontalAlign:c,verticalAlign:d}=Xg(a),g=r[0]-o.displaySize[0]*c,y=r[1]-o.displaySize[1]*d;return{image:o,top:y,bottom:y+o.displaySize[1],left:g,right:g+o.displaySize[0]}}function wv(o,r,a,c,d,g){const y=o.image;let b;if(y.content){const K=y.content,ie=y.pixelRatio||1;b=[K[0]/ie,K[1]/ie,y.displaySize[0]-K[2]/ie,y.displaySize[1]-K[3]/ie]}const E=r.left*g,D=r.right*g;let I,k,L,z;"width"===a||"both"===a?(z=d[0]+E-c[3],k=d[0]+D+c[1]):(z=d[0]+(E+D-y.displaySize[0])/2,k=z+y.displaySize[0]);const V=r.top*g,H=r.bottom*g;return"height"===a||"both"===a?(I=d[1]+V-c[0],L=d[1]+H+c[2]):(I=d[1]+(V+H-y.displaySize[1])/2,L=I+y.displaySize[1]),{image:y,top:I,right:k,bottom:L,left:z,collisionPadding:b}}class Dc extends ct{constructor(r,a,c,d,g){super(r,a),this.angle=d,this.z=c,void 0!==g&&(this.segment=g)}clone(){return new Dc(this.x,this.y,this.z,this.angle,this.segment)}}function Ev(o,r,a,c,d){if(void 0===r.segment)return!0;let g=r,y=r.segment+1,b=0;for(;b>-a/2;){if(y--,y<0)return!1;b-=o[y].dist(g),g=o[y]}b+=o[y].dist(o[y+1]),y++;const E=[];let D=0;for(;b<a/2;){const I=o[y],k=o[y+1];if(!k)return!1;let L=o[y-1].angleTo(I)-I.angleTo(k);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:L}),D+=L;b-E[0].distance>c;)D-=E.shift().angleDelta;if(D>d)return!1;y++,b+=I.dist(k)}return!0}function Yg(o){let r=0;for(let a=0;a<o.length-1;a++)r+=o[a].dist(o[a+1]);return r}function Cv(o,r,a){return o?.6*r*a:0}function Dv(o,r){return Math.max(o?o.right-o.left:0,r?r.right-r.left:0)}function $b(o,r,a,c,d,g){const y=Cv(a,d,g),b=Dv(a,c)*g;let E=0;const D=Yg(o)/2;for(let I=0;I<o.length-1;I++){const k=o[I],L=o[I+1],z=k.dist(L);if(E+z>D){const V=(D-E)/z,H=En(k.x,L.x,V),K=En(k.y,L.y,V),ie=new Dc(H,K,0,L.angleTo(k),I);return!y||Ev(o,ie,b,y,r)?ie:void 0}E+=z}}function xn(o,r,a,c,d,g,y,b,E){const D=Cv(c,g,y),I=Dv(c,d),k=I*y,L=0===o[0].x||o[0].x===E||0===o[0].y||o[0].y===E;return r-k<r/4&&(r=k+r/4),qo(o,L?r/2*b%r:(I/2+2*g)*y*b%r,r,D,a,k,L,!1,E)}function qo(o,r,a,c,d,g,y,b,E){const D=g/2,I=Yg(o);let k=0,L=r-a,z=[];for(let V=0;V<o.length-1;V++){const H=o[V],K=o[V+1],ie=H.dist(K),ue=K.angleTo(H);for(;L+a<k+ie;){L+=a;const ne=(L-k)/ie,ce=En(H.x,K.x,ne),me=En(H.y,K.y,ne);if(ce>=0&&ce<E&&me>=0&&me<E&&L-D>=0&&L+D<=I){const pe=new Dc(ce,me,0,ue,V);pe._round(),c&&!Ev(o,pe,g,c,d)||z.push(pe)}}k+=ie}return b||z.length||y||(z=qo(o,k/2,a,c,d,g,y,!0,E)),z}function Jg(o,r,a,c,d){const g=[];for(let y=0;y<o.length;y++){const b=o[y];let E;for(let D=0;D<b.length-1;D++){let I=b[D],k=b[D+1];I.x<r&&k.x<r||(I.x<r?I=new ct(r,I.y+(r-I.x)/(k.x-I.x)*(k.y-I.y))._round():k.x<r&&(k=new ct(r,I.y+(r-I.x)/(k.x-I.x)*(k.y-I.y))._round()),I.y<a&&k.y<a||(I.y<a?I=new ct(I.x+(a-I.y)/(k.y-I.y)*(k.x-I.x),a)._round():k.y<a&&(k=new ct(I.x+(a-I.y)/(k.y-I.y)*(k.x-I.x),a)._round()),I.x>=c&&k.x>=c||(I.x>=c?I=new ct(c,I.y+(c-I.x)/(k.x-I.x)*(k.y-I.y))._round():k.x>=c&&(k=new ct(c,I.y+(c-I.x)/(k.x-I.x)*(k.y-I.y))._round()),I.y>=d&&k.y>=d||(I.y>=d?I=new ct(I.x+(d-I.y)/(k.y-I.y)*(k.x-I.x),d)._round():k.y>=d&&(k=new ct(I.x+(d-I.y)/(k.y-I.y)*(k.x-I.x),d)._round()),E&&I.equals(E[E.length-1])||(E=[I],g.push(E)),E.push(k)))))}}return g}De(Dc,"Anchor");const cd=1e20;function Tv(o,r,a,c,d,g,y,b,E){for(let D=r;D<r+c;D++)Sv(o,a*g+D,g,d,y,b,E);for(let D=a;D<a+d;D++)Sv(o,D*g+r,1,c,y,b,E)}function Sv(o,r,a,c,d,g,y){g[0]=0,y[0]=-cd,y[1]=cd,d[0]=o[r];for(let b=1,E=0,D=0;b<c;b++){d[b]=o[r+b*a];const I=b*b;do{const k=g[E];D=(d[b]-d[k]+I-k*k)/(b-k)/2}while(D<=y[E]&&--E>-1);E++,g[E]=b,y[E]=D,y[E+1]=cd}for(let b=0,E=0;b<c;b++){for(;y[E+1]<b;)E++;const D=g[E],I=b-D;o[r+b*a]=d[D]+I*I}}const wa=2,Qg={none:0,ideographs:1,all:2};class ih{constructor(r,a,c){this.requestManager=r,this.localGlyphMode=a,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,a){const c=[];for(const d in r)for(const g of r[d])c.push({stack:d,id:g});nr(c,({stack:d,id:g},y)=>{let b=this.entries[d];b||(b=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=b.glyphs[g];if(void 0!==E)return void y(null,{stack:d,id:g,glyph:E});if(E=this._tinySDF(b,d,g),E)return b.glyphs[g]=E,void y(null,{stack:d,id:g,glyph:E});const D=Math.floor(g/256);if(256*D>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[D])return void y(null,{stack:d,id:g,glyph:E});let I=b.requests[D];I||(I=b.requests[D]=[],ih.loadGlyphRange(d,D,this.url,this.requestManager,(k,L)=>{if(L){b.ascender=L.ascender,b.descender=L.descender;for(const z in L.glyphs)this._doesCharSupportLocalGlyph(+z)||(b.glyphs[+z]=L.glyphs[+z]);b.ranges[D]=!0}for(const z of I)z(k,L);delete b.requests[D]})),I.push((k,L)=>{k?y(k):L&&y(null,{stack:d,id:g,glyph:L.glyphs[g]||null})})},(d,g)=>{if(d)a(d);else if(g){const y={};for(const{stack:b,id:E,glyph:D}of g)void 0===y[b]&&(y[b]={}),void 0===y[b].glyphs&&(y[b].glyphs={}),y[b].glyphs[E]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;a(null,y)}})}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==Qg.none&&(this.localGlyphMode===Qg.all?!!this.localFontFamily:!!this.localFontFamily&&(yt["CJK Unified Ideographs"](r)||yt["Hangul Syllables"](r)||yt.Hiragana(r)||yt.Katakana(r)||yt["CJK Symbols and Punctuation"](r)))}_tinySDF(r,a,c){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let g=r.tinySDF;if(!g){let H="400";/bold/i.test(a)?H="900":/medium/i.test(a)?H="500":/light/i.test(a)&&(H="200"),g=r.tinySDF=new ih.TinySDF({fontFamily:d,fontWeight:H,fontSize:24*wa,buffer:3*wa,radius:8*wa}),g.fontWeight=H}if(this.localGlyphs[g.fontWeight][c])return this.localGlyphs[g.fontWeight][c];const y=String.fromCharCode(c),{data:b,width:E,height:D,glyphWidth:I,glyphHeight:k,glyphLeft:L,glyphTop:z,glyphAdvance:V}=g.draw(y);return this.localGlyphs[g.fontWeight][c]={id:c,bitmap:new Vl({width:E,height:D},b),metrics:{width:I/wa,height:k/wa,left:L/wa,top:z/wa-27,advance:V/wa,localGlyph:!0}}}}ih.loadGlyphRange=function(o,r,a,c,d){const g=256*r,y=g+255,b=c.transformRequest(c.normalizeGlyphsURL(a).replace("{fontstack}",o).replace("{range}",`${g}-${y}`),Fs.Glyphs);vl(b,(E,D)=>{if(E)d(E);else if(D){const I={},k=new Rp(D).readFields(Nb,{});for(const L of k.glyphs)I[L.id]=L;d(null,{glyphs:I,ascender:k.ascender,descender:k.descender})}})},ih.TinySDF=class{constructor({fontSize:o=24,buffer:r=3,radius:a=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:y="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=a;const b=this.size=o+4*r,E=this._createCanvas(b),D=this.ctx=E.getContext("2d",{willReadFrequently:!0});D.font=`${y} ${g} ${o}px ${d}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(o){const r=document.createElement("canvas");return r.width=r.height=o,r}draw(o){const{width:r,actualBoundingBoxAscent:a,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(o),y=Math.ceil(a),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),E=Math.min(this.size-this.buffer,y+Math.ceil(c)),D=b+2*this.buffer,I=E+2*this.buffer,k=Math.max(D*I,0),L=new Uint8ClampedArray(k),z={data:L,width:D,height:I,glyphWidth:b,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:r};if(0===b||0===E)return z;const{ctx:V,buffer:H,gridInner:K,gridOuter:ie}=this;V.clearRect(H,H,b,E),V.fillText(o,H,H+y);const ue=V.getImageData(H,H,b,E);ie.fill(cd,0,k),K.fill(0,0,k);for(let ne=0;ne<E;ne++)for(let ce=0;ce<b;ce++){const me=ue.data[4*(ne*b+ce)+3]/255;if(0===me)continue;const pe=(ne+H)*D+ce+H;if(1===me)ie[pe]=0,K[pe]=cd;else{const Ae=.5-me;ie[pe]=Ae>0?Ae*Ae:0,K[pe]=Ae<0?Ae*Ae:0}}Tv(ie,0,0,D,I,D,this.f,this.v,this.z),Tv(K,H,H,b,E,D,this.f,this.v,this.z);for(let ne=0;ne<k;ne++){const ce=Math.sqrt(ie[ne])-Math.sqrt(K[ne]);L[ne]=Math.round(255-255*(ce/this.radius+this.cutoff))}return z}};const ud=Rr;function Mv(o,r,a,c){const d=[],g=o.image,y=g.pixelRatio,b=g.paddedRect.w-2*ud,E=g.paddedRect.h-2*ud,D=o.right-o.left,I=o.bottom-o.top,k=g.stretchX||[[0,b]],L=g.stretchY||[[0,E]],z=(Re,We)=>Re+We[1]-We[0],V=k.reduce(z,0),H=L.reduce(z,0),K=b-V,ie=E-H;let ue=0,ne=V,ce=0,me=H,pe=0,Ae=K,Me=0,Ve=ie;if(g.content&&c){const Re=g.content;ue=e_(k,0,Re[0]),ce=e_(L,0,Re[1]),ne=e_(k,Re[0],Re[2]),me=e_(L,Re[1],Re[3]),pe=Re[0]-ue,Me=Re[1]-ce,Ae=Re[2]-Re[0]-ne,Ve=Re[3]-Re[1]-me}const et=(Re,We,Ze,Qe)=>{const rt=_f(Re.stretch-ue,ne,D,o.left),Ne=Or(Re.fixed-pe,Ae,Re.stretch,V),mt=_f(We.stretch-ce,me,I,o.top),bt=Or(We.fixed-Me,Ve,We.stretch,H),_t=_f(Ze.stretch-ue,ne,D,o.left),Kt=Or(Ze.fixed-pe,Ae,Ze.stretch,V),lt=_f(Qe.stretch-ce,me,I,o.top),At=Or(Qe.fixed-Me,Ve,Qe.stretch,H),Yt=new ct(rt,mt),In=new ct(_t,mt),Jt=new ct(_t,lt),Ot=new ct(rt,lt),bi=new ct(Ne/y,bt/y),jt=new ct(Kt/y,At/y),tn=r*Math.PI/180;if(tn){const oi=Math.sin(tn),hi=Math.cos(tn),Qt=[hi,-oi,oi,hi];Yt._matMult(Qt),In._matMult(Qt),Ot._matMult(Qt),Jt._matMult(Qt)}const ui=Re.stretch+Re.fixed,zn=We.stretch+We.fixed;return{tl:Yt,tr:In,bl:Ot,br:Jt,tex:{x:g.paddedRect.x+ud+ui,y:g.paddedRect.y+ud+zn,w:Ze.stretch+Ze.fixed-ui,h:Qe.stretch+Qe.fixed-zn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:bi,pixelOffsetBR:jt,minFontScaleX:Ae/y/D,minFontScaleY:Ve/y/I,isSDF:a}};if(c&&(g.stretchX||g.stretchY)){const Re=t_(k,K,V),We=t_(L,ie,H);for(let Ze=0;Ze<Re.length-1;Ze++){const Qe=Re[Ze],rt=Re[Ze+1];for(let Ne=0;Ne<We.length-1;Ne++)d.push(et(Qe,We[Ne],rt,We[Ne+1]))}}else d.push(et({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return d}function e_(o,r,a){let c=0;for(const d of o)c+=Math.max(r,Math.min(a,d[1]))-Math.max(r,Math.min(a,d[0]));return c}function t_(o,r,a){const c=[{fixed:-ud,stretch:0}];for(const[d,g]of o){const y=c[c.length-1];c.push({fixed:d-y.stretch,stretch:y.stretch}),c.push({fixed:d-y.stretch,stretch:y.stretch+(g-d)})}return c.push({fixed:r+ud,stretch:a}),c}function _f(o,r,a,c){return o/r*a+c}function Or(o,r,a,c){return o-r*a/c}function Hb(o,r,a,c){const d=r+o.positionedLines[c].lineOffset;return 0===c?a+d/2:a+(d+(r+o.positionedLines[c-1].lineOffset))/2}class n_{constructor(r=[],a=i_){if(this.data=r,this.length=this.data.length,this.compare=a,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(r){this.data.push(r),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const r=this.data[0],a=this.data.pop();return this.length--,this.length>0&&(this.data[0]=a,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:a,compare:c}=this,d=a[r];for(;r>0;){const g=r-1>>1,y=a[g];if(c(d,y)>=0)break;a[r]=y,r=g}a[r]=d}_down(r){const{data:a,compare:c}=this,d=this.length>>1,g=a[r];for(;r<d;){let y=1+(r<<1),b=a[y];const E=y+1;if(E<this.length&&c(a[E],b)<0&&(y=E,b=a[E]),c(b,g)>=0)break;a[r]=b,r=y}a[r]=g}}function i_(o,r){return o<r?-1:o>r?1:0}function Gb(o,r=1,a=!1){let c=1/0,d=1/0,g=-1/0,y=-1/0;const b=o[0];for(let z=0;z<b.length;z++){const V=b[z];(!z||V.x<c)&&(c=V.x),(!z||V.y<d)&&(d=V.y),(!z||V.x>g)&&(g=V.x),(!z||V.y>y)&&(y=V.y)}const E=Math.min(g-c,y-d);let D=E/2;const I=new n_([],LC);if(0===E)return new ct(c,d);for(let z=c;z<g;z+=E)for(let V=d;V<y;V+=E)I.push(new yf(z+D,V+D,D,o));let k=function(z){let V=0,H=0,K=0;const ie=z[0];for(let ue=0,ne=ie.length,ce=ne-1;ue<ne;ce=ue++){const me=ie[ue],pe=ie[ce],Ae=me.x*pe.y-pe.x*me.y;H+=(me.x+pe.x)*Ae,K+=(me.y+pe.y)*Ae,V+=3*Ae}return new yf(H/V,K/V,0,z)}(o),L=I.length;for(;I.length;){const z=I.pop();(z.d>k.d||!k.d)&&(k=z,a&&console.log("found best %d after %d probes",Math.round(1e4*z.d)/1e4,L)),z.max-k.d<=r||(D=z.h/2,I.push(new yf(z.p.x-D,z.p.y-D,D,o)),I.push(new yf(z.p.x+D,z.p.y-D,D,o)),I.push(new yf(z.p.x-D,z.p.y+D,D,o)),I.push(new yf(z.p.x+D,z.p.y+D,D,o)),L+=4)}return a&&(console.log(`num probes: ${L}`),console.log(`best distance: ${k.d}`)),k.p}function LC(o,r){return r.max-o.max}class yf{constructor(r,a,c,d){this.p=new ct(r,a),this.h=c,this.d=function(g,y){let b=!1,E=1/0;for(let D=0;D<y.length;D++){const I=y[D];for(let k=0,L=I.length,z=L-1;k<L;z=k++){const V=I[k],H=I[z];V.y>g.y!=H.y>g.y&&g.x<(H.x-V.x)*(g.y-V.y)/(H.y-V.y)+V.x&&(b=!b),E=Math.min(E,Zy(g,V,H))}}return(b?1:-1)*Math.sqrt(E)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const vf=7,r_=Number.POSITIVE_INFINITY,Av=Math.sqrt(2);function qb(o,[r,a]){let c=0,d=0;if(a===r_){r<0&&(r=0);const g=r/Av;switch(o){case"top-right":case"top-left":d=g-vf;break;case"bottom-right":case"bottom-left":d=-g+vf;break;case"bottom":d=-r+vf;break;case"top":d=r-vf}switch(o){case"top-right":case"bottom-right":c=-g;break;case"top-left":case"bottom-left":c=g;break;case"left":c=r;break;case"right":c=-r}}else{switch(r=Math.abs(r),a=Math.abs(a),o){case"top-right":case"top-left":case"top":d=a-vf;break;case"bottom-right":case"bottom-left":case"bottom":d=-a+vf}switch(o){case"top-right":case"bottom-right":case"right":c=-r;break;case"top-left":case"bottom-left":case"left":c=r}}return[c,d]}function Wb(o,r,a,c,d,g,y,b,E,D){o.createArrays(),o.tilePixelRatio=Pt/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const I=o.layers[0].layout,k=o.layers[0]._unevaluatedLayout._values,L={};if("composite"===o.textSizeData.kind){const{minZoom:H,maxZoom:K}=o.textSizeData;L.compositeTextSizes=[k["text-size"].possiblyEvaluate(new P(H),b),k["text-size"].possiblyEvaluate(new P(K),b)]}if("composite"===o.iconSizeData.kind){const{minZoom:H,maxZoom:K}=o.iconSizeData;L.compositeIconSizes=[k["icon-size"].possiblyEvaluate(new P(H),b),k["icon-size"].possiblyEvaluate(new P(K),b)]}L.layoutTextSize=k["text-size"].possiblyEvaluate(new P(E+1),b),L.layoutIconSize=k["icon-size"].possiblyEvaluate(new P(E+1),b),L.textMaxSize=k["text-size"].possiblyEvaluate(new P(18),b);const z="map"===I.get("text-rotation-alignment")&&"point"!==I.get("symbol-placement"),V=I.get("text-size");for(const H of o.features){const K=I.get("text-font").evaluate(H,{},b).join(","),ie=V.evaluate(H,{},b),ue=L.layoutTextSize.evaluate(H,{},b),ne=(L.layoutIconSize.evaluate(H,{},b),{horizontal:{},vertical:void 0}),ce=H.text;let me,pe=[0,0];if(ce){const Ve=ce.toString(),et=I.get("text-letter-spacing").evaluate(H,{},b)*kr,Re=I.get("text-line-height").evaluate(H,{},b)*kr,We=pa(Ve)?et:0,Ze=I.get("text-anchor").evaluate(H,{},b),Qe=I.get("text-variable-anchor");if(!Qe){const _t=I.get("text-radial-offset").evaluate(H,{},b);pe=_t?qb(Ze,[_t*kr,r_]):I.get("text-offset").evaluate(H,{},b).map(Kt=>Kt*kr)}let rt=z?"center":I.get("text-justify").evaluate(H,{},b);const Ne="point"===I.get("symbol-placement"),mt=Ne?I.get("text-max-width").evaluate(H,{},b)*kr:1/0,bt=_t=>{o.allowVerticalPlacement&&fc(Ve)&&(ne.vertical=yv(ce,r,a,d,K,mt,Re,Ze,_t,We,pe,Qs.vertical,!0,ue,ie))};if(!z&&Qe){const _t="auto"===rt?Qe.map(lt=>su(lt)):[rt];let Kt=!1;for(let lt=0;lt<_t.length;lt++){const At=_t[lt];if(!ne.horizontal[At])if(Kt)ne.horizontal[At]=ne.horizontal[0];else{const Yt=yv(ce,r,a,d,K,mt,Re,"center",At,We,pe,Qs.horizontal,!1,ue,ie);Yt&&(ne.horizontal[At]=Yt,Kt=1===Yt.positionedLines.length)}}bt("left")}else{if("auto"===rt&&(rt=su(Ze)),Ne||I.get("text-writing-mode").indexOf("horizontal")>=0||!fc(Ve)){const _t=yv(ce,r,a,d,K,mt,Re,Ze,rt,We,pe,Qs.horizontal,!1,ue,ie);_t&&(ne.horizontal[rt]=_t)}bt(Ne?"left":rt)}}let Ae=!1;if(H.icon&&H.icon.name){const Ve=c[H.icon.name];Ve&&(me=jb(d[H.icon.name],I.get("icon-offset").evaluate(H,{},b),I.get("icon-anchor").evaluate(H,{},b)),Ae=Ve.sdf,void 0===o.sdfIcons?o.sdfIcons=Ve.sdf:o.sdfIcons!==Ve.sdf&&Tn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ve.pixelRatio!==o.pixelRatio||0!==I.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const Me=o_(ne.horizontal)||ne.vertical;o.iconsInText||(o.iconsInText=!!Me&&Me.iconsInText),(Me||me)&&Zb(o,H,ne,me,c,L,ue,0,pe,Ae,y,b,D)}g&&o.generateCollisionDebugBuffers(E,o.collisionBoxArray)}function su(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Zb(o,r,a,c,d,g,y,b,E,D,I,k,L){let z=g.textMaxSize.evaluate(r,{},k);void 0===z&&(z=y);const V=o.layers[0].layout,H=V.get("icon-offset").evaluate(r,{},k),K=o_(a.horizontal)||a.vertical,ie="globe"===L.name,ue=kr,ne=y/ue,ce=o.tilePixelRatio*z/ue,me=(Ze=o.overscaling,o.zoom>18&&Ze>2&&(Ze>>=1),Math.max(Pt/(512*Ze),1)*V.get("symbol-spacing")),pe=V.get("text-padding")*o.tilePixelRatio,Ae=V.get("icon-padding")*o.tilePixelRatio,Me=cn(V.get("text-max-angle")),Ve="map"===V.get("text-rotation-alignment")&&"point"!==V.get("symbol-placement"),et="map"===V.get("icon-rotation-alignment")&&"point"!==V.get("symbol-placement"),Re=V.get("symbol-placement"),We=me/2;var Ze;const Qe=V.get("icon-text-fit");let rt;c&&"none"!==Qe&&(o.allowVerticalPlacement&&a.vertical&&(rt=wv(c,a.vertical,Qe,V.get("icon-text-fit-padding"),H,ne)),K&&(c=wv(c,K,Qe,V.get("icon-text-fit-padding"),H,ne)));const Ne=(mt,bt,_t)=>{if(bt.x<0||bt.x>=Pt||bt.y<0||bt.y>=Pt)return;let Kt=null;if(ie){const{x:lt,y:At,z:Yt}=L.projectTilePoint(bt.x,bt.y,_t);Kt={anchor:new Dc(lt,At,Yt,0,void 0),up:L.upVector(_t,bt.x,bt.y)}}!function(lt,At,Yt,In,Jt,Ot,bi,jt,tn,ui,zn,oi,hi,Qt,bn,gi,di,Ji,Wi,Oi,Vn,Fi,fi,ho,Un){const Fr=lt.addToLineVertexArray(At,In);let Lr,Fo,xr,Da,hu,Mf,xd,v_=0,x_=0,Xp=0,b_=0,Kp=-1,Yp=-1;const cl={};let w_=$h("");const du=Yt?Yt.anchor:At;let Jp=0,Qp=0;if(void 0===tn._unevaluatedLayout.getValue("text-radial-offset")?[Jp,Qp]=tn.layout.get("text-offset").evaluate(Vn,{},Un).map(Ds=>Ds*kr):(Jp=tn.layout.get("text-radial-offset").evaluate(Vn,{},Un)*kr,Qp=r_),lt.allowVerticalPlacement&&Jt.vertical){const Ds=Jt.vertical;if(bn)Mf=s_(Ds),jt&&(xd=s_(jt));else{const Wo=tn.layout.get("text-rotate").evaluate(Vn,{},Un)+90;xr=Fp(ui,du,At,zn,oi,hi,Ds,Qt,Wo,gi),jt&&(Da=Fp(ui,du,At,zn,oi,hi,jt,Ji,Wo))}}if(Ot){const Ds=tn.layout.get("icon-rotate").evaluate(Vn,{},Un),Wo="none"!==tn.layout.get("icon-text-fit"),hl=Mv(Ot,Ds,fi,Wo),Af=jt?Mv(jt,Ds,fi,Wo):void 0;Fo=Fp(ui,du,At,zn,oi,hi,Ot,Ji,Ds),v_=4*hl.length;const r0=lt.iconSizeData;let Sc=null;"source"===r0.kind?(Sc=[Js*tn.layout.get("icon-size").evaluate(Vn,{},Un)],Sc[0]>rl&&Tn(`${lt.layerIds[0]}: Value for "icon-size" is >= ${hd}. Reduce your "icon-size".`)):"composite"===r0.kind&&(Sc=[Js*Fi.compositeIconSizes[0].evaluate(Vn,{},Un),Js*Fi.compositeIconSizes[1].evaluate(Vn,{},Un)],(Sc[0]>rl||Sc[1]>rl)&&Tn(`${lt.layerIds[0]}: Value for "icon-size" is >= ${hd}. Reduce your "icon-size".`)),lt.addSymbols(lt.icon,hl,Sc,Oi,Wi,Vn,!1,Yt,At,Fr.lineStartIndex,Fr.lineLength,-1,ho,Un),Kp=lt.icon.placedSymbolArray.length-1,Af&&(x_=4*Af.length,lt.addSymbols(lt.icon,Af,Sc,Oi,Wi,Vn,Qs.vertical,Yt,At,Fr.lineStartIndex,Fr.lineLength,-1,ho,Un),Yp=lt.icon.placedSymbolArray.length-1)}for(const Ds in Jt.horizontal){const Wo=Jt.horizontal[Ds];Lr||(w_=$h(Wo.text),bn?hu=s_(Wo):Lr=Fp(ui,du,At,zn,oi,hi,Wo,Qt,tn.layout.get("text-rotate").evaluate(Vn,{},Un),gi));const hl=1===Wo.positionedLines.length;if(Xp+=Iv(lt,Yt,At,Wo,bi,tn,bn,Vn,gi,Fr,Jt.vertical?Qs.horizontal:Qs.horizontalOnly,hl?Object.keys(Jt.horizontal):[Ds],cl,Kp,Fi,ho,Un),hl)break}Jt.vertical&&(b_+=Iv(lt,Yt,At,Jt.vertical,bi,tn,bn,Vn,gi,Fr,Qs.vertical,["vertical"],cl,Yp,Fi,ho,Un));let ul=-1;const Hl=(Ds,Wo)=>Ds?Math.max(Ds,Wo):Wo;ul=Hl(hu,ul),ul=Hl(Mf,ul),ul=Hl(xd,ul);const ow=ul>-1?1:0;lt.glyphOffsetArray.length>=Tc.MAX_GLYPHS&&Tn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Vn.sortKey&&lt.addToSortKeyRanges(lt.symbolInstances.length,Vn.sortKey),lt.symbolInstances.emplaceBack(du.x,du.y,du.z,At.x,At.y,cl.right>=0?cl.right:-1,cl.center>=0?cl.center:-1,cl.left>=0?cl.left:-1,cl.vertical>=0?cl.vertical:-1,Kp,Yp,w_,void 0!==Lr?Lr:lt.collisionBoxArray.length,void 0!==Lr?Lr+1:lt.collisionBoxArray.length,void 0!==xr?xr:lt.collisionBoxArray.length,void 0!==xr?xr+1:lt.collisionBoxArray.length,void 0!==Fo?Fo:lt.collisionBoxArray.length,void 0!==Fo?Fo+1:lt.collisionBoxArray.length,Da||lt.collisionBoxArray.length,Da?Da+1:lt.collisionBoxArray.length,zn,Xp,b_,v_,x_,ow,0,Jp,Qp,ul)}(o,bt,Kt,mt,a,c,d,rt,o.layers[0],o.collisionBoxArray,r.index,r.sourceLayerIndex,o.index,pe,Ve,E,0,Ae,et,H,r,g,D,I,k)};if("line"===Re)for(const mt of Jg(r.geometry,0,0,Pt,Pt)){const bt=xn(mt,me,Me,a.vertical||K,c,ue,ce,o.overscaling,Pt);for(const _t of bt)K&&Xb(o,K.text,We,_t)||Ne(mt,_t,k)}else if("line-center"===Re){for(const mt of r.geometry)if(mt.length>1){const bt=$b(mt,Me,a.vertical||K,c,ue,ce);bt&&Ne(mt,bt,k)}}else if("Polygon"===r.type)for(const mt of Jy(r.geometry,0)){const bt=Gb(mt,16);Ne(mt[0],new Dc(bt.x,bt.y,0,0,void 0),k)}else if("LineString"===r.type)for(const mt of r.geometry)Ne(mt,new Dc(mt[0].x,mt[0].y,0,0,void 0),k);else if("Point"===r.type)for(const mt of r.geometry)for(const bt of mt)Ne([bt],new Dc(bt.x,bt.y,0,0,void 0),k)}const hd=255,rl=hd*Js;function Iv(o,r,a,c,d,g,y,b,E,D,I,k,L,z,V,H,K){const ie=function(ce,me,pe,Ae,Me,Ve,et,Re){const We=[];if(0===me.positionedLines.length)return We;const Ze=Ae.layout.get("text-rotate").evaluate(Ve,{})*Math.PI/180,Qe=function(_t){const Kt=_t[0],lt=_t[1],At=Kt*lt;return At>0?[Kt,-lt]:At<0?[-Kt,lt]:0===Kt?[lt,Kt]:[lt,-Kt]}(pe);let rt=Math.abs(me.top-me.bottom);for(const _t of me.positionedLines)rt-=_t.lineOffset;const Ne=me.positionedLines.length,mt=rt/Ne;let bt=me.top-pe[1];for(let _t=0;_t<Ne;++_t){const Kt=me.positionedLines[_t];bt=Hb(me,mt,bt,_t);for(const lt of Kt.positionedGlyphs){if(!lt.rect)continue;const At=lt.rect||{};let Yt=gv+1,In=!0,Jt=1,Ot=0;if(lt.imageName){const fi=et[lt.imageName];if(!fi)continue;if(fi.sdf){Tn("SDF images are not supported in formatted text and will be ignored.");continue}In=!1,Jt=fi.pixelRatio,Yt=Rr/Jt}const bi=(Me||Re)&&lt.vertical,jt=lt.metrics.advance*lt.scale/2,tn=lt.metrics,ui=lt.rect;if(null===ui)continue;Re&&me.verticalizable&&(Ot=lt.imageName?jt-lt.metrics.width*lt.scale/2:0);const zn=Me?[lt.x+jt,lt.y]:[0,0];let oi=[0,0],hi=[0,0],Qt=!1;Me||(bi?(hi=[lt.x+jt+Qe[0],lt.y+Qe[1]-Ot],Qt=!0):oi=[lt.x+jt+pe[0],lt.y+pe[1]-Ot]);const bn=ui.w*lt.scale/(Jt*(lt.localGlyph?wa:1)),gi=ui.h*lt.scale/(Jt*(lt.localGlyph?wa:1));let di,Ji,Wi,Oi;if(bi){const fi=lt.y-bt,ho=new ct(-jt,jt-fi),Un=-Math.PI/2,Fr=new ct(...hi);di=new ct(-jt+oi[0],oi[1]),di._rotateAround(Un,ho)._add(Fr),di.x+=-fi+jt,di.y-=(tn.left-Yt)*lt.scale;const Lr=lt.imageName?tn.advance*lt.scale:kr*lt.scale,Fo=String.fromCharCode(lt.glyph);kb(Fo)?di.x+=(1-Yt)*lt.scale:jg(Fo)?di.x+=Lr-tn.height*lt.scale+(-Yt-1)*lt.scale:di.x+=lt.imageName||tn.width+2*Yt===ui.w&&tn.height+2*Yt===ui.h?(Lr-gi)/2:(Lr-(tn.height+2*Yt)*lt.scale)/2,Ji=new ct(di.x,di.y-bn),Wi=new ct(di.x+gi,di.y),Oi=new ct(di.x+gi,di.y-bn)}else{const fi=(tn.left-Yt)*lt.scale-jt+oi[0],ho=(-tn.top-Yt)*lt.scale+oi[1],Un=fi+bn,Fr=ho+gi;di=new ct(fi,ho),Ji=new ct(Un,ho),Wi=new ct(fi,Fr),Oi=new ct(Un,Fr)}if(Ze){let fi;fi=Me?new ct(0,0):Qt?new ct(Qe[0],Qe[1]):new ct(pe[0],pe[1]),di._rotateAround(Ze,fi),Ji._rotateAround(Ze,fi),Wi._rotateAround(Ze,fi),Oi._rotateAround(Ze,fi)}const Vn=new ct(0,0),Fi=new ct(0,0);We.push({tl:di,tr:Ji,bl:Wi,br:Oi,tex:At,writingMode:me.writingMode,glyphOffset:zn,sectionIndex:lt.sectionIndex,isSDF:In,pixelOffsetTL:Vn,pixelOffsetBR:Fi,minFontScaleX:0,minFontScaleY:0})}}return We}(0,c,E,g,y,b,d,o.allowVerticalPlacement),ue=o.textSizeData;let ne=null;"source"===ue.kind?(ne=[Js*g.layout.get("text-size").evaluate(b,{},K)],ne[0]>rl&&Tn(`${o.layerIds[0]}: Value for "text-size" is >= ${hd}. Reduce your "text-size".`)):"composite"===ue.kind&&(ne=[Js*V.compositeTextSizes[0].evaluate(b,{},K),Js*V.compositeTextSizes[1].evaluate(b,{},K)],(ne[0]>rl||ne[1]>rl)&&Tn(`${o.layerIds[0]}: Value for "text-size" is >= ${hd}. Reduce your "text-size".`)),o.addSymbols(o.text,ie,ne,E,y,b,I,r,a,D.lineStartIndex,D.lineLength,z,H,K);for(const ce of k)L[ce]=o.text.placedSymbolArray.length-1;return 4*ie.length}function o_(o){for(const r in o)return o[r];return null}function Fp(o,r,a,c,d,g,y,b,E,D){let I=y.top,k=y.bottom,L=y.left,z=y.right;const V=y.collisionPadding;if(V&&(L-=V[0],I-=V[1],z+=V[2],k+=V[3]),E){const H=new ct(L,I),K=new ct(z,I),ie=new ct(L,k),ue=new ct(z,k),ne=cn(E);let ce=new ct(0,0);D&&(ce=new ct(D[0],D[1])),H._rotateAround(ne,ce),K._rotateAround(ne,ce),ie._rotateAround(ne,ce),ue._rotateAround(ne,ce),L=Math.min(H.x,K.x,ie.x,ue.x),z=Math.max(H.x,K.x,ie.x,ue.x),I=Math.min(H.y,K.y,ie.y,ue.y),k=Math.max(H.y,K.y,ie.y,ue.y)}return o.emplaceBack(r.x,r.y,r.z,a.x,a.y,L,I,z,k,b,c,d,g),o.length-1}function s_(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const r=o.bottom-o.top;return r>0?Math.max(10,r):null}function Xb(o,r,a,c){const d=o.compareText;if(r in d){const g=d[r];for(let y=g.length-1;y>=0;y--)if(c.dist(g[y])<a)return!0}else d[r]=[];return d[r].push(c),!1}function Pv(o,r){const a=o.fovAboveCenter,c=o.elevation?o.elevation.getMinElevationBelowMSL()*r:0,d=(o._camera.position[2]*o.worldSize-c)/Math.cos(o._pitch),g=Math.sin(a)*d/Math.sin(Math.max(Math.PI/2-o._pitch-a,.01)),y=Math.sin(o._pitch)*g+d;return Math.min(1.01*y,d*(1/o._horizonShift))}function rh(o,r){if(!r.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:r};const a=Math.pow(2,-o.z),c=o.x*a,d=(o.x+1)*a,g=o.y*a,y=(o.y+1)*a,b=Ys(c),E=Ys(d),D=Zr(g),I=Zr(y),k=r.project(b,D),L=r.project(E,D),z=r.project(E,I),V=r.project(b,I);let H=Math.min(k.x,L.x,z.x,V.x),K=Math.min(k.y,L.y,z.y,V.y),ie=Math.max(k.x,L.x,z.x,V.x),ue=Math.max(k.y,L.y,z.y,V.y);const ne=a/16;function ce(pe,Ae,Me,Ve,et,Re){const We=(Me+et)/2,Ze=(Ve+Re)/2,Qe=r.project(Ys(We),Zr(Ze)),rt=Math.max(0,H-Qe.x,K-Qe.y,Qe.x-ie,Qe.y-ue);H=Math.min(H,Qe.x),ie=Math.max(ie,Qe.x),K=Math.min(K,Qe.y),ue=Math.max(ue,Qe.y),rt>ne&&(ce(pe,Qe,Me,Ve,We,Ze),ce(Qe,Ae,We,Ze,et,Re))}ce(k,L,c,g,d,g),ce(L,z,d,g,d,y),ce(z,V,d,y,c,y),ce(V,k,c,y,c,g),H-=ne,K-=ne,ie+=ne,ue+=ne;const me=1/Math.max(ie-H,ue-K);return{scale:me,x:H*me,y:K*me,x2:ie*me,y2:ue*me,projection:r}}const kv=Po(new Float32Array(16));class au{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,a){return{x:0,y:0,z:0}}unproject(r,a){return new Zn(0,0)}projectTilePoint(r,a,c){return{x:r,y:a,z:0}}locationPoint(r,a,c=!0){return r._coordinatePoint(r.locationCoordinate(a),c)}pixelsPerMeter(r,a){return va(1,r)*a}pixelSpaceConversion(r,a,c){return 1}farthestPixelDistance(r){return Pv(r,r.pixelsPerMeter)}pointCoordinate(r,a,c,d){const g=r.horizonLineFromTop(!1),y=new ct(a,Math.max(g,c));return r.rayIntersectionCoordinate(r.pointRayIntersection(y,d))}pointCoordinate3D(r,a,c){const d=new ct(a,c);if(r.elevation)return r.elevation.pointCoordinate(d);{const g=this.pointCoordinate(r,d.x,d.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,a){if(r.elevation)return!this.pointCoordinate3D(r,a.x,a.y);const c=r.horizonLineFromTop();return a.y<c}createInversionMatrix(r,a){return kv}createTileMatrix(r,a,c){let d,g,y;const b=c.canonical,E=Po(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=rh(b,this);d=1,g=D.x+c.wrap*D.scale,y=D.y,ju(E,E,[d/D.scale,d/D.scale,r.pixelsPerMeter/a])}else d=a/r.zoomScale(b.z),g=(b.x+Math.pow(2,b.z)*c.wrap)*d,y=b.y*d;return mc(E,E,[g,y,0]),ju(E,E,[d/Pt,d/Pt,1]),E}upVector(r,a,c){return[0,0,1]}upVectorScale(r,a,c){return{metersToTile:1}}}class Rv extends au{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[a,c]=this.parallels=r.parallels||[29.5,45.5],d=Math.sin(cn(a));this.n=(d+Math.sin(cn(c)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(r,a){const{n:c,c:d,r0:g}=this,y=cn(r-this.center[0]),b=cn(a),E=Math.sqrt(d-2*c*Math.sin(b))/c;return{x:E*Math.sin(y*c),y:E*Math.cos(y*c)-g,z:0}}unproject(r,a){const{n:c,c:d,r0:g}=this,y=g+a;let b=Math.atan2(r,Math.abs(y))*Math.sign(y);y*c<0&&(b-=Math.PI*Math.sign(r)*Math.sign(y));const E=cn(this.center[0])*c;b=Lt(b,-Math.PI-E,Math.PI-E);const D=zt(tr(b/c)+this.center[0],-180,180),I=Math.asin(zt((d-(r*r+y*y)*c*c)/(2*c),-1,1)),k=zt(tr(I),-Xr,Xr);return new Zn(D,k)}}const dd=1.340264,oh=-.081106,Lp=893e-6,sh=.003796,Np=Math.sqrt(3)/2;class NC extends au{project(r,a){a=a/180*Math.PI,r=r/180*Math.PI;const c=Math.asin(Np*Math.sin(a)),d=c*c,g=d*d*d;return{x:.5*(r*Math.cos(c)/(Np*(dd+3*oh*d+g*(7*Lp+9*sh*d)))/Math.PI+.5),y:1-.5*(c*(dd+oh*d+g*(Lp+sh*d))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let c=a=(2*(1-a)-1)*Math.PI,d=c*c,g=d*d*d;for(let I,k,L,z=0;z<12&&(k=c*(dd+oh*d+g*(Lp+sh*d))-a,L=dd+3*oh*d+g*(7*Lp+9*sh*d),I=k/L,c=zt(c-I,-Math.PI/3,Math.PI/3),d=c*c,g=d*d*d,!(Math.abs(I)<1e-12));++z);const y=Np*r*(dd+3*oh*d+g*(7*Lp+9*sh*d))/Math.cos(c),b=Math.asin(Math.sin(c)/Np),E=zt(180*y/Math.PI,-180,180),D=zt(180*b/Math.PI,-Xr,Xr);return new Zn(E,D)}}class $e extends au{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){return{x:.5+r/360,y:.5-a/360,z:0}}unproject(r,a){const c=360*(r-.5),d=zt(360*(.5-a),-Xr,Xr);return new Zn(c,d)}}const lu=Math.PI/2;function Bp(o){return Math.tan((lu+o)/2)}class Ov extends au{constructor(r){super(r),this.center=r.center||[0,30];const[a,c]=this.parallels=r.parallels||[30,30];let d=cn(a),g=cn(c);this.southernCenter=d+g<0,this.southernCenter&&(d=-d,g=-g);const y=Math.cos(d),b=Bp(d);this.n=d===g?Math.sin(d):Math.log(y/Math.cos(g))/Math.log(Bp(g)/b),this.f=y*Math.pow(Bp(d),this.n)/this.n}project(r,a){a=cn(a),this.southernCenter&&(a=-a),r=cn(r-this.center[0]);const c=1e-6,{n:d,f:g}=this;g>0?a<-lu+c&&(a=-lu+c):a>lu-c&&(a=lu-c);const y=g/Math.pow(Bp(a),d);let b=y*Math.sin(d*r),E=g-y*Math.cos(d*r);return b=.5*(b/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:b,y:this.southernCenter?E:1-E,z:0}}unproject(r,a){r=(2*r-.5)*Math.PI,this.southernCenter&&(a=1-a),a=(2*(1-a)-.5)*Math.PI;const{n:c,f:d}=this,g=d-a,y=Math.sign(g),b=Math.sign(c)*Math.sqrt(r*r+g*g);let E=Math.atan2(r,Math.abs(g))*y;g*c<0&&(E-=Math.PI*Math.sign(r)*y);const D=zt(tr(E/c)+this.center[0],-180,180),I=zt(tr(2*Math.atan(Math.pow(d/b,1/c))-lu),-Xr,Xr);return new Zn(D,this.southernCenter?-I:I)}}class Fv extends au{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,a){return{x:el(r),y:zl(a),z:0}}unproject(r,a){const c=Ys(r),d=Zr(a);return new Zn(c,d)}}const Lv=cn(Xr);class zp extends au{project(r,a){const c=(a=cn(a))*a,d=c*c;return{x:.5*((r=cn(r))*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(a*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(r,a){r=(2*r-.5)*Math.PI;let c=a=(2*(1-a)-1)*Math.PI,d=25,g=0,y=c*c;do{y=c*c;const D=y*y;g=(c*(1.007226+y*(.015085+D*(.028874*y-.044475-.005916*D)))-a)/(1.007226+y*(.045255+D*(.259866*y-.311325-.005916*11*D))),c=zt(c-g,-Lv,Lv)}while(Math.abs(g)>1e-6&&--d>0);y=c*c;const b=zt(tr(r/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=tr(c);return new Zn(b,E)}}const ah=cn(Xr);class a_ extends au{project(r,a){a=cn(a),r=cn(r);const c=Math.cos(a),d=2/Math.PI,g=Math.acos(c*Math.cos(r/2)),y=Math.sin(g)/g,b=.5*(r*d+2*c*Math.sin(r/2)/y)||0,E=.5*(a+Math.sin(a)/y)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(r,a){let c=r=(2*r-.5)*Math.PI,d=a=(2*(1-a)-1)*Math.PI,g=25;const y=1e-6;let b=0,E=0;do{const D=Math.cos(d),I=Math.sin(d),k=2*I*D,L=I*I,z=D*D,V=Math.cos(c/2),H=Math.sin(c/2),K=2*V*H,ie=H*H,ue=1-z*V*V,ne=ue?1/ue:0,ce=ue?Math.acos(D*V)*Math.sqrt(1/ue):0,me=.5*(2*ce*D*H+2*c/Math.PI)-r,pe=.5*(ce*I+d)-a,Ae=.5*ne*(z*ie+ce*D*V*L)+1/Math.PI,Me=ne*(K*k/4-ce*I*H),Ve=.125*ne*(k*H-ce*I*z*K),et=.5*ne*(L*V+ce*ie*D)+.5,Re=Me*Ve-et*Ae;b=(pe*Me-me*et)/Re,E=(me*Ve-pe*Ae)/Re,c=zt(c-b,-Math.PI,Math.PI),d=zt(d-E,-ah,ah)}while((Math.abs(b)>y||Math.abs(E)>y)&&--g>0);return new Zn(tr(c),tr(d))}}class fd extends au{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(cn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,a){const{scale:c,cosPhi:d}=this;return{x:cn(r)*d*c+.5,y:-Math.sin(cn(a))/d*c+.5,z:0}}unproject(r,a){const{scale:c,cosPhi:d}=this,g=-(a-.5)/c,y=zt(tr((r-.5)/c)/d,-180,180),b=Math.asin(zt(g*d,-1,1)),E=zt(tr(b),-Xr,Xr);return new Zn(y,E)}}class l_ extends Fv{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,a,c){const d=tf(r,a,c);return Pi(d,d,qu(yc(c))),{x:d[0],y:d[1],z:d[2]}}locationPoint(r,a){const c=Kh(a.lat,a.lng),d=qr([],c),g=r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(a),r._centerAltitude):r._centerAltitude;Qc(c,c,d,va(1,0)*Pt*g);const y=Po(new Float64Array(16));return Bl(y,r.pixelMatrix,r.globeMatrix),Pi(c,c,y),new ct(c[0],c[1])}pixelsPerMeter(r,a){return va(1,0)*a}pixelSpaceConversion(r,a,c){const d=va(1,r)*a,g=En(va(1,45)*a,d,c);return this.pixelsPerMeter(r,a)/g}createTileMatrix(r,a,c){const d=Xm(yc(c.canonical));return Bl(new Float64Array(16),r.globeMatrix,d)}createInversionMatrix(r,a){const{center:c}=r,d=qu(yc(a));return ap(d,d,cn(c.lng)),Ay(d,d,cn(c.lat)),ju(d,d,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(r,a,c,d){return lb(r,a,c,!0)||new Qh(0,0)}pointCoordinate3D(r,a,c){const d=this.pointCoordinate(r,a,c,0);return[d.x,d.y,d.z]}isPointAboveHorizon(r,a){return!lb(r,a.x,a.y,!1)}farthestPixelDistance(r){const a=function(d,g){const y=d.cameraToCenterDistance,b=d._centerAltitude*g,E=d._camera,D=d._camera.forward(),I=gc([],ls([],D,-y),[0,0,b]),k=d.worldSize/(2*Math.PI),L=[0,0,-k],z=d.width/d.height,V=Math.tan(d.fovAboveCenter),H=ls([],E.up(),V),K=ls([],E.right(),V*z),ie=qr([],gc([],gc([],D,H),K)),ue=[];let ne;if(new Xh(I,ie).closestPointOnSphere(L,k,ue)){const ce=gc([],ue,L),me=cs([],ce,I);ne=Math.cos(d.fovAboveCenter)*Gh(me)}else{const ce=cs([],I,L),me=cs([],L,I);qr(me,me);const pe=Gh(ce)-k;ne=Math.sqrt(pe*(pe+2*k));const Ae=Math.acos(ne/(k+pe))-Math.acos(ko(D,me));ne*=Math.cos(Ae)}return 1.01*ne}(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),c=Yh(r.zoom);if(c>0){const d=Pv(r,va(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),y=Math.max(r.width,r.height)/r.worldSize*Math.PI;return En(a,d+g*(1-Math.cos(y)),Math.pow(c,10))}return a}upVector(r,a,c){return tf(a,c,r,1)}upVectorScale(r){return{metersToTile:qm(fp(yc(r)))}}}function xf(o){const r=o.parallels,a=!!r&&Math.abs(r[0]+r[1])<.01;switch(o.name){case"mercator":return new Fv(o);case"equirectangular":return new $e(o);case"naturalEarth":return new zp(o);case"equalEarth":return new NC(o);case"winkelTripel":return new a_(o);case"albers":return a?new fd(o):new Rv(o);case"lambertConformalConic":return a?new fd(o):new Ov(o);case"globe":return new l_(o)}throw new Error(`Invalid projection name: ${o.name}`)}const Nv=Tp.types,c_=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function pd(o,r,a,c,d,g,y,b,E,D,I,k,L){const z=b?Math.min(rl,Math.round(b[0])):0,V=b?Math.min(rl,Math.round(b[1])):0;o.emplaceBack(r,a,Math.round(32*c),Math.round(32*d),g,y,(z<<1)+(E?1:0),V,16*D,16*I,256*k,256*L)}function md(o,r,a,c,d,g,y){o.emplaceBack(r,a,c,d,g,y)}function bf(o,r,a,c,d){o.emplaceBack(r,a,c,d),o.emplaceBack(r,a,c,d),o.emplaceBack(r,a,c,d),o.emplaceBack(r,a,c,d)}function u_(o){for(const r of o.sections)if(Io(r.text))return!0;return!1}class h_{constructor(r){this.layoutVertexArray=new Je,this.indexArray=new Ct,this.programConfigurations=r,this.segments=new pr,this.dynamicLayoutVertexArray=new nt,this.opacityVertexArray=new St,this.placedSymbolArray=new Yi,this.globeExtVertexArray=new at}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(r,a,c,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,Ab.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,a),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,Ip.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,c_,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,zg.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}De(h_,"SymbolBuffers");class d_{constructor(r,a,c){this.layoutVertexArray=new r,this.layoutAttributes=a,this.indexArray=new c,this.segments=new pr,this.collisionVertexArray=new vn,this.collisionVertexArrayExt=new gn}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,Ib.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,Vg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}De(d_,"CollisionBuffers");class Tc{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map(y=>y.id),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Po([]),this.placementViewportMatrix=Po([]);const a=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ug(this.zoom,a["text-size"]),this.iconSizeData=Ug(this.zoom,a["icon-size"]);const c=this.layers[0].layout,d=c.get("symbol-sort-key"),g=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==g&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===g||"auto"===g&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>Qs[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=r.sourceID,this.projection=r.projection}createArrays(){this.text=new h_(new Uu(this.layers,this.zoom,r=>/^text/.test(r))),this.icon=new h_(new Uu(this.layers,this.zoom,r=>/^icon/.test(r))),this.glyphOffsetArray=new qi,this.lineVertexArray=new Vh,this.symbolInstances=new Si}calculateGlyphDependencies(r,a,c,d,g){for(let y=0;y<r.length;y++)if(a[r.charCodeAt(y)]=!0,d&&g){const b=pf[r.charAt(y)];b&&(a[b.charCodeAt(0)]=!0)}}populate(r,a,c,d){const g=this.layers[0],y=g.layout,b="globe"===this.projection.name,E=y.get("text-font"),D=y.get("text-field"),I=y.get("icon-image"),k=("constant"!==D.value.kind||D.value.value instanceof ro&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),L="constant"!==I.value.kind||!!I.value.value||Object.keys(I.parameters).length>0,z=y.get("symbol-sort-key");if(this.features=[],!k&&!L)return;const V=a.iconDependencies,H=a.glyphDependencies,K=a.availableImages,ie=new P(this.zoom);for(const{feature:ue,id:ne,index:ce,sourceLayerIndex:me}of r){const pe=g._featureFilter.needGeometry,Ae=eu(ue,pe);if(!g._featureFilter.filter(ie,Ae,c))continue;if(pe||(Ae.geometry=tl(ue,c,d)),b&&1!==ue.type&&c.z<=5){const Re=Ae.geometry,We=.98078528056,Ze=(Qe,rt)=>ko(tf(Qe.x,Qe.y,c,1),tf(rt.x,rt.y,c,1))<We;for(let Qe=0;Qe<Re.length;Qe++)Re[Qe]=rf(Re[Qe],Ze)}let Me,Ve;if(k){const Re=g.getValueAndResolveTokens("text-field",Ae,c,K),We=ro.factory(Re);u_(We)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===w()||this.hasRTLText&&S.isParsed())&&(Me=Pb(We,g,Ae))}if(L){const Re=g.getValueAndResolveTokens("icon-image",Ae,c,K);Ve=Re instanceof es?Re:es.fromString(Re)}if(!Me&&!Ve)continue;const et=this.sortFeaturesByKey?z.evaluate(Ae,{},c):void 0;if(this.features.push({id:ne,text:Me,icon:Ve,index:ce,sourceLayerIndex:me,geometry:Ae.geometry,properties:ue.properties,type:Nv[ue.type],sortKey:et}),Ve&&(V[Ve.name]=!0),Me){const Re=E.evaluate(Ae,{},c).join(","),We="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Qs.vertical)>=0;for(const Ze of Me.sections)if(Ze.image)V[Ze.image.name]=!0;else{const Qe=fc(Me.toString()),rt=Ze.fontStack||Re,Ne=H[rt]=H[rt]||{};this.calculateGlyphDependencies(Ze.text,Ne,We,this.allowVerticalPlacement,Qe)}}}"line"===y.get("symbol-placement")&&(this.features=function(ue){const ne={},ce={},me=[];let pe=0;function Ae(Re){me.push(ue[Re]),pe++}function Me(Re,We,Ze){const Qe=ce[Re];return delete ce[Re],ce[We]=Qe,me[Qe].geometry[0].pop(),me[Qe].geometry[0]=me[Qe].geometry[0].concat(Ze[0]),Qe}function Ve(Re,We,Ze){const Qe=ne[We];return delete ne[We],ne[Re]=Qe,me[Qe].geometry[0].shift(),me[Qe].geometry[0]=Ze[0].concat(me[Qe].geometry[0]),Qe}function et(Re,We,Ze){const Qe=Ze?We[0][We[0].length-1]:We[0][0];return`${Re}:${Qe.x}:${Qe.y}`}for(let Re=0;Re<ue.length;Re++){const We=ue[Re],Ze=We.geometry,Qe=We.text?We.text.toString():null;if(!Qe){Ae(Re);continue}const rt=et(Qe,Ze),Ne=et(Qe,Ze,!0);if(rt in ce&&Ne in ne&&ce[rt]!==ne[Ne]){const mt=Ve(rt,Ne,Ze),bt=Me(rt,Ne,me[mt].geometry);delete ne[rt],delete ce[Ne],ce[et(Qe,me[bt].geometry,!0)]=bt,me[mt].geometry=null}else rt in ce?Me(rt,Ne,Ze):Ne in ne?Ve(rt,Ne,Ze):(Ae(Re),ne[rt]=pe-1,ce[Ne]=pe-1)}return me.filter(Re=>Re.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,ne)=>ue.sortKey-ne.sortKey)}update(r,a,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(r,a,this.layers,c,d),this.icon.programConfigurations.updatePaintArrays(r,a,this.layers,c,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=xf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,a){const c=this.lineVertexArray.length;if(void 0!==r.segment)for(const{x:d,y:g}of a)this.lineVertexArray.emplaceBack(d,g);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(r,a,c,d,g,y,b,E,D,I,k,L,z,V){const H=r.indexArray,K=r.layoutVertexArray,ie=r.globeExtVertexArray,ue=r.segments.prepareSegment(4*a.length,K,H,this.canOverlap?y.sortKey:void 0),ne=this.glyphOffsetArray.length,ce=ue.vertexLength,me=this.allowVerticalPlacement&&b===Qs.vertical?Math.PI/2:0,pe=y.text&&y.text.sections;for(let Me=0;Me<a.length;Me++){const{tl:Ve,tr:et,bl:Re,br:We,tex:Ze,pixelOffsetTL:Qe,pixelOffsetBR:rt,minFontScaleX:Ne,minFontScaleY:mt,glyphOffset:bt,isSDF:_t,sectionIndex:Kt}=a[Me],lt=ue.vertexLength,At=bt[1];if(pd(K,D.x,D.y,Ve.x,At+Ve.y,Ze.x,Ze.y,c,_t,Qe.x,Qe.y,Ne,mt),pd(K,D.x,D.y,et.x,At+et.y,Ze.x+Ze.w,Ze.y,c,_t,rt.x,Qe.y,Ne,mt),pd(K,D.x,D.y,Re.x,At+Re.y,Ze.x,Ze.y+Ze.h,c,_t,Qe.x,rt.y,Ne,mt),pd(K,D.x,D.y,We.x,At+We.y,Ze.x+Ze.w,Ze.y+Ze.h,c,_t,rt.x,rt.y,Ne,mt),E){const{x:Yt,y:In,z:Jt}=E.anchor,[Ot,bi,jt]=E.up;md(ie,Yt,In,Jt,Ot,bi,jt),md(ie,Yt,In,Jt,Ot,bi,jt),md(ie,Yt,In,Jt,Ot,bi,jt),md(ie,Yt,In,Jt,Ot,bi,jt),bf(r.dynamicLayoutVertexArray,Yt,In,Jt,me)}else bf(r.dynamicLayoutVertexArray,D.x,D.y,D.z,me);H.emplaceBack(lt,lt+1,lt+2),H.emplaceBack(lt+1,lt+2,lt+3),ue.vertexLength+=4,ue.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(bt[0]),Me!==a.length-1&&Kt===a[Me+1].sectionIndex||r.programConfigurations.populatePaintArrays(K.length,y,y.index,{},z,V,pe&&pe[Kt])}const Ae=E?E.anchor:D;r.placedSymbolArray.emplaceBack(Ae.x,Ae.y,Ae.z,D.x,D.y,ne,this.glyphOffsetArray.length-ne,ce,I,k,D.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],b,0,!1,0,L,0)}_commitLayoutVertex(r,a,c,d,g,y,b){r.emplaceBack(a,c,d,g,y,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(r,a,c,d,g,y,b){const E=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),D=E.vertexLength,I=b.tileAnchorX,k=b.tileAnchorY;for(let z=0;z<4;z++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(a,-r.padding,-r.padding),c.collisionVertexArrayExt.emplaceBack(a,r.padding,-r.padding),c.collisionVertexArrayExt.emplaceBack(a,r.padding,r.padding),c.collisionVertexArrayExt.emplaceBack(a,-r.padding,r.padding),this._commitLayoutVertex(c.layoutVertexArray,d,g,y,I,k,new ct(r.x1,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,g,y,I,k,new ct(r.x2,r.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,g,y,I,k,new ct(r.x2,r.y2)),this._commitLayoutVertex(c.layoutVertexArray,d,g,y,I,k,new ct(r.x1,r.y2)),E.vertexLength+=4;const L=c.indexArray;L.emplaceBack(D,D+1),L.emplaceBack(D+1,D+2),L.emplaceBack(D+2,D+3),L.emplaceBack(D+3,D),E.primitiveLength+=4}_addTextDebugCollisionBoxes(r,a,c,d,g,y){for(let b=d;b<g;b++){const E=c.get(b),D=this.getSymbolInstanceTextSize(r,y,a,b);this._addCollisionDebugVertices(E,D,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(r,a,c,d,g,y){for(let b=d;b<g;b++){const E=c.get(b),D=this.getSymbolInstanceIconSize(r,a,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,D,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(r,a){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new d_(wt,ff.members,rr),this.iconCollisionBox=new d_(wt,ff.members,rr);const c=Qu(this.iconSizeData,r),d=Qu(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const y=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(d,r,a,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(d,r,a,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,r,a,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,r,a,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(r,a,c,d){const g=this.text.placedSymbolArray.get(a.rightJustifiedTextSymbolIndex>=0?a.rightJustifiedTextSymbolIndex:a.centerJustifiedTextSymbolIndex>=0?a.centerJustifiedTextSymbolIndex:a.leftJustifiedTextSymbolIndex>=0?a.leftJustifiedTextSymbolIndex:a.verticalPlacedTextSymbolIndex>=0?a.verticalPlacedTextSymbolIndex:d),y=Pp(this.textSizeData,r,g)/kr;return this.tilePixelRatio*y}getSymbolInstanceIconSize(r,a,c){const d=this.icon.placedSymbolArray.get(c),g=Pp(this.iconSizeData,r,d);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,a,c){r.emplaceBack(a,-c,-c),r.emplaceBack(a,c,-c),r.emplaceBack(a,c,c),r.emplaceBack(a,-c,c)}_updateTextDebugCollisionBoxes(r,a,c,d,g,y){for(let b=d;b<g;b++){const E=c.get(b),D=this.getSymbolInstanceTextSize(r,y,a,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,E.padding)}}_updateIconDebugCollisionBoxes(r,a,c,d,g,y){for(let b=d;b<g;b++){const E=c.get(b),D=this.getSymbolInstanceIconSize(r,a,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,E.padding)}}updateCollisionDebugBuffers(r,a){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Qu(this.iconSizeData,r),d=Qu(this.textSizeData,r);for(let g=0;g<this.symbolInstances.length;g++){const y=this.symbolInstances.get(g);this._updateTextDebugCollisionBoxes(d,r,a,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(d,r,a,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(c,r,a,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,r,a,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,a,c,d,g,y,b,E,D){const I={};if(a<c){const{x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce,featureIndex:me}=r.get(a);I.textBox={x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce},I.textFeatureIndex=me}if(d<g){const{x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce,featureIndex:me}=r.get(d);I.verticalTextBox={x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce},I.verticalTextFeatureIndex=me}if(y<b){const{x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce,featureIndex:me}=r.get(y);I.iconBox={x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce},I.iconFeatureIndex=me}if(E<D){const{x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce,featureIndex:me}=r.get(E);I.verticalIconBox={x1:k,y1:L,x2:z,y2:V,padding:H,projectedAnchorX:K,projectedAnchorY:ie,projectedAnchorZ:ue,tileAnchorX:ne,tileAnchorY:ce},I.verticalIconFeatureIndex=me}return I}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let a=0;a<this.symbolInstances.length;a++){const c=this.symbolInstances.get(a);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(r,a){const c=r.placedSymbolArray.get(a),d=c.vertexStartIndex+4*c.numGlyphs;for(let g=c.vertexStartIndex;g<d;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const a=Math.sin(r),c=Math.cos(r),d=[],g=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const E=this.symbolInstances.get(b);d.push(0|Math.round(a*E.tileAnchorX+c*E.tileAnchorY)),g.push(E.featureIndex)}return y.sort((b,E)=>d[b]-d[E]||g[E]-g[b]),y}addToSortKeyRanges(r,a){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===a?c.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:a,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const a of this.symbolInstanceIndexes){const c=this.symbolInstances.get(a);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:D}=c;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),g>=0&&g!==d&&this.addIndicesForPlacedSymbol(this.text,g),y>=0&&y!==g&&y!==d&&this.addIndicesForPlacedSymbol(this.text,y),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}De(Tc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Tc.MAX_GLYPHS=65535,Tc.addDynamicAttributes=bf;const Kb=new oe({"symbol-placement":new $(Ue.layout_symbol["symbol-placement"]),"symbol-spacing":new $(Ue.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $(Ue.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Y(Ue.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $(Ue.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $(Ue.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new $(Ue.layout_symbol["icon-ignore-placement"]),"icon-optional":new $(Ue.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $(Ue.layout_symbol["icon-rotation-alignment"]),"icon-size":new Y(Ue.layout_symbol["icon-size"]),"icon-text-fit":new $(Ue.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $(Ue.layout_symbol["icon-text-fit-padding"]),"icon-image":new Y(Ue.layout_symbol["icon-image"]),"icon-rotate":new Y(Ue.layout_symbol["icon-rotate"]),"icon-padding":new $(Ue.layout_symbol["icon-padding"]),"icon-keep-upright":new $(Ue.layout_symbol["icon-keep-upright"]),"icon-offset":new Y(Ue.layout_symbol["icon-offset"]),"icon-anchor":new Y(Ue.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $(Ue.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $(Ue.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $(Ue.layout_symbol["text-rotation-alignment"]),"text-field":new Y(Ue.layout_symbol["text-field"]),"text-font":new Y(Ue.layout_symbol["text-font"]),"text-size":new Y(Ue.layout_symbol["text-size"]),"text-max-width":new Y(Ue.layout_symbol["text-max-width"]),"text-line-height":new Y(Ue.layout_symbol["text-line-height"]),"text-letter-spacing":new Y(Ue.layout_symbol["text-letter-spacing"]),"text-justify":new Y(Ue.layout_symbol["text-justify"]),"text-radial-offset":new Y(Ue.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $(Ue.layout_symbol["text-variable-anchor"]),"text-anchor":new Y(Ue.layout_symbol["text-anchor"]),"text-max-angle":new $(Ue.layout_symbol["text-max-angle"]),"text-writing-mode":new $(Ue.layout_symbol["text-writing-mode"]),"text-rotate":new Y(Ue.layout_symbol["text-rotate"]),"text-padding":new $(Ue.layout_symbol["text-padding"]),"text-keep-upright":new $(Ue.layout_symbol["text-keep-upright"]),"text-transform":new Y(Ue.layout_symbol["text-transform"]),"text-offset":new Y(Ue.layout_symbol["text-offset"]),"text-allow-overlap":new $(Ue.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new $(Ue.layout_symbol["text-ignore-placement"]),"text-optional":new $(Ue.layout_symbol["text-optional"])});var Vp={paint:new oe({"icon-opacity":new Y(Ue.paint_symbol["icon-opacity"]),"icon-color":new Y(Ue.paint_symbol["icon-color"]),"icon-halo-color":new Y(Ue.paint_symbol["icon-halo-color"]),"icon-halo-width":new Y(Ue.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Y(Ue.paint_symbol["icon-halo-blur"]),"icon-translate":new $(Ue.paint_symbol["icon-translate"]),"icon-translate-anchor":new $(Ue.paint_symbol["icon-translate-anchor"]),"text-opacity":new Y(Ue.paint_symbol["text-opacity"]),"text-color":new Y(Ue.paint_symbol["text-color"],{runtimeType:Vr,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Y(Ue.paint_symbol["text-halo-color"]),"text-halo-width":new Y(Ue.paint_symbol["text-halo-width"]),"text-halo-blur":new Y(Ue.paint_symbol["text-halo-blur"]),"text-translate":new $(Ue.paint_symbol["text-translate"]),"text-translate-anchor":new $(Ue.paint_symbol["text-translate-anchor"])}),layout:Kb};class f_{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:$n,this.defaultValue=r}evaluate(r){if(r.formattedSection){const a=this.defaultValue.property.overrides;if(a&&a.hasOverride(r.formattedSection))return a.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}De(f_,"FormatSectionOverride",{omit:["defaultValue"]});class Up extends Nl{constructor(r){super(r,Vp)}recalculate(r,a){super.recalculate(r,a),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const d=[];for(const g of c)d.indexOf(g)<0&&d.push(g);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(r,a,c,d){const g=this.layout.get(r).evaluate(a,{},c,d),y=this._unevaluatedLayout._values[r];return y.isDataDriven()||Ri(y.value)||!g?g:(b=a.properties,g.replace(/{([^{}]+)}/g,(D,I)=>I in b?String(b[I]):""));var b}createBucket(r){return new Tc(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of Vp.paint.overridableProperties){if(!Up.hasPaintOverride(this.layout,r))continue;const a=this.paint.get(r),c=new f_(a),d=new Hn(c,a.property.specification);let g=null;g="constant"===a.value.kind||"source"===a.value.kind?new Xa("source",d):new Pl("composite",d,a.value.zoomStops,a.value._interpolationType),this.paint._values[r]=new ee(a.property,g,a.parameters)}}_handleOverridablePaintPropertyUpdate(r,a,c){return!(!this.layout||a.isDataDriven()||c.isDataDriven())&&Up.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,a){const c=r.get("text-field"),d=Vp.paint.properties[a];let g=!1;const y=b=>{for(const E of b)if(d.overrides&&d.overrides.hasOverride(E))return void(g=!0)};if("constant"===c.value.kind&&c.value.value instanceof ro)y(c.value.value.sections);else if("source"===c.value.kind){const b=D=>{g||(D instanceof Sn&&Mi(D.value)===Oa?y(D.value.sections):D instanceof La?y(D.sections):D.eachChild(b))},E=c.value;E._styleExpression&&b(E._styleExpression.expression)}return g}getProgramConfiguration(r){return new Vu(this,r)}}var Yb={paint:new oe({"background-color":new $(Ue.paint_background["background-color"]),"background-pattern":new $(Ue.paint_background["background-pattern"]),"background-opacity":new $(Ue.paint_background["background-opacity"])})},ea={paint:new oe({"raster-opacity":new $(Ue.paint_raster["raster-opacity"]),"raster-hue-rotate":new $(Ue.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $(Ue.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $(Ue.paint_raster["raster-brightness-max"]),"raster-saturation":new $(Ue.paint_raster["raster-saturation"]),"raster-contrast":new $(Ue.paint_raster["raster-contrast"]),"raster-resampling":new $(Ue.paint_raster["raster-resampling"]),"raster-fade-duration":new $(Ue.paint_raster["raster-fade-duration"])})};class Jb extends Nl{constructor(r){super(r,{}),this.implementation=r}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}var Qb={paint:new oe({"sky-type":new $(Ue.paint_sky["sky-type"]),"sky-atmosphere-sun":new $(Ue.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new $(Ue.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new $(Ue.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new $(Ue.paint_sky["sky-gradient-radius"]),"sky-gradient":new ae(Ue.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new $(Ue.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new $(Ue.paint_sky["sky-atmosphere-color"]),"sky-opacity":new $(Ue.paint_sky["sky-opacity"])})};function Bv(o,r,a){const c=[0,0,1],d=Fy([]);return jm(d,d,a?-cn(o)+Math.PI:cn(o)),ob(d,d,-cn(r)),Py(c,c,d),qr(c,c)}const p_={circle:class extends Nl{constructor(o){super(o,Xy)}createBucket(o){return new _p(o)}queryRadius(o){const r=o;return td("circle-radius",this,r)+td("circle-stroke-width",this,r)+yp(this.paint.get("circle-translate"))}queryIntersectsFeature(o,r,a,c,d,g,y,b){const E=cg(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(r,a)+this.paint.get("circle-stroke-width").evaluate(r,a);return ug(o,c,g,y,b,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,D)}getProgramIds(){return["circle"]}getProgramConfiguration(o){return new Vu(this,o)}},heatmap:class extends Nl{createBucket(o){return new hg(o)}constructor(o){super(o,xp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=bp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return td("heatmap-radius",this,o)}queryIntersectsFeature(o,r,a,c,d,g,y,b){const E=this.paint.get("heatmap-radius").evaluate(r,a);return ug(o,c,g,y,b,!0,!0,new ct(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(o){return new Vu(this,o)}},hillshade:class extends Nl{constructor(o){super(o,pg)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Nl{constructor(o){super(o,yb)}getProgramIds(){const o=this.paint.get("fill-pattern"),r=o&&o.constantOr(1),a=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&a.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),a}getProgramConfiguration(o){return new Vu(this,o)}recalculate(o,r){super.recalculate(o,r);const a=this.paint._values["fill-outline-color"];"constant"===a.value.kind&&void 0===a.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Tg(o)}queryRadius(){return yp(this.paint.get("fill-translate"))}queryIntersectsFeature(o,r,a,c,d,g){return!o.queryGeometry.isAboveHorizon&&Wy(lg(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Nl{constructor(o){super(o,Tb)}createBucket(o){return new Yu(o)}queryRadius(){return yp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(o){return new Vu(this,o)}queryIntersectsFeature(o,r,a,c,d,g,y,b,E){const D=cg(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),I=this.paint.get("fill-extrusion-height").evaluate(r,a),k=this.paint.get("fill-extrusion-base").evaluate(r,a),L=[0,0],z=b&&g.elevation,V=g.elevation?g.elevation.exaggeration():1,H=o.tile.getBucket(this);if(z&&H instanceof Yu){const ce=H.centroidVertexArray,me=E+1;me<ce.length&&(L[0]=ce.geta_centroid_pos0(me),L[1]=ce.geta_centroid_pos1(me))}if(0===L[0]&&1===L[1])return!1;"globe"===g.projection.name&&(c=lv([c],[new ct(0,0),new ct(Pt,Pt)],o.tileID.canonical).map(ce=>ce.polygon).flat());const K=z?b:null,[ie,ue]=(me=c,pe=k,Ae=I,Me=D,Ve=y,et=K,Re=L,We=V,Ze=g.center.lat,"globe"===(ce=g).projection.name?function(rt,Ne,mt,bt,_t,Kt,lt,At,Yt,In,Jt){const Ot=[],bi=[],jt=rt.projection.upVectorScale(Jt,rt.center.lat,rt.worldSize).metersToTile,tn=[0,0,0,1],ui=[0,0,0,1],zn=(hi,Qt,bn,gi)=>{hi[0]=Qt,hi[1]=bn,hi[2]=gi,hi[3]=1},oi=av();mt>0&&(mt+=oi),bt+=oi;for(const hi of Ne){const Qt=[],bn=[];for(const gi of hi){const di=gi.x+_t.x,Ji=gi.y+_t.y,Wi=rt.projection.projectTilePoint(di,Ji,Jt),Oi=rt.projection.upVector(Jt,gi.x,gi.y);let Vn=mt,Fi=bt;if(lt){const fi=cv(di,Ji,mt,bt,lt,At,Yt,In);Vn+=fi.base,Fi+=fi.top}0!==mt?zn(tn,Wi.x+Oi[0]*jt*Vn,Wi.y+Oi[1]*jt*Vn,Wi.z+Oi[2]*jt*Vn):zn(tn,Wi.x,Wi.y,Wi.z),zn(ui,Wi.x+Oi[0]*jt*Fi,Wi.y+Oi[1]*jt*Fi,Wi.z+Oi[2]*jt*Fi),Pi(tn,tn,Kt),Pi(ui,ui,Kt),Qt.push(new Ju(tn[0],tn[1],tn[2])),bn.push(new Ju(ui[0],ui[1],ui[2]))}Ot.push(Qt),bi.push(bn)}return[Ot,bi]}(ce,me,pe,Ae,Me,Ve,et,Re,We,Ze,o.tileID.canonical):et?function(rt,Ne,mt,bt,_t,Kt,lt,At,Yt){const In=[],Jt=[],Ot=[0,0,0,1];for(const bi of rt){const jt=[],tn=[];for(const ui of bi){const zn=ui.x+bt.x,oi=ui.y+bt.y,hi=cv(zn,oi,Ne,mt,Kt,lt,At,Yt);Ot[0]=zn,Ot[1]=oi,Ot[2]=hi.base,Ot[3]=1,ya(Ot,Ot,_t),Ot[3]=Math.max(Ot[3],1e-5);const Qt=new Ju(Ot[0]/Ot[3],Ot[1]/Ot[3],Ot[2]/Ot[3]);Ot[0]=zn,Ot[1]=oi,Ot[2]=hi.top,Ot[3]=1,ya(Ot,Ot,_t),Ot[3]=Math.max(Ot[3],1e-5);const bn=new Ju(Ot[0]/Ot[3],Ot[1]/Ot[3],Ot[2]/Ot[3]);jt.push(Qt),tn.push(bn)}In.push(jt),Jt.push(tn)}return[In,Jt]}(me,pe,Ae,Me,Ve,et,Re,We,Ze):function(rt,Ne,mt,bt,_t){const Kt=[],lt=[],At=_t[8]*Ne,Yt=_t[9]*Ne,In=_t[10]*Ne,Jt=_t[11]*Ne,Ot=_t[8]*mt,bi=_t[9]*mt,jt=_t[10]*mt,tn=_t[11]*mt;for(const ui of rt){const zn=[],oi=[];for(const hi of ui){const Qt=hi.x+bt.x,bn=hi.y+bt.y,gi=_t[0]*Qt+_t[4]*bn+_t[12],di=_t[1]*Qt+_t[5]*bn+_t[13],Ji=_t[2]*Qt+_t[6]*bn+_t[14],Wi=_t[3]*Qt+_t[7]*bn+_t[15],Oi=gi+At,Vn=di+Yt,Fi=Ji+In,fi=Math.max(Wi+Jt,1e-5),ho=gi+Ot,Un=di+bi,Fr=Ji+jt,Lr=Math.max(Wi+tn,1e-5);zn.push(new Ju(Oi/fi,Vn/fi,Fi/fi)),oi.push(new Ju(ho/Lr,Un/Lr,Fr/Lr))}Kt.push(zn),lt.push(oi)}return[Kt,lt]}(me,pe,Ae,Me,Ve)),ne=o.queryGeometry;var ce,me,pe,Ae,Me,Ve,et,Re,We,Ze;return function(ce,me,pe){let Ae=1/0;Wy(pe,me)&&(Ae=Rg(pe,me[0]));for(let Me=0;Me<me.length;Me++){const Ve=me[Me],et=ce[Me];for(let Re=0;Re<Ve.length-1;Re++){const We=Ve[Re],Ze=[We,Ve[Re+1],et[Re+1],et[Re],We];qy(pe,Ze)&&(Ae=Math.min(Ae,Rg(pe,Ze)))}}return Ae!==1/0&&Ae}(ie,ue,ne.isPointQuery()?ne.screenBounds:ne.screenGeometry)}},line:class extends Nl{constructor(o){super(o,Ng),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Au,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,r){super.recalculate(o,r),this.paint._values["line-floorwidth"]=Bg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new Ap(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(o){return new Vu(this,o)}queryRadius(o){const r=o,a=iu(td("line-width",this,r),td("line-gap-width",this,r)),c=td("line-offset",this,r);return a/2+Math.abs(c)+yp(this.paint.get("line-translate"))}queryIntersectsFeature(o,r,a,c,d,g){if(o.queryGeometry.isAboveHorizon)return!1;const y=lg(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,o.pixelToTileUnitsFactor),b=o.pixelToTileUnitsFactor/2*iu(this.paint.get("line-width").evaluate(r,a),this.paint.get("line-gap-width").evaluate(r,a)),E=this.paint.get("line-offset").evaluate(r,a);return E&&(c=function(D,I){const k=[],L=new ct(0,0);for(let z=0;z<D.length;z++){const V=D[z],H=[];for(let K=0;K<V.length;K++){const ie=V[K],ue=V[K+1],ne=0===K?L:ie.sub(V[K-1])._unit()._perp(),ce=K===V.length-1?L:ue.sub(ie)._unit()._perp(),me=ne._add(ce)._unit();me._mult(1/(me.x*ce.x+me.y*ce.y)),H.push(me._mult(I)._add(ie))}k.push(H)}return k}(c,E*o.pixelToTileUnitsFactor)),function(D,I,k){for(let L=0;L<I.length;L++){const z=I[L];if(D.length>=3)for(let V=0;V<z.length;V++)if(xc(D,z[V]))return!0;if(cb(D,z,k))return!0}return!1}(y,c,b)}isTileClipped(){return!0}},symbol:Up,background:class extends Nl{constructor(o){super(o,Yb)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Nl{constructor(o){super(o,ea)}getProgramIds(){return["raster"]}},sky:class extends Nl{constructor(o){super(o,Qb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=bp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(o,r){if("atmosphere"===this.paint.get("sky-type")){const c=this.paint.get("sky-atmosphere-sun"),d=!c,g=o.style.light,y=g.properties.get("position");return d&&"viewport"===g.properties.get("anchor")&&Tn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?Bv(y.azimuthal,90-y.polar,r):Bv(c[0],90-c[1],r)}const a=this.paint.get("sky-gradient-center");return Bv(a[0],90-a[1],r)}is3D(){return!1}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}}};class gd{constructor(r,a,c,d){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(a,d)}update(r,a,c){const{width:d,height:g}=r,{context:y}=this,{gl:b}=y,{HTMLImageElement:E,HTMLCanvasElement:D,HTMLVideoElement:I,ImageData:k,ImageBitmap:L}=Ke;if(b.bindTexture(b.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!a||!1!==a.premultiply)),c||this.size&&this.size[0]===d&&this.size[1]===g){const{x:z,y:V}=c||{x:0,y:0};r instanceof E||r instanceof D||r instanceof I||r instanceof k||L&&r instanceof L?b.texSubImage2D(b.TEXTURE_2D,0,z,V,b.RGBA,b.UNSIGNED_BYTE,r):b.texSubImage2D(b.TEXTURE_2D,0,z,V,d,g,b.RGBA,b.UNSIGNED_BYTE,r.data)}else this.size=[d,g],r instanceof E||r instanceof D||r instanceof I||r instanceof k||L&&r instanceof L?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,r):b.texImage2D(b.TEXTURE_2D,0,this.format,d,g,0,this.format,b.UNSIGNED_BYTE,r.data);this.useMipmap=Boolean(a&&a.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(r,a){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),r!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,r),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?r===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:r),this.filter=r),a!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,a),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,a),this.wrap=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class ew{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class tw{constructor(){this.tasks={},this.taskQueue=[],Ln(["process"],this),this.invoker=new ew(this.process),this.nextId=0}add(r,a){const c=this.nextId++,d=function({type:g,isSymbolTile:y,zoom:b}){return b=b||0,"message"===g?0:"maybePrepare"!==g||y?"parseTile"!==g||y?"parseTile"===g&&y?300-b:"maybePrepare"===g&&y?400-b:500:200-b:100-b}(a);if(0===d){Rs();try{r()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:r,metadata:a,priority:d,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Rs();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const r=this.pick();if(null===r)return;const a=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!a)return;a.fn()}finally{}}pick(){let r=null,a=1/0;for(let d=0;d<this.taskQueue.length;d++){const g=this.tasks[this.taskQueue[d]];g.priority<a&&(a=g.priority,r=d)}if(null===r)return null;const c=this.taskQueue[r];return this.taskQueue.splice(r,1),c}remove(){this.invoker.remove()}}class zv{constructor(r){this._stringToNumber={},this._numberToString=[];for(let a=0;a<r.length;a++){const c=r[a];this._stringToNumber[c]=a,this._numberToString[a]=c}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const Vv=["tile","layer","source","sourceLayer","state"];class Uv{constructor(r,a,c,d,g){this.type="Feature",this._vectorTileFeature=r,this._z=a,this._x=c,this._y=d,this.properties=r.properties,this.id=g}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(r.id=this.id);for(const a of Vv)void 0!==this[a]&&(r[a]=this[a]);return r}}const Ea=32,Ca=33,cu=new Uint16Array(8184);for(let o=0;o<2046;o++){let r=o+2,a=0,c=0,d=0,g=0,y=0,b=0;for(1&r?d=g=y=Ea:a=c=b=Ea;(r>>=1)>1;){const D=a+d>>1,I=c+g>>1;1&r?(d=a,g=c,a=y,c=b):(a=d,c=g,d=y,g=b),y=D,b=I}const E=4*o;cu[E+0]=a,cu[E+1]=c,cu[E+2]=d,cu[E+3]=g}const jl=new Uint16Array(2178),uu=new Uint8Array(1089),jp=new Uint16Array(1089);function jv(o){return 0===o?-.03125:32===o?.03125:0}var ol=we([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const $p={type:2,extent:Pt,loadGeometry:()=>[[new ct(0,0),new ct(Pt+1,0),new ct(Pt+1,Pt+1),new ct(0,Pt+1),new ct(0,0)]]};class m_{constructor(r,a,c,d,g){this.tileID=r,this.uid=mn(),this.uses=0,this.tileSize=a,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=g,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(r){const a=r+this.timeAdded;a<ps.now()||this.fadeEndTime&&a<this.fadeEndTime||(this.fadeEndTime=a)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=rh(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(r,a,c){if(this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(d,g){const y={};if(!g)return y;for(const b of d){const E=b.layerIds.map(D=>g.getLayer(D)).filter(Boolean);if(0!==E.length){b.layers=E,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(D=>E.filter(I=>I.id===D)[0]));for(const D of E)y[D.id]=b}}return y}(r.buckets,a.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof Tc){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof Tc&&g.hasRTLText){this.hasRTLText=!0,S.isLoading()||S.isLoaded()||"deferred"!==w()||T();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,a.style.getLayer(d).queryRadius(g))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage),r.lineAtlas&&(this.lineAtlas=r.lineAtlas)}else this.collisionBoxArray=new Yn}unloadVectorData(){if(this.hasData()){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(r){return this.buckets[r.id]}upload(r){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(r)}const a=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new gd(r,this.imageAtlas.image,a.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new gd(r,this.glyphAtlasImage,a.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new gd(r,this.lineAtlas.image,a.ALPHA),this.lineAtlas.uploaded=!0)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,a,c,d,g,y,b,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:b,transform:y,params:g,tileTransform:this.tileTransform},r,a,c):{}}querySourceFeatures(r,a){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),g=a?a.sourceLayer:"",y=d._geojsonTileLayer||d[g];if(!y)return;const b=$d(a&&a.filter),{z:E,x:D,y:I}=this.tileID.canonical,k={z:E,x:D,y:I};for(let L=0;L<y.length;L++){const z=y.feature(L);if(b.needGeometry){const K=eu(z,!0);if(!b.filter(new P(this.tileID.overscaledZ),K,this.tileID.canonical))continue}else if(!b.filter(new P(this.tileID.overscaledZ),z))continue;const V=c.getId(z,g),H=new Uv(z,E,D,I,V);H.tile=k,r.push(H)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const a=this.expirationTime;if(r.cacheControl){const c=an(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(a)if(this.expirationTime<a)d=!0;else{const g=this.expirationTime-a;g?this.expirationTime=c+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(r,a){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(r).length||!a)return;const c=this.latestFeatureIndex.loadVTLayers(),d=a.style.listImages();for(const g in this.buckets){if(!a.style.hasLayer(g))continue;const y=this.buckets[g],b=y.layers[0].sourceLayer||"_geojsonTileLayer",E=c[b],D=r[b];if(!E||!D||0===Object.keys(D).length)continue;if(y.update(D,E,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof Ap||y instanceof Tg){const k=a.style._getSourceCache(y.layers[0].source);a._terrain&&a._terrain.enabled&&k&&y.programConfigurations.needsUpload&&a._terrain._clearRenderCacheForTile(k.id,this.tileID)}const I=a&&a.style&&a.style.getLayer(g);I&&(this.queryPadding=Math.max(this.queryPadding,I.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ps.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=ps.now()+r}setTexture(r,a){const c=a.context,d=c.gl;this.texture=this.texture||a.getTileTexture(r.width),this.texture?this.texture.update(r,{useMipmap:!0}):(this.texture=new gd(c,r,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(r,a){const c={};for(const d of a)c[d]=!0;this.dependencies[r]=c}hasDependency(r,a){for(const c of r){const d=this.dependencies[c];if(d)for(const g of a)if(d[g])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(r,a){if(!a||"mercator"===a.name||this._tileDebugBuffer)return;const c=tl($p,this.tileID.canonical,this.tileTransform)[0],d=new tt,g=new xs;for(let y=0;y<c.length;y++){const{x:b,y:E}=c[y];d.emplaceBack(b,E),g.emplaceBack(y)}g.emplaceBack(0),this._tileDebugIndexBuffer=r.createIndexBuffer(g),this._tileDebugBuffer=r.createVertexBuffer(d,Qd.members),this._tileDebugSegments=pr.simpleSegment(0,0,d.length,g.length)}_makeTileBoundsBuffers(r,a){if(this._tileBoundsBuffer||!a||"mercator"===a.name)return;const c=tl($p,this.tileID.canonical,this.tileTransform)[0];let d,g;if(this.isRaster){const y=function(b,E){const D=rh(b,E),I=Math.pow(2,b.z);for(let K=0;K<Ca;K++)for(let ie=0;ie<Ca;ie++){const ue=Ys((b.x+(ie+jv(ie))/Ea)/I),ne=Zr((b.y+(K+jv(K))/Ea)/I),ce=E.project(ue,ne),me=K*Ca+ie;jl[2*me+0]=Math.round((ce.x*D.scale-D.x)*Pt),jl[2*me+1]=Math.round((ce.y*D.scale-D.y)*Pt)}uu.fill(0),jp.fill(0);for(let K=2045;K>=0;K--){const ie=4*K,ue=cu[ie+0],ne=cu[ie+1],ce=cu[ie+2],me=cu[ie+3],pe=ue+ce>>1,Ae=ne+me>>1,Me=pe+Ae-ne,Ve=Ae+ue-pe,et=ne*Ca+ue,Re=me*Ca+ce,We=Ae*Ca+pe,Ze=Math.hypot((jl[2*et+0]+jl[2*Re+0])/2-jl[2*We+0],(jl[2*et+1]+jl[2*Re+1])/2-jl[2*We+1])>=16;uu[We]=uu[We]||(Ze?1:0),K<1022&&(uu[We]=uu[We]||uu[(ne+Ve>>1)*Ca+(ue+Me>>1)]||uu[(me+Ve>>1)*Ca+(ce+Me>>1)])}const k=new qe,L=new Ct;let z=0;function V(K,ie){const ue=ie*Ca+K;return 0===jp[ue]&&(k.emplaceBack(jl[2*ue+0],jl[2*ue+1],K*Pt/Ea,ie*Pt/Ea),jp[ue]=++z),jp[ue]-1}function H(K,ie,ue,ne,ce,me){const pe=K+ue>>1,Ae=ie+ne>>1;if(Math.abs(K-ce)+Math.abs(ie-me)>1&&uu[Ae*Ca+pe])H(ce,me,K,ie,pe,Ae),H(ue,ne,ce,me,pe,Ae);else{const Me=V(K,ie),Ve=V(ue,ne),et=V(ce,me);L.emplaceBack(Me,Ve,et)}}return H(0,0,Ea,Ea,Ea,0),H(Ea,Ea,0,0,0,Ea),{vertices:k,indices:L}}(this.tileID.canonical,a);d=y.vertices,g=y.indices}else{d=new qe,g=new Ct;for(const{x:b,y:E}of c)d.emplaceBack(b,E,0,0);const y=Dg(d.int16,void 0,4);for(let b=0;b<y.length;b+=3)g.emplaceBack(y[b],y[b+1],y[b+2])}this._tileBoundsBuffer=r.createVertexBuffer(d,ol.members),this._tileBoundsIndexBuffer=r.createIndexBuffer(g),this._tileBoundsSegments=pr.simpleSegment(0,0,d.length,g.length)}_makeGlobeTileDebugBuffers(r,a){const c=a.projection;if(!c||"globe"!==c.name||a.freezeTileCoverage)return;const d=this.tileID.canonical,g=qu(Wm(d,a)),y=Yh(a.zoom);let b;y>0&&(b=sp(new Float64Array(16),a.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(r,d,a,g,b,y),this._makeGlobeTileDebugTextBuffer(r,d,a,g,b,y)}_globePoint(r,a,c,d,g,y,b){let E=tf(r,a,c);if(y){const D=1<<c.z,I=el(d.center.lng),k=zl(d.center.lat),L=(c.x+.5)/D-I;let z=0;L>.5?z=-1:L<-.5&&(z=1);let V=(r/Pt+c.x)/D+z,H=(a/Pt+c.y)/D;V=(V-I)*d._pixelsPerMercatorPixel+I,H=(H-k)*d._pixelsPerMercatorPixel+k;const K=[V*d.worldSize,H*d.worldSize,0];Pi(K,K,y),E=Gu(E,K,b)}return Pi(E,E,g)}_makeGlobeTileDebugBorderBuffer(r,a,c,d,g,y){const b=new tt,E=new xs,D=new Ie,I=(L,z,V,H,K)=>{const ie=(V-L)/(K-1),ue=(H-z)/(K-1),ne=b.length;for(let ce=0;ce<K;ce++){const me=L+ce*ie,pe=z+ce*ue;b.emplaceBack(me,pe);const Ae=this._globePoint(me,pe,a,c,d,g,y);D.emplaceBack(Ae[0],Ae[1],Ae[2]),E.emplaceBack(ne+ce)}},k=Pt;I(0,0,k,0,16),I(k,0,k,k,16),I(k,k,0,k,16),I(0,k,0,0,16),this._tileDebugIndexBuffer=r.createIndexBuffer(E),this._tileDebugBuffer=r.createVertexBuffer(b,Qd.members),this._globeTileDebugBorderBuffer=r.createVertexBuffer(D,Ny.members),this._tileDebugSegments=pr.simpleSegment(0,0,b.length,E.length)}_makeGlobeTileDebugTextBuffer(r,a,c,d,g,y){const b=Pt/4,E=new tt,D=new Ct,I=new Ie,k=25;D.reserve(32),E.reserve(k),I.reserve(k);const L=(z,V)=>k*z+V;for(let z=0;z<k;z++){const V=z*b;for(let H=0;H<k;H++){const K=H*b;E.emplaceBack(K,V);const ie=this._globePoint(K,V,a,c,d,g,y);I.emplaceBack(ie[0],ie[1],ie[2])}}for(let z=0;z<4;z++)for(let V=0;V<4;V++){const H=L(z,V),K=L(z,V+1),ie=L(z+1,V),ue=L(z+1,V+1);D.emplaceBack(H,K,ie),D.emplaceBack(ie,K,ue)}this._tileDebugTextIndexBuffer=r.createIndexBuffer(D),this._tileDebugTextBuffer=r.createVertexBuffer(E,Qd.members),this._globeTileDebugTextBuffer=r.createVertexBuffer(I,Ny.members),this._tileDebugTextSegments=pr.simpleSegment(0,0,k,32)}}class nw{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,a,c){const d=String(a);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][d]=this.stateChanges[r][d]||{},Ei(this.stateChanges[r][d],c),null===this.deletedStates[r]){this.deletedStates[r]={};for(const g in this.state[r])g!==d&&(this.deletedStates[r][g]=null)}else if(this.deletedStates[r]&&null===this.deletedStates[r][d]){this.deletedStates[r][d]={};for(const g in this.state[r][d])c[g]||(this.deletedStates[r][d][g]=null)}else for(const g in c)this.deletedStates[r]&&this.deletedStates[r][d]&&null===this.deletedStates[r][d][g]&&delete this.deletedStates[r][d][g]}removeFeatureState(r,a,c){if(null===this.deletedStates[r])return;const d=String(a);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&void 0!==a)null!==this.deletedStates[r][d]&&(this.deletedStates[r][d]=this.deletedStates[r][d]||{},this.deletedStates[r][d][c]=null);else if(void 0!==a)if(this.stateChanges[r]&&this.stateChanges[r][d])for(c in this.deletedStates[r][d]={},this.stateChanges[r][d])this.deletedStates[r][d][c]=null;else this.deletedStates[r][d]=null;else this.deletedStates[r]=null}getState(r,a){const c=String(a),d=Ei({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(null===this.deletedStates[r])return{};if(this.deletedStates[r]){const g=this.deletedStates[r][a];if(null===g)return{};for(const y in g)delete d[y]}return d}initializeTileState(r,a){r.setFeatureState(this.state,a)}coalesceChanges(r,a){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const y in this.stateChanges[d])this.state[d][y]||(this.state[d][y]={}),Ei(this.state[d][y],this.stateChanges[d][y]),g[y]=this.state[d][y];c[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(null===this.deletedStates[d])for(const y in this.state[d])g[y]={},this.state[d][y]={};else for(const y in this.deletedStates[d]){if(null===this.deletedStates[d][y])this.state[d][y]={};else if(this.state[d][y])for(const b of Object.keys(this.deletedStates[d][y]))delete this.state[d][y][b];g[y]=this.state[d][y]}c[d]=c[d]||{},Ei(c[d],g)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(const d in r)r[d].setFeatureState(c,a)}}class g_{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,a){const c=this.toIdx(r,a);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(r,a){return this.leaves[this.toIdx(r,a)]}toIdx(r,a){return a*this.size+r}}function $v(o,r,a,c){let d=0,g=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(a[y]<o[y]||a[y]>r[y])return null}else{const b=1/c[y];let E=(o[y]-a[y])*b,D=(r[y]-a[y])*b;if(E>D){const I=E;E=D,D=I}if(E>d&&(d=E),D<g&&(g=D),d>g)return null}return d}function Hv(o,r,a,c,d,g,y,b,E,D,I){const k=c-o,L=d-r,z=g-a,V=y-o,H=b-r,K=E-a,ie=I[1]*K-I[2]*H,ue=I[2]*V-I[0]*K,ne=I[0]*H-I[1]*V,ce=k*ie+L*ue+z*ne;if(Math.abs(ce)<1e-15)return null;const me=1/ce,pe=D[0]-o,Ae=D[1]-r,Me=D[2]-a,Ve=(pe*ie+Ae*ue+Me*ne)*me;if(Ve<0||Ve>1)return null;const et=Ae*z-Me*L,Re=Me*k-pe*z,We=pe*L-Ae*k,Ze=(I[0]*et+I[1]*Re+I[2]*We)*me;return Ze<0||Ve+Ze>1?null:(V*et+H*Re+K*We)*me}function Gv(o,r,a){return(o-r)/(a-r)}function Hp(o,r,a,c,d,g,y,b,E){const D=1<<a,I=g-c,k=y-d,L=(o+1)/D*I+c,z=(r+0)/D*k+d,V=(r+1)/D*k+d;b[0]=(o+0)/D*I+c,b[1]=z,E[0]=L,E[1]=V}class qv{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const a=function(g){const y=Math.ceil(Math.log2(g.dim/8)),b=[];let E=Math.ceil(Math.pow(2,y));const D=1/E,I=(z,V,H,K,ie)=>{const ue=K?1:0,ne=(z+1)*H-ue,ce=V*H,me=(V+1)*H-ue;ie[0]=z*H,ie[1]=ce,ie[2]=ne,ie[3]=me};let k=new g_(E);const L=[];for(let z=0;z<E*E;z++){I(z%E,Math.floor(z/E),D,!1,L);const V=sl(L[0],L[1],g),H=sl(L[2],L[1],g),K=sl(L[2],L[3],g),ie=sl(L[0],L[3],g);k.minimums.push(Math.min(V,H,K,ie)),k.maximums.push(Math.max(V,H,K,ie)),k.leaves.push(1)}for(b.push(k),E/=2;E>=1;E/=2){const z=b[b.length-1];k=new g_(E);for(let V=0;V<E*E;V++){I(V%E,Math.floor(V/E),2,!0,L);const H=z.getElevation(L[0],L[1]),K=z.getElevation(L[2],L[1]),ie=z.getElevation(L[2],L[3]),ue=z.getElevation(L[0],L[3]),ne=z.isLeaf(L[0],L[1]),ce=z.isLeaf(L[2],L[1]),me=z.isLeaf(L[2],L[3]),pe=z.isLeaf(L[0],L[3]),Ae=Math.min(H.min,K.min,ie.min,ue.min),Me=Math.max(H.max,K.max,ie.max,ue.max),Ve=ne&&ce&&me&&pe;k.maximums.push(Me),k.minimums.push(Ae),k.leaves.push(Me-Ae<=5&&Ve?1:0)}b.push(k)}return b}(this.dem),c=a.length-1,d=a[c];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(a,0,0,c,0)}raycastRoot(r,a,c,d,g,y,b=1){return $v([r,a,-100],[c,d,this.maximums[0]*b],g,y)}raycast(r,a,c,d,g,y,b=1){if(!this.nodeCount)return null;const E=this.raycastRoot(r,a,c,d,g,y,b);if(null==E)return null;const D=[],I=[],k=[],L=[],z=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;z.length>0;){const{idx:V,t:H,nodex:K,nodey:ie,depth:ue}=z.pop();if(this.leaves[V]){Hp(K,ie,ue,r,a,c,d,k,L);const ce=1<<ue,me=(K+0)/ce,pe=(K+1)/ce,Ae=(ie+0)/ce,Me=(ie+1)/ce,Ve=sl(me,Ae,this.dem)*b,et=sl(pe,Ae,this.dem)*b,Re=sl(pe,Me,this.dem)*b,We=sl(me,Me,this.dem)*b,Ze=Hv(k[0],k[1],Ve,L[0],k[1],et,L[0],L[1],Re,g,y),Qe=Hv(L[0],L[1],Re,k[0],L[1],We,k[0],k[1],Ve,g,y),rt=Math.min(null!==Ze?Ze:Number.MAX_VALUE,null!==Qe?Qe:Number.MAX_VALUE);if(rt!==Number.MAX_VALUE)return rt;{const Ne=Qc([],g,y,H);if(Wv(Ve,et,We,Re,Gv(Ne[0],k[0],L[0]),Gv(Ne[1],k[1],L[1]))>=Ne[2])return H}continue}let ne=0;for(let ce=0;ce<this._siblingOffset.length;ce++){Hp((K<<1)+this._siblingOffset[ce][0],(ie<<1)+this._siblingOffset[ce][1],ue+1,r,a,c,d,k,L),k[2]=-100,L[2]=this.maximums[this.childOffsets[V]+ce]*b;const me=$v(k,L,g,y);if(null!=me){const pe=me;D[ce]=pe;let Ae=!1;for(let Me=0;Me<ne&&!Ae;Me++)pe>=D[I[Me]]&&(I.splice(Me,0,ce),Ae=!0);Ae||(I[ne]=ce),ne++}}for(let ce=0;ce<ne;ce++){const me=I[ce];z.push({idx:this.childOffsets[V]+me,t:D[me],nodex:(K<<1)+this._siblingOffset[me][0],nodey:(ie<<1)+this._siblingOffset[me][1],depth:ue+1})}}return null}_addNode(r,a,c){return this.minimums.push(r),this.maximums.push(a),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(r,a,c,d,g){if(1===r[d].isLeaf(a,c))return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const y=d-1,b=r[y];let E=0,D=0;for(let I=0;I<this._siblingOffset.length;I++){const k=2*a+this._siblingOffset[I][0],L=2*c+this._siblingOffset[I][1],z=b.getElevation(k,L),V=b.isLeaf(k,L),H=this._addNode(z.min,z.max,V);V&&(E|=1<<I),D||(D=H)}for(let I=0;I<this._siblingOffset.length;I++)E&1<<I||this._construct(r,2*a+this._siblingOffset[I][0],2*c+this._siblingOffset[I][1],y,D+I)}}function Wv(o,r,a,c,d,g){return En(En(o,a,g),En(r,c,g),d)}function sl(o,r,a){const c=a.dim,d=zt(o*c-.5,0,c-1),g=zt(r*c-.5,0,c-1),y=Math.floor(d),b=Math.floor(g),E=Math.min(y+1,c-1),D=Math.min(b+1,c-1);return Wv(a.get(y,b),a.get(E,b),a.get(y,D),a.get(E,D),d-y,g-b)}const wf={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Gp(o,r,a){return(256*o*256+256*r+a)/10-1e4}function BC(o,r,a){return 256*o+r+a/256-32768}class _d{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,a,c,d=!1,g=!1){if(this.uid=r,a.height!==a.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return Tn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=a.height;const y=this.dim=a.height-2,b=new Uint32Array(a.data.buffer);if(this.pixels=new Uint8Array(a.data.buffer),this.encoding=c||"mapbox",this.borderReady=d,!d){for(let E=0;E<y;E++)b[this._idx(-1,E)]=b[this._idx(0,E)],b[this._idx(y,E)]=b[this._idx(y-1,E)],b[this._idx(E,-1)]=b[this._idx(E,0)],b[this._idx(E,y)]=b[this._idx(E,y-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(y,-1)]=b[this._idx(y-1,0)],b[this._idx(-1,y)]=b[this._idx(0,y-1)],b[this._idx(y,y)]=b[this._idx(y-1,y-1)],g&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new qv(this)}get(r,a,c=!1){c&&(r=zt(r,-1,this.dim),a=zt(a,-1,this.dim));const d=4*this._idx(r,a);return("terrarium"===this.encoding?BC:Gp)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(r){return wf[r]}get unpackVector(){return wf[this.encoding]}_idx(r,a){if(r<-1||r>=this.dim+1||a<-1||a>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(a+1)*this.stride+(r+1)}static pack(r,a){const c=[0,0,0,0],d=_d.getUnpackVector(a);let g=Math.floor((r+d[3])/d[2]);return c[2]=g%256,g=Math.floor(g/256),c[1]=g%256,g=Math.floor(g/256),c[0]=g,c}getPixels(){return new Oo({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,a,c){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let d=a*this.dim,g=a*this.dim+this.dim,y=c*this.dim,b=c*this.dim+this.dim;switch(a){case-1:d=g-1;break;case 1:g=d+1}switch(c){case-1:y=b-1;break;case 1:b=y+1}const E=-a*this.dim,D=-c*this.dim;for(let I=y;I<b;I++)for(let k=d;k<g;k++){const L=4*this._idx(k,I),z=4*this._idx(k+E,I+D);this.pixels[L+0]=r.pixels[z+0],this.pixels[L+1]=r.pixels[z+1],this.pixels[L+2]=r.pixels[z+2],this.pixels[L+3]=r.pixels[z+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}De(_d,"DEMData"),De(qv,"DemMinMaxQuadTree",{omit:["dem"]});class zC{constructor(r,a){this.max=r,this.onRemove=a,this.reset()}reset(){for(const r in this.data)for(const a of this.data[r])a.timeout&&clearTimeout(a.timeout),this.onRemove(a.value);return this.data={},this.order=[],this}add(r,a,c){const d=r.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const g={value:a,timeout:void 0};if(void 0!==c&&(g.timeout=setTimeout(()=>{this.remove(r,g)},c)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const a=this.data[r].shift();return a.timeout&&clearTimeout(a.timeout),0===this.data[r].length&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),a.value}getByKey(r){const a=this.data[r];return a?a[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,a){if(!this.has(r))return this;const c=r.wrapped().key,d=void 0===a?0:this.data[c].indexOf(a),g=this.data[c][d];return this.data[c].splice(d,1),g.timeout&&clearTimeout(g.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this}filter(r){const a=[];for(const c in this.data)for(const d of this.data[c])r(d.value)||a.push(d);for(const c of a)this.remove(c.value.tileID,c)}}class lh{constructor(r,a,c){this.func=r,this.mask=a,this.range=c}}lh.ReadOnly=!1,lh.ReadWrite=!0,lh.disabled=new lh(519,lh.ReadOnly,[0,1]);class Wp{constructor(r,a,c,d,g,y){this.test=r,this.ref=a,this.mask=c,this.fail=d,this.depthFail=g,this.pass=y}}Wp.disabled=new Wp({func:519,mask:0},0,0,7680,7680,7680);class al{constructor(r,a,c){this.blendFunction=r,this.blendColor=a,this.mask=c}}al.Replace=[1,0],al.disabled=new al(al.Replace,kn.transparent,[!1,!1,!1,!1]),al.unblended=new al(al.Replace,kn.transparent,[!0,!0,!0,!0]),al.alphaBlended=new al([1,771],kn.transparent,[!0,!0,!0,!0]);class Cs{constructor(r,a,c){this.enable=r,this.mode=a,this.frontFace=c}}Cs.disabled=new Cs(!1,1029,2305),Cs.backCCW=new Cs(!0,1029,2305),Cs.backCW=new Cs(!0,1029,2304),Cs.frontCW=new Cs(!0,1028,2304),Cs.frontCCW=new Cs(!0,1028,2305);class $l extends oc{constructor(r,a,c){super(),this.id=r,this._onlySymbols=c,a.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),a.on("error",()=>{this._sourceErrored=!0}),this._source=a,this._tiles={},this._cache=new zC(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=a.minTileCacheSize,this._maxTileCacheSize=a.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new nw,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(r){this.map=r,this._minTileCacheSize=void 0===this._minTileCacheSize&&r?r._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&r?r._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const r in this._tiles){const a=this._tiles[r];if("loaded"!==a.state&&"errored"!==a.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(r,a){return r.isSymbolTile=this._onlySymbols,this._source.loadTile(r,a)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){if(this._source.abortTile)return this._source.abortTile(r,()=>{})}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const a in this._tiles){const c=this._tiles[a];c.upload(r),c.prepare(this.map.style.imageManager)}}getIds(){return vo(this._tiles).map(r=>r.tileID).sort(yd).map(r=>r.key)}getRenderableIds(r){const a=[];for(const c in this._tiles)this._isIdRenderable(+c,r)&&a.push(this._tiles[c]);return r?a.sort((c,d)=>{const g=c.tileID,y=d.tileID,b=new ct(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),E=new ct(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-y.overscaledZ||E.y-b.y||E.x-b.x}).map(c=>c.tileID.key):a.map(c=>c.tileID).sort(yd).map(c=>c.key)}hasRenderableParent(r){const a=this.findLoadedParent(r,0);return!!a&&this._isIdRenderable(a.tileID.key)}_isIdRenderable(r,a){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(a||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)"errored"!==this._tiles[r].state&&this._reloadTile(+r,"reloading")}}_reloadTile(r,a){const c=this._tiles[r];c&&("loading"!==c.state&&(c.state=a),this._loadTile(c,this._tileLoaded.bind(this,c,r,a)))}_tileLoaded(r,a,c,d){if(d)if(r.state="errored",404!==d.status)this._source.fire(new Ls(d,{tile:r}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const g=this.map.painter.terrain;this.update(this.transform,g.getScaledDemTileSize(),!0),g.resetTileLookupCache(this.id)}else this.update(this.transform);else r.timeAdded=ps.now(),"expired"===c&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(a,r),"raster-dem"===this._source.type&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),this._source.fire(new Ra("data",{dataType:"source",tile:r,coord:r.tileID,sourceCacheId:this.id}))}_backfillDEM(r){const a=this.getRenderableIds();for(let d=0;d<a.length;d++){const g=a[d];if(r.neighboringTiles&&r.neighboringTiles[g]){const y=this.getTileByID(g);c(r,y),c(y,r)}}function c(d,g){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let y=g.tileID.canonical.x-d.tileID.canonical.x;const b=g.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),D=g.tileID.key;0===y&&0===b||Math.abs(b)>1||(Math.abs(y)>1&&(1===Math.abs(y+E)?y+=E:1===Math.abs(y-E)&&(y-=E)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,y,b),d.neighboringTiles&&d.neighboringTiles[D]&&(d.neighboringTiles[D].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,a,c,d){for(const g in this._tiles){let y=this._tiles[g];if(d[g]||!y.hasData()||y.tileID.overscaledZ<=a||y.tileID.overscaledZ>c)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>a+1;){const D=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[D.key],y&&y.hasData()&&(b=D)}let E=b;for(;E.overscaledZ>a;)if(E=E.scaledTo(E.overscaledZ-1),r[E.key]){d[b.key]=b;break}}}findLoadedParent(r,a){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=a?c:null}for(let c=r.overscaledZ-1;c>=a;c--){const d=r.scaledTo(c),g=this._getLoadedTile(d);if(g)return g}}_getLoadedTile(r){const a=this._tiles[r.key];return a&&a.hasData()?a:this._cache.getByKey(this._source.reparseOverscaled?r.wrapped().key:r.canonical.key)}updateCacheSize(r,a){a=a||this._source.tileSize;const c=Math.ceil(r.width/a)+1,d=Math.ceil(r.height/a)+1,g=Math.floor(c*d*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,g):g,b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(r){const a=Math.round((r-(void 0===this._prevLng?r:this._prevLng))/360);if(this._prevLng=r,a){const c={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),c[g.tileID.key]=g}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(r,a,c){if(this.transform=r,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let d;this.updateCacheSize(r,a),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Pr(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(d=r.coveringTiles({tileSize:a||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(b=>this._source.hasTile(b)))):d=[];const g=this._updateRetainedTiles(d);if(Zv(this._source.type)&&0!==d.length){const b={},E={},D=Object.keys(g);for(const k of D){const L=g[k],z=this._tiles[k];if(!z||z.fadeEndTime&&z.fadeEndTime<=ps.now())continue;const V=this.findLoadedParent(L,Math.max(L.overscaledZ-$l.maxOverzooming,this._source.minzoom));V&&(this._addTile(V.tileID),b[V.tileID.key]=V.tileID),E[k]=L}const I=d[d.length-1].overscaledZ;for(const k in this._tiles){const L=this._tiles[k];if(g[k]||!L.hasData())continue;let z=L.tileID;for(;z.overscaledZ>I;){z=z.scaledTo(z.overscaledZ-1);const V=this._tiles[z.key];if(V&&V.hasData()&&E[z.key]){g[k]=L.tileID;break}}}for(const k in b)g[k]||(this._coveredTiles[k]=!0,g[k]=b[k])}for(const b in g)this._tiles[b].clearFadeHold();const y=function(b,E){const D=[];for(const I in b)I in E||D.push(I);return D}(this._tiles,g);for(const b of y){const E=this._tiles[b];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(+r)}_updateRetainedTiles(r){const a={};if(0===r.length)return a;const c={},d=r.reduce((D,I)=>Math.min(D,I.overscaledZ),1/0),g=r[0].overscaledZ,y=Math.max(g-$l.maxOverzooming,this._source.minzoom),b=Math.max(g+$l.maxUnderzooming,this._source.minzoom),E={};for(const D of r){const I=this._addTile(D);a[D.key]=D,I.hasData()||d<this._source.maxzoom&&(E[D.key]=D)}this._retainLoadedChildren(E,d,b,a);for(const D of r){let I=this._tiles[D.key];if(I.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const L=D.children(this._source.maxzoom)[0],z=this.getTile(L);if(z&&z.hasData()){a[L.key]=L;continue}}else{const L=D.children(this._source.maxzoom);if(a[L[0].key]&&a[L[1].key]&&a[L[2].key]&&a[L[3].key])continue}let k=I.wasRequested();for(let L=D.overscaledZ-1;L>=y;--L){const z=D.scaledTo(L);if(c[z.key]||(c[z.key]=!0,I=this.getTile(z),!I&&k&&(I=this._addTile(z)),I&&(a[z.key]=z,k=I.wasRequested(),I.hasData())))break}}return a}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const a=[];let c,d=this._tiles[r].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}a.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;d=g}for(const g of a)this._loadedParentTiles[g]=c}}_addTile(r){let a=this._tiles[r.key];if(a)return a;a=this._cache.getAndRemove(r),a&&(this._setTileReloadTimer(r.key,a),a.tileID=r,this._state.initializeTileState(a,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,a)));const c=Boolean(a);if(!c){const d=this.map?this.map.painter:null;a=new m_(r,this._source.tileSize*r.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(a,this._tileLoaded.bind(this,a,r.key,a.state))}return a?(a.uses++,this._tiles[r.key]=a,c||this._source.fire(new Ra("dataloading",{tile:a,coord:a.tileID,dataType:"source"})),a):null}_setTileReloadTimer(r,a){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=a.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const a=this._tiles[r];a&&(a.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),a.uses>0||(a.hasData()&&"reloading"!==a.state?this._cache.add(a.tileID,a,a.getExpiryTimeout()):(a.aborted=!0,this._abortTile(a),this._unloadTile(a))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(+r);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(r,a,c){const d=[],g=this.transform;if(!g)return d;const y="globe"===g.projection.name,b=el(g.center.lng);for(const E in this._tiles){const D=this._tiles[E];if(c&&D.clearQueryDebugViz(),D.holdingForFade())continue;let I;if(y){const k=D.tileID.canonical;if(0===k.z){const L=[Math.abs(zt(b,...vd(k,-1))-b),Math.abs(zt(b,...vd(k,1))-b)];I=[0,2*L.indexOf(Math.min(...L))-1]}else{const L=[Math.abs(zt(b,...vd(k,-1))-b),Math.abs(zt(b,...vd(k,0))-b),Math.abs(zt(b,...vd(k,1))-b)];I=[L.indexOf(Math.min(...L))-1]}}else I=[0];for(const k of I){const L=r.containsTile(D,g,a,k);L&&d.push(L)}}return d}getVisibleCoordinates(r){const a=this.getRenderableIds(r).map(c=>this._tiles[c].tileID);for(const c of a)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return a}hasTransition(){if(this._source.hasTransition())return!0;if(Zv(this._source.type))for(const r in this._tiles){const a=this._tiles[r];if(void 0!==a.fadeEndTime&&a.fadeEndTime>=ps.now())return!0}return!1}setFeatureState(r,a,c){this._state.updateState(r=r||"_geojsonTileLayer",a,c)}removeFeatureState(r,a,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",a,c)}getFeatureState(r,a){return this._state.getState(r=r||"_geojsonTileLayer",a)}setDependencies(r,a,c){const d=this._tiles[r];d&&d.setDependencies(a,c)}reloadTilesForDependencies(r,a){for(const c in this._tiles)this._tiles[c].hasDependency(r,a)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(r,a))}_preloadTiles(r,a){if(!this._sourceLoaded){const b=()=>{this._sourceLoaded&&(this._source.off("data",b),this._preloadTiles(r,a))};return void this._source.on("data",b)}const c=new Map,d=Array.isArray(r)?r:[r],g=this.map.painter.terrain,y=this.usedForTerrain&&g?g.getScaledDemTileSize():this._source.tileSize;for(const b of d){const E=b.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of E)c.set(D.key,D);this.usedForTerrain&&b.updateElevation(!1)}nr(Array.from(c.values()),(b,E)=>{const D=new m_(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,I=>{"raster-dem"===this._source.type&&D.dem&&this._backfillDEM(D),E(I,D)})},a)}}function yd(o,r){const a=Math.abs(2*o.wrap)-+(o.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return o.overscaledZ-r.overscaledZ||c-a||r.canonical.y-o.canonical.y||r.canonical.x-o.canonical.x}function Zv(o){return"raster"===o||"image"===o||"video"===o||"custom"===o}function vd(o,r){const a=1<<o.z;return[o.x/a+r,(o.x+1)/a+r]}$l.maxOverzooming=10,$l.maxUnderzooming=3;class Cf{constructor(r,a,c){this._demTile=r,this._dem=this._demTile.dem,this._scale=a,this._offset=c}static create(r,a,c){const d=c||r.findDEMTileFor(a);if(!d||!d.dem)return;const g=d.dem,y=d.tileID,b=1<<a.canonical.z-y.canonical.z;return new Cf(d,d.tileSize/Pt/b,[(a.canonical.x/b-y.canonical.x)*g.dim,(a.canonical.y/b-y.canonical.y)*g.dim])}tileCoordToPixel(r,a){const c=a*this._scale+this._offset[1],d=Math.floor(r*this._scale+this._offset[0]),g=Math.floor(c);return new ct(d,g)}getElevationAt(r,a,c,d){const g=r*this._scale+this._offset[0],y=a*this._scale+this._offset[1],b=Math.floor(g),E=Math.floor(y),D=this._dem;return d=!!d,c?En(En(D.get(b,E,d),D.get(b,E+1,d),y-E),En(D.get(b+1,E,d),D.get(b+1,E+1,d),y-E),g-b):D.get(b,E,d)}getElevationAtPixel(r,a,c){return this._dem.get(r,a,!!c)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*va(1,r)*this._dem.stride}}class Xv{constructor(r,a){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new dc(Pt,16,0),this.featureIndexArray=new pc,this.promoteId=a}insert(r,a,c,d,g,y=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,g,y);const E=this.grid;for(let D=0;D<a.length;D++){const I=a[D],k=[1/0,1/0,-1/0,-1/0];for(let L=0;L<I.length;L++){const z=I[L];k[0]=Math.min(k[0],z.x),k[1]=Math.min(k[1],z.y),k[2]=Math.max(k[2],z.x),k[3]=Math.max(k[3],z.y)}k[0]<Pt&&k[1]<Pt&&k[2]>=0&&k[3]>=0&&E.insert(b,k[0],k[1],k[2],k[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Dp(new Rp(this.rawTileData)).layers,this.sourceLayerCoder=new zv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,a,c,d){this.loadVTLayers();const g=r.params||{},y=$d(g.filter),b=r.tileResult,E=r.transform,D=b.bufferedTilespaceBounds,I=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(V,H,K,ie)=>sg(b.bufferedTilespaceGeometry,V,H,K,ie));I.sort(Df);let k=null;E.elevation&&I.length>0&&(k=Cf.create(E.elevation,this.tileID));const L={};let z;for(let V=0;V<I.length;V++){const H=I[V];if(H===z)continue;z=H;const K=this.featureIndexArray.get(H);let ie=null;this.loadMatchingFeature(L,K,y,g.layers,g.availableImages,a,c,d,(ue,ne,ce,me=0)=>(ie||(ie=tl(ue,this.tileID.canonical,r.tileTransform)),ne.queryIntersectsFeature(b,ue,ce,ie,this.z,r.transform,r.pixelPosMatrix,k,me)))}return L}loadMatchingFeature(r,a,c,d,g,y,b,E,D){const{featureIndex:I,bucketIndex:k,sourceLayerIndex:L,layoutVertexArrayOffset:z}=a,V=this.bucketLayerIDs[k];if(d&&!function(ue,ne){for(let ce=0;ce<ue.length;ce++)if(ne.indexOf(ue[ce])>=0)return!0;return!1}(d,V))return;const H=this.sourceLayerCoder.decode(L),K=this.vtLayers[H].feature(I);if(c.needGeometry){const ue=eu(K,!0);if(!c.filter(new P(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!c.filter(new P(this.tileID.overscaledZ),K))return;const ie=this.getId(K,H);for(let ue=0;ue<V.length;ue++){const ne=V[ue];if(d&&d.indexOf(ne)<0)continue;const ce=y[ne];if(!ce)continue;let me={};void 0!==ie&&E&&(me=E.getState(ce.sourceLayer||"_geojsonTileLayer",ie));const pe=Ei({},b[ne]);pe.paint=Kv(pe.paint,ce.paint,K,me,g),pe.layout=Kv(pe.layout,ce.layout,K,me,g);const Ae=!D||D(K,ce,me,z);if(!Ae)continue;const Me=new Uv(K,this.z,this.x,this.y,ie);Me.layer=pe;let Ve=r[ne];void 0===Ve&&(Ve=r[ne]=[]),Ve.push({featureIndex:I,feature:Me,intersectionZ:Ae})}}lookupSymbolFeatures(r,a,c,d,g,y,b,E){const D={};this.loadVTLayers();const I=$d(g);for(const k of r)this.loadMatchingFeature(D,{bucketIndex:c,sourceLayerIndex:d,featureIndex:k,layoutVertexArrayOffset:0},I,y,b,E,a);return D}loadFeature(r){const{featureIndex:a,sourceLayerIndex:c}=r;this.loadVTLayers();const d=this.sourceLayerCoder.decode(c),g=this.vtFeatures[d];if(g[a])return g[a];const y=this.vtLayers[d].feature(a);return g[a]=y,y}hasLayer(r){for(const a of this.bucketLayerIDs)for(const c of a)if(r===c)return!0;return!1}getId(r,a){let c=r.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[a];null!=d&&(c=r.properties[d]),"boolean"==typeof c&&(c=Number(c))}return c}}function Kv(o,r,a,c,d){return gt(o,(g,y)=>{const b=r instanceof re?r.get(y):null;return b&&b.evaluate?b.evaluate(a,c,d):b})}function Df(o,r){return r-o}De(Xv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Yv{constructor(r,a){this.width=r,this.height=a,this.nextRow=0,this.image=new Vl({width:r,height:a}),this.positions={},this.uploaded=!1}getDash(r,a){const c=this.getKey(r,a);return this.positions[c]}trim(){const r=this.width,a=this.height=fs(this.nextRow);this.image.resize({width:r,height:a})}getKey(r,a){return r.join(",")+a}getDashRanges(r,a,c){const d=[];let g=r.length%2==1?-r[r.length-1]*c:0,y=r[0]*c,b=!0;d.push({left:g,right:y,isDash:b,zeroLength:0===r[0]});let E=r[0];for(let D=1;D<r.length;D++){b=!b;const I=r[D];g=E*c,E+=I,y=E*c,d.push({left:g,right:y,isDash:b,zeroLength:0===I})}return d}addRoundDash(r,a,c){const d=a/2;for(let g=-c;g<=c;g++){const y=this.width*(this.nextRow+c+g);let b=0,E=r[b];for(let D=0;D<this.width;D++){D/E.right>1&&(E=r[++b]);const I=Math.abs(D-E.left),k=Math.abs(D-E.right),L=Math.min(I,k);let z;const V=g/c*(d+1);if(E.isDash){const H=d-Math.abs(V);z=Math.sqrt(L*L+H*H)}else z=d-Math.sqrt(L*L+V*V);this.image.data[y+D]=Math.max(0,Math.min(255,z+128))}}}addRegularDash(r,a){for(let E=r.length-1;E>=0;--E){const D=r[E],I=r[E+1];D.zeroLength?r.splice(E,1):I&&I.isDash===D.isDash&&(I.left=D.left,r.splice(E,1))}const c=r[0],d=r[r.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);const g=this.width*this.nextRow;let y=0,b=r[y];for(let E=0;E<this.width;E++){E/b.right>1&&(b=r[++y]);const D=Math.abs(E-b.left),I=Math.abs(E-b.right),k=Math.min(D,I);this.image.data[g+E]=Math.max(0,Math.min(255,(b.isDash?k:-k)+a+128))}}addDash(r,a){const c=this.getKey(r,a);if(this.positions[c])return this.positions[c];const d="round"===a,g=d?7:0,y=2*g+1;if(this.nextRow+y>this.height)return Tn("LineAtlas out of space"),null;0===r.length&&r.push(1);let b=0;for(let I=0;I<r.length;I++)r[I]<0&&(Tn("Negative value is found in line dasharray, replacing values with 0"),r[I]=0),b+=r[I];if(0!==b){const I=this.width/b,k=this.getDashRanges(r,this.width,I);d?this.addRoundDash(k,I,g):this.addRegularDash(k,"square"===a?.5*I:0)}const E=this.nextRow+g;this.nextRow+=y;const D={tl:[E,g],br:[b,0]};return this.positions[c]=D,D}}De(Yv,"LineAtlas");const iw=1*wa;class Jv{constructor(r){const a={},c=[];for(const b in r){const E=r[b],D=a[b]={};for(const I in E.glyphs){const k=E.glyphs[+I];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const L=k.metrics.localGlyph?iw:1,z={x:0,y:0,w:k.bitmap.width+2*L,h:k.bitmap.height+2*L};c.push(z),D[I]=z}}const{w:d,h:g}=Wg(c),y=new Vl({width:d||1,height:g||1});for(const b in r){const E=r[b];for(const D in E.glyphs){const I=E.glyphs[+D];if(!I||0===I.bitmap.width||0===I.bitmap.height)continue;const k=a[b][D],L=I.metrics.localGlyph?iw:1;Vl.copy(I.bitmap,y,{x:0,y:0},{x:k.x+L,y:k.y+L},I.bitmap)}}this.image=y,this.positions=a}}De(Jv,"GlyphAtlas");class rw{constructor(r){this.tileID=new Pr(r.tileID.overscaledZ,r.tileID.wrap,r.tileID.canonical.z,r.tileID.canonical.x,r.tileID.canonical.y),this.tileZoom=r.tileZoom,this.uid=r.uid,this.zoom=r.zoom,this.canonical=r.tileID.canonical,this.pixelRatio=r.pixelRatio,this.tileSize=r.tileSize,this.source=r.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=r.showCollisionBoxes,this.collectResourceTiming=!!r.collectResourceTiming,this.returnDependencies=!!r.returnDependencies,this.promoteId=r.promoteId,this.enableTerrain=!!r.enableTerrain,this.isSymbolTile=r.isSymbolTile,this.tileTransform=rh(r.tileID.canonical,r.projection),this.projection=r.projection}parse(r,a,c,d,g){this.status="parsing",this.data=r,this.collisionBoxArray=new Yn;const y=new zv(Object.keys(r.layers).sort()),b=new Xv(this.tileID,this.promoteId);b.bucketLayerIDs=[];const E={},D=new Yv(256,256),I={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:c},k=a.familiesBySource[this.source];for(const me in k){const pe=r.layers[me];if(!pe)continue;let Ae=!1,Me=!1;for(const Re of k[me])"symbol"===Re[0].type?Ae=!0:Me=!0;if(!0===this.isSymbolTile&&!Ae||!1===this.isSymbolTile&&!Me)continue;1===pe.version&&Tn(`Vector tile source "${this.source}" layer "${me}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ve=y.encode(me),et=[];for(let Re=0;Re<pe.length;Re++){const We=pe.feature(Re),Ze=b.getId(We,me);et.push({feature:We,id:Ze,index:Re,sourceLayerIndex:Ve})}for(const Re of k[me]){const We=Re[0];void 0!==this.isSymbolTile&&"symbol"===We.type!==this.isSymbolTile||We.minzoom&&this.zoom<Math.floor(We.minzoom)||We.maxzoom&&this.zoom>=We.maxzoom||"none"!==We.visibility&&(__(Re,this.zoom,c),(E[We.id]=We.createBucket({index:b.bucketLayerIDs.length,layers:Re,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ve,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(et,I,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(Re.map(Ze=>Ze.id)))}}let L,z,V,H;D.trim();const K={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ie=()=>{if(L)return g(L);if(z&&V&&H){const me=new Jv(z),pe=new _v(V,H);for(const Ae in E){const Me=E[Ae];Me instanceof Tc?(__(Me.layers,this.zoom,c),Wb(Me,z,me.positions,V,pe.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Me.hasPattern&&(Me instanceof Ap||Me instanceof Tg||Me instanceof Yu)&&(__(Me.layers,this.zoom,c),Me.addFeatures(I,this.tileID.canonical,pe.patternPositions,c,this.tileTransform))}this.status="done",g(null,{buckets:vo(E).filter(Ae=>!Ae.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:me.image,lineAtlas:D,imageAtlas:pe,glyphMap:this.returnDependencies?z:null,iconMap:this.returnDependencies?V:null,glyphPositions:this.returnDependencies?me.positions:null})}},ue=gt(I.glyphDependencies,me=>Object.keys(me).map(Number));Object.keys(ue).length?d.send("getGlyphs",{uid:this.uid,stacks:ue},(me,pe)=>{L||(L=me,z=pe,ie())},void 0,!1,K):z={};const ne=Object.keys(I.iconDependencies);ne.length?d.send("getImages",{icons:ne,source:this.source,tileID:this.tileID,type:"icons"},(me,pe)=>{L||(L=me,V=pe,ie())},void 0,!1,K):V={};const ce=Object.keys(I.patternDependencies);ce.length?d.send("getImages",{icons:ce,source:this.source,tileID:this.tileID,type:"patterns"},(me,pe)=>{L||(L=me,H=pe,ie())},void 0,!1,K):H={},ie()}}function __(o,r,a){const c=new P(r);for(const d of o)d.recalculate(c,a)}class Qv{constructor(r){this.entries={},this.scheduler=r}request(r,a,c,d){const g=this.entries[r]=this.entries[r]||{callbacks:[]};if(g.result){const[y,b]=g.result;return this.scheduler?this.scheduler.add(()=>{d(y,b)},a):d(y,b),()=>{}}return g.callbacks.push(d),g.cancel||(g.cancel=c((y,b)=>{g.result=[y,b];for(const E of g.callbacks)this.scheduler?this.scheduler.add(()=>{E(y,b)},a):E(y,b);setTimeout(()=>delete this.entries[r],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(y=>y!==d),g.callbacks.length||(g.cancel(),delete this.entries[r]))}}}function e0(o,r,a){const c=JSON.stringify(o.request);return o.data&&(this.deduped.entries[c]={result:[null,o.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},d=>{const g=vl(o.request,(y,b,E,D)=>{y?d(y):b&&d(null,{vectorTile:a?void 0:new Dp(new Rp(b)),rawData:b,cacheControl:E,expires:D})});return()=>{g.cancel(),d()}},r)}const t0=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class y_{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[a,c]=new Uint8Array(r,0,2);if(219!==a)throw new Error("Data does not appear to be in a KDBush format.");const d=c>>4;if(1!==d)throw new Error(`Got v${d} data when expected v1.`);const g=t0[15&c];if(!g)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new y_(b,y,g,r)}constructor(r,a=64,c=Float64Array,d){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+a,2),65535),this.ArrayType=c,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const g=t0.indexOf(this.ArrayType),y=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${c}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+E,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+y+b+E),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+E,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=a,new Uint32Array(this.data,4,1)[0]=r)}add(r,a){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=r,this.coords[this._pos++]=a,c}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return Zp(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,a,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:y,nodeSize:b}=this,E=[0,g.length-1,0],D=[];for(;E.length;){const I=E.pop()||0,k=E.pop()||0,L=E.pop()||0;if(k-L<=b){for(let K=L;K<=k;K++){const ie=y[2*K],ue=y[2*K+1];ie>=r&&ie<=c&&ue>=a&&ue<=d&&D.push(g[K])}continue}const z=L+k>>1,V=y[2*z],H=y[2*z+1];V>=r&&V<=c&&H>=a&&H<=d&&D.push(g[z]),(0===I?r<=V:a<=H)&&(E.push(L),E.push(z-1),E.push(1-I)),(0===I?c>=V:d>=H)&&(E.push(z+1),E.push(k),E.push(1-I))}return D}within(r,a,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:g,nodeSize:y}=this,b=[0,d.length-1,0],E=[],D=c*c;for(;b.length;){const I=b.pop()||0,k=b.pop()||0,L=b.pop()||0;if(k-L<=y){for(let K=L;K<=k;K++)n0(g[2*K],g[2*K+1],r,a)<=D&&E.push(d[K]);continue}const z=L+k>>1,V=g[2*z],H=g[2*z+1];n0(V,H,r,a)<=D&&E.push(d[z]),(0===I?r-c<=V:a-c<=H)&&(b.push(L),b.push(z-1),b.push(1-I)),(0===I?r+c>=V:a+c>=H)&&(b.push(z+1),b.push(k),b.push(1-I))}return E}}function Zp(o,r,a,c,d,g){if(d-c<=a)return;const y=c+d>>1;Xn(o,r,y,c,d,g),Zp(o,r,a,c,y-1,1-g),Zp(o,r,a,y+1,d,1-g)}function Xn(o,r,a,c,d,g){for(;d>c;){if(d-c>600){const D=d-c+1,I=a-c+1,k=Math.log(D),L=.5*Math.exp(2*k/3),z=.5*Math.sqrt(k*L*(D-L)/D)*(I-D/2<0?-1:1);Xn(o,r,a,Math.max(c,Math.floor(a-I*L/D+z)),Math.min(d,Math.floor(a+(D-I)*L/D+z)),g)}const y=r[2*a+g];let b=c,E=d;for(Tf(o,r,c,a),r[2*d+g]>y&&Tf(o,r,c,d);b<E;){for(Tf(o,r,b,E),b++,E--;r[2*b+g]<y;)b++;for(;r[2*E+g]>y;)E--}r[2*c+g]===y?Tf(o,r,c,E):(E++,Tf(o,r,E,d)),E<=a&&(c=E+1),a<=E&&(d=E-1)}}function Tf(o,r,a,c){Sf(o,a,c),Sf(r,2*a,2*c),Sf(r,2*a+1,2*c+1)}function Sf(o,r,a){const c=o[r];o[r]=o[a],o[a]=c}function n0(o,r,a,c){const d=o-a,g=r-c;return d*d+g*g}f.ARRAY_TYPE=uo,f.AUTH_ERR_MSG=ge,f.Aabb=Ro,f.Actor=class{constructor(o,r,a){this.target=o,this.parent=r,this.mapId=a,this.callbacks={},this.cancelCallbacks={},Ln(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Rs()?o:Ke,this.scheduler=new tw}send(o,r,a,c,d=!1,g){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);a&&(a.metadata=g,this.callbacks[y]=a);const b=zo(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:o,hasCallback:!!a,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:Xc(r,b)},b),{cancel:()=>{a&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(o){const r=o.data,a=r.id;if(a&&(!r.targetMapId||this.mapId===r.targetMapId))if("<cancel>"===r.type){const c=this.cancelCallbacks[a];delete this.cancelCallbacks[a],c&&c.cancel()}else if(r.mustQueue||Rs()){const c=this.callbacks[a];this.cancelCallbacks[a]=this.scheduler.add(()=>this.processTask(a,r),c&&c.metadata||{type:"message"})}else this.processTask(a,r)}processTask(o,r){if("<response>"===r.type){const a=this.callbacks[o];delete this.callbacks[o],a&&(r.error?a(Gi(r.error)):a(null,Gi(r.data)))}else{const a=zo(this.globalScope)?void 0:[],c=r.hasCallback?(g,y)=>{delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:g?Xc(g):null,data:Xc(y,a)},a)}:g=>{},d=Gi(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,d,c);else if(this.parent.getWorkerSource){const g=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,g[0],d.source)[g[1]](d,c)}else c(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},f.CanonicalTileID=kg,f.Color=kn,f.ColorMode=al,f.CullFaceMode=Cs,f.DEMData=_d,f.DataConstantProperty=$,f.DedupedRequest=Qv,f.DepthMode=lh,f.EXTENT=Pt,f.Elevation=class{isDataAvailableAtPoint(o){const r=this._source();if(this.isUsingMockSource()||!r||o.y<0||o.y>1)return!1;const a=r.getSource().maxzoom,c=1<<a,d=Math.floor(o.x),g=Math.floor((o.x-d)*c),y=Math.floor(o.y*c),b=this.findDEMTileFor(new Pr(a,d,a,g,y));return!(!b||!b.dem)}getAtPointOrZero(o,r=0){return this.getAtPoint(o,r)||0}getAtPoint(o,r,a=!0){if(this.isUsingMockSource())return null;null==r&&(r=null);const c=this._source();if(!c||o.y<0||o.y>1)return r;const d=c.getSource().maxzoom,g=1<<d,y=Math.floor(o.x),b=o.x-y,E=new Pr(d,y,d,Math.floor(b*g),Math.floor(o.y*g)),D=this.findDEMTileFor(E);if(!D||!D.dem)return r;const I=D.dem,k=1<<D.tileID.canonical.z,L=(b*k-D.tileID.canonical.x)*I.dim,z=(o.y*k-D.tileID.canonical.y)*I.dim,V=Math.floor(L),H=Math.floor(z);return(a?this.exaggeration():1)*En(En(I.get(V,H),I.get(V,H+1),z-H),En(I.get(V+1,H),I.get(V+1,H+1),z-H),L-V)}getAtTileOffset(o,r,a){const c=1<<o.canonical.z;return this.getAtPointOrZero(new Qh(o.wrap+(o.canonical.x+r/Pt)/c,(o.canonical.y+a/Pt)/c))}getAtTileOffsetFunc(o,r,a,c){return d=>{const g=this.getAtTileOffset(o,d.x,d.y),y=c.upVector(o.canonical,d.x,d.y);return ls(y,y,g*c.upVectorScale(o.canonical,r,a).metersToTile),y}}getForTilePoints(o,r,a,c){if(this.isUsingMockSource())return!1;const d=Cf.create(this,o,c);return!!d&&(r.forEach(g=>{g[2]=this.exaggeration()*d.getElevationAt(g[0],g[1],a)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(o);if(!r||!r.dem)return null;const a=r.dem.tree,c=r.tileID,d=1<<o.canonical.z-c.canonical.z;let g=o.canonical.x/d-c.canonical.x,y=o.canonical.y/d-c.canonical.y,b=0;for(let E=0;E<o.canonical.z-c.canonical.z&&!a.leaves[b];E++){g*=2,y*=2;const D=2*Math.floor(y)+Math.floor(g);b=a.childOffsets[b]+D,g%=1,y%=1}return{min:this.exaggeration()*a.minimums[b],max:this.exaggeration()*a.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,r,a){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},f.ErrorEvent=Ls,f.EvaluationParameters=P,f.Event=Ra,f.Evented=oc,f.FillExtrusionBucket=Yu,f.Frustum=$m,f.FrustumCorners=up,f.GLOBE_RADIUS=_c,f.GLOBE_SCALE_MATCH_LATITUDE=45,f.GLOBE_ZOOM_THRESHOLD_MAX=Hm,f.GLOBE_ZOOM_THRESHOLD_MIN=By,f.GlobeSharedBuffers=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const o of this._poleSegments)o.destroy();for(const o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const o of this._wireframeSegments)o.destroy()}}_fillGridMeshWithLods(o,r){const a=new tt,c=new Ct,d=[],g=o+1+2,y=r[0]+1,b=r[0]+1+(1+r.length),E=(D,I,k)=>{let L=D===g-1?D-2:0===D?D:D-1;return L+=k?24575:0,[L,I]};for(let D=0;D<g;++D)a.emplaceBack(...E(D,0,!0));for(let D=0;D<y;++D)for(let I=0;I<g;++I)a.emplaceBack(...E(I,D,(0===I||I===g-1)&&!0));for(let D=0;D<r.length;++D){const I=r[D];for(let k=0;k<g;++k)a.emplaceBack(...E(k,I,!0))}for(let D=0;D<r.length;++D){const I=c.length,k=r[D]+1+2,L=new Ct;for(let H=0;H<k-1;H++){const K=H===k-2,ie=K?g*(b-r.length+D-H):g;for(let ue=0;ue<g-1;ue++){const ne=H*g+ue;0===H||K||0===ue||ue===g-2?(L.emplaceBack(ne+1,ne,ne+ie),L.emplaceBack(ne+ie,ne+ie+1,ne+1)):(c.emplaceBack(ne+1,ne,ne+ie),c.emplaceBack(ne+ie,ne+ie+1,ne+1))}}const z=pr.simpleSegment(0,I,a.length,c.length-I);for(let H=0;H<L.uint16.length;H+=3)c.emplaceBack(L.uint16[H],L.uint16[H+1],L.uint16[H+2]);const V=pr.simpleSegment(0,I,a.length,c.length-I);d.push({withoutSkirts:z,withSkirts:V})}return{vertices:a,indices:c,segments:d}}_createGrid(o){const r=this._fillGridMeshWithLods(64,Hu);this._gridSegments=r.segments,this._gridBuffer=o.createVertexBuffer(r.vertices,Qd.members),this._gridIndexBuffer=o.createIndexBuffer(r.indices,!0)}_createPoles(o){const r=new Ct;for(let d=0;d<=64;d++)r.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=o.createIndexBuffer(r,!0);const a=new ri,c=new ri;this._poleSegments=[];for(let d=0,g=0;d<By;d++){const y=360/(1<<d);a.emplaceBack(0,-_c,0,.5,0),c.emplaceBack(0,-_c,0,.5,1);for(let b=0;b<=64;b++){const E=b/64,D=En(0,y,E),[I,k,L]=Wr(Es,Jm,D,_c);a.emplaceBack(I,k,L,E,0),c.emplaceBack(I,k,L,E,1)}this._poleSegments.push(pr.simpleSegment(g,0,66,64)),g+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(a,Ly,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(c,Ly,!1)}getGridBuffers(o,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}getWirefameBuffers(o,r){if(!this._wireframeSegments){const a=new rr,c=64,d=c+1+2,g=1;this._wireframeSegments=[];for(let y=0,b=0;y<Hu.length;y++){const E=Hu[y];for(let I=g;I<E+g;I++)for(let k=g;k<c+g;k++){const L=I*d+k;a.emplaceBack(L,L+1),a.emplaceBack(L,L+d),a.emplaceBack(L,L+d+1)}const D=E*c*3;this._wireframeSegments.push(pr.simpleSegment(0,b,(E+1)*d,D)),b+=D}this._wireframeIndexBuffer=o.createIndexBuffer(a)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[r]]}},f.GlyphManager=ih,f.ImagePosition=il,f.KDBush=y_,f.LivePerformanceUtils=ir,f.LngLat=Zn,f.LngLatBounds=Bi,f.LocalGlyphMode=Qg,f.MAX_MERCATOR_LATITUDE=Xr,f.MercatorCoordinate=Qh,f.ONE_EM=kr,f.OverscaledTileID=Pr,f.PerformanceMarkers=pi,f.Point=ct,f.Properties=oe,f.RGBAImage=Oo,f.Ray=Xh,f.RequestManager=class{constructor(o,r,a){this._transformRequestFn=o,this._customAccessToken=r,this._silenceAuthErrors=!!a,this._createSkuToken()}_createSkuToken(){const o=function(){let r="";for(let a=0;a<10;a++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_l,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,r){return this._transformRequestFn&&this._transformRequestFn(o,r)||{url:o}}normalizeStyleURL(o,r){if(!xe(o))return o;const a=ut(o);return a.path=`/styles/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeGlyphsURL(o,r){if(!xe(o))return o;const a=ut(o);return a.path=`/fonts/v1${a.path}`,this._makeAPIURL(a,this._customAccessToken||r)}normalizeSourceURL(o,r,a,c){if(!xe(o))return o;const d=ut(o);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),a&&d.params.push(`language=${a}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||r)}normalizeSpriteURL(o,r,a,c){const d=ut(o);return xe(o)?(d.path=`/styles/v1${d.path}/sprite${r}${a}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${r}${a}`,ot(d))}normalizeTileURL(o,r,a){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!xe(o))return o;const c=ut(o);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||a&&"raster"!==c.authority&&512===a?"@2x":""}${Wt.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${$t.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${$t.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(g){for(const y of g){const b=y.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(c.params)||$t.ACCESS_TOKEN;return $t.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(o,r){const a=ut(o);if(!a.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!a.path.match(/\.[\w]+$/))return o;let c="mapbox://";a.path.match(/^\/raster\/v1\//)?c+=`raster/${a.path.replace(`/${$t.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${a.path.replace(`/${$t.TILE_URL_VERSION}/`,"")}`;let d=a.params;return r&&(d=d.filter(g=>!g.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(o,r){const a=!!r&&xe(r),c=[];for(const d of o.tiles||[])Te(d)?c.push(this.canonicalizeTileURL(d,a)):c.push(d);return c}_makeAPIURL(o,r){const a="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=ut($t.API_URL);if(o.protocol=c.protocol,o.authority=c.authority,"http"===o.protocol){const d=o.params.indexOf("secure");d>=0&&o.params.splice(d,1)}if("/"!==c.path&&(o.path=`${c.path}${o.path}`),!$t.REQUIRE_ACCESS_TOKEN)return ot(o);if(r=r||$t.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${a}`);if("s"===r[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${a}`)}return o.params=o.params.filter(d=>-1===d.indexOf("access_token")),o.params.push(`access_token=${r||""}`),ot(o)}},f.ResourceType=Fs,f.SegmentVector=pr,f.SourceCache=$l,f.StencilMode=Wp,f.StructArrayLayout1ui2=xs,f.StructArrayLayout2f1f2i16=kt,f.StructArrayLayout2i4=tt,f.StructArrayLayout2ui4=rr,f.StructArrayLayout3f12=gn,f.StructArrayLayout3ui6=Ct,f.StructArrayLayout4i8=qe,f.StructArrayLayout5f20=ri,f.Texture=gd,f.Tile=m_,f.Transitionable=j,f.Uniform1f=ip,f.Uniform1i=class extends bs{constructor(o){super(o),this.current=0}set(o,r,a){this.fetchUniformLocation(o,r)&&this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},f.Uniform2f=class extends bs{constructor(o){super(o),this.current=[0,0]}set(o,r,a){this.fetchUniformLocation(o,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1])))}},f.Uniform3f=class extends bs{constructor(o){super(o),this.current=[0,0,0]}set(o,r,a){this.fetchUniformLocation(o,r)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2])))}},f.Uniform4f=co,f.UniformColor=rp,f.UniformMatrix2f=class extends bs{constructor(o){super(o),this.current=op}set(o,r,a){if(this.fetchUniformLocation(o,r))for(let c=0;c<4;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}},f.UniformMatrix3f=class extends bs{constructor(o){super(o),this.current=Sy}set(o,r,a){if(this.fetchUniformLocation(o,r))for(let c=0;c<9;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},f.UniformMatrix4f=class extends bs{constructor(o){super(o),this.current=eb}set(o,r,a){if(this.fetchUniformLocation(o,r)){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let c=1;c<16;c++)if(a[c]!==this.current[c]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}}},f.UnwrappedTileID=Sb,f.ValidationError=vt,f.VectorTileFeature=Tp,f.VectorTileWorkerSource=class extends oc{constructor(o,r,a,c,d){super(),this.actor=o,this.layerIndex=r,this.availableImages=a,this.loadVectorData=d||e0,this.loading={},this.loaded={},this.deduped=new Qv(o.scheduler),this.isSpriteLoaded=c,this.scheduler=o.scheduler}loadTile(o,r){const a=o.uid,c=o&&o.request,d=c&&c.collectResourceTiming,g=this.loading[a]=new rw(o);g.abort=this.loadVectorData(o,(y,b)=>{const E=!this.loading[a];if(delete this.loading[a],E||y||!b)return g.status="done",E||(this.loaded[a]=g),r(y);const D=b.rawData,I={};b.expires&&(I.expires=b.expires),b.cacheControl&&(I.cacheControl=b.cacheControl),g.vectorTile=b.vectorTile||new Dp(new Rp(D));const k=()=>{g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,(L,z)=>{if(L||!z)return r(L);const V={};if(d){const H=wu(c);H.length>0&&(V.resourceTiming=JSON.parse(JSON.stringify(H)))}r(null,Ei({rawTileData:D.slice(0)},z,I,V))})};this.isSpriteLoaded?k():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(k,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):k()}),this.loaded=this.loaded||{},this.loaded[a]=g})}reloadTile(o,r){const a=this.loaded,c=o.uid,d=this;if(a&&a[c]){const g=a[c];g.showCollisionBoxes=o.showCollisionBoxes,g.enableTerrain=!!o.enableTerrain,g.projection=o.projection,g.tileTransform=rh(o.tileID.canonical,o.projection);const y=(b,E)=>{const D=g.reloadCallback;D&&(delete g.reloadCallback,g.parse(g.vectorTile,d.layerIndex,this.availableImages,d.actor,D)),r(b,E)};"parsing"===g.status?g.reloadCallback=y:"done"===g.status&&(g.vectorTile?g.parse(g.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(o,r){const a=o.uid,c=this.loading[a];c&&(c.abort&&c.abort(),delete this.loading[a]),r()}removeTile(o,r){const a=this.loaded,c=o.uid;a&&a[c]&&delete a[c],r()}},f.WritingMode=Qs,f.ZoomDependentExpression=Pl,f.add=gc,f.addDynamicAttributes=bf,f.adjoint=function(o,r){var a=r[0],c=r[1],d=r[2],g=r[3],y=r[4],b=r[5],E=r[6],D=r[7],I=r[8];return o[0]=y*I-b*D,o[1]=d*D-c*I,o[2]=c*b-d*y,o[3]=b*E-g*I,o[4]=a*I-d*E,o[5]=d*g-a*b,o[6]=g*D-y*E,o[7]=c*E-a*D,o[8]=a*y-c*g,o},f.asyncAll=nr,f.bezier=Is,f.bindAll=Ln,f.boundsAttributes=ol,f.bufferConvexPolygon=function(o,r){const a=[];for(let c=0;c<o.length;c++){const d=Lt(c-1,-1,o.length-1),g=Lt(c+1,-1,o.length-1),y=o[c],b=o[g],E=o[d].sub(y).unit(),D=b.sub(y).unit(),I=D.angleWithSep(E.x,E.y),k=E.add(D).unit().mult(-1*r/Math.sin(I/2));a.push(y.add(k))}return a},f.cacheEntryPossiblyAdded=function(o){Vo++,Vo>Pa&&(o.getActor().send("enforceCacheSizeLimit",Ia),Vo=0)},f.calculateGlobeLabelMatrix=function(o,r){const{x:a,y:c}=o.point,d=Uy(a,c,o.worldSize/o._pixelsPerMercatorPixel,0,0);return Bl(d,d,Xm(yc(r)))},f.calculateGlobeMatrix=function(o){const{x:r,y:a}=o.point,{lng:c,lat:d}=o._center;return Uy(r,a,o.worldSize,c,d)},f.calculateGlobeMercatorMatrix=function(o){const r=o.pixelsPerMeter,a=r/va(1,o.center.lat),c=Po(new Float64Array(16));return mc(c,c,[o.point.x,o.point.y,0]),ju(c,c,[a,a,r]),Float32Array.from(c)},f.circumferenceAtLatitude=mp,f.clamp=zt,f.clearTileCache=function(o){if(!yl())return;const r=Ke.caches.delete(Ui);o&&r.catch(o).then(()=>o())},f.clipLine=Jg,f.clone=function(o){var r=new uo(16);return r[0]=o[0],r[1]=o[1],r[2]=o[2],r[3]=o[3],r[4]=o[4],r[5]=o[5],r[6]=o[6],r[7]=o[7],r[8]=o[8],r[9]=o[9],r[10]=o[10],r[11]=o[11],r[12]=o[12],r[13]=o[13],r[14]=o[14],r[15]=o[15],r},f.clone$1=Vi,f.collisionCircleLayout=Ul,f.config=$t,f.conjugate=function(o,r){return o[0]=-r[0],o[1]=-r[1],o[2]=-r[2],o[3]=r[3],o},f.create=function(){var o=new uo(16);return uo!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},f.create$1=My,f.createExpression=Ii,f.createLayout=we,f.createStyleLayer=function(o){return"custom"===o.type?new Jb(o):new p_[o.type](o)},f.cross=lp,f.degToRad=cn,f.distance=function(o,r){return Math.hypot(r[0]-o[0],r[1]-o[1],r[2]-o[2])},f.div=function(o,r,a){return o[0]=r[0]/a[0],o[1]=r[1]/a[1],o[2]=r[2]/a[2],o},f.dot=ko,f.earthRadius=Jh,f.ease=eo,f.easeCubicInOut=ec,f.ecefToLatLng=function([o,r,a]){const c=Math.hypot(o,r,a),d=Math.atan2(o,a),g=.5*Math.PI-Math.acos(-r/c);return new Zn(tr(d),tr(g))},f.emitValidationErrors=Qf,f.endsWith=ks,f.enforceCacheSizeLimit=function(o){oa(),yi&&yi.then(r=>{r.keys().then(a=>{for(let c=0;c<a.length-o;c++)r.delete(a[c])})})},f.evaluateSizeForFeature=Pp,f.evaluateSizeForZoom=Qu,f.evaluateVariableOffset=qb,f.evented=x,f.exactEquals=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]&&o[3]===r[3]},f.exactEquals$1=function(o,r){return o[0]===r[0]&&o[1]===r[1]&&o[2]===r[2]},f.exported=ps,f.exported$1=Wt,f.extend=Ei,f.extend$1=ms,f.fillExtrusionHeightLift=av,f.filterObject=Zi,f.fromMat4=function(o,r){return o[0]=r[0],o[1]=r[1],o[2]=r[2],o[3]=r[4],o[4]=r[5],o[5]=r[6],o[6]=r[8],o[7]=r[9],o[8]=r[10],o},f.fromQuat=function(o,r){var a=r[0],c=r[1],d=r[2],g=r[3],y=a+a,b=c+c,E=d+d,D=a*y,I=c*y,k=c*b,L=d*y,z=d*b,V=d*E,H=g*y,K=g*b,ie=g*E;return o[0]=1-k-V,o[1]=I+ie,o[2]=L-K,o[3]=0,o[4]=I-ie,o[5]=1-D-V,o[6]=z+H,o[7]=0,o[8]=L+K,o[9]=z-H,o[10]=1-D-k,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},f.fromRotation=function(o,r){var a=Math.sin(r),c=Math.cos(r);return o[0]=c,o[1]=a,o[2]=0,o[3]=-a,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},f.fromScaling=ib,f.furthestTileCorner=function(o){const r=Math.round((o+45+360)%360/90)%4;return ra[r]},f.getAABBPointSquareDist=function(o,r,a){let c=0;for(let d=0;d<2;++d){const g=a?a[d]:0;o[d]>g&&(c+=(o[d]-g)*(o[d]-g)),r[d]<g&&(c+=(g-r[d])*(g-r[d]))}return c},f.getAnchorAlignment=Xg,f.getAnchorJustification=su,f.getBounds=function(o){let r=1/0,a=1/0,c=-1/0,d=-1/0;for(const g of o)r=Math.min(r,g.x),a=Math.min(a,g.y),c=Math.max(c,g.x),d=Math.max(d,g.y);return{min:new ct(r,a),max:new ct(c,d)}},f.getColumn=Ci,f.getDefaultExportFromCjs=Er,f.getGridMatrix=function(o,r,a,c){const d=r.getNorth(),g=r.getSouth(),y=r.getWest(),b=r.getEast(),E=1<<o.z,D=b-y,I=d-g,k=D/64,L=-I/Hu[a],z=[0,k,0,L,0,0,d,y,0];if(o.z>0){const V=180/c;Ks(z,z,[V/D+1,0,0,0,V/I+1,0,-.5*V/k,.5*V/L,1])}return z[2]=E,z[5]=o.x,z[8]=o.y,z},f.getImage=le,f.getJSON=function(o,r){return bo(Ei(o,{type:"json"}),r)},f.getLatitudinalLod=function(o){const r=Xr-5;o=zt(o,-r,r)/r*90;const a=Math.pow(Math.abs(Math.sin(cn(o))),3);return Math.round(a*(Hu.length-1))},f.getMapSessionAPI=Qn,f.getPerformanceMeasurement=wu,f.getProjection=xf,f.getRTLTextPluginStatus=w,f.getReferrer=la,f.getTilePoint=function(o,{x:r,y:a},c=0){return new ct(((r-c)*o.scale-o.x)*Pt,(a*o.scale-o.y)*Pt)},f.getTileVec3=function(o,r,a=0){return qh(((r.x-a)*o.scale-o.x)*Pt,(r.y*o.scale-o.y)*Pt,$y(r.z,r.y))},f.getVideo=function(o,r){const a=Ke.document.createElement("video");a.muted=!0,a.onloadstart=function(){r(null,a)};for(let c=0;c<o.length;c++){const d=Ke.document.createElement("source");Fc(o[c])||(a.crossOrigin="Anonymous"),d.src=o[c],a.appendChild(d)}return{cancel:()=>{}}},f.globeCenterToScreenPoint=function(o){const r=[0,0,0],a=Po(new Float64Array(16));return Bl(a,o.pixelMatrix,o.globeMatrix),Pi(r,r,a),new ct(r[0],r[1])},f.globeDenormalizeECEF=Xm,f.globeECEFOrigin=function(o,r){const a=[0,0,0];return Pi(a,a,qu(yc(r.canonical))),Pi(a,a,o),a},f.globeMetersToEcef=qm,f.globeNormalizeECEF=qu,f.globePixelsToTileUnits=function(o,r){return Pt/(512*Math.pow(2,o))*fp(yc(r))},f.globePoleMatrixForTile=function(o,r,a){const c=Po(new Float64Array(16)),d=(r/(1<<o)-.5)*Math.PI*2;return ap(c,a.globeMatrix,d),Float32Array.from(c)},f.globeTileBounds=yc,f.globeTiltAtLngLat=Km,f.globeToMercatorTransition=Yh,f.globeUseCustomAntiAliasing=function(o,r,a){const c=Yh(a.zoom),d=o.style.map._antialias,g=!!r.extStandardDerivatives,y=r.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return 0===c&&!d&&!y&&g},f.identity=Po,f.identity$1=Fy,f.invert=sp,f.isFullscreen=function(){return!!Ke.document.fullscreenElement||!!Ke.document.webkitFullscreenElement},f.isLngLatBehindGlobe=Ym,f.isMapAuthenticated=function(o){return Cr.has(o)},f.isMapboxURL=xe,f.isSafariWithAntialiasingBug=function(o){const r=o.navigator?o.navigator.userAgent:null;return!!zo(o)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},f.latFromMercatorY=Zr,f.latLngToECEF=Kh,f.len=ky,f.length=Gh,f.length$1=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},f.lngFromMercatorX=Ys,f.loadVectorTile=e0,f.makeRequest=bo,f.mapValue=function(o,r,a,c,d){return zt((o-r)/(a-r)*(d-c)+c,c,d)},f.mercatorScale=Hy,f.mercatorXfromLng=el,f.mercatorYfromLat=zl,f.mercatorZfromAltitude=va,f.mul=Vm,f.mul$1=cp,f.multiply=Bl,f.multiply$1=Ks,f.multiply$2=Iy,f.nextPowerOfTwo=fs,f.normalize=qr,f.normalize$1=sb,f.normalize$2=Oy,f.number=En,f.ortho=function(o,r,a,c,d,g,y){var b=1/(r-a),E=1/(c-d),D=1/(g-y);return o[0]=-2*b,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*E,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*D,o[11]=0,o[12]=(r+a)*b,o[13]=(d+c)*E,o[14]=(y+g)*D,o[15]=1,o},f.pbf=dv,f.perspective=function(o,r,a,c,d){var g,y=1/Math.tan(r/2);return o[0]=y/a,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=(d+c)*(g=1/(c-d)),o[14]=2*d*c*g):(o[10]=-1,o[14]=-2*c),o},f.pick=function(o,r){const a={};for(let c=0;c<r.length;c++){const d=r[c];d in o&&(a[d]=o[d])}return a},f.plugin=S,f.pointGeometry=ki,f.polesInViewport=function(o){const r=Po(new Float64Array(16));Bl(r,o.pixelMatrix,o.globeMatrix);const a=[0,Ja,0],c=[0,Qa,0];return Pi(a,a,r),Pi(c,c,r),[a[0]>0&&a[0]<=o.width&&a[1]>0&&a[1]<=o.height&&!Ym(o,new Zn(o.center.lat,90)),c[0]>0&&c[0]<=o.width&&c[1]>0&&c[1]<=o.height&&!Ym(o,new Zn(o.center.lat,-90))]},f.polygonContainsPoint=xc,f.polygonIntersectsBox=sg,f.polygonIntersectsPolygon=qy,f.polygonizeBounds=function(o,r,a=0,c=!0){const d=new ct(a,a),g=o.sub(d),y=r.add(d),b=[g,new ct(y.x,g.y),y,new ct(g.x,y.y)];return c&&b.push(g.clone()),b},f.posAttributes=Qd,f.postMapLoadEvent=ji,f.postPerformanceEvent=Xi,f.postTurnstileEvent=_n,f.potpack=Wg,f.prevPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},f.radToDeg=tr,f.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],f.registerForPluginStateChange=function(o){return o({pluginStatus:m,pluginURL:l}),x.on("pluginStateChange",o),o},f.removeAuthState=function(o){Cr.delete(o)},f.renderColorRamp=bp,f.resample=gp,f.rotateX=Ay,f.rotateX$1=ob,f.rotateY=ap,f.rotateY$1=jm,f.rotateZ=function(o,r,a){var c=Math.sin(a),d=Math.cos(a),g=r[0],y=r[1],b=r[2],E=r[3],D=r[4],I=r[5],k=r[6],L=r[7];return r!==o&&(o[8]=r[8],o[9]=r[9],o[10]=r[10],o[11]=r[11],o[12]=r[12],o[13]=r[13],o[14]=r[14],o[15]=r[15]),o[0]=g*d+D*c,o[1]=y*d+I*c,o[2]=b*d+k*c,o[3]=E*d+L*c,o[4]=D*d-g*c,o[5]=I*d-y*c,o[6]=k*d-b*c,o[7]=L*d-E*c,o},f.rotateZ$1=function(o,r,a){a*=.5;var c=r[0],d=r[1],g=r[2],y=r[3],b=Math.sin(a),E=Math.cos(a);return o[0]=c*E+d*b,o[1]=d*E-c*b,o[2]=g*E+y*b,o[3]=y*E-g*b,o},f.scale=ju,f.scale$1=Ry,f.scale$2=ls,f.scaleAndAdd=Qc,f.set=function(o,r,a,c){return o[0]=r,o[1]=a,o[2]=c,o},f.setCacheLimits=function(o,r){Ia=o,Pa=r},f.setColumn=function(o,r,a){o[4*r+0]=a[0],o[4*r+1]=a[1],o[4*r+2]=a[2],o[4*r+3]=a[3]},f.setRTLTextPlugin=function(o,r,a=!1){if(m===Ws||m===zh||m===Rl)throw new Error("setRTLTextPlugin cannot be called multiple times.");l=ps.resolveURL(o),m=Ws,Go=r,_(),a||T()},f.smoothstep=yo,f.spec=Ue,f.squaredLength=function(o){var r=o[0],a=o[1],c=o[2];return r*r+a*a+c*c},f.storeAuthState=function(o,r){r?Cr.add(o):Cr.delete(o)},f.sub=cs,f.subtract=Um,f.symbolSize=ld,f.tileAABB=function(o,r,a,c,d,g,y,b,E){if("globe"===E.name)return function Vy(o,r,a){const c=r/o.worldSize,d=o.globeMatrix;if(a.z<=1){const Me=yc(a).getCorners();return hp(Me,d,c),Ro.fromPoints(Me)}const g=ef(a),y=dp(g);hp(y,d,c);const b=Number.MAX_VALUE,E=[-b,-b,-b],D=[b,b,b];if(g.contains(o.center)){for(const et of y)Yd(D,D,et),Jd(E,E,et);E[2]=0;const Me=o.point,Ve=[Me.x*c,Me.y*c,0];return Yd(D,D,Ve),Jd(E,E,Ve),new Ro(D,E)}const I=[d[12]*c,d[13]*c,d[14]*c],k=g.getCenter(),L=zt(o.center.lat,-Xr,Xr),z=zt(k.lat,-Xr,Xr),V=el(o.center.lng),H=zl(L);let K=V-el(k.lng);const ie=H-zl(z);K>.5?K-=1:K<-.5&&(K+=1);let ue=0;Math.abs(K)>Math.abs(ie)?ue=K>=0?1:3:(ue=ie>=0?0:2,Qc(I,I,[d[4]*c,d[5]*c,d[6]*c],-Math.sin(cn(ie>=0?g.getSouth():g.getNorth()))*_c));const ne=y[ue],ce=y[(ue+1)%4],me=new MC(ne,ce,I),pe=[zy(me,0)||ne[0],zy(me,1)||ne[1],zy(me,2)||ne[2]],Ae=Yh(o.zoom);if(Ae>0){const Me=function({x:et,y:Re,z:We},Ze,Qe,rt,Ne){const mt=1/(1<<We);let bt=et*mt,_t=bt+mt,Kt=Re*mt,lt=Kt+mt,At=0;const Yt=(bt+_t)/2-rt;return Yt>.5?At=-1:Yt<-.5&&(At=1),bt=((bt+At)*Ze-(rt*=Ze))*Qe+rt,_t=((_t+At)*Ze-rt)*Qe+rt,Kt=(Kt*Ze-(Ne*=Ze))*Qe+Ne,lt=(lt*Ze-Ne)*Qe+Ne,[[bt,lt,0],[_t,lt,0],[_t,Kt,0],[bt,Kt,0]]}(a,r,o._pixelsPerMercatorPixel,V,H);for(let et=0;et<y.length;et++)Gu(y[et],Me[et],Ae);const Ve=gc([],Me[ue],Me[(ue+1)%4]);ls(Ve,Ve,.5),Gu(pe,Ve,Ae)}for(const Me of y)Yd(D,D,Me),Jd(E,E,Me);return D[2]=Math.min(ne[2],ce[2]),Yd(D,D,pe),Jd(E,E,pe),new Ro(D,E)}(o,r,new kg(a,c,d));const D=rh({z:a,x:c,y:d},E);return new Ro([(g+D.x/D.scale)*r,r*(D.y/D.scale),y],[(g+D.x2/D.scale)*r,r*(D.y2/D.scale),b])},f.tileCornersToBounds=ef,f.tileTransform=rh,f.transformMat3=function(o,r,a){var c=r[0],d=r[1],g=r[2];return o[0]=c*a[0]+d*a[3]+g*a[6],o[1]=c*a[1]+d*a[4]+g*a[7],o[2]=c*a[2]+d*a[5]+g*a[8],o},f.transformMat4=Pi,f.transformMat4$1=ya,f.transformQuat=Py,f.transitionTileAABBinECEF=Wm,f.translate=mc,f.transpose=function(o,r){if(o===r){var a=r[1],c=r[2],d=r[5];o[1]=r[3],o[2]=r[6],o[3]=a,o[5]=r[7],o[6]=c,o[7]=d}else o[0]=r[0],o[1]=r[3],o[2]=r[6],o[3]=r[1],o[4]=r[4],o[5]=r[7],o[6]=r[2],o[7]=r[5],o[8]=r[8];return o},f.triggerPluginCompletionEvent=h,f.uniqueId=mn,f.updateGlobeVertexNormal=function(o,r,a,c,d){const g=5*r+2;o.float32[g+0]=a,o.float32[g+1]=c,o.float32[g+2]=d},f.validateCustomStyleLayer=function(o){const r=[],a=o.id;return void 0===a&&r.push({message:`layers.${a}: missing required property "id"`}),void 0===o.render&&r.push({message:`layers.${a}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&r.push({message:`layers.${a}: property "renderingMode" must be either "2d" or "3d"`}),r},f.validateFilter=o=>Hs(ao(o)),f.validateFog=o=>Hs(Bu(o)),f.validateLayer=o=>Hs(Nu(o)),f.validateLight=o=>Hs(Ao(o)),f.validateSource=o=>Hs(qd(o)),f.validateStyle=Lh,f.validateTerrain=o=>Hs(Wd(o)),f.values=vo,f.vectorTile=xa,f.version=je,f.warnOnce=Tn,f.window=Ke,f.wrap=Lt}),Oc(0,function(f){function Ke(he){if("number"==typeof he||"boolean"==typeof he||"string"==typeof he||null==he)return JSON.stringify(he);if(Array.isArray(he)){let W="[";for(const le of he)W+=`${Ke(le)},`;return`${W}]`}let q="{";for(const W of Object.keys(he).sort())q+=`${W}:${Ke(he[W])},`;return`${q}}`}function je(he){let q="";for(const W of f.refProperties)q+=`/${Ke(he[W])}`;return q}class Xo{constructor(q){this.keyCache={},q&&this.replace(q)}replace(q){this._layerConfigs={},this._layers={},this.update(q,[])}update(q,W){for(const ge of q)this._layerConfigs[ge.id]=ge,(this._layers[ge.id]=f.createStyleLayer(ge)).compileFilter(),this.keyCache[ge.id]&&delete this.keyCache[ge.id];for(const ge of W)delete this.keyCache[ge],delete this._layerConfigs[ge],delete this._layers[ge];this.familiesBySource={};const le=function(ge,xe){const Te={};for(let be=0;be<ge.length;be++){const Oe=xe&&xe[ge[be].id]||je(ge[be]);xe&&(xe[ge[be].id]=Oe);let st=Te[Oe];st||(st=Te[Oe]=[]),st.push(ge[be])}const Se=[];for(const be in Te)Se.push(Te[be]);return Se}(f.values(this._layerConfigs),this.keyCache);for(const ge of le){const xe=ge.map(ut=>this._layers[ut.id]),Te=xe[0];if("none"===Te.visibility)continue;const Se=Te.source||"";let be=this.familiesBySource[Se];be||(be=this.familiesBySource[Se]={});const Oe=Te.sourceLayer||"_geojsonTileLayer";let st=be[Oe];st||(st=be[Oe]=[]),st.push(xe)}}}class $t{loadTile(q,W){const{uid:le,encoding:ge,rawImageData:xe,padding:Te,buildQuadTree:Se}=q,be=f.window.ImageBitmap&&xe instanceof f.window.ImageBitmap?this.getImageData(xe,Te):xe;W(null,new f.DEMData(le,be,ge,Te<1,Se))}getImageData(q,W){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(q.width,q.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=q.width,this.offscreenCanvas.height=q.height,this.offscreenCanvasContext.drawImage(q,0,0,q.width,q.height);const le=this.offscreenCanvasContext.getImageData(-W,-W,q.width+2*W,q.height+2*W);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),le}}function Wt(he,q){if(0!==he.length){zi(he[0],q);for(var W=1;W<he.length;W++)zi(he[W],!q)}}function zi(he,q){for(var W=0,le=0,ge=0,xe=he.length,Te=xe-1;ge<xe;Te=ge++){var Se=(he[ge][0]-he[Te][0])*(he[Te][1]+he[ge][1]),be=W+Se;le+=Math.abs(W)>=Math.abs(Se)?W-be+Se:Se-be+W,W=be}W+le>=0!=!!q&&he.reverse()}var si=f.getDefaultExportFromCjs(function he(q,W){var le,ge=q&&q.type;if("FeatureCollection"===ge)for(le=0;le<q.features.length;le++)he(q.features[le],W);else if("GeometryCollection"===ge)for(le=0;le<q.geometries.length;le++)he(q.geometries[le],W);else if("Feature"===ge)he(q.geometry,W);else if("Polygon"===ge)Wt(q.coordinates,W);else if("MultiPolygon"===ge)for(le=0;le<q.coordinates.length;le++)Wt(q.coordinates[le],W);return q});const er=f.VectorTileFeature.prototype.toGeoJSON;var ds={exports:{}},Ql=f.pointGeometry,_l=f.vectorTile.VectorTileFeature,Er=Qr;function Qr(he,q){this.options=q||{},this.features=he,this.length=he.length}function ur(he,q){this.id="number"==typeof he.id?he.id:void 0,this.type=he.type,this.rawGeometry=1===he.type?[he.geometry]:he.geometry,this.properties=he.tags,this.extent=q||4096}Qr.prototype.feature=function(he){return new ur(this.features[he],this.options.extent)},ur.prototype.loadGeometry=function(){var he=this.rawGeometry;this.geometry=[];for(var q=0;q<he.length;q++){for(var W=he[q],le=[],ge=0;ge<W.length;ge++)le.push(new Ql(W[ge][0],W[ge][1]));this.geometry.push(le)}return this.geometry},ur.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var he=this.geometry,q=1/0,W=-1/0,le=1/0,ge=-1/0,xe=0;xe<he.length;xe++)for(var Te=he[xe],Se=0;Se<Te.length;Se++){var be=Te[Se];q=Math.min(q,be.x),W=Math.max(W,be.x),le=Math.min(le,be.y),ge=Math.max(ge,be.y)}return[q,le,W,ge]},ur.prototype.toGeoJSON=_l.prototype.toGeoJSON;var As=f.pbf,ki=Er;function zr(he){var q=new As;return function(W,le){for(var ge in W.layers)le.writeMessage(3,ct,W.layers[ge])}(he,q),q.finish()}function ct(he,q){var W;q.writeVarintField(15,he.version||1),q.writeStringField(1,he.name||""),q.writeVarintField(5,he.extent||4096);var le={keys:[],values:[],keycache:{},valuecache:{}};for(W=0;W<he.length;W++)le.feature=he.feature(W),q.writeMessage(2,ti,le);var ge=le.keys;for(W=0;W<ge.length;W++)q.writeStringField(3,ge[W]);var xe=le.values;for(W=0;W<xe.length;W++)q.writeMessage(4,ec,xe[W])}function ti(he,q){var W=he.feature;void 0!==W.id&&q.writeVarintField(1,W.id),q.writeMessage(2,Ko,he),q.writeVarintField(3,W.type),q.writeMessage(4,ra,W)}function Ko(he,q){var W=he.feature,le=he.keys,ge=he.values,xe=he.keycache,Te=he.valuecache;for(var Se in W.properties){var be=W.properties[Se],Oe=xe[Se];if(null!==be){void 0===Oe&&(le.push(Se),xe[Se]=Oe=le.length-1),q.writeVarint(Oe);var st=typeof be;"string"!==st&&"boolean"!==st&&"number"!==st&&(be=JSON.stringify(be));var ut=st+":"+be,ot=Te[ut];void 0===ot&&(ge.push(be),Te[ut]=ot=ge.length-1),q.writeVarint(ot)}}}function cn(he,q){return(q<<3)+(7&he)}function tr(he){return he<<1^he>>31}function ra(he,q){for(var W=he.loadGeometry(),le=he.type,ge=0,xe=0,Te=W.length,Se=0;Se<Te;Se++){var be=W[Se],Oe=1;1===le&&(Oe=be.length),q.writeVarint(cn(1,Oe));for(var st=3===le?be.length-1:be.length,ut=0;ut<st;ut++){1===ut&&1!==le&&q.writeVarint(cn(2,st-1));var ot=be[ut].x-ge,Ht=be[ut].y-xe;q.writeVarint(tr(ot)),q.writeVarint(tr(Ht)),ge+=ot,xe+=Ht}3===le&&q.writeVarint(cn(7,1))}}function ec(he,q){var W=typeof he;"string"===W?q.writeStringField(1,he):"boolean"===W?q.writeBooleanField(7,he):"number"===W&&(he%1!=0?q.writeDoubleField(3,he):he<0?q.writeSVarintField(6,he):q.writeVarintField(5,he))}ds.exports=zr,ds.exports.fromVectorTileJs=zr,ds.exports.fromGeojsonVt=function(he,q){q=q||{};var W={};for(var le in he)W[le]=new ki(he[le].features,q),W[le].name=le,W[le].version=q.version,W[le].extent=q.extent;return zr({layers:W})},ds.exports.GeoJSONWrapper=ki;var Is=f.getDefaultExportFromCjs(ds.exports);const eo={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:he=>he},zt=Math.fround||(yo=new Float32Array(1),he=>(yo[0]=+he,yo[0]));var yo;const Lt=3,nr=5,vo=6;class Ei{constructor(q){this.options=Object.assign(Object.create(eo),q),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(q){const{log:W,minZoom:le,maxZoom:ge}=this.options;W&&console.time("total time");const xe=`prepare ${q.length} points`;W&&console.time(xe),this.points=q;const Te=[];for(let be=0;be<q.length;be++){const Oe=q[be];if(!Oe.geometry)continue;const[st,ut]=Oe.geometry.coordinates,ot=zt(Yo(st)),Ht=zt(fs(ut));Te.push(ot,Ht,1/0,be,-1,1),this.options.reduce&&Te.push(0)}let Se=this.trees[ge+1]=this._createTree(Te);W&&console.timeEnd(xe);for(let be=ge;be>=le;be--){const Oe=+Date.now();Se=this.trees[be]=this._createTree(this._cluster(Se,be)),W&&console.log("z%d: %d clusters in %dms",be,Se.numItems,+Date.now()-Oe)}return W&&console.timeEnd("total time"),this}getClusters(q,W){let le=((q[0]+180)%360+360)%360-180;const ge=Math.max(-90,Math.min(90,q[1]));let xe=180===q[2]?180:((q[2]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,q[3]));if(q[2]-q[0]>=360)le=-180,xe=180;else if(le>xe){const ut=this.getClusters([le,ge,180,Te],W),ot=this.getClusters([-180,ge,xe,Te],W);return ut.concat(ot)}const Se=this.trees[this._limitZoom(W)],be=Se.range(Yo(le),fs(Te),Yo(xe),fs(ge)),Oe=Se.data,st=[];for(const ut of be){const ot=this.stride*ut;st.push(Oe[ot+nr]>1?Ps(Oe,ot,this.clusterProps):this.points[Oe[ot+Lt]])}return st}getChildren(q){const W=this._getOriginId(q),le=this._getOriginZoom(q),ge="No cluster with the specified id.",xe=this.trees[le];if(!xe)throw new Error(ge);const Te=xe.data;if(W*this.stride>=Te.length)throw new Error(ge);const Se=this.options.radius/(this.options.extent*Math.pow(2,le-1)),be=xe.within(Te[W*this.stride],Te[W*this.stride+1],Se),Oe=[];for(const st of be){const ut=st*this.stride;Te[ut+4]===q&&Oe.push(Te[ut+nr]>1?Ps(Te,ut,this.clusterProps):this.points[Te[ut+Lt]])}if(0===Oe.length)throw new Error(ge);return Oe}getLeaves(q,W,le){const ge=[];return this._appendLeaves(ge,q,W=W||10,le=le||0,0),ge}getTile(q,W,le){const ge=this.trees[this._limitZoom(q)],xe=Math.pow(2,q),{extent:Te,radius:Se}=this.options,be=Se/Te,Oe=(le-be)/xe,st=(le+1+be)/xe,ut={features:[]};return this._addTileFeatures(ge.range((W-be)/xe,Oe,(W+1+be)/xe,st),ge.data,W,le,xe,ut),0===W&&this._addTileFeatures(ge.range(1-be/xe,Oe,1,st),ge.data,xe,le,xe,ut),W===xe-1&&this._addTileFeatures(ge.range(0,Oe,be/xe,st),ge.data,-1,le,xe,ut),ut.features.length?ut:null}getClusterExpansionZoom(q){let W=this._getOriginZoom(q)-1;for(;W<=this.options.maxZoom;){const le=this.getChildren(q);if(W++,1!==le.length)break;q=le[0].properties.cluster_id}return W}_appendLeaves(q,W,le,ge,xe){const Te=this.getChildren(W);for(const Se of Te){const be=Se.properties;if(be&&be.cluster?xe+be.point_count<=ge?xe+=be.point_count:xe=this._appendLeaves(q,be.cluster_id,le,ge,xe):xe<ge?xe++:q.push(Se),q.length===le)break}return xe}_createTree(q){const W=new f.KDBush(q.length/this.stride|0,this.options.nodeSize,Float32Array);for(let le=0;le<q.length;le+=this.stride)W.add(q[le],q[le+1]);return W.finish(),W.data=q,W}_addTileFeatures(q,W,le,ge,xe,Te){for(const Se of q){const be=Se*this.stride,Oe=W[be+nr]>1;let st,ut,ot;if(Oe)st=mn(W,be,this.clusterProps),ut=W[be],ot=W[be+1];else{const It=this.points[W[be+Lt]];st=It.properties;const[ln,_n]=It.geometry.coordinates;ut=Yo(ln),ot=fs(_n)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(ut*xe-le)),Math.round(this.options.extent*(ot*xe-ge))]],tags:st};let nn;nn=Oe||this.options.generateId?W[be+Lt]:this.points[W[be+Lt]].id,void 0!==nn&&(Ht.id=nn),Te.features.push(Ht)}}_limitZoom(q){return Math.max(this.options.minZoom,Math.min(Math.floor(+q),this.options.maxZoom+1))}_cluster(q,W){const{radius:le,extent:ge,reduce:xe,minPoints:Te}=this.options,Se=le/(ge*Math.pow(2,W)),be=q.data,Oe=[],st=this.stride;for(let ut=0;ut<be.length;ut+=st){if(be[ut+2]<=W)continue;be[ut+2]=W;const ot=be[ut],Ht=be[ut+1],nn=q.within(be[ut],be[ut+1],Se),It=be[ut+nr];let ln=It;for(const _n of nn){const Di=_n*st;be[Di+2]>W&&(ln+=be[Di+nr])}if(ln>It&&ln>=Te){let _n,Di=ot*It,ji=Ht*It,mr=-1;const Xi=((ut/st|0)<<5)+(W+1)+this.points.length;for(const Uo of nn){const Qn=Uo*st;if(be[Qn+2]<=W)continue;be[Qn+2]=W;const Cr=be[Qn+nr];Di+=be[Qn]*Cr,ji+=be[Qn+1]*Cr,be[Qn+4]=Xi,xe&&(_n||(_n=this._map(be,ut,!0),mr=this.clusterProps.length,this.clusterProps.push(_n)),xe(_n,this._map(be,Qn)))}be[ut+4]=Xi,Oe.push(Di/ln,ji/ln,1/0,Xi,-1,ln),xe&&Oe.push(mr)}else{for(let _n=0;_n<st;_n++)Oe.push(be[ut+_n]);if(ln>1)for(const _n of nn){const Di=_n*st;if(!(be[Di+2]<=W)){be[Di+2]=W;for(let ji=0;ji<st;ji++)Oe.push(be[Di+ji])}}}}return Oe}_getOriginId(q){return q-this.points.length>>5}_getOriginZoom(q){return(q-this.points.length)%32}_map(q,W,le){if(q[W+nr]>1){const Te=this.clusterProps[q[W+vo]];return le?Object.assign({},Te):Te}const ge=this.points[q[W+Lt]].properties,xe=this.options.map(ge);return le&&xe===ge?Object.assign({},xe):xe}}function Ps(he,q,W){return{type:"Feature",id:he[q+Lt],properties:mn(he,q,W),geometry:{type:"Point",coordinates:[(le=he[q],360*(le-.5)),ni(he[q+1])]}};var le}function mn(he,q,W){const le=he[q+nr],ge=le>=1e4?`${Math.round(le/1e3)}k`:le>=1e3?Math.round(le/100)/10+"k":le,xe=he[q+vo],Te=-1===xe?{}:Object.assign({},W[xe]);return Object.assign(Te,{cluster:!0,cluster_id:he[q+Lt],point_count:le,point_count_abbreviated:ge})}function Yo(he){return he/360+.5}function fs(he){const q=Math.sin(he*Math.PI/180),W=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return W<0?0:W>1?1:W}function ni(he){const q=(180-360*he)*Math.PI/180;return 360*Math.atan(Math.exp(q))/Math.PI-90}function Ln(he,q,W,le){for(var ge,xe=le,Te=W-q>>1,Se=W-q,be=he[q],Oe=he[q+1],st=he[W],ut=he[W+1],ot=q+3;ot<W;ot+=3){var Ht=ks(he[ot],he[ot+1],be,Oe,st,ut);if(Ht>xe)ge=ot,xe=Ht;else if(Ht===xe){var nn=Math.abs(ot-Te);nn<Se&&(ge=ot,Se=nn)}}xe>le&&(ge-q>3&&Ln(he,q,ge,le),he[ge+2]=xe,W-ge>3&&Ln(he,ge,W,le))}function ks(he,q,W,le,ge,xe){var Te=ge-W,Se=xe-le;if(0!==Te||0!==Se){var be=((he-W)*Te+(q-le)*Se)/(Te*Te+Se*Se);be>1?(W=ge,le=xe):be>0&&(W+=Te*be,le+=Se*be)}return(Te=he-W)*Te+(Se=q-le)*Se}function gt(he,q,W,le){var ge={id:void 0===he?null:he,type:q,geometry:W,tags:le,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(xe){var Te=xe.geometry,Se=xe.type;if("Point"===Se||"MultiPoint"===Se||"LineString"===Se)Zi(xe,Te);else if("Polygon"===Se||"MultiLineString"===Se)for(var be=0;be<Te.length;be++)Zi(xe,Te[be]);else if("MultiPolygon"===Se)for(be=0;be<Te.length;be++)for(var Oe=0;Oe<Te[be].length;Oe++)Zi(xe,Te[be][Oe])}(ge),ge}function Zi(he,q){for(var W=0;W<q.length;W+=3)he.minX=Math.min(he.minX,q[W]),he.minY=Math.min(he.minY,q[W+1]),he.maxX=Math.max(he.maxX,q[W]),he.maxY=Math.max(he.maxY,q[W+1])}function Vi(he,q,W,le){if(q.geometry){var ge=q.geometry.coordinates,xe=q.geometry.type,Te=Math.pow(W.tolerance/((1<<W.maxZoom)*W.extent),2),Se=[],be=q.id;if(W.promoteId?be=q.properties[W.promoteId]:W.generateId&&(be=le||0),"Point"===xe)Aa(ge,Se);else if("MultiPoint"===xe)for(var Oe=0;Oe<ge.length;Oe++)Aa(ge[Oe],Se);else if("LineString"===xe)Tn(ge,Se,Te,!1);else if("MultiLineString"===xe){if(W.lineMetrics){for(Oe=0;Oe<ge.length;Oe++)Tn(ge[Oe],Se=[],Te,!1),he.push(gt(be,"LineString",Se,q.properties));return}to(ge,Se,Te,!1)}else if("Polygon"===xe)to(ge,Se,Te,!0);else{if("MultiPolygon"!==xe){if("GeometryCollection"===xe){for(Oe=0;Oe<q.geometry.geometries.length;Oe++)Vi(he,{id:be,geometry:q.geometry.geometries[Oe],properties:q.properties},W,le);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Oe=0;Oe<ge.length;Oe++){var st=[];to(ge[Oe],st,Te,!0),Se.push(st)}}he.push(gt(be,xe,Se,q.properties))}}function Aa(he,q){q.push(tc(he[0])),q.push(Rs(he[1])),q.push(0)}function Tn(he,q,W,le){for(var ge,xe,Te=0,Se=0;Se<he.length;Se++){var be=tc(he[Se][0]),Oe=Rs(he[Se][1]);q.push(be),q.push(Oe),q.push(0),Se>0&&(Te+=le?(ge*Oe-be*xe)/2:Math.sqrt(Math.pow(be-ge,2)+Math.pow(Oe-xe,2))),ge=be,xe=Oe}var st=q.length-3;q[2]=1,Ln(q,0,st,W),q[st+2]=1,q.size=Math.abs(Te),q.start=0,q.end=q.size}function to(he,q,W,le){for(var ge=0;ge<he.length;ge++){var xe=[];Tn(he[ge],xe,W,le),q.push(xe)}}function tc(he){return he/360+.5}function Rs(he){var q=Math.sin(he*Math.PI/180),W=.5-.25*Math.log((1+q)/(1-q))/Math.PI;return W<0?0:W>1?1:W}function an(he,q,W,le,ge,xe,Te,Se){if(le/=q,xe>=(W/=q)&&Te<le)return he;if(Te<W||xe>=le)return null;for(var be=[],Oe=0;Oe<he.length;Oe++){var st=he[Oe],ut=st.geometry,ot=st.type,Ht=0===ge?st.minX:st.minY,nn=0===ge?st.maxX:st.maxY;if(Ht>=W&&nn<le)be.push(st);else if(!(nn<W||Ht>=le)){var It=[];if("Point"===ot||"MultiPoint"===ot)xo(ut,It,W,le,ge);else if("LineString"===ot)zo(ut,It,W,le,ge,!1,Se.lineMetrics);else if("MultiLineString"===ot)Ci(ut,It,W,le,ge,!1);else if("Polygon"===ot)Ci(ut,It,W,le,ge,!0);else if("MultiPolygon"===ot)for(var ln=0;ln<ut.length;ln++){var _n=[];Ci(ut[ln],_n,W,le,ge,!0),_n.length&&It.push(_n)}if(It.length){if(Se.lineMetrics&&"LineString"===ot){for(ln=0;ln<It.length;ln++)be.push(gt(st.id,ot,It[ln],st.tags));continue}"LineString"!==ot&&"MultiLineString"!==ot||(1===It.length?(ot="LineString",It=It[0]):ot="MultiLineString"),"Point"!==ot&&"MultiPoint"!==ot||(ot=3===It.length?"Point":"MultiPoint"),be.push(gt(st.id,ot,It,st.tags))}}}return be.length?be:null}function xo(he,q,W,le,ge){for(var xe=0;xe<he.length;xe+=3){var Te=he[xe+ge];Te>=W&&Te<=le&&(q.push(he[xe]),q.push(he[xe+1]),q.push(he[xe+2]))}}function zo(he,q,W,le,ge,xe,Te){for(var Se,be,Oe=Jo(he),st=0===ge?Ia:Pa,ut=he.start,ot=0;ot<he.length-3;ot+=3){var Ht=he[ot],nn=he[ot+1],It=he[ot+2],ln=he[ot+3],_n=he[ot+4],Di=0===ge?Ht:nn,ji=0===ge?ln:_n,mr=!1;Te&&(Se=Math.sqrt(Math.pow(Ht-ln,2)+Math.pow(nn-_n,2))),Di<W?ji>W&&(be=st(Oe,Ht,nn,ln,_n,W),Te&&(Oe.start=ut+Se*be)):Di>le?ji<le&&(be=st(Oe,Ht,nn,ln,_n,le),Te&&(Oe.start=ut+Se*be)):Ui(Oe,Ht,nn,It),ji<W&&Di>=W&&(be=st(Oe,Ht,nn,ln,_n,W),mr=!0),ji>le&&Di<=le&&(be=st(Oe,Ht,nn,ln,_n,le),mr=!0),!xe&&mr&&(Te&&(Oe.end=ut+Se*be),q.push(Oe),Oe=Jo(he)),Te&&(ut+=Se)}var Xi=he.length-3;Ht=he[Xi],nn=he[Xi+1],It=he[Xi+2],(Di=0===ge?Ht:nn)>=W&&Di<=le&&Ui(Oe,Ht,nn,It),Xi=Oe.length-3,xe&&Xi>=3&&(Oe[Xi]!==Oe[0]||Oe[Xi+1]!==Oe[1])&&Ui(Oe,Oe[0],Oe[1],Oe[2]),Oe.length&&q.push(Oe)}function Jo(he){var q=[];return q.size=he.size,q.start=he.start,q.end=he.end,q}function Ci(he,q,W,le,ge,xe){for(var Te=0;Te<he.length;Te++)zo(he[Te],q,W,le,ge,xe,!1)}function Ui(he,q,W,le){he.push(q),he.push(W),he.push(le)}function Ia(he,q,W,le,ge,xe){var Te=(xe-q)/(le-q);return he.push(xe),he.push(W+(ge-W)*Te),he.push(1),Te}function Pa(he,q,W,le,ge,xe){var Te=(xe-W)/(ge-W);return he.push(q+(le-q)*Te),he.push(xe),he.push(1),Te}function yi(he,q){for(var W=[],le=0;le<he.length;le++){var ge,xe=he[le],Te=xe.type;if("Point"===Te||"MultiPoint"===Te||"LineString"===Te)ge=Os(xe.geometry,q);else if("MultiLineString"===Te||"Polygon"===Te){ge=[];for(var Se=0;Se<xe.geometry.length;Se++)ge.push(Os(xe.geometry[Se],q))}else if("MultiPolygon"===Te)for(ge=[],Se=0;Se<xe.geometry.length;Se++){for(var be=[],Oe=0;Oe<xe.geometry[Se].length;Oe++)be.push(Os(xe.geometry[Se][Oe],q));ge.push(be)}W.push(gt(xe.id,Te,ge,xe.tags))}return W}function Os(he,q){var W=[];W.size=he.size,void 0!==he.start&&(W.start=he.start,W.end=he.end);for(var le=0;le<he.length;le+=3)W.push(he[le]+q,he[le+1],he[le+2]);return W}function yl(he,q){if(he.transformed)return he;var W,le,ge,xe=1<<he.z,Te=he.x,Se=he.y;for(W=0;W<he.features.length;W++){var be=he.features[W],Oe=be.geometry,st=be.type;if(be.geometry=[],1===st)for(le=0;le<Oe.length;le+=2)be.geometry.push(oa(Oe[le],Oe[le+1],q,xe,Te,Se));else for(le=0;le<Oe.length;le++){var ut=[];for(ge=0;ge<Oe[le].length;ge+=2)ut.push(oa(Oe[le][ge],Oe[le][ge+1],q,xe,Te,Se));be.geometry.push(ut)}}return he.transformed=!0,he}function oa(he,q,W,le,ge,xe){return[Math.round(W*(he*le-ge)),Math.round(W*(q*le-xe))]}function sa(he,q,W,le,ge){for(var xe=q===ge.maxZoom?0:ge.tolerance/((1<<q)*ge.extent),Te={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:W,y:le,z:q,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Se=0;Se<he.length;Se++){Te.numFeatures++,Vo(Te,he[Se],xe,ge);var be=he[Se].minX,Oe=he[Se].minY,st=he[Se].maxX,ut=he[Se].maxY;be<Te.minX&&(Te.minX=be),Oe<Te.minY&&(Te.minY=Oe),st>Te.maxX&&(Te.maxX=st),ut>Te.maxY&&(Te.maxY=ut)}return Te}function Vo(he,q,W,le){var ge=q.geometry,xe=q.type,Te=[];if("Point"===xe||"MultiPoint"===xe)for(var Se=0;Se<ge.length;Se+=3)Te.push(ge[Se]),Te.push(ge[Se+1]),he.numPoints++,he.numSimplified++;else if("LineString"===xe)Fs(Te,ge,he,W,!1,!1);else if("MultiLineString"===xe||"Polygon"===xe)for(Se=0;Se<ge.length;Se++)Fs(Te,ge[Se],he,W,"Polygon"===xe,0===Se);else if("MultiPolygon"===xe)for(var be=0;be<ge.length;be++){var Oe=ge[be];for(Se=0;Se<Oe.length;Se++)Fs(Te,Oe[Se],he,W,!0,0===Se)}if(Te.length){var st=q.tags||null;if("LineString"===xe&&le.lineMetrics){for(var ut in st={},q.tags)st[ut]=q.tags[ut];st.mapbox_clip_start=ge.start/ge.size,st.mapbox_clip_end=ge.end/ge.size}var ot={geometry:Te,type:"Polygon"===xe||"MultiPolygon"===xe?3:"LineString"===xe||"MultiLineString"===xe?2:1,tags:st};null!==q.id&&(ot.id=q.id),he.features.push(ot)}}function Fs(he,q,W,le,ge,xe){var Te=le*le;if(le>0&&q.size<(ge?Te:le))W.numPoints+=q.length/3;else{for(var Se=[],be=0;be<q.length;be+=3)(0===le||q[be+2]>Te)&&(W.numSimplified++,Se.push(q[be]),Se.push(q[be+1])),W.numPoints++;ge&&function(Oe,st){for(var ut=0,ot=0,Ht=Oe.length,nn=Ht-2;ot<Ht;nn=ot,ot+=2)ut+=(Oe[ot]-Oe[nn])*(Oe[ot+1]+Oe[nn+1]);if(ut>0===st)for(ot=0,Ht=Oe.length;ot<Ht/2;ot+=2){var It=Oe[ot],ln=Oe[ot+1];Oe[ot]=Oe[Ht-2-ot],Oe[ot+1]=Oe[Ht-1-ot],Oe[Ht-2-ot]=It,Oe[Ht-1-ot]=ln}}(Se,xe),he.push(Se)}}function aa(he,q){var W=(q=this.options=function(ge,xe){for(var Te in xe)ge[Te]=xe[Te];return ge}(Object.create(this.options),q)).debug;if(W&&console.time("preprocess data"),q.maxZoom<0||q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(q.promoteId&&q.generateId)throw new Error("promoteId and generateId cannot be used together.");var ge,xe,Te,Se,be,Oe,le=function(ge,xe){var Te=[];if("FeatureCollection"===ge.type)for(var Se=0;Se<ge.features.length;Se++)Vi(Te,ge.features[Se],xe,Se);else Vi(Te,"Feature"===ge.type?ge:{geometry:ge},xe);return Te}(he,q);this.tiles={},this.tileCoords=[],W&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",q.indexMaxZoom,q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Se=ge=le,be=an(ge,1,-1-(Te=(xe=q).buffer/xe.extent),Te,0,-1,2,xe),Oe=an(ge,1,1-Te,2+Te,0,-1,2,xe),(be||Oe)&&(Se=an(ge,1,-Te,1+Te,0,-1,2,xe)||[],be&&(Se=yi(be,1).concat(Se)),Oe&&(Se=Se.concat(yi(Oe,-1)))),(le=Se).length&&this.splitTile(le,0,0,0),W&&(le.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function la(he,q,W){return 32*((1<<he)*W+q)+he}function bo(he,q){const W=he.tileID.canonical;if(!this._geoJSONIndex)return q(null,null);const le=this._geoJSONIndex.getTile(W.z,W.x,W.y);if(!le)return q(null,null);const ge=new class{constructor(Te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=f.EXTENT,this.length=Te.length,this._features=Te}feature(Te){return new class{constructor(Se){this._feature=Se,this.extent=f.EXTENT,this.type=Se.type,this.properties=Se.tags,"id"in Se&&!isNaN(Se.id)&&(this.id=parseInt(Se.id,10))}loadGeometry(){if(1===this._feature.type){const Se=[];for(const be of this._feature.geometry)Se.push([new f.Point(be[0],be[1])]);return Se}{const Se=[];for(const be of this._feature.geometry){const Oe=[];for(const st of be)Oe.push(new f.Point(st[0],st[1]));Se.push(Oe)}return Se}}toGeoJSON(Se,be,Oe){return er.call(this,Se,be,Oe)}}(this._features[Te])}}(le.features);let xe=Is(ge);0===xe.byteOffset&&xe.byteLength===xe.buffer.byteLength||(xe=new Uint8Array(xe)),q(null,{vectorTile:ge,rawData:xe.buffer})}aa.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},aa.prototype.splitTile=function(he,q,W,le,ge,xe,Te){for(var Se=[he,q,W,le],be=this.options,Oe=be.debug;Se.length;){le=Se.pop(),W=Se.pop(),q=Se.pop(),he=Se.pop();var st=1<<q,ut=la(q,W,le),ot=this.tiles[ut];if(!ot&&(Oe>1&&console.time("creation"),ot=this.tiles[ut]=sa(he,q,W,le,be),this.tileCoords.push({z:q,x:W,y:le}),Oe)){Oe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",q,W,le,ot.numFeatures,ot.numPoints,ot.numSimplified),console.timeEnd("creation"));var Ht="z"+q;this.stats[Ht]=(this.stats[Ht]||0)+1,this.total++}if(ot.source=he,ge){if(q===be.maxZoom||q===ge)continue;var nn=1<<ge-q;if(W!==Math.floor(xe/nn)||le!==Math.floor(Te/nn))continue}else if(q===be.indexMaxZoom||ot.numPoints<=be.indexMaxPoints)continue;if(ot.source=null,0!==he.length){Oe>1&&console.time("clipping");var It,ln,_n,Di,ji,mr,Xi=.5*be.buffer/be.extent,Uo=.5-Xi,Qn=.5+Xi,Cr=1+Xi;It=ln=_n=Di=null,ji=an(he,st,W-Xi,W+Qn,0,ot.minX,ot.maxX,be),mr=an(he,st,W+Uo,W+Cr,0,ot.minX,ot.maxX,be),he=null,ji&&(It=an(ji,st,le-Xi,le+Qn,1,ot.minY,ot.maxY,be),ln=an(ji,st,le+Uo,le+Cr,1,ot.minY,ot.maxY,be),ji=null),mr&&(_n=an(mr,st,le-Xi,le+Qn,1,ot.minY,ot.maxY,be),Di=an(mr,st,le+Uo,le+Cr,1,ot.minY,ot.maxY,be),mr=null),Oe>1&&console.timeEnd("clipping"),Se.push(It||[],q+1,2*W,2*le),Se.push(ln||[],q+1,2*W,2*le+1),Se.push(_n||[],q+1,2*W+1,2*le),Se.push(Di||[],q+1,2*W+1,2*le+1)}}},aa.prototype.getTile=function(he,q,W){var le=this.options,ge=le.extent,xe=le.debug;if(he<0||he>24)return null;var Te=1<<he,Se=la(he,q=(q%Te+Te)%Te,W);if(this.tiles[Se])return yl(this.tiles[Se],ge);xe>1&&console.log("drilling down to z%d-%d-%d",he,q,W);for(var be,Oe=he,st=q,ut=W;!be&&Oe>0;)Oe--,st=Math.floor(st/2),ut=Math.floor(ut/2),be=this.tiles[la(Oe,st,ut)];return be&&be.source?(xe>1&&console.log("found parent tile z%d-%d-%d",Oe,st,ut),xe>1&&console.time("drilling down"),this.splitTile(be.source,Oe,st,ut,he,q,W),xe>1&&console.timeEnd("drilling down"),this.tiles[Se]?yl(this.tiles[Se],ge):null):null};class vl extends f.VectorTileWorkerSource{constructor(q,W,le,ge,xe){super(q,W,le,ge,bo),xe&&(this.loadGeoJSON=xe)}loadData(q,W){const le=q&&q.request,ge=le&&le.collectResourceTiming;this.loadGeoJSON(q,(xe,Te)=>{if(xe||!Te)return W(xe);if("object"!=typeof Te)return W(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));{si(Te,!0);try{if(q.filter){const be=f.createExpression(q.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===be.result)throw new Error(be.value.map(st=>`${st.key}: ${st.message}`).join(", "));Te={type:"FeatureCollection",features:Te.features.filter(st=>be.value.evaluate({zoom:0},st))}}this._geoJSONIndex=q.cluster?new Ei(function({superclusterOptions:be,clusterProperties:Oe}){if(!Oe||!be)return be;const st={},ut={},ot={accumulated:null,zoom:0},Ht={properties:null},nn=Object.keys(Oe);for(const It of nn){const[ln,_n]=Oe[It],Di=f.createExpression(_n),ji=f.createExpression("string"==typeof ln?[ln,["accumulated"],["get",It]]:ln);st[It]=Di.value,ut[It]=ji.value}return be.map=It=>{Ht.properties=It;const ln={};for(const _n of nn)ln[_n]=st[_n].evaluate(ot,Ht);return ln},be.reduce=(It,ln)=>{Ht.properties=ln;for(const _n of nn)ot.accumulated=It[_n],It[_n]=ut[_n].evaluate(ot,Ht)},be}(q)).load(Te.features):new aa(be=Te,q.geojsonVtOptions)}catch(be){return W(be)}this.loaded={};const Se={};if(ge){const be=f.getPerformanceMeasurement(le);be&&(Se.resourceTiming={},Se.resourceTiming[q.source]=JSON.parse(JSON.stringify(be)))}W(null,Se)}var be})}reloadTile(q,W){const le=this.loaded;return le&&le[q.uid]?super.reloadTile(q,W):this.loadTile(q,W)}loadGeoJSON(q,W){if(q.request)f.getJSON(q.request,W);else{if("string"!=typeof q.data)return W(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`));try{return W(null,JSON.parse(q.data))}catch{return W(new Error(`Input data given to '${q.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(q,W){try{W(null,this._geoJSONIndex.getClusterExpansionZoom(q.clusterId))}catch(le){W(le)}}getClusterChildren(q,W){try{W(null,this._geoJSONIndex.getChildren(q.clusterId))}catch(le){W(le)}}getClusterLeaves(q,W){try{W(null,this._geoJSONIndex.getLeaves(q.clusterId,q.limit,q.offset))}catch(le){W(le)}}}class Fc{constructor(q){this.self=q,this.actor=new f.Actor(q,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=f.getProjection({name:"mercator"}),this.workerSourceTypes={vector:f.VectorTileWorkerSource,geojson:vl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(W,le)=>{if(this.workerSourceTypes[W])throw new Error(`Worker source with name "${W}" already registered.`);this.workerSourceTypes[W]=le},this.self.registerRTLTextPlugin=W=>{if(f.plugin.isParsed())throw new Error("RTL text plugin already registered.");f.plugin.applyArabicShaping=W.applyArabicShaping,f.plugin.processBidirectionalText=W.processBidirectionalText,f.plugin.processStyledBidirectionalText=W.processStyledBidirectionalText}}clearCaches(q,W,le){delete this.layerIndexes[q],delete this.availableImages[q],delete this.workerSources[q],delete this.demWorkerSources[q],le()}checkIfReady(q,W,le){le()}setReferrer(q,W){this.referrer=W}spriteLoaded(q,W){this.isSpriteLoaded[q]=W;for(const le in this.workerSources[q]){const ge=this.workerSources[q][le];for(const xe in ge)ge[xe]instanceof f.VectorTileWorkerSource&&(ge[xe].isSpriteLoaded=W,ge[xe].fire(new f.Event("isSpriteLoaded")))}}setImages(q,W,le){this.availableImages[q]=W;for(const ge in this.workerSources[q]){const xe=this.workerSources[q][ge];for(const Te in xe)xe[Te].availableImages=W}le()}enableTerrain(q,W,le){this.terrain=W,le()}setProjection(q,W){this.projections[q]=f.getProjection(W)}setLayers(q,W,le){this.getLayerIndex(q).replace(W),le()}updateLayers(q,W,le){this.getLayerIndex(q).update(W.layers,W.removedIds),le()}loadTile(q,W,le){const ge=this.enableTerrain?f.extend({enableTerrain:this.terrain},W):W;ge.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,W.type,W.source).loadTile(ge,le)}loadDEMTile(q,W,le){const ge=this.enableTerrain?f.extend({buildQuadTree:this.terrain},W):W;this.getDEMWorkerSource(q,W.source).loadTile(ge,le)}reloadTile(q,W,le){const ge=this.enableTerrain?f.extend({enableTerrain:this.terrain},W):W;ge.projection=this.projections[q]||this.defaultProjection,this.getWorkerSource(q,W.type,W.source).reloadTile(ge,le)}abortTile(q,W,le){this.getWorkerSource(q,W.type,W.source).abortTile(W,le)}removeTile(q,W,le){this.getWorkerSource(q,W.type,W.source).removeTile(W,le)}removeSource(q,W,le){if(!this.workerSources[q]||!this.workerSources[q][W.type]||!this.workerSources[q][W.type][W.source])return;const ge=this.workerSources[q][W.type][W.source];delete this.workerSources[q][W.type][W.source],void 0!==ge.removeSource?ge.removeSource(W,le):le()}loadWorkerSource(q,W,le){try{this.self.importScripts(W.url),le()}catch(ge){le(ge.toString())}}syncRTLPluginState(q,W,le){try{f.plugin.setState(W);const ge=f.plugin.getPluginURL();if(f.plugin.isLoaded()&&!f.plugin.isParsed()&&null!=ge){this.self.importScripts(ge);const xe=f.plugin.isParsed();le(xe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${ge}`),xe)}}catch(ge){le(ge.toString())}}getAvailableImages(q){let W=this.availableImages[q];return W||(W=[]),W}getLayerIndex(q){let W=this.layerIndexes[q];return W||(W=this.layerIndexes[q]=new Xo),W}getWorkerSource(q,W,le){return this.workerSources[q]||(this.workerSources[q]={}),this.workerSources[q][W]||(this.workerSources[q][W]={}),this.workerSources[q][W][le]||(this.workerSources[q][W][le]=new this.workerSourceTypes[W]({send:(xe,Te,Se,be,Oe,st)=>{this.actor.send(xe,Te,Se,q,Oe,st)},scheduler:this.actor.scheduler},this.getLayerIndex(q),this.getAvailableImages(q),this.isSpriteLoaded[q])),this.workerSources[q][W][le]}getDEMWorkerSource(q,W){return this.demWorkerSources[q]||(this.demWorkerSources[q]={}),this.demWorkerSources[q][W]||(this.demWorkerSources[q][W]=new $t),this.demWorkerSources[q][W]}enforceCacheSizeLimit(q,W){f.enforceCacheSizeLimit(W)}getWorkerPerformanceMetrics(q,W,le){le(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Fc(self)),Fc}),Oc(0,function(f){function Ke(m,l){if(Array.isArray(m)){if(!Array.isArray(l)||m.length!==l.length)return!1;for(let h=0;h<m.length;h++)if(!Ke(m[h],l[h]))return!1;return!0}if("object"==typeof m&&null!==m&&null!==l){if("object"!=typeof l||Object.keys(m).length!==Object.keys(l).length)return!1;for(const h in m)if(!Ke(m[h],l[h]))return!1;return!0}return m===l}var je=Xo;function Xo(m){return l=m,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,x,w=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(w);try{x=new Worker(T),_=!0}catch{_=!1}return x&&x.terminate(),URL.revokeObjectURL(T),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var x=_.getContext("2d");if(!x)return!1;var w=x.getImageData(0,0,1,1);return w&&w.width===_.width}()||(void 0===$t[h=l&&l.failIfMajorPerformanceCaveat]&&($t[h]=function(_){var x,T,S,P,w=(T=_,S=document.createElement("canvas"),(P=Object.create(Xo.webGLContextAttributes)).failIfMajorPerformanceCaveat=T,S.getContext("webgl",P)||S.getContext("experimental-webgl",P));if(!w)return!1;try{x=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!x||w.isContextLost())&&(w.shaderSource(x,"void main() {}"),w.compileShader(x),!0===w.getShaderParameter(x,w.COMPILE_STATUS))}(h)),!$t[h]||document.documentMode));var l,h}var $t={};function Wt(m,l,h){const _=f.window.document.createElement(m);return void 0!==l&&(_.className=l),h&&h.appendChild(_),_}function zi(m,l,h){const _=f.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const x of Object.keys(l))_.setAttributeNS(null,x,l[x]);return h&&h.appendChild(_),_}Xo.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const si=f.window.document&&f.window.document.documentElement.style,er=si&&void 0!==si.userSelect?"userSelect":"WebkitUserSelect";let ds;function Ql(){si&&er&&(ds=si[er],si[er]="none")}function _l(){si&&er&&(si[er]=ds)}function Er(m){m.preventDefault(),m.stopPropagation(),f.window.removeEventListener("click",Er,!0)}function Qr(){f.window.addEventListener("click",Er,!0),f.window.setTimeout(()=>{f.window.removeEventListener("click",Er,!0)},0)}function ur(m,l){const h=m.getBoundingClientRect();return zr(m,h,l)}function As(m,l){const h=m.getBoundingClientRect(),_=[];for(let x=0;x<l.length;x++)_.push(zr(m,h,l[x]));return _}function ki(m){return void 0!==f.window.InstallTrigger&&2===m.button&&m.ctrlKey&&f.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function zr(m,l,h){const _=m.offsetWidth===l.width?1:m.offsetWidth/l.width;return new f.Point((h.clientX-l.left)*_,(h.clientY-l.top)*_)}function ct(m,l){var h=l[0],_=l[1],x=l[2],w=l[3],T=h*w-x*_;return T?(m[0]=w*(T=1/T),m[1]=-_*T,m[2]=-x*T,m[3]=h*T,m):null}function ti(m){const{userImage:l}=m;return!!(l&&l.render&&l.render())&&(m.data.replace(new Uint8Array(l.data.buffer)),!0)}class Ko extends f.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new f.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(const{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(l){return!!this.getImage(l)}getImage(l){return this.images[l]}addImage(l,h){this._validate(l,h)&&(this.images[l]=h)}_validate(l,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new f.ErrorEvent(new Error(`Image "${l}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new f.ErrorEvent(new Error(`Image "${l}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new f.ErrorEvent(new Error(`Image "${l}" has invalid "content" value`))),_=!1),_}_validateStretch(l,h){if(!l)return!0;let _=0;for(const x of l){if(x[0]<_||x[1]<x[0]||h<x[1])return!1;_=x[1]}return!0}_validateContent(l,h){return!(l&&(4!==l.length||l[0]<0||h.data.width<l[0]||l[1]<0||h.data.height<l[1]||l[2]<0||h.data.width<l[2]||l[3]<0||h.data.height<l[3]||l[2]<l[0]||l[3]<l[1]))}updateImage(l,h){h.version=this.images[l].version+1,this.images[l]=h,this.updatedImages[l]=!0}removeImage(l){const h=this.images[l];delete this.images[l],delete this.patterns[l],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,h){let _=!0;if(!this.isLoaded())for(const x of l)this.images[x]||(_=!1);this.isLoaded()||_?this._notify(l,h):this.requestors.push({ids:l,callback:h})}_notify(l,h){const _={};for(const x of l){this.images[x]||this.fire(new f.Event("styleimagemissing",{id:x}));const w=this.images[x];w?_[x]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:Boolean(w.userImage&&w.userImage.render)}:f.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){const{width:l,height:h}=this.atlasImage;return{width:l,height:h}}getPattern(l){const h=this.patterns[l],_=this.getImage(l);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{const x={w:_.data.width+2,h:_.data.height+2,x:0,y:0},w=new f.ImagePosition(x,_);this.patterns[l]={bin:x,position:w}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){const h=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new f.Texture(l,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const l=[];for(const w in this.patterns)l.push(this.patterns[w].bin);const{w:h,h:_}=f.potpack(l),x=this.atlasImage;x.resize({width:h||1,height:_||1});for(const w in this.patterns){const{bin:T}=this.patterns[w],S=T.x+1,P=T.y+1,B=this.images[w].data,N=B.width,j=B.height;f.RGBAImage.copy(B,x,{x:0,y:0},{x:S,y:P},{width:N,height:j}),f.RGBAImage.copy(B,x,{x:0,y:j-1},{x:S,y:P-1},{width:N,height:1}),f.RGBAImage.copy(B,x,{x:0,y:0},{x:S,y:P+j},{width:N,height:1}),f.RGBAImage.copy(B,x,{x:N-1,y:0},{x:S-1,y:P},{width:1,height:j}),f.RGBAImage.copy(B,x,{x:0,y:0},{x:S+N,y:P},{width:1,height:j})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(const h of l){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const _=this.images[h];ti(_)&&this.updateImage(h,_)}}}const cn=new f.Properties({anchor:new f.DataConstantProperty(f.spec.light.anchor),position:new class{constructor(){this.specification=f.spec.light.position}possiblyEvaluate(m,l){return function([h,_,x]){const w=f.degToRad(_+90),T=f.degToRad(x);return{x:h*Math.cos(w)*Math.sin(T),y:h*Math.sin(w)*Math.sin(T),z:h*Math.cos(T),azimuthal:_,polar:x}}(m.expression.evaluate(l))}interpolate(m,l,h){return{x:f.number(m.x,l.x,h),y:f.number(m.y,l.y,h),z:f.number(m.z,l.z,h),azimuthal:f.number(m.azimuthal,l.azimuthal,h),polar:f.number(m.polar,l.polar,h)}}},color:new f.DataConstantProperty(f.spec.light.color),intensity:new f.DataConstantProperty(f.spec.light.intensity)});class tr extends f.Evented{constructor(l){super(),this._transitionable=new f.Transitionable(cn),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,h={}){if(!this._validate(f.validateLight,l,h))for(const _ in l){const x=l[_];f.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),x):this._transitionable.setValue(_,x)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||!1!==_.validate)&&f.emitValidationErrors(this,l.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}const ra=new f.Properties({source:new f.DataConstantProperty(f.spec.terrain.source),exaggeration:new f.DataConstantProperty(f.spec.terrain.exaggeration)});let ec=class extends f.Evented{constructor(m,l){super(),this._transitionable=new f.Transitionable(ra),this.set(m),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=l}get(){return this._transitionable.serialize()}set(m){for(const l in m){const h=m[l];f.endsWith(l,"-transition")?this._transitionable.setTransition(l.slice(0,-11),h):this._transitionable.setValue(l,h)}}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}};function Is(m,l,h,_){const x=f.smoothstep(45,65,h),[w,T]=eo(m,_),S=f.length(l);let P=1-Math.min(1,Math.exp((S-w)/(T-w)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*x*m.alpha}function eo(m,l){const h=.5/Math.tan(.5*l);return[m.range[0]+h,m.range[1]+h]}const zt=new f.Properties({range:new f.DataConstantProperty(f.spec.fog.range),color:new f.DataConstantProperty(f.spec.fog.color),"high-color":new f.DataConstantProperty(f.spec.fog["high-color"]),"space-color":new f.DataConstantProperty(f.spec.fog["space-color"]),"horizon-blend":new f.DataConstantProperty(f.spec.fog["horizon-blend"]),"star-intensity":new f.DataConstantProperty(f.spec.fog["star-intensity"])});class yo extends f.Evented{constructor(l,h){super(),this._transitionable=new f.Transitionable(zt),this.set(l),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const l=this._transform,h="globe"===l.projection.name,_=f.globeToMercatorTransition(l.zoom),x=this.properties.get("range"),w=[.5,3];return{range:h?[f.number(w[0],x[0],_),f.number(w[1],x[1],_)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(l,h={}){if(!this._validate(f.validateFog,l,h)){for(const _ of Object.keys(f.spec.fog))l&&void 0===l[_]&&(l[_]=f.spec.fog[_].default);for(const _ in l){const x=l[_];f.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),x):this._transitionable.setValue(_,x)}}}getOpacity(l){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:f.smoothstep(45,65,l))*h.a}getOpacityAtLatLng(l,h){return this._transform.projection.supportsFog?function(_,x,w){const T=f.MercatorCoordinate.fromLngLat(x),S=w.elevation?w.elevation.getAtPointOrZero(T):0,P=[T.x,T.y,S];return f.transformMat4(P,P,w.mercatorFogMatrix),Is(_,P,w.pitch,w._fov)}(this.state,l,h):0}getFovAdjustedRange(l){return this._transform.projection.supportsFog?eo(this.state,l):[0,1]}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,h,_){return(!_||!1!==_.validate)&&f.emitValidationErrors(this,l.call(f.validateStyle,f.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:f.spec})))}}class Lt{constructor(l,h){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=f.uniqueId();const _=this.workerPool.acquire(this.id);for(let x=0;x<_.length;x++){const w=new Lt.Actor(_[x],h,this.id);w.name=`Worker ${x}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(l,h,_){f.asyncAll(this.actors,(x,w)=>{x.send(l,h,w)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(l=>{l.remove()}),this.actors=[],this.workerPool.release(this.id)}}function nr(m,l,h){return l*(f.EXTENT/(m.tileSize*Math.pow(2,h-m.tileID.overscaledZ)))}Lt.Actor=f.Actor;class vo{constructor(l,h,_,x){this.screenBounds=l,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(l,h){let _,x;if(l instanceof f.Point||"number"==typeof l[0]){const w=f.Point.convert(l);_=[w],x=h.isPointAboveHorizon(w)}else{const w=f.Point.convert(l[0]),T=f.Point.convert(l[1]);_=[w,T],x=f.polygonizeBounds(w,T).every(S=>h.isPointAboveHorizon(S))}return new vo(_,h.getCameraPoint(),x,h)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(l){return f.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],l)}bufferedCameraGeometry(l){const h=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new f.Point(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?x[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(x[3]=this.cameraPoint)),f.bufferConvexPolygon(x,l)}bufferedCameraGeometryGlobe(l){const h=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new f.Point(1,1)):this.screenBounds[1],x=f.polygonizeBounds(h,_,l),w=this.cameraPoint.clone();switch(3*((w.y>h.y)+(w.y>_.y))+((w.x>h.x)+(w.x>_.x))){case 0:x[0]=w,x[4]=w.clone();break;case 1:x.splice(1,0,w);break;case 2:x[1]=w;break;case 3:x.splice(4,0,w);break;case 5:x.splice(2,0,w);break;case 6:x[3]=w;break;case 7:x.splice(3,0,w);break;case 8:x[2]=w}return x}containsTile(l,h,_,x=0){const w=l.queryPadding/h._pixelsPerMercatorPixel+1,T=_?this._bufferedCameraMercator(w,h):this._bufferedScreenMercator(w,h);let S=l.tileID.wrap+(T.unwrapped?x:0);const P=T.polygon.map(re=>f.getTilePoint(l.tileTransform,re,S));if(!f.polygonIntersectsBox(P,0,0,f.EXTENT,f.EXTENT))return;S=l.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const B=this.screenGeometryMercator.polygon.map(re=>f.getTileVec3(l.tileTransform,re,S)),N=B.map(re=>new f.Point(re[0],re[1])),j=h.getFreeCameraOptions().position||new f.MercatorCoordinate(0,0,0),X=f.getTileVec3(l.tileTransform,j,S),J=B.map(re=>{const $=f.sub(re,re,X);return f.normalize($,$),new f.Ray(X,$)}),te=nr(l,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:N,tilespaceRays:J,bufferedTilespaceGeometry:P,bufferedTilespaceBounds:(ee=f.getBounds(P),ee.min.x=f.clamp(ee.min.x,0,f.EXTENT),ee.min.y=f.clamp(ee.min.y,0,f.EXTENT),ee.max.x=f.clamp(ee.max.x,0,f.EXTENT),ee.max.y=f.clamp(ee.max.y,0,f.EXTENT),ee),tile:l,tileID:l.tileID,pixelToTileUnitsFactor:te};var ee}_bufferedScreenMercator(l,h){const _=mn(l);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedScreenGeometry(l),h):{polygon:this.bufferedScreenGeometry(l).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._screenRaycastCache[_]=x,x}}_bufferedCameraMercator(l,h){const _=mn(l);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let x;return x="globe"===h.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(l),h):{polygon:this.bufferedCameraGeometry(l).map(w=>h.pointCoordinate3D(w)),unwrapped:!0},this._cameraRaycastCache[_]=x,x}}_projectAndResample(l,h){const _=function(w,T){const S=f.multiply([],T.pixelMatrix,T.globeMatrix),P=[0,-f.GLOBE_RADIUS,0,1],B=[0,f.GLOBE_RADIUS,0,1],N=[0,0,0,1];f.transformMat4$1(P,P,S),f.transformMat4$1(B,B,S),f.transformMat4$1(N,N,S);const j=new f.Point(P[0]/P[3],P[1]/P[3]),X=new f.Point(B[0]/B[3],B[1]/B[3]),J=f.polygonContainsPoint(w,j)&&P[3]<N[3],te=f.polygonContainsPoint(w,X)&&B[3]<N[3];if(!J&&!te)return null;const ee=function(ye,Ce,we){for(let ke=1;ke<ye.length;ke++){const tt=Ps(Ce.pointCoordinate3D(ye[ke-1]).x),Ie=Ps(Ce.pointCoordinate3D(ye[ke]).x);if(we<0){if(tt<Ie)return{idx:ke,t:-tt/(Ie-1-tt)}}else if(Ie<tt)return{idx:ke,t:(1-tt)/(Ie+1-tt)}}return null}(w,T,J?-1:1);if(!ee)return null;const{idx:re,t:$}=ee;let Y=re>1?Ei(w.slice(0,re),T):[],ae=re<w.length?Ei(w.slice(re),T):[];Y=Y.map(ye=>new f.Point(Ps(ye.x),ye.y)),ae=ae.map(ye=>new f.Point(Ps(ye.x),ye.y));const oe=[...Y];0===oe.length&&oe.push(ae[ae.length-1]);const _e=f.number(oe[oe.length-1].y,(0===ae.length?Y[0]:ae[0]).y,$);let ve;return ve=J?[new f.Point(0,_e),new f.Point(0,0),new f.Point(1,0),new f.Point(1,_e)]:[new f.Point(1,_e),new f.Point(1,1),new f.Point(0,1),new f.Point(0,_e)],oe.push(...ve),0===ae.length?oe.push(Y[0]):oe.push(...ae),{polygon:oe.map(ye=>new f.MercatorCoordinate(ye.x,ye.y)),unwrapped:!1}}(l,h);if(_)return _;const x=function(w,T){let S=!1,P=-1/0,B=0;for(let j=0;j<w.length-1;j++)w[j].x>P&&(P=w[j].x,B=j);for(let j=0;j<w.length-1;j++){const X=(B+j)%(w.length-1),J=w[X],te=w[X+1];Math.abs(J.x-te.x)>.5&&(J.x<te.x?(J.x+=1,0===X&&(w[w.length-1].x+=1)):(te.x+=1,X+1===w.length-1&&(w[0].x+=1)),S=!0)}const N=f.mercatorXfromLng(T.center.lng);return S&&N<Math.abs(N-1)&&w.forEach(j=>{j.x-=1}),{polygon:w,unwrapped:S}}(Ei(l,h).map(w=>new f.Point(Ps(w.x),w.y)),h);return{polygon:x.polygon.map(w=>new f.MercatorCoordinate(w.x,w.y)),unwrapped:x.unwrapped}}}function Ei(m,l){return f.resample(m,h=>{const _=l.pointCoordinate3D(h);h.x=_.x,h.y=_.y},1/256)}function Ps(m){return m<0?1+m%1:m%1}function mn(m){return 100*m|0}function Yo(m,l,h,_,x){const w=function(T,S){if(T)return x(T);if(S){m.url&&S.tiles&&m.tiles&&delete m.tiles;const P=f.pick(f.extend(S,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);S.vector_layers&&(P.vectorLayers=S.vector_layers,P.vectorLayerIds=P.vectorLayers.map(B=>B.id)),P.tiles=l.canonicalizeTileset(P,m.url),x(null,P)}};return m.url?f.getJSON(l.transformRequest(l.normalizeSourceURL(m.url,null,h,_),f.ResourceType.Source),w):f.exported.frame(()=>w(null,m))}class fs{constructor(l,h,_){this.bounds=f.LngLatBounds.convert(this.validateBounds(l)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(l){return Array.isArray(l)&&4===l.length?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){const h=Math.pow(2,l.z),_=Math.floor(f.mercatorXfromLng(this.bounds.getWest())*h),x=Math.floor(f.mercatorYfromLat(this.bounds.getNorth())*h),w=Math.ceil(f.mercatorXfromLng(this.bounds.getEast())*h),T=Math.ceil(f.mercatorYfromLat(this.bounds.getSouth())*h);return l.x>=_&&l.x<w&&l.y>=x&&l.y<T}}class ni{constructor(l,h,_){this.context=l;const x=l.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ln={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ks{constructor(l,h,_,x){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=x,this.context=l;const w=l.gl;this.buffer=w.createBuffer(),l.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,h){for(let _=0;_<this.attributes.length;_++){const x=h.attributes[this.attributes[_].name];void 0!==x&&l.enableVertexAttribArray(x)}}setVertexAttribPointers(l,h,_){for(let x=0;x<this.attributes.length;x++){const w=this.attributes[x],T=h.attributes[w.name];void 0!==T&&l.vertexAttribPointer(T,w.components,l[Ln[w.type]],!1,this.itemSize,w.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class gt{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Zi extends gt{getDefault(){return f.Color.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Vi extends gt{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class Aa extends gt{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class Tn extends gt{getDefault(){return[!0,!0,!0,!0]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class to extends gt{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class tc extends gt{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class Rs extends gt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){const h=this.current;(l.func!==h.func||l.ref!==h.ref||l.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class an extends gt{getDefault(){const l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class xo extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=l,this.dirty=!1}}class zo extends gt{getDefault(){return[0,1]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class Jo extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=l,this.dirty=!1}}class Ci extends gt{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class Ui extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.BLEND):h.disable(h.BLEND),this.current=l,this.dirty=!1}}class Ia extends gt{getDefault(){const l=this.gl;return[l.ONE,l.ZERO]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Pa extends gt{getDefault(){return f.Color.transparent}set(l){const h=this.current;(l.r!==h.r||l.g!==h.g||l.b!==h.b||l.a!==h.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class yi extends gt{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class Os extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;l?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=l,this.dirty=!1}}class yl extends gt{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class oa extends gt{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}let sa,Vo=class extends gt{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class Fs extends gt{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class aa extends gt{getDefault(){const l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){const h=this.current;(l[0]!==h[0]||l[1]!==h[1]||l[2]!==h[2]||l[3]!==h[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class la extends gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class bo extends gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class vl extends gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class Fc extends gt{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class he extends gt{getDefault(){return null}set(l){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class q extends gt{constructor(l){super(l),this.vao=l.extVertexArrayObject}getDefault(){return null}set(l){this.vao&&(l!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(l),this.current=l,this.dirty=!1)}}class W extends gt{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class le extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class ge extends gt{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class xe extends gt{constructor(l,h){super(l),this.context=l,this.parent=h}getDefault(){return null}}class Te extends xe{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class Se extends xe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class be extends Se{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Oe{constructor(l,h,_,x){this.context=l,this.width=h,this.height=_;const w=this.framebuffer=l.gl.createFramebuffer();this.colorAttachment=new Te(l,w),x&&(this.depthAttachment=new Se(l,w))}destroy(){const l=this.context.gl,h=this.colorAttachment.get();if(h&&l.deleteTexture(h),this.depthAttachment){const _=this.depthAttachment.get();_&&l.deleteRenderbuffer(_)}l.deleteFramebuffer(this.framebuffer)}}class st{constructor(l,h=!1){if(this.gl=l,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const _=l;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(l),deleteVertexArrayOES:_.deleteVertexArray.bind(l),bindVertexArrayOES:_.bindVertexArray.bind(l)}}this.clearColor=new Zi(this),this.clearDepth=new Vi(this),this.clearStencil=new Aa(this),this.colorMask=new Tn(this),this.depthMask=new to(this),this.stencilMask=new tc(this),this.stencilFunc=new Rs(this),this.stencilOp=new an(this),this.stencilTest=new xo(this),this.depthRange=new zo(this),this.depthTest=new Jo(this),this.depthFunc=new Ci(this),this.blend=new Ui(this),this.blendFunc=new Ia(this),this.blendColor=new Pa(this),this.blendEquation=new yi(this),this.cullFace=new Os(this),this.cullFaceSide=new yl(this),this.frontFace=new oa(this),this.program=new Vo(this),this.activeTexture=new Fs(this),this.viewport=new aa(this),this.bindFramebuffer=new la(this),this.bindRenderbuffer=new bo(this),this.bindTexture=new vl(this),this.bindVertexBuffer=new Fc(this),this.bindElementBuffer=new he(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new q(this),this.pixelStoreUnpack=new W(this),this.pixelStoreUnpackPremultiplyAlpha=new le(this),this.pixelStoreUnpackFlipY=new ge(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=l.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=l.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=l.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=l.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&l.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=l.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||l.getExtension("OES_standard_derivatives"),this.extTimerQuery=l.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,h){return new ni(this,l,h)}createVertexBuffer(l,h,_){return new ks(this,l,h,_)}createRenderbuffer(l,h,_){const x=this.gl,w=x.createRenderbuffer();return this.bindRenderbuffer.set(w),x.renderbufferStorage(x.RENDERBUFFER,l,h,_),this.bindRenderbuffer.set(null),w}createFramebuffer(l,h,_){return new Oe(this,l,h,_)}clear({color:l,depth:h,stencil:_}){const x=this.gl;let w=0;l&&(w|=x.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(w|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),void 0!==_&&(w|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),x.clear(w)}setCullFace(l){!1===l.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){Ke(l.blendFunction,f.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class ut extends f.Evented{constructor(l,h,_,x){if(super(),this.id=l,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,f.extend(this,f.pick(h,["url","scheme","tileSize","promoteId"])),this._options=f.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new f.DedupedRequest}load(l){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=Yo(this._options,this.map._requestManager,h,_,(x,w)=>{this._tileJSONRequest=null,this._loaded=!0,x?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&2!==_.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new f.ErrorEvent(x))):w&&(f.extend(this,w),w.bounds&&(this.tileBounds=new fs(w.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(w.tiles,this.map._requestManager._customAccessToken),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(x)})}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}loadTile(l,h){const _=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(_,f.ResourceType.Tile),data:void 0,uid:l.uid,tileID:l.tileID,tileZoom:l.tileZoom,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:l.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,l.actor&&"expired"!==l.state)"loading"===l.state?l.reloadCallback=h:l.request=l.actor.send("reloadTile",x,w.bind(this));else if(l.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)l.request=l.actor.send("loadTile",x,w.bind(this),void 0,!0);else{const T=f.loadVectorTile.call({deduped:this._deduped},x,(S,P)=>{S||!P?w.call(this,S):(x.data={cacheControl:P.cacheControl,expires:P.expires,rawData:P.rawData.slice(0)},l.actor&&l.actor.send("loadTile",x,w.bind(this),void 0,!0))},!0);l.request={cancel:T}}function w(T,S){return delete l.request,l.aborted?h(null):T&&404!==T.status?h(T):(S&&S.resourceTiming&&(l.resourceTiming=S.resourceTiming),this.map._refreshExpiredTiles&&S&&l.setExpiryData(S),l.loadVectorData(S,this.map.painter),f.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id})}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ot extends f.Evented{constructor(l,h,_,x){super(),this.id=l,this.dispatcher=_,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=f.extend({type:"raster"},h),f.extend(this,f.pick(h,["url","scheme","tileSize"]))}load(l){this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Yo(this._options,this.map._requestManager,null,null,(h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new f.ErrorEvent(h)):_&&(f.extend(this,_),_.bounds&&(this.tileBounds=new fs(_.bounds,this.minzoom,this.maxzoom)),f.postTurnstileEvent(_.tiles),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))),l&&l(h)})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(l){return this._options.tiles=l,this.reload(),this}setUrl(l){return this.url=l,this._options.url=l,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return f.extend({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,h){const _=f.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(l.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);l.request=f.getImage(this.map._requestManager.transformRequest(x,f.ResourceType.Tile),(w,T,S,P)=>(delete l.request,l.aborted?(l.state="unloaded",h(null)):w?(l.state="errored",h(w)):T?(this.map._refreshExpiredTiles&&l.setExpiryData({cacheControl:S,expires:P}),l.setTexture(T,this.map.painter),l.state="loaded",f.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(l,h,_){l.setTexture(h,_)}static unloadTileData(l,h){l.texture&&h.saveTileTexture(l.texture)}abortTile(l,h){l.request&&(l.request.cancel(),delete l.request),h()}unloadTile(l,h){l.texture&&this.map.painter.saveTileTexture(l.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ht(m,l,h,_,x,w,T,S){const P=[m,h,x,l,_,w,1,1,1],B=[T,S,1],N=f.adjoint([],P),[j,X,J]=f.transformMat3(B,B,f.transpose(N,N));return f.multiply$1(P,[j,0,0,0,X,0,0,0,J],P)}class nn extends f.Evented{constructor(l,h,_,x){super(),this.id=l,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=h,this._dirty=!1}load(l,h){this._loaded=h||!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=f.getImage(this.map._requestManager.transformRequest(this.url,f.ResourceType.Image),(_,x)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new f.ErrorEvent(_));else if(x){const{HTMLImageElement:w}=f.window;this.image=x instanceof w?f.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,l&&(this.coordinates=l),this._finishLoading()}})}loaded(){return this._loaded}updateImage(l){return this.image&&l.url?(this._imageRequest&&l.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=l.url,this.load(l.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(l){this.coordinates=l,this._boundsArray=void 0;const h=l.map(f.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let x=1/0,w=1/0,T=-1/0,S=-1/0;for(const j of _)x=Math.min(x,j.x),w=Math.min(w,j.y),T=Math.max(T,j.x),S=Math.max(S,j.y);const P=Math.max(T-x,S-w),B=Math.max(0,Math.floor(-Math.log(P)/Math.LN2)),N=Math.pow(2,B);return new f.CanonicalTileID(B,Math.floor((x+T)/2*N),Math.floor((w+S)/2*N))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(l){for(const P in this.tiles){const B=this.tiles[P];"loaded"!==B.state&&(B.state="loaded",B.texture=this.texture)}if(this._boundsArray)return;const h=f.tileTransform(this.tileID,this.map.transform.projection),[_,x,w,T]=this.coordinates.map(P=>{const B=h.projection.project(P[0],P[1]);return f.getTilePoint(h,B)._round()});this.perspectiveTransform=function(P,B,N,j,X,J,te,ee,re,$){const Y=Ht(0,0,P,0,0,B,P,B),ae=Ht(N,j,X,J,te,ee,re,$);return f.multiply$1(ae,f.adjoint(Y,Y),ae),[ae[6]/ae[8]*P/f.EXTENT,ae[7]/ae[8]*B/f.EXTENT]}(this.width,this.height,_.x,_.y,x.x,x.y,T.x,T.y,w.x,w.y);const S=this._boundsArray=new f.StructArrayLayout4i8;S.emplaceBack(_.x,_.y,0,0),S.emplaceBack(x.x,x.y,f.EXTENT,0),S.emplaceBack(T.x,T.y,0,f.EXTENT),S.emplaceBack(w.x,w.y,f.EXTENT,f.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=l.createVertexBuffer(S,f.boundsAttributes.members),this.boundsSegments=f.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const l=this.map.painter.context,h=l.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new f.Texture(l,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(l)}loadTile(l,h){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},h(null)):(l.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const It={vector:ut,raster:ot,"raster-dem":class extends ot{constructor(m,l,h,_){super(m,l,h,_),this.type="raster-dem",this.maxzoom=22,this._options=f.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}loadTile(m,l){const h=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(x,w){x&&(m.state="errored",l(x)),w&&(m.dem=w,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",l(null))}m.request=f.getImage(this.map._requestManager.transformRequest(h,f.ResourceType.Tile),function(x,w,T,S){if(delete m.request,m.aborted)m.state="unloaded",l(null);else if(x)m.state="errored",l(x);else if(w){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:T,expires:S});const P=f.window.ImageBitmap&&w instanceof f.window.ImageBitmap&&(null==sa&&(sa=f.window.OffscreenCanvas&&new f.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof f.window.createImageBitmap),sa),B=1-(w.width-f.prevPowerOfTwo(w.width))/2;B<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const N=P?w:f.exported.getImageData(w,B),j={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:N,encoding:this.encoding,padding:B};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",j,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const l=m.canonical,h=Math.pow(2,l.z),_=(l.x-1+h)%h,x=0===l.x?m.wrap-1:m.wrap,w=(l.x+1+h)%h,T=l.x+1===h?m.wrap+1:m.wrap,S={};return S[new f.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y).key]={backfilled:!1},S[new f.OverscaledTileID(m.overscaledZ,T,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(S[new f.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y-1).key]={backfilled:!1},S[new f.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},S[new f.OverscaledTileID(m.overscaledZ,T,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<h&&(S[new f.OverscaledTileID(m.overscaledZ,x,l.z,_,l.y+1).key]={backfilled:!1},S[new f.OverscaledTileID(m.overscaledZ,m.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},S[new f.OverscaledTileID(m.overscaledZ,T,l.z,w,l.y+1).key]={backfilled:!1}),S}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends f.Evented{constructor(m,l,h,_){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=l.data,this._options=f.extend({},l),this._collectResourceTiming=l.collectResourceTiming,void 0!==l.maxzoom&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;const x=f.EXTENT/this.tileSize;this.workerOptions=f.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(void 0!==l.buffer?l.buffer:128)*x,tolerance:(void 0!==l.tolerance?l.tolerance:.375)*x,extent:f.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:void 0!==l.clusterMaxZoom?l.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:f.EXTENT,radius:(void 0!==l.clusterRadius?l.clusterRadius:50)*x,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},l),this}getClusterChildren(m,l){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},l),this}getClusterLeaves(m,l,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:l,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new f.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=f.extend({},this.workerOptions),l=this._data;"string"==typeof l?(m.request=this.map._requestManager.transformRequest(f.exported.resolveURL(l),f.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(l),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new f.ErrorEvent(h));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),this.fire(new f.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,l){const h=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(h,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:f.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,x)=>(delete m.request,m.unloadVectorData(),m.aborted?l(null):_?l(_):(m.loadVectorData(x,this.map.painter,"reloadTile"===h),l(null))),void 0,"loadTile"===h)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return f.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends nn{constructor(m,l,h,_){super(m,l,h,_),this.roundZoom=!0,this.type="video",this.options=l}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const l of m.urls)this.urls.push(this.map._requestManager.transformRequest(l,f.ResourceType.Source).url);f.getVideo(this.urls,(l,h)=>{this._loaded=!0,l?this.fire(new f.ErrorEvent(l)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const l=this.video.seekable;m<l.start(0)||m>l.end(0)?this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${l.start(0)} and ${l.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,l=m.gl;this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new f.Texture(m,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:nn,canvas:class extends nn{constructor(m,l,h,_){super(m,l,h,_),l.coordinates?Array.isArray(l.coordinates)&&4===l.coordinates.length&&!l.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(w=>"number"!=typeof w))||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),l.animate&&"boolean"!=typeof l.animate&&this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),l.canvas?"string"==typeof l.canvas||l.canvas instanceof f.window.HTMLCanvasElement||this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new f.ErrorEvent(new f.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=l,this.animate=void 0===l.animate||l.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof f.window.HTMLCanvasElement?this.options.canvas:f.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new f.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const l=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new f.Texture(l,this.canvas,l.gl.RGBA,{premultiply:!0}),this._prepareData(l)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends f.Evented{constructor(m,l,h,_){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=l,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new f.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new f.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new fs(this._implementation.bounds,this.minzoom,this.maxzoom)),l.update=this._update.bind(this),l.clearTiles=this._clearTiles.bind(this),l.coveringTiles=this._coveringTiles.bind(this),f.extend(this,f.pick(l,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return f.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new f.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new f.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:l,y:h,z:_}=m.canonical;return this._implementation.hasTile({x:l,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,l){const{x:h,y:_,z:x}=m.tileID.canonical,w=new f.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:x},{signal:w.signal})).then(function(T){return delete m.request,m.aborted?(m.state="unloaded",l(null)):void 0===T?(m.state="errored",l(null)):null===T?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",l(null)):(S=T)instanceof f.window.ImageData||S instanceof f.window.HTMLCanvasElement||S instanceof f.window.ImageBitmap||S instanceof f.window.HTMLImageElement?(this.loadTileData(m,T),m.state="loaded",void l(null)):(m.state="errored",l(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var S}.bind(this)).catch(T=>{20!==T.code&&(m.state="errored",l(T))}),m.request.cancel=()=>w.abort()}loadTileData(m,l){ot.loadTileData(m,l,this._map.painter)}unloadTileData(m){ot.unloadTileData(m,this._map.painter)}unloadTile(m,l){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:h,y:_,z:x}=m.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:x})}l()}abortTile(m,l){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),l()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new f.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ln=function(m,l,h,_){const x=new It[l.type](m,l,h,_);if(x.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${x.id}`);return f.bindAll(["load","abort","unload","serialize","prepare"],x),x};function _n(m,l){const h=f.identity([]);return f.scale(h,h,[.5*m.width,.5*-m.height,1]),f.translate(h,h,[1,-1,0]),f.multiply(h,h,m.calculateProjMatrix(l.toUnwrapped())),Float32Array.from(h)}function Di(m,l,h,_,x,w,T,S=!1){const P=m.tilesIn(_,T,S);P.sort(mr);const B=[];for(const j of P)B.push({wrappedTileID:j.tile.tileID.wrapped().key,queryResults:j.tile.queryRenderedFeatures(l,h,m._state,j,x,w,_n(m.transform,j.tile.tileID),S)});const N=function(j){const X={},J={};for(const te of j){const ee=te.queryResults,re=te.wrappedTileID,$=J[re]=J[re]||{};for(const Y in ee){const ae=ee[Y],oe=$[Y]=$[Y]||{},_e=X[Y]=X[Y]||[];for(const ve of ae)oe[ve.featureIndex]||(oe[ve.featureIndex]=!0,_e.push(ve))}}return X}(B);for(const j in N)N[j].forEach(X=>{const J=X.feature,te=J.layer;te&&"background"!==te.type&&"sky"!==te.type&&(J.source=te.source,te["source-layer"]&&(J.sourceLayer=te["source-layer"]),J.state=void 0!==J.id?m.getFeatureState(te["source-layer"],J.id):{})});return N}function ji(m,l){const h=m.getRenderableIds().map(w=>m.getTileByID(w)),_=[],x={};for(let w=0;w<h.length;w++){const T=h[w],S=T.tileID.canonical.key;x[S]||(x[S]=!0,T.querySourceFeatures(_,l))}return _}function mr(m,l){const h=m.tileID,_=l.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function Xi(){return null!=Go.workerClass?new Go.workerClass:new f.window.Worker(Go.workerUrl)}const Uo="mapboxgl_preloaded_worker_pool";class Qn{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Qn.workerCount;)this.workers.push(new Xi);return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],0===this.numActive()&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Uo]}numActive(){return Object.keys(this.active).length}}let Cr;function pi(){return Cr||(Cr=new Qn),Cr}function ir(m,l){const h={};for(const _ in m)"ref"!==_&&(h[_]=m[_]);return f.refProperties.forEach(_=>{_ in l&&(h[_]=l[_])}),h}function Qo(m){m=m.slice();const l=Object.create(null);for(let h=0;h<m.length;h++)l[m[h].id]=m[h];for(let h=0;h<m.length;h++)"ref"in m[h]&&(m[h]=ir(m[h],l[m[h].ref]));return m}Qn.workerCount=2;const Nn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function wu(m,l,h){h.push({command:Nn.addSource,args:[m,l[m]]})}function ka(m,l,h){l.push({command:Nn.removeSource,args:[m]}),h[m]=!0}function nc(m,l,h,_){ka(m,h,_),wu(m,l,h)}function ic(m,l,h){let _;for(_ in m[h])if(m[h].hasOwnProperty(_)&&"data"!==_&&!Ke(m[h][_],l[h][_]))return!1;for(_ in l[h])if(l[h].hasOwnProperty(_)&&"data"!==_&&!Ke(m[h][_],l[h][_]))return!1;return!0}function no(m,l,h,_,x,w){let T;for(T in l=l||{},m=m||{})m.hasOwnProperty(T)&&(Ke(m[T],l[T])||h.push({command:w,args:[_,T,l[T],x]}));for(T in l)l.hasOwnProperty(T)&&!m.hasOwnProperty(T)&&(Ke(m[T],l[T])||h.push({command:w,args:[_,T,l[T],x]}))}function ps(m){return m.id}function Lc(m,l){return m[l.id]=l,m}class rc{constructor(l,h){this.reset(l,h)}reset(l,h){this.points=l||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(1===this.points.length)return this.points[0];l=f.clamp(l,0,1);let h=1,_=this._distances[h];const x=l*this.paddedLength+this.padding;for(;_<x&&h<this._distances.length;)_=this._distances[++h];const w=h-1,T=this._distances[w],S=_-T,P=S>0?(x-T)/S:0;return this.points[w].mult(1-P).add(this.points[h].mult(P))}}class Ra{constructor(l,h,_){const x=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(l/_),this.yCellCount=Math.ceil(h/_);for(let T=0;T<this.xCellCount*this.yCellCount;T++)x.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=h,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,h,_,x,w){this._forEachCell(h,_,x,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(w)}insertCircle(l,h,_,x){this._forEachCell(h-x,_-x,h+x,_+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(h),this.circles.push(_),this.circles.push(x)}_insertBoxCell(l,h,_,x,w,T){this.boxCells[w].push(T)}_insertCircleCell(l,h,_,x,w,T){this.circleCells[w].push(T)}_query(l,h,_,x,w,T){if(_<0||l>this.width||x<0||h>this.height)return!w&&[];const S=[];if(l<=0&&h<=0&&this.width<=_&&this.height<=x){if(w)return!0;for(let P=0;P<this.boxKeys.length;P++)S.push({key:this.boxKeys[P],x1:this.bboxes[4*P],y1:this.bboxes[4*P+1],x2:this.bboxes[4*P+2],y2:this.bboxes[4*P+3]});for(let P=0;P<this.circleKeys.length;P++){const B=this.circles[3*P],N=this.circles[3*P+1],j=this.circles[3*P+2];S.push({key:this.circleKeys[P],x1:B-j,y1:N-j,x2:B+j,y2:N+j})}return T?S.filter(T):S}return this._forEachCell(l,h,_,x,this._queryCell,S,{hitTest:w,seenUids:{box:{},circle:{}}},T),w?S.length>0:S}_queryCircle(l,h,_,x,w){const T=l-_,S=l+_,P=h-_,B=h+_;if(S<0||T>this.width||B<0||P>this.height)return!x&&[];const N=[];return this._forEachCell(T,P,S,B,this._queryCellCircle,N,{hitTest:x,circle:{x:l,y:h,radius:_},seenUids:{box:{},circle:{}}},w),x?N.length>0:N}query(l,h,_,x,w){return this._query(l,h,_,x,!1,w)}hitTest(l,h,_,x,w){return this._query(l,h,_,x,!0,w)}hitTestCircle(l,h,_,x){return this._queryCircle(l,h,_,!0,x)}_queryCell(l,h,_,x,w,T,S,P){const B=S.seenUids,N=this.boxCells[w];if(null!==N){const X=this.bboxes;for(const J of N)if(!B.box[J]){B.box[J]=!0;const te=4*J;if(l<=X[te+2]&&h<=X[te+3]&&_>=X[te+0]&&x>=X[te+1]&&(!P||P(this.boxKeys[J]))){if(S.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[J],x1:X[te],y1:X[te+1],x2:X[te+2],y2:X[te+3]})}}}const j=this.circleCells[w];if(null!==j){const X=this.circles;for(const J of j)if(!B.circle[J]){B.circle[J]=!0;const te=3*J;if(this._circleAndRectCollide(X[te],X[te+1],X[te+2],l,h,_,x)&&(!P||P(this.circleKeys[J]))){if(S.hitTest)return T.push(!0),!0;{const ee=X[te],re=X[te+1],$=X[te+2];T.push({key:this.circleKeys[J],x1:ee-$,y1:re-$,x2:ee+$,y2:re+$})}}}}}_queryCellCircle(l,h,_,x,w,T,S,P){const B=S.circle,N=S.seenUids,j=this.boxCells[w];if(null!==j){const J=this.bboxes;for(const te of j)if(!N.box[te]){N.box[te]=!0;const ee=4*te;if(this._circleAndRectCollide(B.x,B.y,B.radius,J[ee+0],J[ee+1],J[ee+2],J[ee+3])&&(!P||P(this.boxKeys[te])))return T.push(!0),!0}}const X=this.circleCells[w];if(null!==X){const J=this.circles;for(const te of X)if(!N.circle[te]){N.circle[te]=!0;const ee=3*te;if(this._circlesCollide(J[ee],J[ee+1],J[ee+2],B.x,B.y,B.radius)&&(!P||P(this.circleKeys[te])))return T.push(!0),!0}}}_forEachCell(l,h,_,x,w,T,S,P){const B=this._convertToXCellCoord(l),N=this._convertToYCellCoord(h),j=this._convertToXCellCoord(_),X=this._convertToYCellCoord(x);for(let J=B;J<=j;J++)for(let te=N;te<=X;te++)if(w.call(this,l,h,_,x,this.xCellCount*te+J,T,S,P))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,h,_,x,w,T){const S=x-l,P=w-h,B=_+T;return B*B>S*S+P*P}_circleAndRectCollide(l,h,_,x,w,T,S){const P=(T-x)/2,B=Math.abs(l-(x+P));if(B>P+_)return!1;const N=(S-w)/2,j=Math.abs(h-(w+N));if(j>N+_)return!1;if(B<=P||j<=N)return!0;const X=B-P,J=j-N;return X*X+J*J<=_*_}}const Ls={unknown:0,flipRequired:1,flipNotRequired:2},oc=Math.tan(85*Math.PI/180);function Ue(m,l,h,_,x,w,T){const S=f.create();if(h)if("globe"===w.name){const P=f.calculateGlobeLabelMatrix(x,l);f.multiply(S,S,P)}else{const P=ct([],T);S[0]=P[0],S[1]=P[1],S[4]=P[2],S[5]=P[3],_||f.rotateZ(S,S,x.angle)}else f.multiply(S,x.labelPlaneMatrix,m);return S}function ms(m,l,h,_,x,w,T){const S=Ue(m,l,h,_,x,w,T);return"globe"===w.name&&h||(S[2]=S[6]=S[10]=S[14]=0),S}function $i(m,l,h,_,x,w,T){if(h){if("globe"===w.name){const S=Ue(m,l,h,_,x,w,T);return f.invert(S,S),f.multiply(S,m,S),S}{const S=f.clone(m),P=f.identity([]);return P[0]=T[0],P[1]=T[1],P[4]=T[2],P[5]=T[3],f.multiply(S,S,P),_||f.rotateZ(S,S,-x.angle),S}}return x.glCoordMatrix}function hr(m,l,h,_){const x=[m,l,h,1];h?f.transformMat4$1(x,x,_):dt(x,x,_);const w=x[3];return x[0]/=w,x[1]/=w,x[2]/=w,x}function Li(m,l){return Math.min(.5+m/l*.5,1.5)}function io(m,l){const h=m[0]/m[3],_=m[1]/m[3];return h>=-l[0]&&h<=l[0]&&_>=-l[1]&&_<=l[1]}function Nc(m,l,h,_,x,w,T,S,P,B){const N=h.transform,j=_?m.textSizeData:m.iconSizeData,X=f.evaluateSizeForZoom(j,h.transform.zoom),J="globe"===N.projection.name,te=[256/h.width*2+1,256/h.height*2+1],ee=_?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;ee.clear();let re=null;J&&(re=_?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const $=m.lineVertexArray,Y=_?m.text.placedSymbolArray:m.icon.placedSymbolArray,ae=h.transform.width/h.transform.height;let oe,_e=!1;for(let ve=0;ve<Y.length;ve++){const ye=Y.get(ve),{numGlyphs:Ce,writingMode:we}=ye;if(we!==f.WritingMode.vertical||_e||oe===f.WritingMode.horizontal||(_e=!0),oe=we,(ye.hidden||we===f.WritingMode.vertical)&&!_e){wn(Ce,ee);continue}_e=!1;const ke=new f.Point(ye.tileAnchorX,ye.tileAnchorY);let{x:tt,y:Ie,z:qe}=N.projection.projectTilePoint(ke.x,ke.y,B.canonical);if(P){const[Gt,wt,kt]=P(ke);tt+=Gt,Ie+=wt,qe+=kt}const Fe=[tt,Ie,qe,1];if(f.transformMat4$1(Fe,Fe,l),!io(Fe,te)){wn(Ce,ee);continue}const nt=Li(h.transform.cameraToCenterDistance,Fe[3]),Pe=f.evaluateSizeForFeature(j,X,ye),He=T?Pe/nt:Pe*nt,it=hr(tt,Ie,qe,x);if(it[3]<=0){wn(Ce,ee);continue}let Je={};const at=T?null:P,St=ht(ye,He,!1,S,l,x,w,m.glyphOffsetArray,$,ee,re,it,ke,Je,ae,at,N.projection,B,T);_e=St.useVertical,at&&St.needsFlipping&&(Je={}),(St.notEnoughRoom||_e||St.needsFlipping&&ht(ye,He,!0,S,l,x,w,m.glyphOffsetArray,$,ee,re,it,ke,Je,ae,at,N.projection,B,T).notEnoughRoom)&&wn(Ce,ee)}_?(m.text.dynamicLayoutVertexBuffer.updateData(ee),re&&m.text.globeExtVertexBuffer.updateData(re)):(m.icon.dynamicLayoutVertexBuffer.updateData(ee),re&&m.icon.globeExtVertexBuffer.updateData(re))}function Bc(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee){const{lineStartIndex:re,glyphStartIndex:$,segment:Y}=S,ae=$+S.numGlyphs,oe=re+S.lineLength,_e=l.getoffsetX($),ve=l.getoffsetX(ae-1),ye=Vr(m*_e,h,_,x,w,T,Y,re,oe,P,B,N,j,X,!0,J,te,ee);if(!ye)return null;const Ce=Vr(m*ve,h,_,x,w,T,Y,re,oe,P,B,N,j,X,!0,J,te,ee);return Ce?{first:ye,last:Ce}:null}function $n(m,l,h,_){return m===f.WritingMode.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:m===f.WritingMode.vertical?_>0?{needsFlipping:!0}:null:l!==Ls.unknown&&(0===(x=h)||Math.abs(_/x)>oc)?l===Ls.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null;var x}function ht(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee,re,$,Y){const ae=l/24,oe=m.lineOffsetX*ae,_e=m.lineOffsetY*ae,{lineStartIndex:ve,glyphStartIndex:ye,numGlyphs:Ce,segment:we,writingMode:ke,flipState:tt}=m,Ie=ve+m.lineLength,qe=Fe=>{if(N){const[it,Je,at]=Fe.up,St=B.length;f.updateGlobeVertexNormal(N,St+0,it,Je,at),f.updateGlobeVertexNormal(N,St+1,it,Je,at),f.updateGlobeVertexNormal(N,St+2,it,Je,at),f.updateGlobeVertexNormal(N,St+3,it,Je,at)}const[nt,Pe,He]=Fe.point;f.addDynamicAttributes(B,nt,Pe,He,Fe.angle)};if(Ce>1){const Fe=Bc(ae,S,oe,_e,h,j,X,m,P,w,J,ee,!1,re,$,Y);if(!Fe)return{notEnoughRoom:!0};if(_&&!h){let[nt,Pe,He]=Fe.first.point,[it,Je,at]=Fe.last.point;[nt,Pe]=hr(nt,Pe,He,T),[it,Je]=hr(it,Je,at,T);const St=$n(ke,tt,(it-nt)*te,Je-Pe);if(m.flipState=St&&St.needsFlipping?Ls.flipRequired:Ls.flipNotRequired,St)return St}qe(Fe.first);for(let nt=ye+1;nt<ye+Ce-1;nt++){const Pe=Vr(ae*S.getoffsetX(nt),oe,_e,h,j,X,we,ve,Ie,P,w,J,ee,!1,!1,re,$,Y);if(!Pe)return B.length-=4*(nt-ye),{notEnoughRoom:!0};qe(Pe)}qe(Fe.last)}else{if(_&&!h){const nt=hr(X.x,X.y,0,x),Pe=ve+we+1,He=new f.Point(P.getx(Pe),P.gety(Pe)),it=hr(He.x,He.y,0,x),Je=it[3]>0?it:rn(X,He,nt,1,x,void 0,re,$.canonical),at=$n(ke,tt,(Je[0]-nt[0])*te,Je[1]-nt[1]);if(m.flipState=at&&at.needsFlipping?Ls.flipRequired:Ls.flipNotRequired,at)return at}const Fe=Vr(ae*S.getoffsetX(ye),oe,_e,h,j,X,we,ve,Ie,P,w,J,ee,!1,!1,re,$,Y);if(!Fe)return{notEnoughRoom:!0};qe(Fe)}return{}}function Dt(m,l,h,_,x){const{x:w,y:T,z:S}=_.projectTilePoint(m.x,m.y,l);if(!x)return hr(w,T,S,h);const[P,B,N]=x(m);return hr(w+P,T+B,S+N,h)}function rn(m,l,h,_,x,w,T,S){const P=Dt(m.sub(l)._unit()._add(m),S,x,T,w);return f.sub(P,h,P),f.normalize(P,P),f.scaleAndAdd(P,h,P,_)}function Vr(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee,re,$){const Y=_?m-l:m+l;let ae=Y>0?1:-1,oe=0;_&&(ae*=-1,oe=Math.PI),ae<0&&(oe+=Math.PI);let _e=S+T+(ae>0?0:1)|0,ve=x,ye=x,Ce=0,we=0;const ke=Math.abs(Y),tt=[],Ie=[];let qe=w,Fe=qe;const nt=()=>rn(Fe,qe,ye,ke-Ce+1,N,X,ee,re.canonical);for(;Ce+we<=ke;){if(_e+=ae,_e<S||_e>=P)return null;if(ye=ve,Fe=qe,tt.push(ye),J&&Ie.push(Fe),qe=new f.Point(B.getx(_e),B.gety(_e)),ve=j[_e],!ve){const kt=Dt(qe,re.canonical,N,ee,X);ve=kt[3]>0?j[_e]=kt:nt()}Ce+=we,we=f.distance(ye,ve)}te&&X&&(j[_e]&&(ve=nt(),we=f.distance(ye,ve)),j[_e]=ve);const Pe=(ke-Ce)/we,He=qe.sub(Fe)._mult(Pe)._add(Fe),it=f.sub([],ve,ye),Je=f.scaleAndAdd([],ye,it,Pe);let at=[0,0,1],St=it[0],Gt=it[1];if($&&(at=ee.upVector(re.canonical,He.x,He.y),0!==at[0]||0!==at[1]||1!==at[2])){const kt=[at[2],0,-at[0]],vn=f.cross([],at,kt);f.normalize(kt,kt),f.normalize(vn,vn),St=f.dot(it,kt),Gt=f.dot(it,vn)}if(h){const kt=f.cross([],at,it);f.normalize(kt,kt),f.scaleAndAdd(Je,Je,kt,h*ae)}const wt=oe+Math.atan2(Gt,St);return tt.push(Je),J&&Ie.push(He),{point:Je,angle:wt,path:tt,tilePath:Ie,up:at}}function wn(m,l){const h=l.length,_=h+4*m;l.resize(_),l.float32.fill(-1/0,4*h,4*_)}function dt(m,l,h){const _=l[0],x=l[1];return m[0]=h[0]*_+h[4]*x+h[12],m[1]=h[1]*_+h[5]*x+h[13],m[3]=h[3]*_+h[7]*x+h[15],m}const Ur=100;class Oa{constructor(l,h,_=new Ra(l.width+200,l.height+200,25),x=new Ra(l.width+200,l.height+200,25)){this.transform=l,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Ur,this.screenBottomBoundary=l.height+Ur,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.fogState=h}placeCollisionBox(l,h,_,x,w,T,S,P){let B=_.projectedAnchorX,N=_.projectedAnchorY,j=_.projectedAnchorZ;const X=_.elevation,J=_.tileID,te=l.getProjection();if(X&&J){const[ve,ye,Ce]=te.upVector(J.canonical,_.tileAnchorX,_.tileAnchorY),we=te.upVectorScale(J.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;B+=ve*X*we,N+=ye*X*we,j+=Ce*X*we}const ee=this.projectAndGetPerspectiveRatio(S,B,N,j,_.tileID,"globe"===te.name||!!X||this.transform.pitch>0,te),re=T*ee.perspectiveRatio,$=(_.x1*h+x.x-_.padding)*re+ee.point.x,Y=(_.y1*h+x.y-_.padding)*re+ee.point.y,ae=(_.x2*h+x.x+_.padding)*re+ee.point.x,oe=(_.y2*h+x.y+_.padding)*re+ee.point.y,_e=ee.perspectiveRatio<=.55||ee.occluded;return!this.isInsideGrid($,Y,ae,oe)||!w&&this.grid.hitTest($,Y,ae,oe,P)||_e?{box:[],offscreen:!1,occluded:ee.occluded}:{box:[$,Y,ae,oe],offscreen:this.isOffscreen($,Y,ae,oe),occluded:!1}}placeCollisionCircles(l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee){const re=[],$=this.transform.elevation,Y=l.getProjection(),ae=$?$.getAtTileOffsetFunc(ee,this.transform.center.lat,this.transform.worldSize,Y):null,oe=new f.Point(_.tileAnchorX,_.tileAnchorY);let{x:_e,y:ve,z:ye}=Y.projectTilePoint(oe.x,oe.y,ee.canonical);if(ae){const[He,it,Je]=ae(oe);_e+=He,ve+=it,ye+=Je}const Ce="globe"===Y.name,we=this.projectAndGetPerspectiveRatio(S,_e,ve,ye,ee,Ce||!!$||this.transform.pitch>0,Y),{perspectiveRatio:ke}=we,tt=(j?T/ke:T*ke)/f.ONE_EM,Ie=hr(_e,ve,ye,P),qe=we.signedDistanceFromCamera>0?Bc(tt,w,_.lineOffsetX*tt,_.lineOffsetY*tt,!1,Ie,oe,_,x,P,{},$&&!j?ae:null,j&&!!$,Y,ee,j):null;let Fe=!1,nt=!1,Pe=!0;if(qe&&!we.occluded){const He=.5*J*ke+te,it=new f.Point(-100,-100),Je=new f.Point(this.screenRightBoundary,this.screenBottomBoundary),at=new rc,{first:St,last:Gt}=qe,wt=St.path.length;let kt=[];for(let Ct=wt-1;Ct>=1;Ct--)kt.push(St.path[Ct]);for(let Ct=1;Ct<Gt.path.length;Ct++)kt.push(Gt.path[Ct]);const vn=2.5*He;B&&(kt=kt.map(([Ct,Gn,ii],qn)=>(ae&&!Ce&&(ii=ae(qn<wt-1?St.tilePath[wt-1-qn]:Gt.tilePath[qn-wt+2])[2]),hr(Ct,Gn,ii,B))),kt.some(Ct=>Ct[3]<=0)&&(kt=[]));let gn=[];if(kt.length>0){let Ct=1/0,Gn=-1/0,ii=1/0,qn=-1/0;for(const ri of kt)Ct=Math.min(Ct,ri[0]),ii=Math.min(ii,ri[1]),Gn=Math.max(Gn,ri[0]),qn=Math.max(qn,ri[1]);Gn>=it.x&&Ct<=Je.x&&qn>=it.y&&ii<=Je.y&&(gn=[kt.map(ri=>new f.Point(ri[0],ri[1]))],(Ct<it.x||Gn>Je.x||ii<it.y||qn>Je.y)&&(gn=f.clipLine(gn,it.x,it.y,Je.x,Je.y)))}for(const Ct of gn){at.reset(Ct,.25*He);let Gn=0;Gn=at.length<=.5*He?1:Math.ceil(at.paddedLength/vn)+1;for(let ii=0;ii<Gn;ii++){const qn=ii/Math.max(Gn-1,1),ri=at.lerp(qn),Gr=ri.x+Ur,rr=ri.y+Ur;re.push(Gr,rr,He,0);const xs=Gr-He,as=rr-He,xi=Gr+He,Yn=rr+He;if(Pe=Pe&&this.isOffscreen(xs,as,xi,Yn),nt=nt||this.isInsideGrid(xs,as,xi,Yn),!h&&this.grid.hitTestCircle(Gr,rr,He,X)&&(Fe=!0,!N))return{circles:[],offscreen:!1,collisionDetected:Fe,occluded:!1}}}}return{circles:!N&&Fe||!nt?[]:re,offscreen:Pe,collisionDetected:Fe,occluded:we.occluded}}queryRenderedSymbols(l){if(0===l.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const h=[];let _=1/0,x=1/0,w=-1/0,T=-1/0;for(const N of l){const j=new f.Point(N.x+Ur,N.y+Ur);_=Math.min(_,j.x),x=Math.min(x,j.y),w=Math.max(w,j.x),T=Math.max(T,j.y),h.push(j)}const S=this.grid.query(_,x,w,T).concat(this.ignoredGrid.query(_,x,w,T)),P={},B={};for(const N of S){const j=N.key;if(void 0===P[j.bucketInstanceId]&&(P[j.bucketInstanceId]={}),P[j.bucketInstanceId][j.featureIndex])continue;const X=[new f.Point(N.x1,N.y1),new f.Point(N.x2,N.y1),new f.Point(N.x2,N.y2),new f.Point(N.x1,N.y2)];f.polygonIntersectsPolygon(h,X)&&(P[j.bucketInstanceId][j.featureIndex]=!0,void 0===B[j.bucketInstanceId]&&(B[j.bucketInstanceId]=[]),B[j.bucketInstanceId].push(j.featureIndex))}return B}insertCollisionBox(l,h,_,x,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:w},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,h,_,x,w){const T=h?this.ignoredGrid:this.grid,S={bucketInstanceId:_,featureIndex:x,collisionGroupID:w};for(let P=0;P<l.length;P+=4)T.insertCircle(S,l[P],l[P+1],l[P+2])}projectAndGetPerspectiveRatio(l,h,_,x,w,T,S){const P=[h,_,x,1];let B=!1;x||this.transform.pitch>0?(f.transformMat4$1(P,P,l),this.fogState&&w&&"globe"!==S.name&&(B=function(X,J,te,ee,re,$){const Y=$.calculateFogTileMatrix(re),ae=[J,te,ee];return f.transformMat4(ae,ae,Y),Is(X,ae,$.pitch,$._fov)}(this.fogState,h,_,x,w.toUnwrapped(),this.transform)>.9)):dt(P,P,l);const N=P[3];return{point:new f.Point((P[0]/N+1)/2*this.transform.width+Ur,(-P[1]/N+1)/2*this.transform.height+Ur),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(S)/N*.5,1.5),signedDistanceFromCamera:N,occluded:T&&P[2]>N||B}}isOffscreen(l,h,_,x){return _<Ur||l>=this.screenRightBoundary||x<Ur||h>this.screenBottomBoundary}isInsideGrid(l,h,_,x){return _>=0&&l<this.gridRightBoundary&&x>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const l=f.identity([]);return f.translate(l,l,[-100,-100,0]),l}}function xl(m,l,h){const _=l.createTileMatrix(m,m.worldSize,h.toUnwrapped());return f.multiply(new Float32Array(16),m.projMatrix,_)}function wo(m,l,h){if(l.projection.name===h.projection.name)return m.projMatrix;const _=h.clone();return _.setProjection(l.projection),xl(_,l.getProjection(),m)}function Le(m,l,h){return l.name===h.projection.name?m.projMatrix:xl(h,l,m)}class Ns{constructor(l,h,_,x){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?h:-h))):x&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class Vt{constructor(l,h,_,x,w,T=!1){this.text=new Ns(l?l.text:null,h,_,w),this.icon=new Ns(l?l.icon:null,h,x,w),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class An{constructor(l,h,_,x=!1){this.text=l,this.icon=h,this.skipFade=_,this.clipped=x}}class bl{constructor(){this.invProjMatrix=f.create(),this.viewportMatrix=f.create(),this.circles=[]}}class bh{constructor(l,h,_,x,w){this.bucketInstanceId=l,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=x,this.tileID=w}}class wh{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){const h=++this.maxGroupID;this.collisionGroups[l]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[l]}}function ca(m,l,h,_,x){const{horizontalAlign:w,verticalAlign:T}=f.getAnchorAlignment(m),S=-(w-.5)*l,P=-(T-.5)*h,B=f.evaluateVariableOffset(m,_);return new f.Point(S+B[0]*x,P+B[1]*x)}function gr(m,l,h,_,x){const w=new f.Point(m,l);return h&&w._rotate(_?x:-x),w}class Eu{constructor(l,h,_,x,w){this.transform=l.clone(),this.projection=l.projection.name,this.collisionIndex=new Oa(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new wh(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,h,_,x){const w=_.getBucket(h),T=_.latestFeatureIndex;if(!w||!T||h.id!==w.layerIds[0])return;const S=w.layers[0].layout,P=_.collisionBoxArray,B=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),N=_.tileSize/f.EXTENT,j=_.tileID.toUnwrapped();this.transform.setProjection(w.projection);const X=(J=_.tileID,te=w.getProjection(),ee=this.transform,te.name===this.projection?ee.calculateProjMatrix(J.toUnwrapped()):xl(ee,te,J));var J,te,ee;const re="map"===S.get("text-pitch-alignment"),$="map"===S.get("text-rotation-alignment");h.compileFilter();const Y=h.dynamicFilter(),ae=h.dynamicFilterNeedsFeature(),oe=this.transform.calculatePixelsToTileUnitsMatrix(_),_e=ms(X,_.tileID.canonical,re,$,this.transform,w.getProjection(),oe);let ve=null;if(re){const we=$i(X,_.tileID.canonical,re,$,this.transform,w.getProjection(),oe);ve=f.multiply([],this.transform.labelPlaneMatrix,we)}let ye=null;Y&&_.latestFeatureIndex&&(ye={unwrappedTileID:j,dynamicFilter:Y,dynamicFilterNeedsFeature:ae,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new bh(w.bucketInstanceId,T,w.sourceLayerIndex,w.index,_.tileID);const Ce={bucket:w,layout:S,posMatrix:X,textLabelPlaneMatrix:_e,labelToScreenMatrix:ve,clippingData:ye,scale:B,textPixelRatio:N,holdingForFade:_.holdingForFade(),collisionBoxArray:P,partiallyEvaluatedTextSize:f.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:f.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(x)for(const we of w.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:tt,symbolInstanceEnd:Ie}=we;l.push({sortKey:ke,symbolInstanceStart:tt,symbolInstanceEnd:Ie,parameters:Ce})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Ce})}attemptAnchorPlacement(l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee,re,$,Y){const{textOffset0:ae,textOffset1:oe,crossTileID:_e}=X,ve=[ae,oe],ye=ca(l,_,x,ve,w),Ce=this.collisionIndex.placeCollisionBox(te,w,h,gr(ye.x,ye.y,T,S,this.transform.angle),j,P,B,N.predicate);if(re){const we=te.getSymbolInstanceIconSize(Y,this.transform.zoom,X.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(te,we,re,gr(ye.x,ye.y,T,S,this.transform.angle),j,P,B,N.predicate).box.length)return}if(Ce.box.length>0){let we;return this.prevPlacement&&this.prevPlacement.variableOffsets[_e]&&this.prevPlacement.placements[_e]&&this.prevPlacement.placements[_e].text&&(we=this.prevPlacement.variableOffsets[_e].anchor),this.variableOffsets[_e]={textOffset:ve,width:_,height:x,anchor:l,textScale:w,prevAnchor:we},this.markUsedJustification(te,l,X,ee),te.allowVerticalPlacement&&(this.markUsedOrientation(te,ee,X),this.placedOrientations[_e]=ee),{shift:ye,placedGlyphBoxes:Ce}}}placeLayerBucketPart(l,h,_,x){const{bucket:w,layout:T,posMatrix:S,textLabelPlaneMatrix:P,labelToScreenMatrix:B,clippingData:N,textPixelRatio:j,holdingForFade:X,collisionBoxArray:J,partiallyEvaluatedTextSize:te,partiallyEvaluatedIconSize:ee,collisionGroup:re}=l.parameters,$=T.get("text-optional"),Y=T.get("icon-optional"),ae=T.get("text-allow-overlap"),oe=T.get("icon-allow-overlap"),_e="map"===T.get("text-rotation-alignment"),ve="map"===T.get("text-pitch-alignment"),ye="none"!==T.get("icon-text-fit"),Ce="viewport-y"===T.get("symbol-z-order");this.transform.setProjection(w.projection);let we=ae&&(oe||!w.hasIconData()||Y),ke=oe&&(ae||!w.hasTextData()||$);!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J),_&&x&&w.updateCollisionDebugBuffers(this.transform.zoom,J);const tt=(Ie,qe,Fe)=>{const{crossTileID:nt,numVerticalGlyphVertices:Pe}=Ie;if(N){const xi={zoom:this.transform.zoom,pitch:this.transform.pitch};let Yn=null;if(N.dynamicFilterNeedsFeature){const Wn=this.retainedQueryData[w.bucketInstanceId];Yn=N.featureIndex.loadFeature({featureIndex:Ie.featureIndex,bucketIndex:Wn.bucketIndex,sourceLayerIndex:Wn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,N.dynamicFilter)(xi,Yn,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new f.Point(Ie.tileAnchorX,Ie.tileAnchorY),this.transform.calculateDistanceTileData(N.unwrappedTileID)))return this.placements[nt]=new An(!1,!1,!1,!0),void h.add(nt)}if(h.has(nt))return;if(X)return void(this.placements[nt]=new An(!1,!1,!1));let He=!1,it=!1,Je=!0,at=!1,St=!1,Gt=null,wt={box:null,offscreen:null,occluded:null},kt={box:null,offscreen:null,occluded:null},vn=null,gn=null,Ct=null,Gn=0,ii=0,qn=0;Fe.textFeatureIndex?Gn=Fe.textFeatureIndex:Ie.useRuntimeCollisionCircles&&(Gn=Ie.featureIndex),Fe.verticalTextFeatureIndex&&(ii=Fe.verticalTextFeatureIndex);const ri=xi=>{xi.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const Yn=this.transform.elevation;(Yn||xi.elevation)&&(xi.elevation=Yn?Yn.getAtTileOffset(xi.tileID,xi.tileAnchorX,xi.tileAnchorY):0)},Gr=Fe.textBox;if(Gr){ri(Gr);const xi=Wn=>{let Yi=f.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Wn&&this.prevPlacement){const lo=this.prevPlacement.placedOrientations[nt];lo&&(this.placedOrientations[nt]=lo,Yi=lo,this.markUsedOrientation(w,Yi,Ie))}return Yi},Yn=(Wn,Yi)=>{if(w.allowVerticalPlacement&&Pe>0&&Fe.verticalTextBox){for(const lo of w.writingModes)if(lo===f.WritingMode.vertical?(wt=Yi(),kt=wt):wt=Wn(),wt&&wt.box&&wt.box.length)break}else wt=Wn()};if(T.get("text-variable-anchor")){let Wn=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[nt]){const Si=this.prevPlacement.variableOffsets[nt];Wn.indexOf(Si.anchor)>0&&(Wn=Wn.filter(qi=>qi!==Si.anchor),Wn.unshift(Si.anchor))}const Yi=(Si,qi,Vh)=>{const ma=w.getSymbolInstanceTextSize(te,Ie,this.transform.zoom,qe),pc=(Si.x2-Si.x1)*ma+2*Si.padding,ga=(Si.y2-Si.y1)*ma+2*Si.padding,_a=ye&&!oe?qi:null;_a&&ri(_a);let Ka={box:[],offscreen:!1,occluded:!1};const Uh=ae?2*Wn.length:Wn.length;for(let Kc=0;Kc<Uh;++Kc){const jh=this.attemptAnchorPlacement(Wn[Kc%Wn.length],Si,pc,ga,ma,_e,ve,j,S,re,Kc>=Wn.length,Ie,qe,w,Vh,_a,te,ee);if(jh&&(Ka=jh.placedGlyphBoxes,Ka&&Ka.box&&Ka.box.length)){He=!0,Gt=jh.shift;break}}return Ka};Yn(()=>Yi(Gr,Fe.iconBox,f.WritingMode.horizontal),()=>{const Si=Fe.verticalTextBox;return Si&&ri(Si),w.allowVerticalPlacement&&!(wt&&wt.box&&wt.box.length)&&Pe>0&&Si?Yi(Si,Fe.verticalIconBox,f.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),wt&&(He=wt.box,Je=wt.offscreen,at=wt.occluded);const lo=xi(!(!wt||!wt.box));if(!He&&this.prevPlacement){const Si=this.prevPlacement.variableOffsets[nt];Si&&(this.variableOffsets[nt]=Si,this.markUsedJustification(w,Si.anchor,Ie,lo))}}else{const Wn=(Yi,lo)=>{const Si=w.getSymbolInstanceTextSize(te,Ie,this.transform.zoom,qe),qi=this.collisionIndex.placeCollisionBox(w,Si,Yi,new f.Point(0,0),ae,j,S,re.predicate);return qi&&qi.box&&qi.box.length&&(this.markUsedOrientation(w,lo,Ie),this.placedOrientations[nt]=lo),qi};Yn(()=>Wn(Gr,f.WritingMode.horizontal),()=>{const Yi=Fe.verticalTextBox;return w.allowVerticalPlacement&&Pe>0&&Yi?(ri(Yi),Wn(Yi,f.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),xi(!!(wt&&wt.box&&wt.box.length))}}if(vn=wt,He=vn&&vn.box&&vn.box.length>0,Je=vn&&vn.offscreen,at=vn&&vn.occluded,Ie.useRuntimeCollisionCircles){const xi=w.text.placedSymbolArray.get(Ie.centerJustifiedTextSymbolIndex>=0?Ie.centerJustifiedTextSymbolIndex:Ie.verticalPlacedTextSymbolIndex),Yn=f.evaluateSizeForFeature(w.textSizeData,te,xi),Wn=T.get("text-padding");gn=this.collisionIndex.placeCollisionCircles(w,ae,xi,w.lineVertexArray,w.glyphOffsetArray,Yn,S,P,B,_,ve,re.predicate,Ie.collisionCircleDiameter*Yn/f.ONE_EM,Wn,this.retainedQueryData[w.bucketInstanceId].tileID),He=ae||gn.circles.length>0&&!gn.collisionDetected,Je=Je&&gn.offscreen,at=gn.occluded}if(Fe.iconFeatureIndex&&(qn=Fe.iconFeatureIndex),Fe.iconBox){const xi=Yn=>{ri(Yn);const Wn=ye&&Gt?gr(Gt.x,Gt.y,_e,ve,this.transform.angle):new f.Point(0,0),Yi=w.getSymbolInstanceIconSize(ee,this.transform.zoom,Ie.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,Yi,Yn,Wn,oe,j,S,re.predicate)};kt&&kt.box&&kt.box.length&&Fe.verticalIconBox?(Ct=xi(Fe.verticalIconBox),it=Ct.box.length>0):(Ct=xi(Fe.iconBox),it=Ct.box.length>0),Je=Je&&Ct.offscreen,St=Ct.occluded}const rr=$||0===Ie.numHorizontalGlyphVertices&&0===Pe,xs=Y||0===Ie.numIconVertices;if(rr||xs?xs?rr||(it=it&&He):He=it&&He:it=He=it&&He,He&&vn&&vn.box&&this.collisionIndex.insertCollisionBox(vn.box,T.get("text-ignore-placement"),w.bucketInstanceId,kt&&kt.box&&ii?ii:Gn,re.ID),it&&Ct&&this.collisionIndex.insertCollisionBox(Ct.box,T.get("icon-ignore-placement"),w.bucketInstanceId,qn,re.ID),gn&&(He&&this.collisionIndex.insertCollisionCircles(gn.circles,T.get("text-ignore-placement"),w.bucketInstanceId,Gn,re.ID),_)){const xi=w.bucketInstanceId;let Yn=this.collisionCircleArrays[xi];void 0===Yn&&(Yn=this.collisionCircleArrays[xi]=new bl);for(let Wn=0;Wn<gn.circles.length;Wn+=4)Yn.circles.push(gn.circles[Wn+0]),Yn.circles.push(gn.circles[Wn+1]),Yn.circles.push(gn.circles[Wn+2]),Yn.circles.push(gn.collisionDetected?1:0)}const as="globe"!==w.projection.name;we=we&&(as||!at),ke=ke&&(as||!St),this.placements[nt]=new An(He||we,it||ke,Je||w.justReloaded),h.add(nt)};if(Ce){const Ie=w.getSortedSymbolIndexes(this.transform.angle);for(let qe=Ie.length-1;qe>=0;--qe){const Fe=Ie[qe];tt(w.symbolInstances.get(Fe),Fe,w.collisionArrays[Fe])}}else for(let Ie=l.symbolInstanceStart;Ie<l.symbolInstanceEnd;Ie++)tt(w.symbolInstances.get(Ie),Ie,w.collisionArrays[Ie]);if(_&&w.bucketInstanceId in this.collisionCircleArrays){const Ie=this.collisionCircleArrays[w.bucketInstanceId];f.invert(Ie.invProjMatrix,S),Ie.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(l,h,_,x){const{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:P,crossTileID:B}=_,N=f.getAnchorJustification(h),j=x===f.WritingMode.vertical?P:"left"===N?w:"center"===N?T:"right"===N?S:-1;w>=0&&(l.text.placedSymbolArray.get(w).crossTileID=j>=0&&w!==j?0:B),T>=0&&(l.text.placedSymbolArray.get(T).crossTileID=j>=0&&T!==j?0:B),S>=0&&(l.text.placedSymbolArray.get(S).crossTileID=j>=0&&S!==j?0:B),P>=0&&(l.text.placedSymbolArray.get(P).crossTileID=j>=0&&P!==j?0:B)}markUsedOrientation(l,h,_){const x=h===f.WritingMode.horizontal||h===f.WritingMode.horizontalOnly?h:0,w=h===f.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:B}=_,N=l.text.placedSymbolArray;T>=0&&(N.get(T).placedOrientation=x),S>=0&&(N.get(S).placedOrientation=x),P>=0&&(N.get(P).placedOrientation=x),B>=0&&(N.get(B).placedOrientation=w)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const x=h?h.symbolFadeChange(l):1,w=h?h.opacities:{},T=h?h.variableOffsets:{},S=h?h.placedOrientations:{};for(const P in this.placements){const B=this.placements[P],N=w[P];N?(this.opacities[P]=new Vt(N,x,B.text,B.icon,null,B.clipped),_=_||B.text!==N.text.placed||B.icon!==N.icon.placed):(this.opacities[P]=new Vt(null,x,B.text,B.icon,B.skipFade,B.clipped),_=_||B.text||B.icon)}for(const P in w){const B=w[P];if(!this.opacities[P]){const N=new Vt(B,x,!1,!1);N.isHidden()||(this.opacities[P]=N,_=_||B.text.placed||B.icon.placed)}}for(const P in T)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=T[P]);for(const P in S)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=S[P]);_?this.lastPlacementChangeTime=l:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:l)}updateLayerOpacities(l,h){const _=new Set;for(const x of h){const w=x.getBucket(l);w&&x.latestFeatureIndex&&l.id===w.layerIds[0]&&this.updateBucketOpacities(w,_,x.collisionBoxArray)}}updateBucketOpacities(l,h,_){l.hasTextData()&&l.text.opacityVertexArray.clear(),l.hasIconData()&&l.icon.opacityVertexArray.clear(),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();const x=l.layers[0].layout,w=!!l.layers[0].dynamicFilter(),T=new Vt(null,0,!1,!1,!0),S=x.get("text-allow-overlap"),P=x.get("icon-allow-overlap"),B=x.get("text-variable-anchor"),N="map"===x.get("text-rotation-alignment"),j="map"===x.get("text-pitch-alignment"),X="none"!==x.get("icon-text-fit"),J=new Vt(null,0,S&&(P||!l.hasIconData()||x.get("icon-optional")),P&&(S||!l.hasTextData()||x.get("text-optional")),!0);!l.collisionArrays&&_&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(_);const te=(re,$,Y)=>{for(let ae=0;ae<$/4;ae++)re.opacityVertexArray.emplaceBack(Y)};let ee=0;for(let re=0;re<l.symbolInstances.length;re++){const $=l.symbolInstances.get(re),{numHorizontalGlyphVertices:Y,numVerticalGlyphVertices:ae,crossTileID:oe,numIconVertices:_e}=$,ve=h.has(oe);let ye=this.opacities[oe];ve?ye=T:ye||(ye=J,this.opacities[oe]=ye),h.add(oe);const Ce=Y>0||ae>0,we=_e>0,ke=this.placedOrientations[oe],tt=ke===f.WritingMode.vertical,Ie=ke===f.WritingMode.horizontal||ke===f.WritingMode.horizontalOnly;if(!Ce&&!we||ye.isHidden()||ee++,Ce){const qe=zc(ye.text);te(l.text,Y,tt?Mi:qe),te(l.text,ae,Ie?Mi:qe);const Fe=ye.text.isHidden(),{leftJustifiedTextSymbolIndex:nt,centerJustifiedTextSymbolIndex:Pe,rightJustifiedTextSymbolIndex:He,verticalPlacedTextSymbolIndex:it}=$,Je=l.text.placedSymbolArray,at=Fe||tt?1:0;nt>=0&&(Je.get(nt).hidden=at),Pe>=0&&(Je.get(Pe).hidden=at),He>=0&&(Je.get(He).hidden=at),it>=0&&(Je.get(it).hidden=Fe||Ie?1:0);const St=this.variableOffsets[oe];St&&this.markUsedJustification(l,St.anchor,$,ke);const Gt=this.placedOrientations[oe];Gt&&(this.markUsedJustification(l,"left",$,Gt),this.markUsedOrientation(l,Gt,$))}if(we){const qe=zc(ye.icon),{placedIconSymbolIndex:Fe,verticalPlacedIconSymbolIndex:nt}=$,Pe=l.icon.placedSymbolArray,He=ye.icon.isHidden()?1:0;Fe>=0&&(te(l.icon,_e,tt?Mi:qe),Pe.get(Fe).hidden=He),nt>=0&&(te(l.icon,$.numVerticalIconVertices,Ie?Mi:qe),Pe.get(nt).hidden=He)}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){const qe=l.collisionArrays[re];if(qe){let Fe=new f.Point(0,0),nt=!0;if(qe.textBox||qe.verticalTextBox){if(B){const He=this.variableOffsets[oe];He?(Fe=ca(He.anchor,He.width,He.height,He.textOffset,He.textScale),N&&Fe._rotate(j?this.transform.angle:-this.transform.angle)):nt=!1}w&&(nt=!ye.clipped),qe.textBox&&wl(l.textCollisionBox.collisionVertexArray,ye.text.placed,!nt||tt,Fe.x,Fe.y),qe.verticalTextBox&&wl(l.textCollisionBox.collisionVertexArray,ye.text.placed,!nt||Ie,Fe.x,Fe.y)}const Pe=nt&&Boolean(!Ie&&qe.verticalIconBox);qe.iconBox&&wl(l.iconCollisionBox.collisionVertexArray,ye.icon.placed,Pe,X?Fe.x:0,X?Fe.y:0),qe.verticalIconBox&&wl(l.iconCollisionBox.collisionVertexArray,ye.icon.placed,!Pe,X?Fe.x:0,X?Fe.y:0)}}}if(l.fullyClipped=0===ee,l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.bucketInstanceId in this.collisionCircleArrays){const re=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=re.invProjMatrix,l.placementViewportMatrix=re.viewportMatrix,l.collisionCircleArray=re.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return 0===this.fadeDuration?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>l}setStale(){this.stale=!0}}function wl(m,l,h,_,x){m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0),m.emplaceBack(l?1:0,h?1:0,_||0,x||0)}const Eo=Math.pow(2,25),kn=Math.pow(2,24),Eh=Math.pow(2,17),Ch=Math.pow(2,16),ro=Math.pow(2,9),es=Math.pow(2,8),Bs=Math.pow(2,1);function zc(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const l=m.placed?1:0,h=Math.floor(127*m.opacity);return h*Eo+l*kn+h*Eh+l*Ch+h*ro+l*es+h*Bs+l}const Mi=0;class ua{constructor(l){this._sortAcrossTiles="viewport-y"!==l.layout.get("symbol-z-order")&&void 0!==l.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(l,h,_,x,w){const T=this._bucketParts;for(;this._currentTileIndex<l.length;)if(h.getBucketParts(T,x,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((S,P)=>S.sortKey-P.sortKey));this._currentPartIndex<T.length;){const S=T[this._currentPartIndex];if(h.placeLayerBucketPart(S,this._seenCrossTileIDs,_,0===S.symbolInstanceStart),this._currentPartIndex++,w())return!0}return!1}}class oo{constructor(l,h,_,x,w,T,S,P){this.placement=new Eu(l,w,T,S,P),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(l,h,_){const x=f.exported.now(),w=()=>{const T=f.exported.now()-x;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=h[l[this._currentPlacementIndex]],S=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=S)&&(!T.maxzoom||T.maxzoom>S)){if(this._inProgressLayer||(this._inProgressLayer=new ua(T)),this._inProgressLayer.continuePlacement(_[T.source],this.placement,this._showCollisionBoxes,T,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}const Sn=512/f.EXTENT/2;class Dr{constructor(l,h,_){this.tileID=l,this.bucketInstanceId=_,this.index=new f.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=l.canonical.x*f.EXTENT,w=l.canonical.y*f.EXTENT;for(let T=0;T<h.length;T++){const{key:S,crossTileID:P,tileAnchorX:B,tileAnchorY:N}=h.get(T),j=Math.floor((x+B)*Sn),X=Math.floor((w+N)*Sn);this.index.add(j,X),this.keys.push(S),this.crossTileIDs.push(P)}this.index.finish()}findMatches(l,h,_){const x=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),w=Sn/Math.pow(2,h.canonical.z-this.tileID.canonical.z),T=h.canonical.x*f.EXTENT,S=h.canonical.y*f.EXTENT;for(let P=0;P<l.length;P++){const B=l.get(P);if(B.crossTileID)continue;const{key:N,tileAnchorX:j,tileAnchorY:X}=B,J=Math.floor((T+j)*w),te=Math.floor((S+X)*w),ee=this.index.range(J-x,te-x,J+x,te+x);for(const re of ee){const $=this.crossTileIDs[re];if(this.keys[re]===N&&!_.has($)){_.add($),B.crossTileID=$;break}}}}}class Cu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Fa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){const h=Math.round((l-this.lng)/360);if(0!==h)for(const _ in this.indexes){const x=this.indexes[_],w={};for(const T in x){const S=x[T];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+h),w[S.tileID.key]=S}this.indexes[_]=w}this.lng=l}addBucket(l,h,_){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let w=0;w<h.symbolInstances.length;w++)h.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]=new Set);const x=this.usedCrossTileIDs[l.overscaledZ];for(const w in this.indexes){const T=this.indexes[w];if(Number(w)>l.overscaledZ)for(const S in T){const P=T[S];P.tileID.isChildOf(l)&&P.findMatches(h.symbolInstances,l,x)}else{const S=T[l.scaledTo(Number(w)).key];S&&S.findMatches(h.symbolInstances,l,x)}}for(let w=0;w<h.symbolInstances.length;w++){const T=h.symbolInstances.get(w);T.crossTileID||(T.crossTileID=_.generate(),x.add(T.crossTileID))}return void 0===this.indexes[l.overscaledZ]&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new Dr(l,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(l,h){for(const _ of h.crossTileIDs)this.usedCrossTileIDs[l].delete(_)}removeStaleBuckets(l){let h=!1;for(const _ in this.indexes){const x=this.indexes[_];for(const w in x)l[x[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,x[w]),delete x[w],h=!0)}return h}}class pt{constructor(){this.layerIndexes={},this.crossTileIDs=new Cu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,h,_,x){let w=this.layerIndexes[l.id];void 0===w&&(w=this.layerIndexes[l.id]=new Fa);let T=!1;const S={};"globe"!==x.name&&w.handleWrapJump(_);for(const P of h){const B=P.getBucket(l);B&&l.id===B.layerIds[0]&&(B.bucketInstanceId||(B.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(P.tileID,B,this.crossTileIDs)&&(T=!0),S[B.bucketInstanceId]=!0)}return w.removeStaleBuckets(S)&&(T=!0),T}pruneUnusedLayers(l){const h={};l.forEach(_=>{h[_]=!0});for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}const La=(m,l)=>f.emitValidationErrors(m,l&&l.filter(h=>"source.canvas"!==h.identifier)),mi=f.pick(Nn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Vc=f.pick(Nn,["setCenter","setZoom","setBearing","setPitch"]),Du={version:8,layers:[],sources:{}},Na={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class gs extends f.Evented{constructor(l,h={}){super(),this.map=l,this.dispatcher=new Lt(pi(),this),this.imageManager=new Ko,this.imageManager.setEventedParent(this),this.glyphManager=new f.GlyphManager(l._requestManager,h.localFontFamily?f.LocalGlyphMode.all:h.localIdeographFontFamily?f.LocalGlyphMode.ideographs:f.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new pt,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",f.getReferrer());const _=this;this._rtlTextPluginCallback=gs.registerForPluginStateChange(x=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(w,T)=>{if(f.triggerPluginCompletionEvent(w),T&&T.every(S=>S))for(const S in _._sourceCaches){const P=_._sourceCaches[S],B=P.getSource().type;"vector"!==B&&"geojson"!==B||P.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const w=this.getSource(x.sourceId);if(w&&w.vectorLayerIds)for(const T in this._layers){const S=this._layers[T];S.source===w.id&&this._validateLayer(S)}})}loadURL(l,h={}){this.fire(new f.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof h.validate?h.validate:!f.isMapboxURL(l);l=this.map._requestManager.normalizeStyleURL(l,h.accessToken);const x=this.map._requestManager.transformRequest(l,f.ResourceType.Style);this._request=f.getJSON(x,(w,T)=>{this._request=null,w?this.fire(new f.ErrorEvent(w)):T&&this._load(T,_)})}loadJSON(l,h={}){this.fire(new f.Event("dataloading",{dataType:"style"})),this._request=f.exported.frame(()=>{this._request=null,this._load(l,!1!==h.validate)})}loadEmpty(){this.fire(new f.Event("dataloading",{dataType:"style"})),this._load(Du,!1)}_updateLayerCount(l,h){const _=h?1:-1;l.is3D()&&(this._num3DLayers+=_),"circle"===l.type&&(this._numCircleLayers+=_),"symbol"===l.type&&(this._numSymbolLayers+=_)}_load(l,h){if(h&&La(this,f.validateStyle(l)))return;this._loaded=!0,this.stylesheet=f.clone$1(l),this._updateMapProjection();for(const x in l.sources)this.addSource(x,l.sources[x],{validate:!1});this._changed=!1,l.sprite?this._loadSprite(l.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(l.glyphs);const _=Qo(this.stylesheet.layers);this._order=_.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of _){const w=f.createStyleLayer(x);w.setEventedParent(this,{layer:{id:w.id}}),this._layers[w.id]=w,this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new tr(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new f.Event("data",{dataType:"style"})),this.fire(new f.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(l){l?this.stylesheet.projection=l:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(l){this._spriteRequest=function(h,_,x){let w,T,S;const P=f.exported.devicePixelRatio>1?"@2x":"";let B=f.getJSON(_.transformRequest(_.normalizeSpriteURL(h,P,".json"),f.ResourceType.SpriteJSON),(X,J)=>{B=null,S||(S=X,w=J,j())}),N=f.getImage(_.transformRequest(_.normalizeSpriteURL(h,P,".png"),f.ResourceType.SpriteImage),(X,J)=>{N=null,S||(S=X,T=J,j())});function j(){if(S)x(S);else if(w&&T){const X=f.exported.getImageData(T),J={};for(const te in w){const{width:ee,height:re,x:$,y:Y,sdf:ae,pixelRatio:oe,stretchX:_e,stretchY:ve,content:ye}=w[te],Ce=new f.RGBAImage({width:ee,height:re});f.RGBAImage.copy(X,Ce,{x:$,y:Y},{x:0,y:0},{width:ee,height:re}),J[te]={data:Ce,pixelRatio:oe,sdf:ae,stretchX:_e,stretchY:ve,content:ye}}x(null,J)}}return{cancel(){B&&(B.cancel(),B=null),N&&(N.cancel(),N=null)}}}(l,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new f.ErrorEvent(h));else if(_)for(const x in _)this.imageManager.addImage(x,_[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new f.Event("data",{dataType:"style"}))})}_validateLayer(l){const h=this.getSource(l.source);if(!h)return;const _=l.sourceLayer;_&&("geojson"===h.type||h.vectorLayerIds&&-1===h.vectorLayerIds.indexOf(_))&&this.fire(new f.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${l.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const l in this._sourceCaches)if(!this._sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(l){const h=[];for(const _ of l){const x=this._layers[_];"custom"!==x.type&&h.push(x.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const l in this._sourceCaches)if(this._sourceCaches[l].hasTransition())return!0;for(const l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(l){return!!this.terrain&&("function"==typeof l.isLayerDraped?l.isLayerDraped():Na[l.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(l){if(!this._loaded)return;const h=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(x.length||w.length)&&this._updateWorkerLayers(x,w);for(const T in this._updatedSources){const S=this._updatedSources[T];"reload"===S?this._reloadSource(T):"clear"===S&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(l);this.light.updateTransitions(l),this.fog&&this.fog.updateTransitions(l),this._resetUpdates()}const _={};for(const x in this._sourceCaches){const w=this._sourceCaches[x];_[x]=w.used,w.used=!1}for(const x of this._order){const w=this._layers[x];if(w.recalculate(l,this._availableImages),!w.isHidden(l.zoom)){const S=this._getLayerSourceCache(w);S&&(S.used=!0)}const T=this.map.painter;if(T){const S=w.getProgramIds();if(!S)continue;const P=w.getProgramConfiguration(l.zoom);for(const B of S)T.useProgram(B,P)}}for(const x in _){const w=this._sourceCaches[x];_[x]!==w.used&&w.getSource().fire(new f.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(l),this.terrain&&this.terrain.recalculate(l),this.fog&&this.fog.recalculate(l),this.z=l.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new f.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const l=Object.keys(this._changedImages);if(l.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateWorkerLayers(l,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(l),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(l){if(this._checkLoaded(),La(this,f.validateStyle(l)))return!1;(l=f.clone$1(l)).layers=Qo(l.layers);const h=function(x,w){if(!x)return[{command:Nn.setStyle,args:[w]}];let T=[];try{if(!Ke(x.version,w.version))return[{command:Nn.setStyle,args:[w]}];Ke(x.center,w.center)||T.push({command:Nn.setCenter,args:[w.center]}),Ke(x.zoom,w.zoom)||T.push({command:Nn.setZoom,args:[w.zoom]}),Ke(x.bearing,w.bearing)||T.push({command:Nn.setBearing,args:[w.bearing]}),Ke(x.pitch,w.pitch)||T.push({command:Nn.setPitch,args:[w.pitch]}),Ke(x.sprite,w.sprite)||T.push({command:Nn.setSprite,args:[w.sprite]}),Ke(x.glyphs,w.glyphs)||T.push({command:Nn.setGlyphs,args:[w.glyphs]}),Ke(x.transition,w.transition)||T.push({command:Nn.setTransition,args:[w.transition]}),Ke(x.light,w.light)||T.push({command:Nn.setLight,args:[w.light]}),Ke(x.fog,w.fog)||T.push({command:Nn.setFog,args:[w.fog]}),Ke(x.projection,w.projection)||T.push({command:Nn.setProjection,args:[w.projection]});const S={},P=[];!function(j,X,J,te){let ee;for(ee in X=X||{},j=j||{})j.hasOwnProperty(ee)&&(X.hasOwnProperty(ee)||ka(ee,J,te));for(ee in X){if(!X.hasOwnProperty(ee))continue;const re=X[ee];j.hasOwnProperty(ee)?Ke(j[ee],re)||("geojson"===j[ee].type&&"geojson"===re.type&&ic(j,X,ee)?J.push({command:Nn.setGeoJSONSourceData,args:[ee,re.data]}):nc(ee,X,J,te)):wu(ee,X,J)}}(x.sources,w.sources,P,S);const B=[];x.layers&&x.layers.forEach(j=>{j.source&&S[j.source]?T.push({command:Nn.removeLayer,args:[j.id]}):B.push(j)});let N=x.terrain;N&&S[N.source]&&(T.push({command:Nn.setTerrain,args:[void 0]}),N=void 0),T=T.concat(P),Ke(N,w.terrain)||T.push({command:Nn.setTerrain,args:[w.terrain]}),function(j,X,J){X=X||[];const te=(j=j||[]).map(ps),ee=X.map(ps),re=j.reduce(Lc,{}),$=X.reduce(Lc,{}),Y=te.slice(),ae=Object.create(null);let oe,_e,ve,ye,Ce,we,ke;for(oe=0,_e=0;oe<te.length;oe++)ve=te[oe],$.hasOwnProperty(ve)?_e++:(J.push({command:Nn.removeLayer,args:[ve]}),Y.splice(Y.indexOf(ve,_e),1));for(oe=0,_e=0;oe<ee.length;oe++)ve=ee[ee.length-1-oe],Y[Y.length-1-oe]!==ve&&(re.hasOwnProperty(ve)?(J.push({command:Nn.removeLayer,args:[ve]}),Y.splice(Y.lastIndexOf(ve,Y.length-_e),1)):_e++,we=Y[Y.length-oe],J.push({command:Nn.addLayer,args:[$[ve],we]}),Y.splice(Y.length-oe,0,ve),ae[ve]=!0);for(oe=0;oe<ee.length;oe++)if(ve=ee[oe],ye=re[ve],Ce=$[ve],!ae[ve]&&!Ke(ye,Ce))if(Ke(ye.source,Ce.source)&&Ke(ye["source-layer"],Ce["source-layer"])&&Ke(ye.type,Ce.type)){for(ke in no(ye.layout,Ce.layout,J,ve,null,Nn.setLayoutProperty),no(ye.paint,Ce.paint,J,ve,null,Nn.setPaintProperty),Ke(ye.filter,Ce.filter)||J.push({command:Nn.setFilter,args:[ve,Ce.filter]}),Ke(ye.minzoom,Ce.minzoom)&&Ke(ye.maxzoom,Ce.maxzoom)||J.push({command:Nn.setLayerZoomRange,args:[ve,Ce.minzoom,Ce.maxzoom]}),ye)ye.hasOwnProperty(ke)&&"layout"!==ke&&"paint"!==ke&&"filter"!==ke&&"metadata"!==ke&&"minzoom"!==ke&&"maxzoom"!==ke&&(0===ke.indexOf("paint.")?no(ye[ke],Ce[ke],J,ve,ke.slice(6),Nn.setPaintProperty):Ke(ye[ke],Ce[ke])||J.push({command:Nn.setLayerProperty,args:[ve,ke,Ce[ke]]}));for(ke in Ce)Ce.hasOwnProperty(ke)&&!ye.hasOwnProperty(ke)&&"layout"!==ke&&"paint"!==ke&&"filter"!==ke&&"metadata"!==ke&&"minzoom"!==ke&&"maxzoom"!==ke&&(0===ke.indexOf("paint.")?no(ye[ke],Ce[ke],J,ve,ke.slice(6),Nn.setPaintProperty):Ke(ye[ke],Ce[ke])||J.push({command:Nn.setLayerProperty,args:[ve,ke,Ce[ke]]}))}else J.push({command:Nn.removeLayer,args:[ve]}),we=Y[Y.lastIndexOf(ve)+1],J.push({command:Nn.addLayer,args:[Ce,we]})}(B,w.layers,T)}catch(S){console.warn("Unable to compute style diff:",S),T=[{command:Nn.setStyle,args:[w]}]}return T}(this.serialize(),l).filter(x=>!(x.command in Vc));if(0===h.length)return!1;const _=h.filter(x=>!(x.command in mi));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);return h.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=l,this._updateMapProjection(),!0}addImage(l,h){return this.getImage(l)?this.fire(new f.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(l,h),this._afterImageUpdated(l),this)}updateImage(l,h){this.imageManager.updateImage(l,h)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){return this.getImage(l)?(this.imageManager.removeImage(l),this._afterImageUpdated(l),this):this.fire(new f.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new f.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(l,h,_={}){if(this._checkLoaded(),void 0!==this.getSource(l))throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(f.validateSource,`sources.${l}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const x=ln(l,h,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(l),source:x.serialize(),sourceId:l}));const w=T=>{const S=(T?"symbol:":"other:")+l,P=this._sourceCaches[S]=new f.SourceCache(S,x,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[l]=P,P.style=this,P.onAdd(this.map)};w(!1),"vector"!==h.type&&"geojson"!==h.type||w(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(l){this._checkLoaded();const h=this.getSource(l);if(!h)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===l)return this.fire(new f.ErrorEvent(new Error(`Source "${l}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===l)return this.fire(new f.ErrorEvent(new Error(`Source "${l}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(l);for(const x of _)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new f.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[l],delete this._symbolSourceCaches[l],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(l,h){this._checkLoaded(),this.getSource(l).setData(h),this._changed=!0}getSource(l){const h=this._getSourceCache(l);return h&&h.getSource()}_getSources(){const l=[];for(const h in this._otherSourceCaches){const _=this._getSourceCache(h);_&&l.push(_.getSource())}return l}addLayer(l,h,_={}){this._checkLoaded();const x=l.id;if(this.getLayer(x))return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let w;if("custom"===l.type){if(La(this,f.validateCustomStyleLayer(l)))return;w=f.createStyleLayer(l)}else{if("object"==typeof l.source&&(this.addSource(x,l.source),l=f.clone$1(l),l=f.extend(l,{source:x})),this._validate(f.validateLayer,`layers.${x}`,l,{arrayIndex:-1},_))return;w=f.createStyleLayer(l),this._validateLayer(w),w.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const T=h?this._order.indexOf(h):this._order.length;if(h&&-1===T)return void this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(T,0,x),this._layerOrderChanged=!0,this._layers[x]=w;const S=this._getLayerSourceCache(w);if(this._removedLayers[x]&&w.source&&S&&"custom"!==w.type){const P=this._removedLayers[x];delete this._removedLayers[x],P.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",S.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(l,h){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===h)return;const _=this._order.indexOf(l);this._order.splice(_,1);const x=h?this._order.indexOf(h):this._order.length;h&&-1===x?this.fire(new f.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(x,0,l),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(l){this._checkLoaded();const h=this._layers[l];if(!h)return void this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const _=this._order.indexOf(l);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=h,delete this._layers[l],delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(l){return this._layers[l]}hasLayer(l){return l in this._layers}hasLayerType(l){for(const h in this._layers)if(this._layers[h].type===l)return!0;return!1}setLayerZoomRange(l,h,_){this._checkLoaded();const x=this.getLayer(l);x?x.minzoom===h&&x.maxzoom===_||(null!=h&&(x.minzoom=h),null!=_&&(x.maxzoom=_),this._updateLayer(x)):this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(l,h,_={}){this._checkLoaded();const x=this.getLayer(l);if(x){if(!Ke(x.filter,h))return null==h?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(f.validateFilter,`layers.${x.id}.filter`,h,{layerType:x.type},_)||(x.filter=f.clone$1(h),this._updateLayer(x)))}else this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be filtered.`)))}getFilter(l){const h=this.getLayer(l);return h&&f.clone$1(h.filter)}setLayoutProperty(l,h,_,x={}){this._checkLoaded();const w=this.getLayer(l);w?Ke(w.getLayoutProperty(h),_)||(w.setLayoutProperty(h,_,x),this._updateLayer(w)):this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(l,h){const _=this.getLayer(l);if(_)return _.getLayoutProperty(h);this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style.`)))}setPaintProperty(l,h,_,x={}){this._checkLoaded();const w=this.getLayer(l);w?Ke(w.getPaintProperty(h),_)||(w.setPaintProperty(h,_,x)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new f.ErrorEvent(new Error(`The layer '${l}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(l,h){const _=this.getLayer(l);return _&&_.getPaintProperty(h)}setFeatureState(l,h){this._checkLoaded();const _=l.source,x=l.sourceLayer,w=this.getSource(_);if(!w)return void this.fire(new f.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const T=w.type;if("geojson"===T&&x)return void this.fire(new f.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===T&&!x)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===l.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided.")));const S=this._getSourceCaches(_);for(const P of S)P.setFeatureState(x,l.id,h)}removeFeatureState(l,h){this._checkLoaded();const _=l.source,x=this.getSource(_);if(!x)return void this.fire(new f.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const w=x.type,T="vector"===w?l.sourceLayer:void 0;if("vector"===w&&!T)return void this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&"string"!=typeof l.id&&"number"!=typeof l.id)return void this.fire(new f.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const S=this._getSourceCaches(_);for(const P of S)P.removeFeatureState(T,l.id,h)}getFeatureState(l){this._checkLoaded();const h=l.source,_=l.sourceLayer,x=this.getSource(h);if(x){if("vector"!==x.type||_)return void 0===l.id&&this.fire(new f.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,l.id);this.fire(new f.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new f.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return f.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const l={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();l[_.id]||(l[_.id]=_.serialize())}return f.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:l,layers:this._serializeLayers(this._order)},h=>void 0!==h)}_updateLayer(l){this._updatedLayers[l.id]=!0;const h=this._getLayerSourceCache(l);l.source&&!this._updatedSources[l.source]&&h&&"raster"!==h.getSource().type&&(this._updatedSources[l.source]="reload",h.pause()),this._changed=!0,l.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(l){const h=T=>"fill-extrusion"===this._layers[T].type,_={},x=[];for(let T=this._order.length-1;T>=0;T--){const S=this._order[T];if(h(S)){_[S]=T;for(const P of l){const B=P[S];if(B)for(const N of B)x.push(N)}}}x.sort((T,S)=>S.intersectionZ-T.intersectionZ);const w=[];for(let T=this._order.length-1;T>=0;T--){const S=this._order[T];if(h(S))for(let P=x.length-1;P>=0;P--){const B=x[P].feature;if(_[B.layer.id]<T)break;w.push(B),x.pop()}else for(const P of l){const B=P[S];if(B)for(const N of B)w.push(N.feature)}}return w}queryRenderedFeatures(l,h,_){h&&h.filter&&this._validate(f.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const x={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new f.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const P of h.layers){const B=this._layers[P];if(!B)return this.fire(new f.ErrorEvent(new Error(`The layer '${P}' does not exist in the map's style and cannot be queried for features.`))),[];x[B.source]=!0}}const w=[];h.availableImages=this._availableImages;const T=h&&h.layers?h.layers.some(P=>{const B=this.getLayer(P);return B&&B.is3D()}):this.has3DLayers(),S=vo.createFromScreenPoints(l,_);for(const P in this._sourceCaches){const B=this._sourceCaches[P].getSource().id;h.layers&&!x[B]||w.push(Di(this._sourceCaches[P],this._layers,this._serializedLayers,S,h,_,T,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(P,B,N,j,X,J,te){const ee={},re=J.queryRenderedSymbols(j),$=[];for(const Y of Object.keys(re).map(Number))$.push(te[Y]);$.sort(mr);for(const Y of $){const ae=Y.featureIndex.lookupSymbolFeatures(re[Y.bucketInstanceId],B,Y.bucketIndex,Y.sourceLayerIndex,X.filter,X.layers,X.availableImages,P);for(const oe in ae){const _e=ee[oe]=ee[oe]||[],ve=ae[oe];ve.sort((ye,Ce)=>{const we=Y.featureSortOrder;if(we){const ke=we.indexOf(ye.featureIndex);return we.indexOf(Ce.featureIndex)-ke}return Ce.featureIndex-ye.featureIndex});for(const ye of ve)_e.push(ye)}}for(const Y in ee)ee[Y].forEach(ae=>{const oe=ae.feature,_e=N(P[Y]);if(!_e)return;const ve=_e.getFeatureState(oe.layer["source-layer"],oe.id);oe.source=oe.layer.source,oe.layer["source-layer"]&&(oe.sourceLayer=oe.layer["source-layer"]),oe.state=ve});return ee}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),S.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(l,h){h&&h.filter&&this._validate(f.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const _=this._getSourceCaches(l);let x=[];for(const w of _)x=x.concat(ji(w,h));return x}addSourceType(l,h,_){return gs.getSourceType(l)?_(new Error(`A source type called "${l}" already exists.`)):(gs.setSourceType(l,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(l,h={}){this._checkLoaded();const _=this.light.getLight();let x=!1;for(const T in l)if(!Ke(l[T],_[T])){x=!0;break}if(!x)return;const w=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(l,h),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(l,h=1){if(this._checkLoaded(),!l)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=l;if(1===h){if("object"==typeof _.source){const x="terrain-dem-src";this.addSource(x,_.source),_=f.clone$1(_),_=f.extend(_,{source:x})}if(this._validate(f.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,h)}else{const x=this.terrain,w=x.get();for(const T of Object.keys(f.spec.terrain))!_.hasOwnProperty(T)&&f.spec.terrain[T].default&&(_[T]=f.spec.terrain[T].default);for(const T in _)if(!Ke(_[T],w[T])){x.set(_),this.stylesheet.terrain=_;const S=this._setTransitionParameters({duration:0});x.updateTransitions(S);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(l){const h=this.fog=new yo(l,this.map.transform);this.stylesheet.fog=l;const _=this._setTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const l of this.map._markers)l._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(l){if(this._checkLoaded(),!l)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,_=h.get();0===Object.keys(l).length&&h.set(l);for(const x in l)if(!Ke(l[x],_[x])){h.set(l),this.stylesheet.fog=l;const w=this._setTransitionParameters({duration:0});h.updateTransitions(w);break}}else this._createFog(l);this._markersNeedUpdate=!0}_setTransitionParameters(l){return{now:f.exported.now(),transition:f.extend(l,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const l=this._order.filter(_=>this.isLayerDraped(this._layers[_])),h=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...l),this._drapedFirstOrder.push(...h)}_createTerrain(l,h){const _=this.terrain=new ec(l,h);this.stylesheet.terrain=l,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});_.updateTransitions(x)}_force3DLayerUpdate(){for(const l in this._layers){const h=this._layers[l];"fill-extrusion"===h.type&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const l in this._layers){const h=this._layers[l];"symbol"===h.type&&this._updateLayer(h)}}_validate(l,h,_,x,w={}){return(!w||!1!==w.validate)&&La(this,l.call(f.validateStyle,f.extend({key:h,style:this.serialize(),value:_,styleSpec:f.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),f.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const l in this._layers)this._layers[l].setEventedParent(null);for(const l in this._sourceCaches)this._sourceCaches[l].clearTiles(),this._sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(l){const h=this._getSourceCaches(l);for(const _ of h)_.clearTiles()}_reloadSource(l){const h=this._getSourceCaches(l);for(const _ of h)_.resume(),_.reload()}_reloadSources(){for(const l of this._getSources())l.reload&&l.reload()}_updateSources(l){for(const h in this._sourceCaches)this._sourceCaches[h].update(l)}_generateCollisionBoxes(){for(const l in this._sourceCaches){const h=this._sourceCaches[l];h.resume(),h.reload()}}_updatePlacement(l,h,_,x,w=!1){let T=!1,S=!1;const P={};for(const B of this._order){const N=this._layers[B];if("symbol"!==N.type)continue;if(!P[N.source]){const X=this._getLayerSourceCache(N);if(!X)continue;P[N.source]=X.getRenderableIds(!0).map(J=>X.getTileByID(J)).sort((J,te)=>te.tileID.overscaledZ-J.tileID.overscaledZ||(J.tileID.isLessThan(te.tileID)?-1:1))}const j=this.crossTileSymbolIndex.addLayer(N,P[N.source],l.center.lng,l.projection);T=T||j}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new f.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(f.exported.now(),l.zoom))&&(this.pauseablePlacement=new oo(l,this._order,w,h,_,x,this.placement,this.fog&&l.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(f.exported.now()),S=!0),T&&this.pauseablePlacement.placement.setStale()),S||T)for(const B of this._order){const N=this._layers[B];"symbol"===N.type&&this.placement.updateLayerOpacities(N,P[N.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(f.exported.now())}_releaseSymbolFadeTiles(){for(const l in this._sourceCaches)this._sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();const x=w=>{w&&w.setDependencies(h.tileID.key,h.type,h.icons)};x(this._otherSourceCaches[h.source]),x(this._symbolSourceCaches[h.source])}getGlyphs(l,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(l,h,_){return f.makeRequest(h,_)}_getSourceCache(l){return this._otherSourceCaches[l]}_getLayerSourceCache(l){return"symbol"===l.type?this._symbolSourceCaches[l.source]:this._otherSourceCaches[l.source]}_getSourceCaches(l){const h=[];return this._otherSourceCaches[l]&&h.push(this._otherSourceCaches[l]),this._symbolSourceCaches[l]&&h.push(this._symbolSourceCaches[l]),h}_isSourceCacheLoaded(l){const h=this._getSourceCaches(l);return 0===h.length?(this.fire(new f.ErrorEvent(new Error(`There is no source with ID '${l}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}gs.getSourceType=function(m){return It[m]},gs.setSourceType=function(m,l){It[m]=l},gs.registerForPluginStateChange=f.registerForPluginStateChange;var Uc="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",_s="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Co="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Ba="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",zs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Bt={},ha={};const El=[];Va(Uc,El),Va(Co,El),Va(Ba,El),Va(zs,El),Bt=Mn("",Co),ha=Mn(zs,Ba);const Do=Mn("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),za=Uc,Tu="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ai={background:Mn("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Mn("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Mn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Mn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Mn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Mn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Mn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Mn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Mn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Mn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Mn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Mn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Mn("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Mn("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Mn("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Mn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Mn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Mn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Mn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Mn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Mn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Mn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Mn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Mn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Mn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Mn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",_s),skyboxGradient:Mn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",_s),skyboxCapture:Mn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Mn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Mn("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Va(m,l){const h=m.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let _ of h)if(_=_.trim(),"#"===_[0]&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=_.split(" ");for(const w of x)l.includes(w)||l.push(w)}}function Mn(m,l){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=l.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},w=[...El];return Va(m,w),Va(l,w),{fragmentSource:m=m.replace(h,(T,S,P,B,N)=>(x[N]=!0,"define"===S?`\n#ifndef HAS_UNIFORM_u_${N}\nvarying ${P} ${B} ${N};\n#else\nuniform ${P} ${B} u_${N};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${N}\n    ${P} ${B} ${N} = u_${N};\n#endif\n`)),vertexSource:l=l.replace(h,(T,S,P,B,N)=>{const j="float"===B?"vec2":"vec4",X=N.match(/color/)?"color":j;return x[N]?"define"===S?`\n#ifndef HAS_UNIFORM_u_${N}\nuniform lowp float u_${N}_t;\nattribute ${P} ${j} a_${N};\nvarying ${P} ${B} ${N};\n#else\nuniform ${P} ${B} u_${N};\n#endif\n`:"vec4"===X?`\n#ifndef HAS_UNIFORM_u_${N}\n    ${N} = a_${N};\n#else\n    ${P} ${B} ${N} = u_${N};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${N}\n    ${N} = unpack_mix_${X}(a_${N}, u_${N}_t);\n#else\n    ${P} ${B} ${N} = u_${N};\n#endif\n`:"define"===S?`\n#ifndef HAS_UNIFORM_u_${N}\nuniform lowp float u_${N}_t;\nattribute ${P} ${j} a_${N};\n#else\nuniform ${P} ${B} u_${N};\n#endif\n`:"vec4"===X?`\n#ifndef HAS_UNIFORM_u_${N}\n    ${P} ${B} ${N} = a_${N};\n#else\n    ${P} ${B} ${N} = u_${N};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${N}\n    ${P} ${B} ${N} = unpack_mix_${X}(a_${N}, u_${N}_t);\n#else\n    ${P} ${B} ${N} = u_${N};\n#endif\n`}),staticAttributes:_,usedDefines:w}}class qf{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(l,h,_,x,w,T,S){this.context=l;let P=this.boundPaintVertexBuffers.length!==x.length;for(let N=0;!P&&N<x.length;N++)this.boundPaintVertexBuffers[N]!==x[N]&&(P=!0);let B=this.boundDynamicVertexBuffers.length!==S.length;for(let N=0;!B&&N<S.length;N++)this.boundDynamicVertexBuffers[N]!==S[N]&&(B=!0);if(!l.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||P||B||this.boundIndexBuffer!==w||this.boundVertexOffset!==T)this.freshBind(h,_,x,w,T,S);else{l.bindVertexArrayOES.set(this.vao);for(const N of S)N&&N.bind();w&&w.dynamicDraw&&w.bind()}}freshBind(l,h,_,x,w,T){let S;const P=l.numAttributes,B=this.context,N=B.gl;if(B.extVertexArrayObject)this.vao&&this.destroy(),this.vao=B.extVertexArrayObject.createVertexArrayOES(),B.bindVertexArrayOES.set(this.vao),S=0,this.boundProgram=l,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=x,this.boundVertexOffset=w,this.boundDynamicVertexBuffers=T;else{S=B.currentNumAttributes||0;for(let j=P;j<S;j++)N.disableVertexAttribArray(j)}h.enableAttributes(N,l),h.bind(),h.setVertexAttribPointers(N,l,w);for(const j of _)j.enableAttributes(N,l),j.bind(),j.setVertexAttribPointers(N,l,w);for(const j of T)j&&(j.enableAttributes(N,l),j.bind(),j.setVertexAttribPointers(N,l,w));x&&x.bind(),B.currentNumAttributes=P}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function da(m,l){const h=Math.pow(2,l.canonical.z),_=l.canonical.y;return[new f.MercatorCoordinate(0,_/h).toLngLat().lat,new f.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function sc(m,l,h,_,x,w,T){const S=m.context,P=S.gl,B=h.fbo;if(!B)return;m.prepareDrawTile();const N=m.useProgram("hillshade");S.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,B.colorAttachment.get());const j=((ee,re,$,Y)=>{const ae=$.paint.get("hillshade-shadow-color"),oe=$.paint.get("hillshade-highlight-color"),_e=$.paint.get("hillshade-accent-color");let ve=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===$.paint.get("hillshade-illumination-anchor")&&(ve-=ee.transform.angle);const ye=!ee.options.moving;return{u_matrix:Y||ee.transform.calculateProjMatrix(re.tileID.toUnwrapped(),ye),u_image:0,u_latrange:da(0,re.tileID),u_light:[$.paint.get("hillshade-exaggeration"),ve],u_shadow:ae,u_highlight:oe,u_accent:_e}})(m,h,_,m.terrain?l.projMatrix:null);m.prepareDrawProgram(S,N,l.toUnwrapped());const{tileBoundsBuffer:X,tileBoundsIndexBuffer:J,tileBoundsSegments:te}=m.getTileBoundsBuffers(h);N.draw(S,P.TRIANGLES,x,w,T,f.CullFaceMode.disabled,j,_.id,X,J,te)}function Ua(m,l,h){if(!l.needsDEMTextureUpload)return;const _=m.context,x=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||m.getTileTexture(h.stride);const w=h.getPixels();l.demTexture?l.demTexture.update(w,{premultiply:!1}):l.demTexture=new f.Texture(_,w,x.RGBA,{premultiply:!1}),l.needsDEMTextureUpload=!1}function Su(m,l,h,_,x,w){const T=m.context,S=T.gl;if(!l.dem)return;const P=l.dem;if(T.activeTexture.set(S.TEXTURE1),Ua(m,l,P),!l.demTexture)return;l.demTexture.bind(S.NEAREST,S.CLAMP_TO_EDGE);const B=P.dim;T.activeTexture.set(S.TEXTURE0);let N=l.fbo;if(!N){const te=new f.Texture(T,{width:B,height:B,data:null},S.RGBA);te.bind(S.LINEAR,S.CLAMP_TO_EDGE),N=l.fbo=T.createFramebuffer(B,B,!0),N.colorAttachment.set(te.texture)}T.bindFramebuffer.set(N.framebuffer),T.viewport.set([0,0,B,B]);const{tileBoundsBuffer:j,tileBoundsIndexBuffer:X,tileBoundsSegments:J}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(T,S.TRIANGLES,_,x,w,f.CullFaceMode.disabled,((te,ee)=>{const re=ee.stride,$=f.create();return f.ortho($,0,f.EXTENT,-f.EXTENT,0,0,1),f.translate($,$,[0,-f.EXTENT,0]),{u_matrix:$,u_image:1,u_dimension:[re,re],u_zoom:te.overscaledZ,u_unpack:ee.unpackVector}})(l.tileID,P),h.id,j,X,J),l.needsHillshadePrepare=!1}const jc=m=>({u_matrix:new f.UniformMatrix4f(m),u_image0:new f.Uniform1i(m),u_skirt_height:new f.Uniform1f(m)}),ja=(m,l)=>({u_matrix:m,u_image0:0,u_skirt_height:l}),Cl=(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:l,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:x,u_merc_center:w,u_image0:0,u_frustum_tl:T,u_frustum_tr:S,u_frustum_br:P,u_frustum_bl:B,u_globe_pos:N,u_globe_radius:j,u_viewport:X,u_grid_matrix:te?Float32Array.from(te):new Float32Array(9),u_skirt_height:J});function ts(m,l){return null!=m&&null!=l&&!(!m.hasData()||!l.hasData())&&null!=m.demTexture&&null!=l.demTexture&&m.tileID.key!==l.tileID.key}const jr=new class{constructor(){this.operations={}}newMorphing(m,l,h,_,x){if(m in this.operations){const w=this.operations[m];w.to.tileID.key!==h.tileID.key&&(w.queued=h)}else this.operations[m]={startTime:_,phase:0,duration:x,from:l,to:h,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const l=this.operations[m];return{from:l.from,to:l.to,phase:l.phase}}update(m){for(const l in this.operations){const h=this.operations[l];for(h.phase=(m-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,m)){delete this.operations[l];break}}}_nextOp(m,l){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=l,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},jo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function ze(m){return 6*Math.pow(1.5,22-m)}function Mu(m,l){const h=1<<m.z;return!l&&(0===m.x||m.x===h-1)||0===m.y||m.y===h-1}const Zt=m=>({u_matrix:m});function $a(m,l,h,_,x){if(x>0){const w=f.exported.now(),T=(w-m.timeAdded)/x,S=l?(w-l.timeAdded)/x:-1,P=h.getSource(),B=_.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),N=!l||Math.abs(l.tileID.overscaledZ-B)>Math.abs(m.tileID.overscaledZ-B),j=N&&m.refreshedUponExpiration?1:f.clamp(N?T:1-S,0,1);return m.refreshedUponExpiration&&T>=1&&(m.refreshedUponExpiration=!1),l?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class Dl extends f.SourceCache{constructor(l){const h={type:"raster-dem",maxzoom:l.transform.maxZoom},_=new Lt(pi(),null),x=ln("mock-dem",h,_,l.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(l,h){l.state="loaded",h(null)}}class Vs extends f.SourceCache{constructor(l){const h=ln("proxy",{type:"geojson",maxzoom:l.transform.maxZoom},new Lt(pi(),null),l.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=l,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(l,h,_){if(l.freezeTileCoverage)return;this.transform=l;const x=l.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,T)=>{if(w[T.key]="",!this._tiles[T.key]){const S=new f.Tile(T,this._source.tileSize*T.overscaleFactor(),l.tileZoom);S.state="loaded",this._tiles[T.key]=S}return w},{});for(const w in this._tiles)w in x||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(l){const h=this.proxyCachedFBO[l];if(void 0!==h){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[l]}}deallocRenderCache(){this.renderCache.forEach(l=>l.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class $c extends f.OverscaledTileID{constructor(l,h,_){super(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class Au extends f.Elevation{constructor(l,h){super(),this.painter=l,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,x,w]=function(P){const B=new f.StructArrayLayout2i4,N=new f.StructArrayLayout3ui6,j=131;B.reserve(17161),N.reserve(33800);const X=f.EXTENT/128,J=f.EXTENT+X/2,te=J+X;for(let re=-X;re<te;re+=X)for(let $=-X;$<te;$+=X){const Y=$<0||$>J||re<0||re>J?24575:0,ae=f.clamp(Math.round($),0,f.EXTENT),oe=f.clamp(Math.round(re),0,f.EXTENT);B.emplaceBack(ae+Y,oe)}const ee=(re,$)=>{const Y=$*j+re;N.emplaceBack(Y+1,Y,Y+j),N.emplaceBack(Y+j,Y+j+1,Y+1)};for(let re=1;re<129;re++)for(let $=1;$<129;$++)ee($,re);return[0,129].forEach(re=>{for(let $=0;$<130;$++)ee($,re),ee(re,$)}),[B,N,32768]}(),T=l.context;this.gridBuffer=T.createVertexBuffer(_,f.posAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(x),this.gridSegments=f.SegmentVector.simpleSegment(0,0,_.length,x.length),this.gridNoSkirtSegments=f.SegmentVector.simpleSegment(0,0,_.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Vs(h.map),this.orthoMatrix=f.create(),f.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,f.EXTENT,0,f.EXTENT,0,1);const S=T.gl;this._overlapStencilMode=new f.StencilMode({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=l.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Dl(h.map)}set style(l){l.on("data",this._onStyleDataEvent.bind(this)),l.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=l,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(l,h,_){if(l&&l.terrain){this._style!==l&&(this.style=l),this.enabled=!0;const x=l.terrain.properties;this.sourceCache=0===l.terrain.drapeRenderMode?this._mockSourceCache:l._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const w=()=>{this.sourceCache.used&&f.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(h,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(l){this._findCoveringTileCache[l]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const l=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==l.efficiency&&f.warnOnce(`Terrain render cache efficiency is not optimal (${l.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${l.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(l){l.coord&&"source"===l.dataType?this._clearRenderCacheForTile(l.sourceCacheId,l.coord):"style"===l.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const l in this._style._sourceCaches)this._style._sourceCaches[l].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(l=>l.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const l=2*this.proxySourceCache.getSource().tileSize;return[l,l]}set useVertexMorphing(l){this._useVertexMorphing=l}updateTileBinding(l){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=h.getIds().map(P=>{const B=h.getTileByID(P).tileID;return B.projMatrix=_.calculateProjMatrix(B.toUnwrapped()),B});(function(P,B){const N=B.transform.pointCoordinate(B.transform.getCameraPoint()),j=new f.Point(N.x,N.y);P.sort((X,J)=>{if(J.overscaledZ-X.overscaledZ)return J.overscaledZ-X.overscaledZ;const te=new f.Point(X.canonical.x+(1<<X.canonical.z)*X.wrap,X.canonical.y),ee=new f.Point(J.canonical.x+(1<<J.canonical.z)*J.wrap,J.canonical.y),re=j.mult(1<<X.canonical.z);return re.x-=.5,re.y-=.5,re.distSqr(te)-re.distSqr(ee)})})(x,this.painter),this._previousZoom=_.zoom;const w=this.proxyToSource||{};this.proxyToSource={},x.forEach(P=>{this.proxyToSource[P.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const P in T){const B=T[P];if(!B.used||(B!==this.sourceCache&&this.resetTileLookupCache(B.id),this._setupProxiedCoordsForOrtho(B,l[P],w),B.usedForTerrain))continue;const N=l[P];B.getSource().reparseOverscaled&&this._assignTerrainTiles(N)}this.proxiedCoords[h.id]=x.map(P=>new $c(P,P.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=f.exported.now();const S={};this._visibleDemTiles=[];for(const P of this.proxyCoords){const B=this.terrainTileForTile[P.key];if(!B)continue;const N=B.tileID.key;N in S||(this._visibleDemTiles.push(B),S[N]=N)}}_assignTerrainTiles(l){this._initializing||l.forEach(h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){const l=this.painter.context,h=l.gl;for(const _ in this.terrainTileForTile){const x=this.terrainTileForTile[_],w=x.dem;!w||x.demTexture&&!x.needsDEMTextureUpload||(l.activeTexture.set(h.TEXTURE1),Ua(this.painter,x,w))}}_prepareDemTileUniforms(l,h,_,x){if(!h||null==h.demTexture)return!1;const w=l.tileID.canonical,T=Math.pow(2,h.tileID.canonical.z-w.z),S=x||"";return _[`u_dem_tl${S}`]=[w.x*T%1,w.y*T%1],_[`u_dem_scale${S}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const l=this.painter.context,h=l.gl;if(!this._emptyDepthBufferTexture){const _=new f.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new f.Texture(l,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let l=0;const h=this._visibleDemTiles.reduce((_,x)=>{if(!x.dem)return _;const w=x.dem.tree.minimums[0];return w>0&&l++,_+w},0);return l?h/l:0}_updateEmptyDEMTexture(){const l=this.painter.context,h=l.gl;l.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),x=new f.RGBAImage({width:1,height:1},new Uint8Array(f.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(x,{premultiply:!1}):w=this._emptyDEMTexture=new f.Texture(l,x,h.RGBA,{premultiply:!1}),w}setupElevationDraw(l,h,_){const x=this.painter.context,w=x.gl,T=(S=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:f.DEMData.getUnpackVector(S),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var S;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();let P=null,B=null,N=1;if(_&&_.morphing&&this._useVertexMorphing){const j=_.morphing.srcDemTile,X=_.morphing.dstDemTile;N=_.morphing.phase,j&&X&&(this._prepareDemTileUniforms(l,j,T,"_prev")&&(B=j),this._prepareDemTileUniforms(l,X,T)&&(P=X))}if(B&&P?(x.activeTexture.set(w.TEXTURE2),P.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),x.activeTexture.set(w.TEXTURE4),B.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),T.u_dem_lerp=N):(P=this.terrainTileForTile[l.tileID.key],x.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(l,P,T)?P.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),x.activeTexture.set(w.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&P){const j=(1<<P.tileID.canonical.z)*f.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=j}if(_&&_.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(x,T),"globe"===this.painter.transform.projection.name){const j=this.globeUniformValues(this.painter.transform,l.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(x,j)}}globeUniformValues(l,h,_){const x=l.projection;return{u_tile_tl_up:x.upVector(h,0,0),u_tile_tr_up:x.upVector(h,f.EXTENT,0),u_tile_br_up:x.upVector(h,f.EXTENT,f.EXTENT),u_tile_bl_up:x.upVector(h,0,f.EXTENT),u_tile_up_scale:_?f.globeMetersToEcef(1):x.upVectorScale(h,l.center.lat,l.worldSize).metersToTile}}renderToBackBuffer(l){const h=this.painter,_=this.painter.context;0!==l.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,w,T,S,P){if("globe"===x.transform.projection.name)!function(B,N,j,X,J){const te=B.context,ee=te.gl;let re,$;const Y=B.options.showTerrainWireframe?2:0,ae=B.transform,oe=f.globeUseCustomAntiAliasing(B,te,ae),_e=(nt,Pe)=>{if($===nt)return;const He=[jo[nt],"PROJECTION_GLOBE_VIEW"];oe&&He.push("CUSTOM_ANTIALIASING"),Pe&&He.push(jo[Y]),re=B.useProgram("globeRaster",null,He),$=nt},ve=B.colorModeForRenderPass(),ye=new f.DepthMode(ee.LEQUAL,f.DepthMode.ReadWrite,B.depthRangeFor3D);jr.update(J);const Ce=f.calculateGlobeMercatorMatrix(ae),we=[f.mercatorXfromLng(ae.center.lng),f.mercatorYfromLat(ae.center.lat)],ke=Y?[!1,!0]:[!1],tt=B.globeSharedBuffers,Ie=[ae.width*f.exported.devicePixelRatio,ae.height*f.exported.devicePixelRatio],qe=Float32Array.from(ae.globeMatrix),Fe={useDenormalizedUpVectorScale:!0};if(ke.forEach(nt=>{const Pe=B.transform,He=ze(Pe.zoom)*N.exaggeration();$=-1;const it=nt?ee.LINES:ee.TRIANGLES;for(const Je of X){const at=j.getTile(Je),St=f.StencilMode.disabled,Gt=N.prevTerrainTileForTile[Je.key],wt=N.terrainTileForTile[Je.key];ts(Gt,wt)&&jr.newMorphing(Je.key,Gt,wt,J,250),te.activeTexture.set(ee.TEXTURE0),at.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const kt=jr.getMorphValuesForProxy(Je.key),vn=kt?1:0;kt&&f.extend$1(Fe,{morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:f.easeCubicInOut(kt.phase)}});const gn=f.tileCornersToBounds(Je.canonical),Ct=f.getLatitudinalLod(gn.getCenter().lat),Gn=f.getGridMatrix(Je.canonical,gn,Ct,Pe.worldSize/Pe._pixelsPerMercatorPixel),ii=f.globeNormalizeECEF(f.globeTileBounds(Je.canonical)),qn=Cl(Pe.projMatrix,qe,Ce,ii,f.globeToMercatorTransition(Pe.zoom),we,Pe.frustumCorners.TL,Pe.frustumCorners.TR,Pe.frustumCorners.BR,Pe.frustumCorners.BL,Pe.globeCenterInViewSpace,Pe.globeRadius,Ie,He,Gn);if(_e(vn,nt),N.setupElevationDraw(at,re,Fe),B.prepareDrawProgram(te,re,Je.toUnwrapped()),tt){const[ri,Gr,rr]=nt?tt.getWirefameBuffers(B.context,Ct):tt.getGridBuffers(Ct,0!==He);re.draw(te,it,ye,St,ve,f.CullFaceMode.backCCW,qn,"globe_raster",ri,Gr,rr)}}}),tt){const nt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];oe&&nt.push("CUSTOM_ANTIALIASING"),re=B.useProgram("globeRaster",null,nt);for(const Pe of X){const{x:He,y:it,z:Je}=Pe.canonical,at=0===it,St=it===(1<<Je)-1,[Gt,wt,kt,vn]=tt.getPoleBuffers(Je);if(vn&&(at||St)){const gn=j.getTile(Pe);te.activeTexture.set(ee.TEXTURE0),gn.texture.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);let Ct=f.globePoleMatrixForTile(Je,He,ae);const Gn=f.globeNormalizeECEF(f.globeTileBounds(Pe.canonical)),ii=(qn,ri)=>qn.draw(te,ee.TRIANGLES,ye,f.StencilMode.disabled,ve,f.CullFaceMode.disabled,Cl(ae.projMatrix,Ct,Ct,Gn,0,we,ae.frustumCorners.TL,ae.frustumCorners.TR,ae.frustumCorners.BR,ae.frustumCorners.BL,ae.globeCenterInViewSpace,ae.globeRadius,Ie,0),"globe_pole_raster",ri,kt,vn);N.setupElevationDraw(gn,re,Fe),B.prepareDrawProgram(te,re,Pe.toUnwrapped()),at&&ii(re,Gt),St&&(Ct=f.scale(f.create(),Ct,[1,-1,1]),ii(re,wt))}}}}(x,w,T,S,P);else{const B=x.context,N=B.gl;let j,X;const J=x.options.showTerrainWireframe?2:0,te=(ae,oe)=>{if(X===ae)return;const _e=[jo[ae]];oe&&_e.push(jo[J]),j=x.useProgram("terrainRaster",null,_e),X=ae},ee=x.colorModeForRenderPass(),re=new f.DepthMode(N.LEQUAL,f.DepthMode.ReadWrite,x.depthRangeFor3D);jr.update(P);const $=x.transform,Y=ze($.zoom)*w.exaggeration();(J?[!1,!0]:[!1]).forEach(ae=>{X=-1;const oe=ae?N.LINES:N.TRIANGLES,[_e,ve]=ae?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const ye of S){const Ce=T.getTile(ye),we=f.StencilMode.disabled,ke=w.prevTerrainTileForTile[ye.key],tt=w.terrainTileForTile[ye.key];ts(ke,tt)&&jr.newMorphing(ye.key,ke,tt,P,250),B.activeTexture.set(N.TEXTURE0),Ce.texture.bind(N.LINEAR,N.CLAMP_TO_EDGE,N.LINEAR_MIPMAP_NEAREST);const Ie=jr.getMorphValuesForProxy(ye.key),qe=Ie?1:0;let Fe;Ie&&(Fe={morphing:{srcDemTile:Ie.from,dstDemTile:Ie.to,phase:f.easeCubicInOut(Ie.phase)}});const nt=ja(ye.projMatrix,Mu(ye.canonical,$.renderWorldCopies)?Y/10:Y);te(qe,ae),w.setupElevationDraw(Ce,j,Fe),x.prepareDrawProgram(B,j,ye.toUnwrapped()),j.draw(B,oe,re,we,ee,f.CullFaceMode.backCCW,nt,"terrain_raster",w.gridBuffer,_e,ve)}})}}(h,this,this.proxySourceCache,l,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),l.splice(0,l.length))}renderBatch(l){if(0===this._drapedRenderBatches.length)return l+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,x=this.proxySourceCache,w=this.proxiedCoords[x.id],T=this._drapedRenderBatches.shift(),S=[],P=h.style.order;let B=0;for(const N of w){const j=x.getTileByID(N.proxyTileKey),X=x.proxyCachedFBO[N.key]?x.proxyCachedFBO[N.key][l]:void 0,J=void 0!==X?x.renderCache[X]:this.pool[B++],te=void 0!==X;if(j.texture=J.tex,te&&!J.dirty){S.push(j.tileID);continue}let ee;_.bindFramebuffer.set(J.fb.framebuffer),this.renderedToTile=!1,J.dirty&&(_.clear({color:f.Color.transparent,stencil:0}),J.dirty=!1);for(let re=T.start;re<=T.end;++re){const $=h.style._layers[P[re]];if($.isHidden(h.transform.zoom))continue;const Y=h.style._getLayerSourceCache($),ae=Y?this.proxyToSource[N.key][Y.id]:[N];if(!ae)continue;const oe=ae;_.viewport.set([0,0,J.fb.width,J.fb.height]),ee!==(Y?Y.id:null)&&(this._setupStencil(J,ae,$,Y),ee=Y?Y.id:null),h.renderLayer(h,Y,$,oe)}this.renderedToTile?(J.dirty=!0,S.push(j.tileID)):te||--B,5===B&&(B=0,this.renderToBackBuffer(S))}return this.renderToBackBuffer(S),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),T.end+1}postRender(){}renderCacheEfficiency(l){const h=l.order.length;if(0===h)return{efficiency:100};let _,x=0,w=0,T=!1;for(let S=0;S<h;++S){const P=l._layers[l.order[S]];this._style.isLayerDraped(P)?(T&&++x,++w):T||(T=!0,_=P.id)}return 0===w?{efficiency:100}:{efficiency:100*(1-x/w),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let l=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{l=Math.min(l,h.dem.tree.minimums[0])}),0===l?l:(l-30)*this._exaggeration}raycast(l,h,_){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const T=w.tileID,S=1<<T.overscaledZ,{x:P,y:B}=T.canonical,N=P/S,j=(P+1)/S,X=B/S,J=(B+1)/S;return{minx:N,miny:X,maxx:j,maxy:J,t:w.dem.tree.raycastRoot(N,X,j,J,l,h,_),tile:w}});x.sort((w,T)=>(null!==w.t?w.t:Number.MAX_VALUE)-(null!==T.t?T.t:Number.MAX_VALUE));for(const w of x){if(null==w.t)return null;const T=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,l,h,_);if(null!=T)return T}return null}_createFBO(){const l=this.painter.context,h=l.gl,_=this.drapeBufferSize;l.activeTexture.set(h.TEXTURE0);const x=new f.Texture(l,{width:_[0],height:_[1],data:null},h.RGBA);x.bind(h.LINEAR,h.CLAMP_TO_EDGE);const w=l.createFramebuffer(_[0],_[1],!1);return w.colorAttachment.set(x.texture),w.depthAttachment=new be(l,w.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=l.createRenderbuffer(l.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),l.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),l.extTextureFilterAnisotropic&&!l.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,l.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,l.extTextureFilterAnisotropicMax),{fb:w,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const l in this._style._sourceCaches)if(this._style._sourceCaches[l].hasTransition())return!0;return this._style.order.some(l=>{const h=this._style._layers[l],_=h.isHidden(this.painter.transform.zoom);return"custom"===h.type?!_&&h.shouldRedrape():!_&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let l=!1;for(const _ of this._style._getSources())if(_ instanceof ut){l=!0;break}if(!l)return;const h={};for(let _=0;_<this._style.order.length;++_){const x=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(x);if(w&&!h[w.id]&&!x.isHidden(this.painter.transform.zoom)&&"line"===x.type&&x.widthExpression()instanceof f.ZoomDependentExpression){h[w.id]=!0;for(const T of this.proxyCoords){const S=this.proxyToSource[T.key][w.id];if(S)for(const P of S)this._clearRenderCacheForTile(w.id,P)}}}}_clearRasterLayersFromRenderCache(){let l=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof ot){l=!0;break}if(!l)return;const h={};for(let _=0;_<this._style.order.length;++_){const x=this._style._layers[this._style.order[_]],w=this._style._getLayerSourceCache(x);if(!w||h[w.id]||x.isHidden(this.painter.transform.zoom)||"raster"!==x.type)continue;const T=x.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const P=this.proxyToSource[S.key][w.id];if(P)for(const B of P){const N=$a(w.getTile(B),w.findLoadedParent(B,0),w,this.painter.transform,T);(1!==N.opacity||0!==N.mix)&&this._clearRenderCacheForTile(w.id,B)}}}}_setupDrapedRenderBatches(){const l=this._style.order,h=l.length;if(0===h)return;const _=[];let x,w=0,T=this._style._layers[l[w]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++w<h;)T=this._style._layers[l[w]];for(;w<h;++w){const S=this._style._layers[l[w]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?void 0===x&&(x=w):void 0!==x&&(_.push({start:x,end:w-1}),x=void 0))}void 0!==x&&_.push({start:x,end:w-1}),this._drapedRenderBatches=_}_setupRenderCache(l){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const T=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let S=0;S<T.length;++S){const P=Object.values(T[S]);h.renderCachePool.push(...P)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,x=this._tilesDirty;for(let T=_.length-1;T>=0;T--){const S=_[T];if(h.getTileByID(S.key),void 0!==h.proxyCachedFBO[S.key]){const P=l[S.key],B=this.proxyToSource[S.key];let N=0;for(const j in B){const X=B[j],J=P[j];if(!J||J.length!==X.length||X.some((te,ee)=>te!==J[ee]||x[j]&&x[j].hasOwnProperty(te.key))){N=-1;break}++N}for(const j in h.proxyCachedFBO[S.key])h.renderCache[h.proxyCachedFBO[S.key][j]].dirty=N<0||N!==Object.values(P).length}}const w=[...this._drapedRenderBatches];w.sort((T,S)=>S.end-S.start-(T.end-T.start));for(const T of w)for(const S of _){if(h.proxyCachedFBO[S.key])continue;let P=h.renderCachePool.pop();void 0===P&&h.renderCache.length<50&&(P=h.renderCache.length,h.renderCache.push(this._createFBO())),void 0!==P&&(h.proxyCachedFBO[S.key]={},h.proxyCachedFBO[S.key][T.start]=P,h.renderCache[P].dirty=!0)}this._tilesDirty={}}_setupStencil(l,h,_,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,T=w.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let S;if(_.isTileClipped())S=h.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(l){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[l.key]),this._overlapStencilMode):f.StencilMode.disabled}_renderTileClippingMasks(l,h){const _=this.painter,x=this.painter.context,w=x.gl;_._tileClippingMaskIDs={},x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const T=_.useProgram("clippingMask");for(const S of l){const P=_._tileClippingMaskIDs[S.key]=--h;T.draw(x,w.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:w.ALWAYS,mask:0},P,255,w.KEEP,w.KEEP,w.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Zt(S.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(l){const h=this.painter.transform;if(l.x<0||l.x>h.width||l.y<0||l.y>h.height)return null;const _=[l.x,l.y,1,1];f.transformMat4$1(_,_,h.pixelMatrixInverse),f.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const x=h._camera.position,w=f.mercatorZfromAltitude(1,h.center.lat),T=[x[0],x[1],x[2]/w,0],S=f.subtract([],_.slice(0,3),T);f.normalize(S,S);const P=this.raycast(T,S,this._exaggeration);return null!==P&&P?(f.scaleAndAdd(T,T,S,P),T[3]=T[2],T[2]*=w,T):null}drawDepth(){const l=this.painter,h=l.context,_=this.proxySourceCache,x=Math.ceil(l.width),w=Math.ceil(l.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=h.gl,S=h.createFramebuffer(x,w,!0);h.activeTexture.set(T.TEXTURE0);const P=new f.Texture(h,{width:x,height:w,data:null},T.RGBA);P.bind(T.NEAREST,T.CLAMP_TO_EDGE),S.colorAttachment.set(P.texture);const B=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,x,w);S.depthAttachment.set(B),this._depthFBO=S,this._depthTexture=P}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,x,w]),function(T,S,P,B){if("globe"===T.transform.projection.name)return;const N=T.context,j=N.gl;N.clear({depth:1});const X=T.useProgram("terrainDepth"),J=new f.DepthMode(j.LESS,f.DepthMode.ReadWrite,T.depthRangeFor3D);for(const te of B){const ee=P.getTile(te),re=ja(te.projMatrix,0);S.setupElevationDraw(ee,X),X.draw(N,j.TRIANGLES,J,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.backCCW,re,"terrain_depth",S.gridBuffer,S.gridIndexBuffer,S.gridNoSkirtSegments)}}(l,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(l,h,_){if(l.getSource()instanceof nn)return this._setupProxiedCoordsForImageSource(l,h,_);this._findCoveringTileCache[l.id]=this._findCoveringTileCache[l.id]||{};const x=this.proxiedCoords[l.id]=[],w=this.proxyCoords;for(let S=0;S<w.length;S++){const P=w[S],B=this._findTileCoveringTileID(P,l);if(B){const N=this._createProxiedId(P,B,_[P.key]&&_[P.key][l.id]);x.push(N),this.proxyToSource[P.key][l.id]=[N]}}let T=!1;for(let S=0;S<h.length;S++){const P=l.getTile(h[S]);if(!P||!P.hasData())continue;const B=this._findTileCoveringTileID(P.tileID,this.proxySourceCache);if(B&&B.tileID.canonical.z!==P.tileID.canonical.z){const N=this.proxyToSource[B.tileID.key][l.id],j=this._createProxiedId(B.tileID,P,_[B.tileID.key]&&_[B.tileID.key][l.id]);N?N.splice(N.length-1,0,j):this.proxyToSource[B.tileID.key][l.id]=[j],x.push(j),T=!0}}this._sourceTilesOverlap[l.id]=T}_setupProxiedCoordsForImageSource(l,h,_){if(!l.getSource().loaded())return;const x=this.proxiedCoords[l.id]=[],w=this.proxyCoords,T=l.getSource(),S=new f.Point(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),P=T.coordinates.map(f.MercatorCoordinate.fromLngLat).reduce((N,j)=>(N.min.x=Math.min(N.min.x,j.x-S.x),N.min.y=Math.min(N.min.y,j.y-S.y),N.max.x=Math.max(N.max.x,j.x-S.x),N.max.y=Math.max(N.max.y,j.y-S.y),N),{min:new f.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new f.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),B=(N,j)=>{const X=N.wrap+N.canonical.x/(1<<N.canonical.z),J=N.canonical.y/(1<<N.canonical.z),te=f.EXTENT/(1<<N.canonical.z),ee=j.wrap+j.canonical.x/(1<<j.canonical.z),re=j.canonical.y/(1<<j.canonical.z);return X+te<ee+P.min.x||X>ee+P.max.x||J+te<re+P.min.y||J>re+P.max.y};for(let N=0;N<w.length;N++){const j=w[N];for(let X=0;X<h.length;X++){const J=l.getTile(h[X]);if(!J||!J.hasData()||B(j,J.tileID))continue;const te=this._createProxiedId(j,J,_[j.key]&&_[j.key][l.id]),ee=this.proxyToSource[j.key][l.id];ee?ee.push(te):this.proxyToSource[j.key][l.id]=[te],x.push(te)}}}_createProxiedId(l,h,_){let x=this.orthoMatrix;if(_){const w=_.find(T=>T.key===h.tileID.key);if(w)return w}if(h.tileID.key!==l.key){const w=l.canonical.z-h.tileID.canonical.z;let T,S,P;x=f.create();const B=h.tileID.wrap-l.wrap<<l.overscaledZ;w>0?(T=f.EXTENT>>w,S=T*((h.tileID.canonical.x<<w)-l.canonical.x+B),P=T*((h.tileID.canonical.y<<w)-l.canonical.y)):(T=f.EXTENT<<-w,S=f.EXTENT*(h.tileID.canonical.x-(l.canonical.x+B<<-w)),P=f.EXTENT*(h.tileID.canonical.y-(l.canonical.y<<-w))),f.ortho(x,0,T,0,T,0,1),f.translate(x,x,[S,P,0])}return new $c(h.tileID,l.key,x)}_findTileCoveringTileID(l,h){let _=h.getTile(l);if(_&&_.hasData())return _;const x=this._findCoveringTileCache[h.id],w=x[l.key];if(_=w?h.getTileByID(w):null,_&&_.hasData()||null===w)return _;let T=_?_.tileID:l,S=T.overscaledZ;const P=h.getSource().minzoom,B=[];if(!w){const j=h.getSource().maxzoom;if(l.canonical.z>=j){const X=l.canonical.z-j;h.getSource().reparseOverscaled?(S=Math.max(l.canonical.z+2,h.transform.tileZoom),T=new f.OverscaledTileID(S,l.wrap,j,l.canonical.x>>X,l.canonical.y>>X)):0!==X&&(S=j,T=new f.OverscaledTileID(S,l.wrap,j,l.canonical.x>>X,l.canonical.y>>X))}T.key!==l.key&&(B.push(T.key),_=h.getTile(T))}const N=j=>{B.forEach(X=>{x[X]=j}),B.length=0};for(S-=1;S>=P&&(!_||!_.hasData());S--){_&&N(_.tileID.key);const j=T.calculateScaledKey(S);if(_=h.getTileByID(j),_&&_.hasData())break;const X=x[j];if(null===X)break;void 0===X?B.push(j):_=h.getTileByID(X)}return N(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(l){return this.enabled?this._findTileCoveringTileID(l,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(l,h){let _=this._tilesDirty[l];_||(_=this._tilesDirty[l]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const l=function(h){let _=0;const x=new f.StructArrayLayout2ui4,w=131;for(let T=1;T<129;T++){for(let S=1;S<129;S++)_=T*w+S,x.emplaceBack(_,_+1),x.emplaceBack(_,_+w),x.emplaceBack(_+1,_+w),128===T&&x.emplaceBack(_+w,_+w+1);x.emplaceBack(_+1,_+1+w)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(l),this.wireframeSegments=f.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,l.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class En{static cacheKey(l,h,_,x){let w=`${h}${x?x.cacheKey:""}`;for(const T of _)l.usedDefines.includes(T)&&(w+=`/${T}`);return w}constructor(l,h,_,x,w,T){const S=l.gl;this.program=S.createProgram();const P=function($){const Y=[];for(let ae=0;ae<$.length;ae++){if(null===$[ae])continue;const oe=$[ae].split(" ");Y.push(oe.pop())}return Y}(_.staticAttributes),B=x?x.getBinderAttributes():[],N=P.concat(B);let j=x?x.defines():[];j=j.concat(T.map($=>`#define ${$}`));const X=l.isWebGL2?"#version 300 es\n":"",J=X+j.concat(l.extStandardDerivatives&&0===X.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Tu):Tu,Tu,za,Do.fragmentSource,ha.fragmentSource,_.fragmentSource).join("\n"),te=X+j.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",za,Do.vertexSource,ha.vertexSource,Bt.vertexSource,_.vertexSource).join("\n"),ee=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(ee,J),S.compileShader(ee),S.attachShader(this.program,ee);const re=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(re,te),S.compileShader(re),S.attachShader(this.program,re),this.attributes={},this.numAttributes=N.length;for(let $=0;$<this.numAttributes;$++)N[$]&&(S.bindAttribLocation(this.program,$,N[$]),this.attributes[N[$]]=$);S.linkProgram(this.program),S.deleteShader(re),S.deleteShader(ee),this.fixedUniforms=w(l),this.binderUniforms=x?x.getUniforms(l):[],T.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new f.Uniform1i($=l),u_dem_prev:new f.Uniform1i($),u_dem_unpack:new f.Uniform4f($),u_dem_tl:new f.Uniform2f($),u_dem_scale:new f.Uniform1f($),u_dem_tl_prev:new f.Uniform2f($),u_dem_scale_prev:new f.Uniform1f($),u_dem_size:new f.Uniform1f($),u_dem_lerp:new f.Uniform1f($),u_exaggeration:new f.Uniform1f($),u_depth:new f.Uniform1i($),u_depth_size_inv:new f.Uniform2f($),u_meter_to_dem:new f.Uniform1f($),u_label_plane_matrix_inv:new f.UniformMatrix4f($)}),T.includes("GLOBE")&&(this.globeUniforms=($=>({u_tile_tl_up:new f.Uniform3f($),u_tile_tr_up:new f.Uniform3f($),u_tile_br_up:new f.Uniform3f($),u_tile_bl_up:new f.Uniform3f($),u_tile_up_scale:new f.Uniform1f($)}))(l)),T.includes("FOG")&&(this.fogUniforms=($=>({u_fog_matrix:new f.UniformMatrix4f($),u_fog_range:new f.Uniform2f($),u_fog_color:new f.Uniform4f($),u_fog_horizon_blend:new f.Uniform1f($),u_fog_temporal_offset:new f.Uniform1f($),u_frustum_tl:new f.Uniform3f($),u_frustum_tr:new f.Uniform3f($),u_frustum_br:new f.Uniform3f($),u_frustum_bl:new f.Uniform3f($),u_globe_pos:new f.Uniform3f($),u_globe_radius:new f.Uniform1f($),u_globe_transition:new f.Uniform1f($),u_is_globe:new f.Uniform1i($),u_viewport:new f.Uniform2f($)}))(l))}var $}setTerrainUniformValues(l,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x]&&_[x].set(this.program,x,h[x])}}setGlobeUniformValues(l,h){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x]&&_[x].set(this.program,x,h[x])}}setFogUniformValues(l,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){l.program.set(this.program);for(const x in h)_[x].set(this.program,x,h[x])}}draw(l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee){const re=l.gl;if(this.failedToCreate)return;l.program.set(this.program),l.setDepthMode(_),l.setStencilMode(x),l.setColorMode(w),l.setCullFace(T);for(const Y of Object.keys(this.fixedUniforms))this.fixedUniforms[Y].set(this.program,Y,S[Y]);te&&te.setUniforms(this.program,l,this.binderUniforms,X,{zoom:J});const $={[re.LINES]:2,[re.TRIANGLES]:3,[re.LINE_STRIP]:1}[h];for(const Y of j.get()){const ae=Y.vaos||(Y.vaos={});(ae[P]||(ae[P]=new qf)).bind(l,this,B,te?te.getPaintVertexBuffers():[],N,Y.vertexOffset,ee||[]),re.drawElements(h,Y.primitiveLength*$,re.UNSIGNED_SHORT,Y.primitiveOffset*$*2)}}}function To(m,l){const h=Math.pow(2,l.tileID.overscaledZ),_=l.tileSize*Math.pow(2,m.transform.tileZoom)/h,x=_*(l.tileID.canonical.x+l.tileID.wrap*h),w=_*l.tileID.canonical.y;return{u_image:0,u_texsize:l.imageAtlasTexture.size,u_tile_units_to_pixels:1/nr(l,1,m.transform.tileZoom),u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const $o=f.create(),So=(m,l,h,_,x,w,T,S,P,B,N)=>{const j=l.style.light,X=j.properties.get("position"),J=[X.x,X.y,X.z],te=f.create$1();"viewport"===j.properties.get("anchor")&&(f.fromRotation(te,-l.transform.angle),f.transformMat3(J,J,te));const ee=j.properties.get("color"),re=l.transform,$={u_matrix:m,u_lightpos:J,u_lightintensity:j.properties.get("intensity"),u_lightcolor:[ee.r,ee.g,ee.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:$o,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:w};return"globe"===re.projection.name&&($.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],$.u_zoom_transition=P,$.u_inv_rot_matrix=N,$.u_merc_center=B,$.u_up_dir=re.projection.upVector(new f.CanonicalTileID(0,0,0),B[0]*f.EXTENT,B[1]*f.EXTENT),$.u_height_lift=S),$},ns=(m,l,h,_,x,w,T,S,P,B,N,j)=>{const X=So(m,l,h,_,x,w,T,P,B,N,j),J={u_height_factor:-Math.pow(2,T.overscaledZ)/S.tileSize/8};return f.extend(X,To(l,S),J)},Cn=m=>({u_matrix:m}),Ha=(m,l,h)=>f.extend(Cn(m),To(l,h)),ac=(m,l)=>({u_matrix:m,u_world:l}),Iu=(m,l,h,_)=>f.extend(Ha(m,l,h),{u_world:_}),Dh=f.create(),is=(m,l,h,_,x,w)=>{const T=m.transform,S="globe"===T.projection.name;let P;if("map"===w.paint.get("circle-pitch-alignment"))if(S){const N=f.globePixelsToTileUnits(T.zoom,l.canonical)*T._pixelsPerMercatorPixel;P=Float32Array.from([N,0,0,N])}else P=T.calculatePixelsToTileUnitsMatrix(h);else P=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const B={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:m.translatePosMatrix(l.projMatrix,h,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:f.exported.devicePixelRatio,u_extrude_scale:P,u_inv_rot_matrix:Dh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(S){B.u_inv_rot_matrix=_,B.u_merc_center=x,B.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],B.u_zoom_transition=f.globeToMercatorTransition(T.zoom);const N=x[0]*f.EXTENT,j=x[1]*f.EXTENT;B.u_up_dir=T.projection.upVector(new f.CanonicalTileID(0,0,0),N,j)}return B},Ga=m=>{const l=[];return"map"===m.paint.get("circle-pitch-alignment")&&l.push("PITCH_WITH_MAP"),"map"===m.paint.get("circle-pitch-scale")&&l.push("SCALE_WITH_MAP"),l},Tl=(m,l,h,_)=>{const x=f.EXTENT/h.tileSize;return{u_matrix:m,u_camera_to_center_distance:l.getCameraToCenterDistance(_),u_extrude_scale:[l.pixelsToGLUnits[0]/x,l.pixelsToGLUnits[1]/x]}},Mo=(m,l,h=1)=>({u_matrix:m,u_color:l,u_overlay:0,u_overlay_scale:h}),Th=f.create(),Sh=(m,l,h,_,x,w,T)=>{const S=m.transform,P="globe"===S.projection.name,B=P?f.globePixelsToTileUnits(S.zoom,l.canonical)*S._pixelsPerMercatorPixel:nr(h,1,w),N={u_matrix:l.projMatrix,u_extrude_scale:B,u_intensity:T,u_inv_rot_matrix:Th,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(P){N.u_inv_rot_matrix=_,N.u_merc_center=x,N.u_tile_id=[l.canonical.x,l.canonical.y,1<<l.canonical.z],N.u_zoom_transition=f.globeToMercatorTransition(S.zoom);const j=x[0]*f.EXTENT,X=x[1]*f.EXTENT;N.u_up_dir=S.projection.upVector(new f.CanonicalTileID(0,0,0),j,X)}return N},zd=(m,l,h,_,x,w,T)=>{const S=m.transform,P=S.calculatePixelsToTileUnitsMatrix(l);return{u_matrix:Hc(m,l,h,_),u_pixels_to_tile_units:P,u_device_pixel_ratio:w,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:Nt(h)?l.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Sl(l,m.transform),u_alpha_discard_threshold:0,u_trim_offset:T}},li=(m,l,h,_,x)=>{const w=m.transform;return{u_matrix:Hc(m,l,h,_),u_texsize:l.imageAtlasTexture.size,u_pixels_to_tile_units:w.calculatePixelsToTileUnitsMatrix(l),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:Sl(l,w),u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Sl(m,l){return 1/nr(m,1,l.tileZoom)}function Hc(m,l,h,_){return m.translatePosMatrix(_||l.tileID.projMatrix,l,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Nt(m){const l=m.paint.get("line-dasharray").value;return l.value||"constant"!==l.kind}const Tr=(m,l,h,_,x,w)=>{return{u_matrix:m,u_tl_parent:l,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(S=x.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(T=x.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:yn(x.paint.get("raster-hue-rotate")),u_perspective_transform:w};var T,S};function yn(m){m*=Math.PI/180;const l=Math.sin(m),h=Math.cos(m);return[(2*h+1)/3,(-Math.sqrt(3)*l-h+1)/3,(Math.sqrt(3)*l-h+1)/3]}const Ki=f.create(),Sr=(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee)=>{const re=x.transform,$={u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:re.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:re.width/re.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:T,u_coord_matrix:S,u_is_text:+P,u_pitch_with_map:+_,u_texsize:B,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ki,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ki,u_up_vector:[0,-1,0]};return"globe"===ee.name&&($.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],$.u_zoom_transition=j,$.u_inv_rot_matrix=J,$.u_merc_center=X,$.u_camera_forward=re._camera.forward(),$.u_ecef_origin=f.globeECEFOrigin(re.globeMatrix,N.toUnwrapped()),$.u_tile_matrix=Float32Array.from(re.globeMatrix),$.u_up_vector=te),$},Us=(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee,re)=>f.extend(Sr(m,l,h,_,x,w,T,S,P,B,j,X,J,te,ee,re),{u_gamma_scale:_?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:f.exported.devicePixelRatio,u_is_halo:+N}),so=(m,l,h,_,x,w,T,S,P,B,N,j,X,J,te,ee)=>f.extend(Us(m,l,h,_,x,w,T,S,!0,P,!0,N,j,X,J,te,ee),{u_texsize_icon:B,u_texture_icon:1}),lc=(m,l,h)=>({u_matrix:m,u_opacity:l,u_color:h}),Gc=(m,l,h,_,x)=>f.extend(function(w,T,S){const P=T.imageManager.getPattern(w.toString()),{width:B,height:N}=T.imageManager.getPixelSize(),j=Math.pow(2,S.tileID.overscaledZ),X=S.tileSize*Math.pow(2,T.transform.tileZoom)/j,J=X*(S.tileID.canonical.x+S.tileID.wrap*j),te=X*S.tileID.canonical.y;return{u_image:0,u_pattern_tl:P.tl,u_pattern_br:P.br,u_texsize:[B,N],u_pattern_size:P.displaySize,u_tile_units_to_pixels:1/nr(S,1,T.transform.tileZoom),u_pixel_coord_upper:[J>>16,te>>16],u_pixel_coord_lower:[65535&J,65535&te]}}(_,h,x),{u_matrix:m,u_opacity:l}),Ml={fillExtrusion:m=>({u_matrix:new f.UniformMatrix4f(m),u_lightpos:new f.Uniform3f(m),u_lightintensity:new f.Uniform1f(m),u_lightcolor:new f.Uniform3f(m),u_vertical_gradient:new f.Uniform1f(m),u_opacity:new f.Uniform1f(m),u_edge_radius:new f.Uniform1f(m),u_ao:new f.Uniform2f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_up_dir:new f.Uniform3f(m),u_height_lift:new f.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new f.UniformMatrix4f(m),u_lightpos:new f.Uniform3f(m),u_lightintensity:new f.Uniform1f(m),u_lightcolor:new f.Uniform3f(m),u_vertical_gradient:new f.Uniform1f(m),u_height_factor:new f.Uniform1f(m),u_edge_radius:new f.Uniform1f(m),u_ao:new f.Uniform2f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_up_dir:new f.Uniform3f(m),u_height_lift:new f.Uniform1f(m),u_image:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_pixel_coord_upper:new f.Uniform2f(m),u_pixel_coord_lower:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m),u_opacity:new f.Uniform1f(m)}),fill:m=>({u_matrix:new f.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new f.UniformMatrix4f(m),u_image:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_pixel_coord_upper:new f.Uniform2f(m),u_pixel_coord_lower:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m)}),fillOutline:m=>({u_matrix:new f.UniformMatrix4f(m),u_world:new f.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new f.UniformMatrix4f(m),u_world:new f.Uniform2f(m),u_image:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_pixel_coord_upper:new f.Uniform2f(m),u_pixel_coord_lower:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new f.Uniform1f(m),u_extrude_scale:new f.UniformMatrix2f(m),u_device_pixel_ratio:new f.Uniform1f(m),u_matrix:new f.UniformMatrix4f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_up_dir:new f.Uniform3f(m)}),collisionBox:m=>({u_matrix:new f.UniformMatrix4f(m),u_camera_to_center_distance:new f.Uniform1f(m),u_extrude_scale:new f.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new f.UniformMatrix4f(m),u_inv_matrix:new f.UniformMatrix4f(m),u_camera_to_center_distance:new f.Uniform1f(m),u_viewport_size:new f.Uniform2f(m)}),debug:m=>({u_color:new f.UniformColor(m),u_matrix:new f.UniformMatrix4f(m),u_overlay:new f.Uniform1i(m),u_overlay_scale:new f.Uniform1f(m)}),clippingMask:m=>({u_matrix:new f.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new f.Uniform1f(m),u_intensity:new f.Uniform1f(m),u_matrix:new f.UniformMatrix4f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_up_dir:new f.Uniform3f(m)}),heatmapTexture:m=>({u_image:new f.Uniform1i(m),u_color_ramp:new f.Uniform1i(m),u_opacity:new f.Uniform1f(m)}),hillshade:m=>({u_matrix:new f.UniformMatrix4f(m),u_image:new f.Uniform1i(m),u_latrange:new f.Uniform2f(m),u_light:new f.Uniform2f(m),u_shadow:new f.UniformColor(m),u_highlight:new f.UniformColor(m),u_accent:new f.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new f.UniformMatrix4f(m),u_image:new f.Uniform1i(m),u_dimension:new f.Uniform2f(m),u_zoom:new f.Uniform1f(m),u_unpack:new f.Uniform4f(m)}),line:m=>({u_matrix:new f.UniformMatrix4f(m),u_pixels_to_tile_units:new f.UniformMatrix2f(m),u_device_pixel_ratio:new f.Uniform1f(m),u_units_to_pixels:new f.Uniform2f(m),u_dash_image:new f.Uniform1i(m),u_gradient_image:new f.Uniform1i(m),u_image_height:new f.Uniform1f(m),u_texsize:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m),u_alpha_discard_threshold:new f.Uniform1f(m),u_trim_offset:new f.Uniform2f(m)}),linePattern:m=>({u_matrix:new f.UniformMatrix4f(m),u_texsize:new f.Uniform2f(m),u_pixels_to_tile_units:new f.UniformMatrix2f(m),u_device_pixel_ratio:new f.Uniform1f(m),u_image:new f.Uniform1i(m),u_units_to_pixels:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m),u_alpha_discard_threshold:new f.Uniform1f(m)}),raster:m=>({u_matrix:new f.UniformMatrix4f(m),u_tl_parent:new f.Uniform2f(m),u_scale_parent:new f.Uniform1f(m),u_fade_t:new f.Uniform1f(m),u_opacity:new f.Uniform1f(m),u_image0:new f.Uniform1i(m),u_image1:new f.Uniform1i(m),u_brightness_low:new f.Uniform1f(m),u_brightness_high:new f.Uniform1f(m),u_saturation_factor:new f.Uniform1f(m),u_contrast_factor:new f.Uniform1f(m),u_spin_weights:new f.Uniform3f(m),u_perspective_transform:new f.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new f.Uniform1i(m),u_is_size_feature_constant:new f.Uniform1i(m),u_size_t:new f.Uniform1f(m),u_size:new f.Uniform1f(m),u_camera_to_center_distance:new f.Uniform1f(m),u_rotate_symbol:new f.Uniform1i(m),u_aspect_ratio:new f.Uniform1f(m),u_fade_change:new f.Uniform1f(m),u_matrix:new f.UniformMatrix4f(m),u_label_plane_matrix:new f.UniformMatrix4f(m),u_coord_matrix:new f.UniformMatrix4f(m),u_is_text:new f.Uniform1i(m),u_pitch_with_map:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_camera_forward:new f.Uniform3f(m),u_tile_matrix:new f.UniformMatrix4f(m),u_up_vector:new f.Uniform3f(m),u_ecef_origin:new f.Uniform3f(m),u_texture:new f.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new f.Uniform1i(m),u_is_size_feature_constant:new f.Uniform1i(m),u_size_t:new f.Uniform1f(m),u_size:new f.Uniform1f(m),u_camera_to_center_distance:new f.Uniform1f(m),u_rotate_symbol:new f.Uniform1i(m),u_aspect_ratio:new f.Uniform1f(m),u_fade_change:new f.Uniform1f(m),u_matrix:new f.UniformMatrix4f(m),u_label_plane_matrix:new f.UniformMatrix4f(m),u_coord_matrix:new f.UniformMatrix4f(m),u_is_text:new f.Uniform1i(m),u_pitch_with_map:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_texture:new f.Uniform1i(m),u_gamma_scale:new f.Uniform1f(m),u_device_pixel_ratio:new f.Uniform1f(m),u_tile_id:new f.Uniform3f(m),u_zoom_transition:new f.Uniform1f(m),u_inv_rot_matrix:new f.UniformMatrix4f(m),u_merc_center:new f.Uniform2f(m),u_camera_forward:new f.Uniform3f(m),u_tile_matrix:new f.UniformMatrix4f(m),u_up_vector:new f.Uniform3f(m),u_ecef_origin:new f.Uniform3f(m),u_is_halo:new f.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new f.Uniform1i(m),u_is_size_feature_constant:new f.Uniform1i(m),u_size_t:new f.Uniform1f(m),u_size:new f.Uniform1f(m),u_camera_to_center_distance:new f.Uniform1f(m),u_rotate_symbol:new f.Uniform1i(m),u_aspect_ratio:new f.Uniform1f(m),u_fade_change:new f.Uniform1f(m),u_matrix:new f.UniformMatrix4f(m),u_label_plane_matrix:new f.UniformMatrix4f(m),u_coord_matrix:new f.UniformMatrix4f(m),u_is_text:new f.Uniform1i(m),u_pitch_with_map:new f.Uniform1i(m),u_texsize:new f.Uniform2f(m),u_texsize_icon:new f.Uniform2f(m),u_texture:new f.Uniform1i(m),u_texture_icon:new f.Uniform1i(m),u_gamma_scale:new f.Uniform1f(m),u_device_pixel_ratio:new f.Uniform1f(m),u_is_halo:new f.Uniform1i(m)}),background:m=>({u_matrix:new f.UniformMatrix4f(m),u_opacity:new f.Uniform1f(m),u_color:new f.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new f.UniformMatrix4f(m),u_opacity:new f.Uniform1f(m),u_image:new f.Uniform1i(m),u_pattern_tl:new f.Uniform2f(m),u_pattern_br:new f.Uniform2f(m),u_texsize:new f.Uniform2f(m),u_pattern_size:new f.Uniform2f(m),u_pixel_coord_upper:new f.Uniform2f(m),u_pixel_coord_lower:new f.Uniform2f(m),u_tile_units_to_pixels:new f.Uniform1f(m)}),terrainRaster:jc,terrainDepth:jc,skybox:m=>({u_matrix:new f.UniformMatrix4f(m),u_sun_direction:new f.Uniform3f(m),u_cubemap:new f.Uniform1i(m),u_opacity:new f.Uniform1f(m),u_temporal_offset:new f.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new f.UniformMatrix4f(m),u_color_ramp:new f.Uniform1i(m),u_center_direction:new f.Uniform3f(m),u_radius:new f.Uniform1f(m),u_opacity:new f.Uniform1f(m),u_temporal_offset:new f.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new f.UniformMatrix3f(m),u_sun_direction:new f.Uniform3f(m),u_sun_intensity:new f.Uniform1f(m),u_color_tint_r:new f.Uniform4f(m),u_color_tint_m:new f.Uniform4f(m),u_luminance:new f.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new f.UniformMatrix4f(m),u_globe_matrix:new f.UniformMatrix4f(m),u_normalize_matrix:new f.UniformMatrix4f(m),u_merc_matrix:new f.UniformMatrix4f(m),u_zoom_transition:new f.Uniform1f(m),u_merc_center:new f.Uniform2f(m),u_image0:new f.Uniform1i(m),u_grid_matrix:new f.UniformMatrix3f(m),u_skirt_height:new f.Uniform1f(m),u_frustum_tl:new f.Uniform3f(m),u_frustum_tr:new f.Uniform3f(m),u_frustum_br:new f.Uniform3f(m),u_frustum_bl:new f.Uniform3f(m),u_globe_pos:new f.Uniform3f(m),u_globe_radius:new f.Uniform1f(m),u_viewport:new f.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new f.Uniform3f(m),u_frustum_tr:new f.Uniform3f(m),u_frustum_br:new f.Uniform3f(m),u_frustum_bl:new f.Uniform3f(m),u_horizon:new f.Uniform1f(m),u_transition:new f.Uniform1f(m),u_fadeout_range:new f.Uniform1f(m),u_color:new f.Uniform4f(m),u_high_color:new f.Uniform4f(m),u_space_color:new f.Uniform4f(m),u_star_intensity:new f.Uniform1f(m),u_star_density:new f.Uniform1f(m),u_star_size:new f.Uniform1f(m),u_temporal_offset:new f.Uniform1f(m),u_horizon_angle:new f.Uniform1f(m),u_rotation_matrix:new f.UniformMatrix4f(m)})};let Ho;function Et(m,l,h,_,x,w,T){const S=m.context,P=S.gl,B=m.transform,N=m.useProgram("collisionBox"),j=[];let X=0,J=0;for(let oe=0;oe<_.length;oe++){const _e=_[oe],ve=l.getTile(_e),ye=ve.getBucket(h);if(!ye)continue;const Ce=wo(_e,ye,B);let we=Ce;0===x[0]&&0===x[1]||(we=m.translatePosMatrix(Ce,ve,x,w));const ke=T?ye.textCollisionBox:ye.iconCollisionBox,tt=ye.collisionCircleArray;if(tt.length>0){const Ie=f.create(),qe=we;f.mul(Ie,ye.placementInvProjMatrix,B.glCoordMatrix),f.mul(Ie,Ie,ye.placementViewportMatrix),j.push({circleArray:tt,circleOffset:J,transform:qe,invTransform:Ie,projection:ye.getProjection()}),X+=tt.length/4,J=X}ke&&(m.terrain&&m.terrain.setupElevationDraw(ve,N),N.draw(S,P.LINES,f.DepthMode.disabled,f.StencilMode.disabled,m.colorModeForRenderPass(),f.CullFaceMode.disabled,Tl(we,B,ve,ye.getProjection()),h.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,B.zoom,null,[ke.collisionVertexBuffer,ke.collisionVertexBufferExt]))}if(!T||!j.length)return;const te=m.useProgram("collisionCircle"),ee=new f.StructArrayLayout2f1f2i16;ee.resize(4*X),ee._trim();let re=0;for(const oe of j)for(let _e=0;_e<oe.circleArray.length/4;_e++){const ve=4*_e,ye=oe.circleArray[ve+0],Ce=oe.circleArray[ve+1],we=oe.circleArray[ve+2],ke=oe.circleArray[ve+3];ee.emplace(re++,ye,Ce,we,ke,0),ee.emplace(re++,ye,Ce,we,ke,1),ee.emplace(re++,ye,Ce,we,ke,2),ee.emplace(re++,ye,Ce,we,ke,3)}(!Ho||Ho.length<2*X)&&(Ho=function(oe){const _e=2*oe,ve=new f.StructArrayLayout3ui6;ve.resize(_e),ve._trim();for(let ye=0;ye<_e;ye++){const Ce=6*ye;ve.uint16[Ce+0]=4*ye+0,ve.uint16[Ce+1]=4*ye+1,ve.uint16[Ce+2]=4*ye+2,ve.uint16[Ce+3]=4*ye+2,ve.uint16[Ce+4]=4*ye+3,ve.uint16[Ce+5]=4*ye+0}return ve}(X));const $=S.createIndexBuffer(Ho,!0),Y=S.createVertexBuffer(ee,f.collisionCircleLayout.members,!0);for(const oe of j){const _e={u_matrix:oe.transform,u_inv_matrix:oe.invTransform,u_camera_to_center_distance:(ae=B).getCameraToCenterDistance(oe.projection),u_viewport_size:[ae.width,ae.height]};te.draw(S,P.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,m.colorModeForRenderPass(),f.CullFaceMode.disabled,_e,h.id,Y,$,f.SegmentVector.simpleSegment(0,2*oe.circleOffset,oe.circleArray.length,oe.circleArray.length/2),null,B.zoom)}var ae;Y.destroy(),$.destroy()}const dn=f.create();function Ti({width:m,height:l,anchor:h,textOffset:_,textScale:x},w){const{horizontalAlign:T,verticalAlign:S}=f.getAnchorAlignment(h),P=-(T-.5)*m,B=-(S-.5)*l,N=f.evaluateVariableOffset(h,_);return new f.Point((P/x+N[0])*w,(B/x+N[1])*w)}function rs(m,l,h,_,x,w,T,S,P,B,N){const j=m.text.placedSymbolArray,X=m.text.dynamicLayoutVertexArray,J=m.icon.dynamicLayoutVertexArray,te={},ee=m.getProjection(),re=Le(S,ee,w),$=w.elevation,Y=ee.upVectorScale(S.canonical,w.center.lat,w.worldSize).metersToTile;X.clear();for(let ae=0;ae<j.length;ae++){const oe=j.get(ae),{tileAnchorX:_e,tileAnchorY:ve,numGlyphs:ye}=oe,Ce=oe.hidden||!oe.crossTileID||m.allowVerticalPlacement&&!oe.placedOrientation?null:_[oe.crossTileID];if(Ce){let we=0,ke=0,tt=0;if($){const at=$?$.getAtTileOffset(S,_e,ve):0,[St,Gt,wt]=ee.upVector(S.canonical,_e,ve);we=at*St*Y,ke=at*Gt*Y,tt=at*wt*Y}let[Ie,qe,Fe,nt]=hr(oe.projectedAnchorX+we,oe.projectedAnchorY+ke,oe.projectedAnchorZ+tt,h?re:T);const Pe=Li(w.getCameraToCenterDistance(ee),nt);let He=x.evaluateSizeForFeature(m.textSizeData,B,oe)*Pe/f.ONE_EM;h&&(He*=m.tilePixelRatio/P);const it=Ti(Ce,He);h?(({x:Ie,y:qe,z:Fe}=ee.projectTilePoint(_e+it.x,ve+it.y,S.canonical)),[Ie,qe,Fe]=hr(Ie+we,qe+ke,Fe+tt,T)):(l&&it._rotate(-w.angle),Ie+=it.x,qe+=it.y,Fe=0);const Je=m.allowVerticalPlacement&&oe.placedOrientation===f.WritingMode.vertical?Math.PI/2:0;for(let at=0;at<ye;at++)f.addDynamicAttributes(X,Ie,qe,Fe,Je);N&&oe.associatedIconIndex>=0&&(te[oe.associatedIconIndex]={x:Ie,y:qe,z:Fe,angle:Je})}else wn(ye,X)}if(N){J.clear();const ae=m.icon.placedSymbolArray;for(let oe=0;oe<ae.length;oe++){const _e=ae.get(oe),{numGlyphs:ve}=_e,ye=te[oe];if(_e.hidden||!ye)wn(ve,J);else{const{x:Ce,y:we,z:ke,angle:tt}=ye;for(let Ie=0;Ie<ve;Ie++)f.addDynamicAttributes(J,Ce,we,ke,tt)}}m.icon.dynamicLayoutVertexBuffer.updateData(J)}m.text.dynamicLayoutVertexBuffer.updateData(X)}function js(m,l,h){return h.iconsInText&&l?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function _r(m,l,h,_,x,w,T,S,P,B,N,j){const X=m.context,J=X.gl,te=m.transform,ee="map"===S,re="map"===P,$=ee&&"point"!==h.layout.get("symbol-placement"),Y=ee&&!re&&!$,ae=void 0!==h.layout.get("symbol-sort-key").constantOr(1);let oe=!1;const _e=m.depthModeForSublayer(0,f.DepthMode.ReadOnly),ve=[f.mercatorXfromLng(te.center.lng),f.mercatorYfromLat(te.center.lat)],ye=h.layout.get("text-variable-anchor"),Ce="globe"===te.projection.name,we=[],ke=[0,-1,0];let tt=ke;!Ce&&!te.mercatorFromTransition||ee||(tt=function(Ie){const qe=Ie._camera.getWorldToCamera(Ie.worldSize,1),Fe=f.multiply([],qe,Ie.globeMatrix);f.invert(Fe,Fe);const nt=[0,0,0],Pe=[0,1,0,0];return f.transformMat4$1(Pe,Pe,Fe),nt[0]=Pe[0],nt[1]=Pe[1],nt[2]=Pe[2],f.normalize(nt,nt),nt}(te));for(const Ie of _){const qe=l.getTile(Ie),Fe=qe.getBucket(h);if(!Fe||"mercator"===Fe.projection.name&&Ce)continue;const nt=x?Fe.text:Fe.icon;if(!nt||Fe.fullyClipped||!nt.segments.get().length)continue;const Pe=nt.programConfigurations.get(h.id),He=x||Fe.sdfIcons,it=x?Fe.textSizeData:Fe.iconSizeData,Je=re||0!==te.pitch,at=f.evaluateSizeForZoom(it,te.zoom);let St,Gt,wt,kt,vn=[0,0],gn=null;if(x)Gt=qe.glyphAtlasTexture,wt=J.LINEAR,St=qe.glyphAtlasTexture.size,Fe.iconsInText&&(vn=qe.imageAtlasTexture.size,gn=qe.imageAtlasTexture,kt=Je||m.options.rotating||m.options.zooming||"composite"===it.kind||"camera"===it.kind?J.LINEAR:J.NEAREST);else{const ga=1!==h.layout.get("icon-size").constantOr(0)||Fe.iconsNeedLinear;Gt=qe.imageAtlasTexture,wt=He||m.options.rotating||m.options.zooming||ga||Je?J.LINEAR:J.NEAREST,St=qe.imageAtlasTexture.size}const Ct="globe"===Fe.projection.name,Gn=Ct?tt:ke,ii=Ct?f.globeToMercatorTransition(te.zoom):0,qn=Le(Ie,Fe.getProjection(),te),ri=te.calculatePixelsToTileUnitsMatrix(qe),Gr=Ue(qn,qe.tileID.canonical,re,ee,te,Fe.getProjection(),ri),rr=m.terrain&&re&&$?f.invert(f.create(),Gr):dn,xs=$i(qn,qe.tileID.canonical,re,ee,te,Fe.getProjection(),ri),as=ye&&Fe.hasTextData(),xi="none"!==h.layout.get("icon-text-fit")&&as&&Fe.hasIconData();if($){const ga=te.elevation,_a=ga?ga.getAtTileOffsetFunc(Ie,te.center.lat,te.worldSize,Fe.getProjection()):null,Ka=ms(qn,qe.tileID.canonical,re,ee,te,Fe.getProjection(),ri);Nc(Fe,qn,m,x,Ka,xs,re,B,_a,Ie)}const Yn=$||x&&ye||xi,Wn=m.translatePosMatrix(qn,qe,w,T),Yi=Yn?dn:Gr,lo=m.translatePosMatrix(xs,qe,w,T,!0),Si=Fe.getProjection().createInversionMatrix(te,Ie.canonical),qi=[];m.terrainRenderModeElevated()&&re&&qi.push("PITCH_WITH_MAP_TERRAIN"),Ct&&qi.push("PROJECTION_GLOBE_VIEW"),Yn&&qi.push("PROJECTED_POS_ON_VIEWPORT");const Vh=He&&0!==h.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let ma;ma=He?Fe.iconsInText?so(it.kind,at,Y,re,m,Wn,Yi,lo,St,vn,Ie,ii,ve,Si,Gn,Fe.getProjection()):Us(it.kind,at,Y,re,m,Wn,Yi,lo,x,St,!0,Ie,ii,ve,Si,Gn,Fe.getProjection()):Sr(it.kind,at,Y,re,m,Wn,Yi,lo,x,St,Ie,ii,ve,Si,Gn,Fe.getProjection());const pc={program:m.useProgram(js(He,x,Fe),Pe,qi),buffers:nt,uniformValues:ma,atlasTexture:Gt,atlasTextureIcon:gn,atlasInterpolation:wt,atlasInterpolationIcon:kt,isSDF:He,hasHalo:Vh,tile:qe,labelPlaneMatrixInv:rr};if(ae&&Fe.canOverlap){oe=!0;const ga=nt.segments.get();for(const _a of ga)we.push({segments:new f.SegmentVector([_a]),sortKey:_a.sortKey,state:pc})}else we.push({segments:nt.segments,sortKey:0,state:pc})}oe&&we.sort((Ie,qe)=>Ie.sortKey-qe.sortKey);for(const Ie of we){const qe=Ie.state;if(m.terrain&&m.terrain.setupElevationDraw(qe.tile,qe.program,{useDepthForOcclusion:!Ce,labelPlaneMatrixInv:qe.labelPlaneMatrixInv}),X.activeTexture.set(J.TEXTURE0),qe.atlasTexture.bind(qe.atlasInterpolation,J.CLAMP_TO_EDGE),qe.atlasTextureIcon&&(X.activeTexture.set(J.TEXTURE1),qe.atlasTextureIcon&&qe.atlasTextureIcon.bind(qe.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),qe.isSDF){const Fe=qe.uniformValues;qe.hasHalo&&(Fe.u_is_halo=1,ys(qe.buffers,Ie.segments,h,m,qe.program,_e,N,j,Fe)),Fe.u_is_halo=0}ys(qe.buffers,Ie.segments,h,m,qe.program,_e,N,j,qe.uniformValues)}}function ys(m,l,h,_,x,w,T,S,P){const B=_.context,N=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];x.draw(B,B.gl.TRIANGLES,w,T,S,f.CullFaceMode.disabled,P,h.id,m.layoutVertexBuffer,m.indexBuffer,l,h.paint,_.transform.zoom,m.programConfigurations.get(h.id),N)}function Ni(m,l,h,_,x,w,T){const S=m.context.gl,P=h.paint.get("fill-pattern"),B=P&&P.constantOr(1);let N,j,X,J,te;T?(j=B&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",N=S.LINES):(j=B?"fillPattern":"fill",N=S.TRIANGLES);for(const ee of _){const re=l.getTile(ee);if(B&&!re.patternsLoaded())continue;const $=re.getBucket(h);if(!$)continue;m.prepareDrawTile();const Y=$.programConfigurations.get(h.id),ae=m.useProgram(j,Y);B&&(m.context.activeTexture.set(S.TEXTURE0),re.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),Y.updatePaintBuffers());const oe=P.constantOr(null);if(oe&&re.imageAtlas){const ve=re.imageAtlas.patternPositions[oe.toString()];ve&&Y.setConstantPatternPositions(ve)}const _e=m.translatePosMatrix(ee.projMatrix,re,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(T){J=$.indexBuffer2,te=$.segments2;const ve=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[S.drawingBufferWidth,S.drawingBufferHeight];X="fillOutlinePattern"===j&&B?Iu(_e,m,re,ve):ac(_e,ve)}else J=$.indexBuffer,te=$.segments,X=B?Ha(_e,m,re):Cn(_e);m.prepareDrawProgram(m.context,ae,ee.toUnwrapped()),ae.draw(m.context,N,x,m.stencilModeForClipping(ee),w,f.CullFaceMode.disabled,X,h.id,$.layoutVertexBuffer,J,te,h.paint,m.transform.zoom,Y)}}function qa(m,l,h,_,x,w,T){const S=m.context,P=S.gl,B=m.transform,N=h.paint.get("fill-extrusion-pattern"),j=N.constantOr(1),X=h.paint.get("fill-extrusion-opacity"),J=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],te=h.layout.get("fill-extrusion-edge-radius"),ee=te>0&&!h.paint.get("fill-extrusion-rounded-roof"),re=ee?0:te,$="globe"===B.projection.name?f.fillExtrusionHeightLift():0,Y="globe"===B.projection.name,ae=Y?f.globeToMercatorTransition(B.zoom):0,oe=[f.mercatorXfromLng(B.center.lng),f.mercatorYfromLat(B.center.lat)],_e=[];Y&&_e.push("PROJECTION_GLOBE_VIEW"),J[0]>0&&_e.push("FAUX_AO"),ee&&_e.push("ZERO_ROOF_RADIUS");for(const ve of _){const ye=l.getTile(ve),Ce=ye.getBucket(h);if(!Ce||Ce.projection.name!==B.projection.name)continue;const we=Ce.programConfigurations.get(h.id),ke=m.useProgram(j?"fillExtrusionPattern":"fillExtrusion",we,_e);if(m.terrain){const He=m.terrain;if(m.style.terrainSetForDrapingOnly())He.setupElevationDraw(ye,ke,{useMeterToDem:!0});else{if(!Ce.enableTerrain)continue;if(He.setupElevationDraw(ye,ke,{useMeterToDem:!0}),cc(S,l,ve,Ce,h,He),!Ce.centroidVertexBuffer){const it=ke.attributes.a_centroid_pos;void 0!==it&&P.vertexAttrib2f(it,0,0)}}}j&&(m.context.activeTexture.set(P.TEXTURE0),ye.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),we.updatePaintBuffers());const tt=N.constantOr(null);if(tt&&ye.imageAtlas){const He=ye.imageAtlas.patternPositions[tt.toString()];He&&we.setConstantPatternPositions(He)}const Ie=m.translatePosMatrix(ve.projMatrix,ye,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),qe=B.projection.createInversionMatrix(B,ve.canonical),Fe=h.paint.get("fill-extrusion-vertical-gradient"),nt=j?ns(Ie,m,Fe,X,J,re,ve,ye,$,ae,oe,qe):So(Ie,m,Fe,X,J,re,ve,$,ae,oe,qe);m.prepareDrawProgram(S,ke,ve.toUnwrapped());const Pe=[];m.terrain&&Pe.push(Ce.centroidVertexBuffer),Y&&Pe.push(Ce.layoutVertexExtBuffer),ke.draw(S,S.gl.TRIANGLES,x,w,T,f.CullFaceMode.backCCW,nt,h.id,Ce.layoutVertexBuffer,Ce.indexBuffer,Ce.segments,h.paint,m.transform.zoom,we,Pe)}}function cc(m,l,h,_,x,w){const T=[$=>{let Y=$.canonical.x-1,ae=$.wrap;return Y<0&&(Y=(1<<$.canonical.z)-1,ae--),new f.OverscaledTileID($.overscaledZ,ae,$.canonical.z,Y,$.canonical.y)},$=>{let Y=$.canonical.x+1,ae=$.wrap;return Y===1<<$.canonical.z&&(Y=0,ae++),new f.OverscaledTileID($.overscaledZ,ae,$.canonical.z,Y,$.canonical.y)},$=>new f.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,(0===$.canonical.y?1<<$.canonical.z:$.canonical.y)-1),$=>new f.OverscaledTileID($.overscaledZ,$.wrap,$.canonical.z,$.canonical.x,$.canonical.y===(1<<$.canonical.z)-1?0:$.canonical.y+1)],S=$=>{const Y=l.getSource().minzoom,ae=_e=>{const ve=l.getTileByID(_e);if(ve&&ve.hasData())return ve.getBucket(x)},oe=[0,-1,1];for(const _e of oe){if($.overscaledZ+_e<Y)continue;const ve=ae($.calculateScaledKey($.overscaledZ+_e));if(ve)return ve}},P=[0,0,0],B=($,Y)=>(P[0]=Math.min($.min.y,Y.min.y),P[1]=Math.max($.max.y,Y.max.y),P[2]=f.EXTENT-Y.min.x>$.max.x?Y.min.x-f.EXTENT:$.max.x,P),N=($,Y)=>(P[0]=Math.min($.min.x,Y.min.x),P[1]=Math.max($.max.x,Y.max.x),P[2]=f.EXTENT-Y.min.y>$.max.y?Y.min.y-f.EXTENT:$.max.y,P),j=[($,Y)=>B($,Y),($,Y)=>B(Y,$),($,Y)=>N($,Y),($,Y)=>N(Y,$)],X=new f.Point(0,0);let J,te,ee;const re=($,Y,ae,oe,_e)=>{const ve=[[oe?ae:$,oe?$:ae,0],[oe?ae:Y,oe?Y:ae,0]],ye=_e<0?f.EXTENT+_e:_e,Ce=[oe?ye:($+Y)/2,oe?($+Y)/2:ye,0];return 0===ae&&_e<0||0!==ae&&_e>0?w.getForTilePoints(ee,[Ce],!0,te):ve.push(Ce),w.getForTilePoints(h,ve,!0,J),Math.max(ve[0][2],ve[1][2],Ce[2])/w.exaggeration()};for(let $=0;$<4;$++){const Y=($<2?1:5)-$,ae=_.borders[$];if(0===ae.length)continue;const oe=ee=T[$](h),_e=S(oe);if(!(_e&&_e instanceof f.FillExtrusionBucket&&_e.enableTerrain)||_.borderDoneWithNeighborZ[$]===_e.canonical.z&&_e.borderDoneWithNeighborZ[Y]===_.canonical.z||(te=w.findDEMTileFor(oe),!te||!te.dem))continue;if(!J){const we=w.findDEMTileFor(h);if(!we||!we.dem)return;J=we}const ve=_e.borders[Y];let ye=0;const Ce=_e.borderDoneWithNeighborZ[Y]!==_.canonical.z;if(_.canonical.z===_e.canonical.z){for(let we=0;we<ae.length;we++){const ke=_.featuresOnBorder[ae[we]],tt=ke.borders[$];let Ie;for(;ye<ve.length&&(Ie=_e.featuresOnBorder[ve[ye]],!(Ie.borders[Y][1]>tt[0]+3));)Ce&&_e.encodeCentroid(void 0,Ie,!1),ye++;if(Ie&&ye<ve.length){const qe=ye;let Fe=0;for(;!(Ie.borders[Y][0]>tt[1]-3)&&(Fe++,++ye!==ve.length);)Ie=_e.featuresOnBorder[ve[ye]];if(Ie=_e.featuresOnBorder[ve[qe]],ke.intersectsCount()>1||Ie.intersectsCount()>1||1!==Fe){1!==Fe&&(ye=qe),_.encodeCentroid(void 0,ke,!1),Ce&&_e.encodeCentroid(void 0,Ie,!1);continue}const nt=j[$](ke,Ie),Pe=$%2?f.EXTENT-1:0;X.x=re(nt[0],Math.min(f.EXTENT-1,nt[1]),Pe,$<2,nt[2]),X.y=0,_.encodeCentroid(X,ke,!1),Ce&&_e.encodeCentroid(X,Ie,!1)}else _.encodeCentroid(void 0,ke,!1)}_.borderDoneWithNeighborZ[$]=_e.canonical.z,_.needsCentroidUpdate=!0,Ce&&(_e.borderDoneWithNeighborZ[Y]=_.canonical.z,_e.needsCentroidUpdate=!0)}else{for(const we of ae)_.encodeCentroid(void 0,_.featuresOnBorder[we],!1);if(Ce){for(const we of ve)_e.encodeCentroid(void 0,_e.featuresOnBorder[we],!1);_e.borderDoneWithNeighborZ[Y]=_.canonical.z,_e.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[$]=_e.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(m)}const on=new f.Color(1,0,0,1),Pu=new f.Color(0,1,0,1),os=new f.Color(0,0,1,1),ku=new f.Color(1,0,1,1),Al=new f.Color(0,1,1,1);function yr(m,l,h){const _=m.context,x=m.transform,w=_.gl,T="globe"===x.projection.name,S=T?["PROJECTION_GLOBE_VIEW"]:null;let P=h.projMatrix;if(T&&f.globeToMercatorTransition(x.zoom)>0){const ke=f.transitionTileAABBinECEF(h.canonical,x),tt=f.globeDenormalizeECEF(ke);P=f.multiply(new Float32Array(16),x.globeMatrix,tt),f.multiply(P,x.projMatrix,P)}const B=m.useProgram("debug",null,S),N=l.getTileByID(h.key);m.terrain&&m.terrain.setupElevationDraw(N,B);const j=f.DepthMode.disabled,X=f.StencilMode.disabled,J=m.colorModeForRenderPass();_.activeTexture.set(w.TEXTURE0),m.emptyTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),T?N._makeGlobeTileDebugBuffers(m.context,x):N._makeDebugTileBoundsBuffers(m.context,x.projection);const ee=N._tileDebugBuffer||m.debugBuffer,re=N._tileDebugIndexBuffer||m.debugIndexBuffer,$=N._tileDebugSegments||m.debugSegments;B.draw(_,w.LINE_STRIP,j,X,J,f.CullFaceMode.disabled,Mo(P,f.Color.red),"$debug",ee,re,$,null,null,null,[N._globeTileDebugBorderBuffer]);const Y=N.latestRawTileData,ae=Math.floor((Y&&Y.byteLength||0)/1024),oe=l.getTile(h).tileSize,_e=512/Math.min(oe,512)*(h.overscaledZ/x.zoom)*.5;let ve=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(ve+=` => ${h.overscaledZ}`),ve+=` ${ae}kb`,function(ke,tt){ke.initDebugOverlayCanvas();const Ie=ke.debugOverlayCanvas,qe=ke.context.gl,Fe=ke.debugOverlayCanvas.getContext("2d");Fe.clearRect(0,0,Ie.width,Ie.height),Fe.shadowColor="white",Fe.shadowBlur=2,Fe.lineWidth=1.5,Fe.strokeStyle="white",Fe.textBaseline="top",Fe.font="bold 36px Open Sans, sans-serif",Fe.fillText(tt,5,5),Fe.strokeText(tt,5,5),ke.debugOverlayTexture.update(Ie),ke.debugOverlayTexture.bind(qe.LINEAR,qe.CLAMP_TO_EDGE)}(m,ve);const ye=N._tileDebugTextBuffer||m.debugBuffer,Ce=N._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,we=N._tileDebugTextSegments||m.debugSegments;B.draw(_,w.TRIANGLES,j,X,f.ColorMode.alphaBlended,f.CullFaceMode.disabled,Mo(P,f.Color.transparent,_e),"$debug",ye,Ce,we,null,null,null,[N._globeTileDebugTextBuffer])}function Il(m,l,h,_){$r(m,0,l+h/2,m.transform.width,h,_)}function $s(m,l,h,_){$r(m,l-h/2,0,h,m.transform.height,_)}function $r(m,l,h,_,x,w){const T=m.context,S=T.gl;S.enable(S.SCISSOR_TEST),S.scissor(l*f.exported.devicePixelRatio,h*f.exported.devicePixelRatio,_*f.exported.devicePixelRatio,x*f.exported.devicePixelRatio),T.clear({color:w}),S.disable(S.SCISSOR_TEST)}const Wa=f.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Ru}=Wa;function Bn(m,l,h,_){m.emplaceBack(l,h,_)}class Ou{constructor(l){this.vertexArray=new f.StructArrayLayout3f12,this.indices=new f.StructArrayLayout3ui6,Bn(this.vertexArray,-1,-1,1),Bn(this.vertexArray,1,-1,1),Bn(this.vertexArray,-1,1,1),Bn(this.vertexArray,1,1,1),Bn(this.vertexArray,-1,-1,-1),Bn(this.vertexArray,1,-1,-1),Bn(this.vertexArray,-1,1,-1),Bn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=l.createVertexBuffer(this.vertexArray,Ru),this.indexBuffer=l.createIndexBuffer(this.indices),this.segment=f.SegmentVector.simpleSegment(0,0,36,12)}}function Ai(m,l,h,_,x,w){const T=m.gl,S=l.paint.get("sky-atmosphere-color"),P=l.paint.get("sky-atmosphere-halo-color"),B=l.paint.get("sky-atmosphere-sun-intensity"),N={u_matrix_3f:f.fromMat4(f.create$1(),_),u_sun_direction:x,u_sun_intensity:B,u_color_tint_r:[(te=S).r,te.g,te.b,te.a],u_color_tint_m:[(ee=P).r,ee.g,ee.b,ee.a],u_luminance:5e-5};var te,ee;T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+w,l.skyboxTexture,0),h.draw(m,T.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,f.ColorMode.unblended,f.CullFaceMode.frontCW,N,"skyboxCapture",l.skyboxGeometry.vertexBuffer,l.skyboxGeometry.indexBuffer,l.skyboxGeometry.segment)}const vi=f.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class uc{constructor(l){const h=new f.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const _=new f.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=l.createVertexBuffer(h,vi.members),this.indexBuffer=l.createIndexBuffer(_),this.segments=f.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const vs={symbol:function(m,l,h,_,x){if("translucent"!==m.renderPass)return;const w=f.StencilMode.disabled,T=m.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(S,P,B,N,j,X,J){const te=P.transform,ee="map"===j,re="map"===X;for(const $ of S){const Y=N.getTile($),ae=Y.getBucket(B);if(!ae||!ae.text||!ae.text.segments.get().length)continue;const oe=f.evaluateSizeForZoom(ae.textSizeData,te.zoom),_e=Le($,ae.getProjection(),te),ve=te.calculatePixelsToTileUnitsMatrix(Y),ye=Ue(_e,Y.tileID.canonical,re,ee,te,ae.getProjection(),ve),Ce="none"!==B.layout.get("icon-text-fit")&&ae.hasIconData();if(oe){const we=Math.pow(2,te.zoom-Y.tileID.overscaledZ);rs(ae,ee,re,J,f.symbolSize,te,ye,$,we,oe,Ce)}}}(_,m,h,l,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),x),0!==h.paint.get("icon-opacity").constantOr(1)&&_r(m,l,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),w,T),0!==h.paint.get("text-opacity").constantOr(1)&&_r(m,l,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),w,T),l.map.showCollisionBoxes&&(Et(m,l,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Et(m,l,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(m,l,h,_){if("translucent"!==m.renderPass)return;const x=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),T=h.paint.get("circle-stroke-opacity"),S=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===w.constantOr(1)||0===T.constantOr(1)))return;const P=m.context,B=P.gl,N=m.transform,j=m.depthModeForSublayer(0,f.DepthMode.ReadOnly),X=f.StencilMode.disabled,J=m.colorModeForRenderPass(),te="globe"===N.projection.name,ee=[f.mercatorXfromLng(N.center.lng),f.mercatorYfromLat(N.center.lat)],re=[];for(let Y=0;Y<_.length;Y++){const ae=_[Y],oe=l.getTile(ae),_e=oe.getBucket(h);if(!_e||_e.projection.name!==N.projection.name)continue;const ve=_e.programConfigurations.get(h.id),ye=Ga(h);te&&ye.push("PROJECTION_GLOBE_VIEW");const Ce=m.useProgram("circle",ve,ye),we=_e.layoutVertexBuffer,ke=_e.globeExtVertexBuffer,tt=_e.indexBuffer,Ie=N.projection.createInversionMatrix(N,ae.canonical),qe={programConfiguration:ve,program:Ce,layoutVertexBuffer:we,globeExtVertexBuffer:ke,indexBuffer:tt,uniformValues:is(m,ae,oe,Ie,ee,h),tile:oe};if(S){const Fe=_e.segments.get();for(const nt of Fe)re.push({segments:new f.SegmentVector([nt]),sortKey:nt.sortKey,state:qe})}else re.push({segments:_e.segments,sortKey:0,state:qe})}S&&re.sort((Y,ae)=>Y.sortKey-ae.sortKey);const $={useDepthForOcclusion:!te};for(const Y of re){const{programConfiguration:ae,program:oe,layoutVertexBuffer:_e,globeExtVertexBuffer:ve,indexBuffer:ye,uniformValues:Ce,tile:we}=Y.state,ke=Y.segments;m.terrain&&m.terrain.setupElevationDraw(we,oe,$),m.prepareDrawProgram(P,oe,we.tileID.toUnwrapped()),oe.draw(P,B.TRIANGLES,j,X,J,f.CullFaceMode.disabled,Ce,h.id,_e,ye,ke,h.paint,N.zoom,ae,[ve])}},heatmap:function(m,l,h,_){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const x=m.context,w=x.gl,T=f.StencilMode.disabled,S=new f.ColorMode([w.ONE,w.ONE],f.Color.transparent,[!0,!0,!0,!0]);(function(J,te,ee,re){const $=J.gl,Y=te.width*re,ae=te.height*re;J.activeTexture.set($.TEXTURE1),J.viewport.set([0,0,Y,ae]);let oe=ee.heatmapFbo;if(!oe||oe&&(oe.width!==Y||oe.height!==ae)){oe&&oe.destroy();const _e=$.createTexture();$.bindTexture($.TEXTURE_2D,_e),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_S,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_WRAP_T,$.CLAMP_TO_EDGE),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MIN_FILTER,$.LINEAR),$.texParameteri($.TEXTURE_2D,$.TEXTURE_MAG_FILTER,$.LINEAR),oe=ee.heatmapFbo=J.createFramebuffer(Y,ae,!1),function(ve,ye,Ce,we,ke,tt){const Ie=ve.gl;Ie.texImage2D(Ie.TEXTURE_2D,0,ve.isWebGL2&&ve.extRenderToTextureHalfFloat?Ie.RGBA16F:Ie.RGBA,ke,tt,0,Ie.RGBA,ve.extRenderToTextureHalfFloat?ve.isWebGL2?Ie.HALF_FLOAT:ve.extTextureHalfFloat.HALF_FLOAT_OES:Ie.UNSIGNED_BYTE,null),we.colorAttachment.set(Ce)}(J,0,_e,oe,Y,ae)}else $.bindTexture($.TEXTURE_2D,oe.colorAttachment.get()),J.bindFramebuffer.set(oe.framebuffer)})(x,m,h,"globe"===m.transform.projection.name?.5:.25),x.clear({color:f.Color.transparent});const P=m.transform,B="globe"===P.projection.name,N=B?["PROJECTION_GLOBE_VIEW"]:null,j=B?f.CullFaceMode.frontCCW:f.CullFaceMode.disabled,X=[f.mercatorXfromLng(P.center.lng),f.mercatorYfromLat(P.center.lat)];for(let J=0;J<_.length;J++){const te=_[J];if(l.hasRenderableParent(te))continue;const ee=l.getTile(te),re=ee.getBucket(h);if(!re||re.projection.name!==P.projection.name)continue;const $=re.programConfigurations.get(h.id),Y=m.useProgram("heatmap",$,N),{zoom:ae}=m.transform;m.terrain&&m.terrain.setupElevationDraw(ee,Y),m.prepareDrawProgram(x,Y,te.toUnwrapped());const oe=P.projection.createInversionMatrix(P,te.canonical);Y.draw(x,w.TRIANGLES,f.DepthMode.disabled,T,S,j,Sh(m,te,ee,oe,X,ae,h.paint.get("heatmap-intensity")),h.id,re.layoutVertexBuffer,re.indexBuffer,re.segments,h.paint,m.transform.zoom,$,B?[re.globeExtVertexBuffer]:null)}x.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(x,w){const T=x.context,S=T.gl,P=w.heatmapFbo;if(!P)return;T.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,P.colorAttachment.get()),T.activeTexture.set(S.TEXTURE1);let B=w.colorRampTexture;B||(B=w.colorRampTexture=new f.Texture(T,w.colorRamp,S.RGBA)),B.bind(S.LINEAR,S.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(T,S.TRIANGLES,f.DepthMode.disabled,f.StencilMode.disabled,x.colorModeForRenderPass(),f.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:w.paint.get("heatmap-opacity")},w.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,w.paint,x.transform.zoom)}(m,h))},line:function(m,l,h,_){if("translucent"!==m.renderPass)return;const x=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(0===x.constantOr(1)||0===w.constantOr(1))return;const T=m.depthModeForSublayer(0,f.DepthMode.ReadOnly),S=m.colorModeForRenderPass(),P=m.terrain&&m.terrain.renderingToTexture?1:f.exported.devicePixelRatio,B=h.paint.get("line-dasharray"),N=B.constantOr(1),j=h.layout.get("line-cap"),X=h.paint.get("line-pattern"),J=X.constantOr(1),te=h.paint.get("line-gradient"),ee=J?"linePattern":"line",re=m.context,$=re.gl,Y=(oe=>{const _e=[];Nt(oe)&&_e.push("RENDER_LINE_DASH"),oe.paint.get("line-gradient")&&_e.push("RENDER_LINE_GRADIENT");const ve=oe.paint.get("line-trim-offset");0===ve[0]&&0===ve[1]||_e.push("RENDER_LINE_TRIM_OFFSET");const ye=oe.paint.get("line-pattern").constantOr(1),Ce=1!==oe.paint.get("line-opacity").constantOr(1);return!ye&&Ce&&_e.push("RENDER_LINE_ALPHA_DISCARD"),_e})(h);let ae=Y.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(ae=!1);for(const oe of _){const _e=l.getTile(oe);if(J&&!_e.patternsLoaded())continue;const ve=_e.getBucket(h);if(!ve)continue;m.prepareDrawTile();const ye=ve.programConfigurations.get(h.id),Ce=m.useProgram(ee,ye,Y),we=X.constantOr(null);if(we&&_e.imageAtlas){const He=_e.imageAtlas.patternPositions[we.toString()];He&&ye.setConstantPatternPositions(He)}const ke=B.constantOr(null),tt=j.constantOr(null);if(!J&&ke&&tt&&_e.lineAtlas){const He=_e.lineAtlas.getDash(ke,tt);He&&ye.setConstantPatternPositions(He)}let[Ie,qe]=h.paint.get("line-trim-offset");("round"===tt||"square"===tt)&&Ie!==qe&&(0===Ie&&(Ie-=1),1===qe&&(qe+=1));const Fe=m.terrain?oe.projMatrix:null,nt=J?li(m,_e,h,Fe,P):zd(m,_e,h,Fe,ve.lineClipsArray.length,P,[Ie,qe]);if(te){const He=ve.gradients[h.id];let it=He.texture;if(h.gradientVersion!==He.version){let Je=256;if(h.stepInterpolant){const at=l.getSource().maxzoom,St=oe.canonical.z===at?Math.ceil(1<<m.transform.maxZoom-oe.canonical.z):1;Je=f.clamp(f.nextPowerOfTwo(ve.maxLineLength/f.EXTENT*1024*St),256,re.maxTextureSize)}He.gradient=f.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:Je,image:He.gradient||void 0,clips:ve.lineClipsArray}),He.texture?He.texture.update(He.gradient):He.texture=new f.Texture(re,He.gradient,$.RGBA),He.version=h.gradientVersion,it=He.texture}re.activeTexture.set($.TEXTURE1),it.bind(h.stepInterpolant?$.NEAREST:$.LINEAR,$.CLAMP_TO_EDGE)}N&&(re.activeTexture.set($.TEXTURE0),_e.lineAtlasTexture.bind($.LINEAR,$.REPEAT),ye.updatePaintBuffers()),J&&(re.activeTexture.set($.TEXTURE0),_e.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),ye.updatePaintBuffers()),m.prepareDrawProgram(re,Ce,oe.toUnwrapped());const Pe=He=>{Ce.draw(re,$.TRIANGLES,T,He,S,f.CullFaceMode.disabled,nt,h.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,h.paint,m.transform.zoom,ye,[ve.layoutVertexBuffer2])};if(ae){const He=m.stencilModeForClipping(oe).ref;0===He&&m.terrain&&re.clear({stencil:0});const it={func:$.EQUAL,mask:255};nt.u_alpha_discard_threshold=.8,Pe(new f.StencilMode(it,He,255,$.KEEP,$.KEEP,$.INVERT)),nt.u_alpha_discard_threshold=0,Pe(new f.StencilMode(it,He,255,$.KEEP,$.KEEP,$.KEEP))}else Pe(m.stencilModeForClipping(oe))}ae&&(m.resetStencilClippingMasks(),m.terrain&&re.clear({stencil:0}))},fill:function(m,l,h,_){const x=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(0===w.constantOr(1))return;const T=m.colorModeForRenderPass(),S=h.paint.get("fill-pattern"),P=m.opaquePassEnabledForLayer()&&!S.constantOr(1)&&1===x.constantOr(f.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(m.renderPass===P){const B=m.depthModeForSublayer(1,"opaque"===m.renderPass?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly);Ni(m,l,h,_,B,T,!1)}if("translucent"===m.renderPass&&h.paint.get("fill-antialias")){const B=m.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,f.DepthMode.ReadOnly);Ni(m,l,h,_,B,T,!0)}},"fill-extrusion":function(m,l,h,_){const x=h.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===m.renderPass){const w=new f.DepthMode(m.context.gl.LEQUAL,f.DepthMode.ReadWrite,m.depthRangeFor3D);if(1!==x||h.paint.get("fill-extrusion-pattern").constantOr(1))qa(m,l,h,_,w,f.StencilMode.disabled,f.ColorMode.disabled),qa(m,l,h,_,w,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const T=m.colorModeForRenderPass();qa(m,l,h,_,w,f.StencilMode.disabled,T)}}},hillshade:function(m,l,h,_){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const x=m.context,w=m.depthModeForSublayer(0,f.DepthMode.ReadOnly),T=m.colorModeForRenderPass(),S=m.terrain&&m.terrain.renderingToTexture,[P,B]="translucent"!==m.renderPass||S?[{},_]:m.stencilConfigForOverlap(_);for(const N of B){const j=l.getTile(N);if(j.needsHillshadePrepare&&"offscreen"===m.renderPass)Su(m,j,h,w,f.StencilMode.disabled,T);else if("translucent"===m.renderPass){const X=S&&m.terrain?m.terrain.stencilModeForRTTOverlap(N):P[N.overscaledZ];sc(m,N,j,h,w,X,T)}}x.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,l,h,_,x,w){if("translucent"!==m.renderPass||0===h.paint.get("raster-opacity")||!_.length)return;const T=m.context,S=T.gl,P=l.getSource(),B=m.useProgram("raster"),N=m.colorModeForRenderPass(),j=m.terrain&&m.terrain.renderingToTexture,[X,J]=P instanceof nn||j?[{},_]:m.stencilConfigForOverlap(_),te=J[J.length-1].overscaledZ,ee=!m.options.moving;for(const re of J){const $=j?f.DepthMode.disabled:m.depthModeForSublayer(re.overscaledZ-te,1===h.paint.get("raster-opacity")?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly,S.LESS),Y=re.toUnwrapped(),ae=l.getTile(re);if(j&&(!ae||!ae.hasData()))continue;const oe=j?re.projMatrix:m.transform.calculateProjMatrix(Y,ee),_e=m.terrain&&j?m.terrain.stencilModeForRTTOverlap(re):X[re.overscaledZ],ve=w?0:h.paint.get("raster-fade-duration");ae.registerFadeDuration(ve);const ye=l.findLoadedParent(re,0),Ce=$a(ae,ye,l,m.transform,ve);let we,ke;m.terrain&&m.terrain.prepareDrawTile();const tt="nearest"===h.paint.get("raster-resampling")?S.NEAREST:S.LINEAR;T.activeTexture.set(S.TEXTURE0),ae.texture.bind(tt,S.CLAMP_TO_EDGE),T.activeTexture.set(S.TEXTURE1),ye?(ye.texture.bind(tt,S.CLAMP_TO_EDGE),we=Math.pow(2,ye.tileID.overscaledZ-ae.tileID.overscaledZ),ke=[ae.tileID.canonical.x*we%1,ae.tileID.canonical.y*we%1]):ae.texture.bind(tt,S.CLAMP_TO_EDGE),ae.texture.useMipmap&&T.extTextureFilterAnisotropic&&m.transform.pitch>20&&S.texParameterf(S.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax);const Ie=Tr(oe,ke||[0,0],we||1,Ce,h,P instanceof nn?P.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(T,B,Y),P instanceof nn)P.boundsBuffer&&P.boundsSegments&&B.draw(T,S.TRIANGLES,$,f.StencilMode.disabled,N,f.CullFaceMode.disabled,Ie,h.id,P.boundsBuffer,m.quadTriangleIndexBuffer,P.boundsSegments);else{const{tileBoundsBuffer:qe,tileBoundsIndexBuffer:Fe,tileBoundsSegments:nt}=m.getTileBoundsBuffers(ae);B.draw(T,S.TRIANGLES,$,_e,N,f.CullFaceMode.disabled,Ie,h.id,qe,Fe,nt)}}m.resetStencilClippingMasks()},background:function(m,l,h,_){const x=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(0===w)return;const T=m.context,S=T.gl,P=m.transform,B=P.tileSize,N=h.paint.get("background-pattern");if(m.isPatternMissing(N))return;const j=!N&&1===x.a&&1===w&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==j)return;const X=f.StencilMode.disabled,J=m.depthModeForSublayer(0,"opaque"===j?f.DepthMode.ReadWrite:f.DepthMode.ReadOnly),te=m.colorModeForRenderPass(),ee=m.useProgram(N?"backgroundPattern":"background");let re,$=_;$||(re=m.getBackgroundTiles(),$=Object.values(re).map(Y=>Y.tileID)),N&&(T.activeTexture.set(S.TEXTURE0),m.imageManager.bind(m.context));for(const Y of $){const ae=Y.toUnwrapped(),oe=_?Y.projMatrix:m.transform.calculateProjMatrix(ae);m.prepareDrawTile();const _e=l?l.getTile(Y):re?re[Y.key]:new f.Tile(Y,B,P.zoom,m),ve=N?Gc(oe,w,m,N,{tileID:Y,tileSize:B}):lc(oe,w,x);m.prepareDrawProgram(T,ee,ae);const{tileBoundsBuffer:ye,tileBoundsIndexBuffer:Ce,tileBoundsSegments:we}=m.getTileBoundsBuffers(_e);ee.draw(T,S.TRIANGLES,J,X,te,f.CullFaceMode.disabled,ve,h.id,ye,Ce,we)}},sky:function(m,l,h){const _=m.transform,x="mercator"===_.projection.name||"globe"===_.projection.name?1:f.smoothstep(7,8,_.zoom),w=h.paint.get("sky-opacity")*x;if(0===w)return;const T=m.context,S=h.paint.get("sky-type"),P=new f.DepthMode(T.gl.LEQUAL,f.DepthMode.ReadOnly,[0,1]),B=m.frameCounter/1e3%1;"atmosphere"===S?"offscreen"===m.renderPass?h.needsSkyboxCapture(m)&&(function(N,j,X,J){const te=N.context,ee=te.gl;let re=j.skyboxFbo;if(!re){re=j.skyboxFbo=te.createFramebuffer(32,32,!1),j.skyboxGeometry=new Ou(te),j.skyboxTexture=te.gl.createTexture(),ee.bindTexture(ee.TEXTURE_CUBE_MAP,j.skyboxTexture),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MIN_FILTER,ee.LINEAR),ee.texParameteri(ee.TEXTURE_CUBE_MAP,ee.TEXTURE_MAG_FILTER,ee.LINEAR);for(let oe=0;oe<6;++oe)ee.texImage2D(ee.TEXTURE_CUBE_MAP_POSITIVE_X+oe,0,ee.RGBA,32,32,0,ee.RGBA,ee.UNSIGNED_BYTE,null)}te.bindFramebuffer.set(re.framebuffer),te.viewport.set([0,0,32,32]);const $=j.getCenter(N,!0),Y=N.useProgram("skyboxCapture"),ae=new Float64Array(16);f.identity(ae),f.rotateY(ae,ae,.5*-Math.PI),Ai(te,j,Y,ae,$,0),f.identity(ae),f.rotateY(ae,ae,.5*Math.PI),Ai(te,j,Y,ae,$,1),f.identity(ae),f.rotateX(ae,ae,.5*-Math.PI),Ai(te,j,Y,ae,$,2),f.identity(ae),f.rotateX(ae,ae,.5*Math.PI),Ai(te,j,Y,ae,$,3),f.identity(ae),Ai(te,j,Y,ae,$,4),f.identity(ae),f.rotateY(ae,ae,Math.PI),Ai(te,j,Y,ae,$,5),te.viewport.set([0,0,N.width,N.height])}(m,h),h.markSkyboxValid(m)):"sky"===m.renderPass&&function(N,j,X,J,te){const ee=N.context,re=ee.gl,$=N.transform,Y=N.useProgram("skybox");ee.activeTexture.set(re.TEXTURE0),re.bindTexture(re.TEXTURE_CUBE_MAP,j.skyboxTexture);const ae={u_matrix:$.skyboxMatrix,u_sun_direction:j.getCenter(N,!1),u_cubemap:0,u_opacity:J,u_temporal_offset:te};N.prepareDrawProgram(ee,Y),Y.draw(ee,re.TRIANGLES,X,f.StencilMode.disabled,N.colorModeForRenderPass(),f.CullFaceMode.backCW,ae,"skybox",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(m,h,P,w,B):"gradient"===S&&"sky"===m.renderPass&&function(N,j,X,J,te){const ee=N.context,re=ee.gl,$=N.transform,Y=N.useProgram("skyboxGradient");j.skyboxGeometry||(j.skyboxGeometry=new Ou(ee)),ee.activeTexture.set(re.TEXTURE0);let ae=j.colorRampTexture;ae||(ae=j.colorRampTexture=new f.Texture(ee,j.colorRamp,re.RGBA)),ae.bind(re.LINEAR,re.CLAMP_TO_EDGE);const oe=(_e=$.skyboxMatrix,ve=j.getCenter(N,!1),ye=j.paint.get("sky-gradient-radius"),Ce=J,we=te,{u_matrix:_e,u_color_ramp:0,u_center_direction:ve,u_radius:f.degToRad(ye),u_opacity:Ce,u_temporal_offset:we});var _e,ve,ye,Ce,we;N.prepareDrawProgram(ee,Y),Y.draw(ee,re.TRIANGLES,X,f.StencilMode.disabled,N.colorModeForRenderPass(),f.CullFaceMode.backCW,oe,"skyboxGradient",j.skyboxGeometry.vertexBuffer,j.skyboxGeometry.indexBuffer,j.skyboxGeometry.segment)}(m,h,P,w,B)},debug:function(m,l,h){for(let _=0;_<h.length;_++)yr(m,l,h[_])},custom:function(m,l,h,_){const x=m.context,w=h.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||"offscreen"===m.renderPass)&&h.isLayerDraped()){if("offscreen"===m.renderPass){const T=w.prerender;if(T){if(m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),"globe"===m.transform.projection.name){const S=m.transform.pointMerc;T.call(w,x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(m.transform.zoom),[S.x,S.y],m.transform.pixelsPerMeterRatio)}else T.call(w,x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState()}}else if("translucent"===m.renderPass){if(m.terrain&&m.terrain.renderingToTexture){const S=w.renderToTile;if(S){const P=_[0].canonical,B=new f.MercatorCoordinate(P.x+_[0].wrap*(1<<P.z),P.y,P.z);x.setDepthMode(f.DepthMode.disabled),x.setStencilMode(f.StencilMode.disabled),x.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),S.call(w,x.gl,B),x.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),x.setColorMode(m.colorModeForRenderPass()),x.setStencilMode(f.StencilMode.disabled);const T="3d"===w.renderingMode?new f.DepthMode(m.context.gl.LEQUAL,f.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,f.DepthMode.ReadOnly);if(x.setDepthMode(T),"globe"===m.transform.projection.name){const S=m.transform.pointMerc;w.render(x.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),f.globeToMercatorTransition(m.transform.zoom),[S.x,S.y],m.transform.pixelsPerMeterRatio)}else w.render(x.gl,m.transform.customLayerMatrix());x.setDirty(),m.setBaseState(),x.bindFramebuffer.set(null)}}else f.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class ss{constructor(l,h,_=!1){this.context=new st(l,_),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=f.SourceCache.maxUnderzooming+f.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(l,h){const _=!!l&&!!l.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Au(this,l));const x=this._terrain;this.transform.elevation=_?x:null,x.update(l,this.transform,h)}_updateFog(l){const h=l.fog;if(!h||"globe"===this.transform.projection.name||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,x]=h.getFovAdjustedRange(this.transform._fov);if(_>x)return void(this.transform.fogCullDistSq=null);const w=_+.78*(x-_);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(l,h){if(this.width=l*f.exported.devicePixelRatio,this.height=h*f.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const l=this.context,h=new f.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(f.EXTENT,0),h.emplaceBack(0,f.EXTENT),h.emplaceBack(f.EXTENT,f.EXTENT),this.tileExtentBuffer=l.createVertexBuffer(h,f.posAttributes.members),this.tileExtentSegments=f.SegmentVector.simpleSegment(0,0,4,2);const _=new f.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(f.EXTENT,0),_.emplaceBack(0,f.EXTENT),_.emplaceBack(f.EXTENT,f.EXTENT),this.debugBuffer=l.createVertexBuffer(_,f.posAttributes.members),this.debugSegments=f.SegmentVector.simpleSegment(0,0,4,5);const x=new f.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(x,f.posAttributes.members),this.viewportSegments=f.SegmentVector.simpleSegment(0,0,4,2);const w=new f.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(f.EXTENT,0,f.EXTENT,0),w.emplaceBack(0,f.EXTENT,0,f.EXTENT),w.emplaceBack(f.EXTENT,f.EXTENT,f.EXTENT,f.EXTENT),this.mercatorBoundsBuffer=l.createVertexBuffer(w,f.boundsAttributes.members),this.mercatorBoundsSegments=f.SegmentVector.simpleSegment(0,0,4,2);const T=new f.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(T);const S=new f.StructArrayLayout1ui2;for(const B of[0,1,3,2,0])S.emplaceBack(B);this.debugIndexBuffer=l.createIndexBuffer(S),this.emptyTexture=new f.Texture(l,new f.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),l.gl.RGBA),this.identityMat=f.create();const P=this.context.gl;this.stencilClearMode=new f.StencilMode({func:P.ALWAYS,mask:0},0,255,P.ZERO,P.ZERO,P.ZERO),this.loadTimeStamps.push(f.window.performance.now()),this.atmosphereBuffer=new uc(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(l){return l._makeTileBoundsBuffers(this.context,this.transform.projection),l._tileBoundsBuffer?{tileBoundsBuffer:l._tileBoundsBuffer,tileBoundsIndexBuffer:l._tileBoundsIndexBuffer,tileBoundsSegments:l._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const l=this.context,h=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(l,h.TRIANGLES,f.DepthMode.disabled,this.stencilClearMode,f.ColorMode.disabled,f.CullFaceMode.disabled,Zt(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(l,h,_){if(!h||this.currentStencilSource===h.id||!l.isTileClipped()||!_||0===_.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let S=!1;for(const P of _)if(void 0===this._tileClippingMaskIDs[P.key]){S=!0;break}if(!S)return}this.currentStencilSource=h.id;const x=this.context,w=x.gl;this.nextStencilID+_.length>256&&this.clearStencil(),x.setColorMode(f.ColorMode.disabled),x.setDepthMode(f.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of _){const P=h.getTile(S),B=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,{tileBoundsBuffer:N,tileBoundsIndexBuffer:j,tileBoundsSegments:X}=this.getTileBoundsBuffers(P);T.draw(x,w.TRIANGLES,f.DepthMode.disabled,new f.StencilMode({func:w.ALWAYS,mask:0},B,255,w.KEEP,w.KEEP,w.REPLACE),f.ColorMode.disabled,f.CullFaceMode.disabled,Zt(S.projMatrix),"$clipping",N,j,X)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const l=this.nextStencilID++,h=this.context.gl;return new f.StencilMode({func:h.NOTEQUAL,mask:255},l,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(l){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(l);const h=this.context.gl;return new f.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(l){const h=this.context.gl,_=l.sort((T,S)=>S.overscaledZ-T.overscaledZ),x=_[_.length-1].overscaledZ,w=_[0].overscaledZ-x+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const T={};for(let S=0;S<w;S++)T[S+x]=new f.StencilMode({func:h.GEQUAL,mask:255},S+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[T,_]}return[{[x]:f.StencilMode.disabled},_]}colorModeForRenderPass(){const l=this.context.gl;return this._showOverdrawInspector?new f.ColorMode([l.CONSTANT_COLOR,l.ONE],new f.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?f.ColorMode.unblended:f.ColorMode.alphaBlended}depthModeForSublayer(l,h,_){if(!this.opaquePassEnabledForLayer())return f.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new f.DepthMode(_||this.context.gl.LEQUAL,h,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,h){this.style=l,this.options=h,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(f.exported.now()),this.imageManager.beginFrame();const _=this.style.order,x=this.style._sourceCaches;for(const B in x){const N=x[B];N.used&&N.prepare(this.context)}const w={},T={},S={};for(const B in x){const N=x[B];w[B]=N.getVisibleCoordinates(),T[B]=w[B].slice().reverse(),S[B]=N.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let B=0;B<_.length;B++)if(this.style._layers[_[B]].is3D()){this.opaquePassCutoff=B;break}if(this.terrain&&(this.terrain.updateTileBinding(S),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new f.GlobeSharedBuffers(this.context)),!f.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const B of _){const N=this.style._layers[B],j=l._getLayerSourceCache(N);if(!N.hasOffscreenPass()||N.isHidden(this.transform.zoom))continue;const X=j?T[j.id]:void 0;("custom"===N.type||N.isSky()||X&&X.length)&&this.renderLayer(this,j,N,X)}this.depthRangeFor3D=[0,1-(l.order.length+2)*this.numSublayers*this.depthEpsilon];const P=this.terrain;if(P&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&P.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?f.Color.black:f.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const B=this.style._layers[_[this.currentLayer]],N=l._getLayerSourceCache(B);if(B.isSky())continue;const j=N?T[N.id]:void 0;this._renderTileClippingMasks(B,N,j),this.renderLayer(this,N,B,j)}if(this.style.fog&&this.transform.projection.supportsFog&&function(B,N){const j=B.context,X=j.gl,J=B.transform,te=new f.DepthMode(X.LEQUAL,f.DepthMode.ReadOnly,[0,1]),ee=B.useProgram("globeAtmosphere",null,"globe"===J.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),re=f.globeToMercatorTransition(J.zoom),$=N.properties.get("color").toArray01(),Y=N.properties.get("high-color").toArray01(),ae=N.properties.get("space-color").toArray01PremultipliedAlpha(),oe=f.identity$1([]);f.rotateY$1(oe,oe,-f.degToRad(J._center.lng)),f.rotateX$1(oe,oe,f.degToRad(J._center.lat)),f.rotateZ$1(oe,oe,J.angle),f.rotateX$1(oe,oe,-J._pitch);const _e=f.fromQuat(new Float32Array(16),oe),ve=f.mapValue(N.properties.get("star-intensity"),0,1,0,.25),Ce=f.mapValue(N.properties.get("horizon-blend"),0,1,5e-4,.25),we=f.globeUseCustomAntiAliasing(B,j,J)&&5e-4===Ce?J.worldSize/(2*Math.PI*1.025)-1:J.globeRadius,ke=B.frameCounter/1e3%1,tt=f.length(J.globeCenterInViewSpace),Ie=Math.sqrt(Math.pow(tt,2)-Math.pow(we,2)),qe=Math.acos(Ie/tt),Fe={u_frustum_tl:J.frustumCorners.TL,u_frustum_tr:J.frustumCorners.TR,u_frustum_br:J.frustumCorners.BR,u_frustum_bl:J.frustumCorners.BL,u_horizon:J.frustumCorners.horizon,u_transition:re,u_fadeout_range:Ce,u_color:$,u_high_color:Y,u_space_color:ae,u_star_intensity:ve,u_star_size:5*f.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:ke,u_horizon_angle:qe,u_rotation_matrix:_e};B.prepareDrawProgram(j,ee);const nt=B.atmosphereBuffer;nt&&ee.draw(j,X.TRIANGLES,te,f.StencilMode.disabled,f.ColorMode.alphaBlended,f.CullFaceMode.backCW,Fe,"skybox",nt.vertexBuffer,nt.indexBuffer,nt.segments)}(this,this.style.fog),this.renderPass="sky",(f.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const B=this.style._layers[_[this.currentLayer]],N=l._getLayerSourceCache(B);B.isSky()&&this.renderLayer(this,N,B,N?T[N.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const B=this.style._layers[_[this.currentLayer]],N=l._getLayerSourceCache(B);if(B.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(B)){if(B.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const j=N?("symbol"===B.type?S:T)[N.id]:void 0;this._renderTileClippingMasks(B,N,N?w[N.id]:void 0),this.renderLayer(this,N,B,j),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let B=null;f.values(this.style._layers).forEach(N=>{const j=l._getLayerSourceCache(N);j&&!N.isHidden(this.transform.zoom)&&(!B||B.getSource().maxzoom<j.getSource().maxzoom)&&(B=j)}),B&&this.options.showTileBoundaries&&vs.debug(this,B,B.getVisibleCoordinates())}this.options.showPadding&&function(B){const N=B.transform.padding;Il(B,B.transform.height-(N.top||0),3,on),Il(B,N.bottom||0,3,Pu),$s(B,N.left||0,3,os),$s(B,B.transform.width-(N.right||0),3,ku);const j=B.transform.centerPoint;var X,J,te,ee;$r(X=B,(J=j.x)-1,(te=B.transform.height-j.y)-10,2,20,ee=Al),$r(X,J-10,te-1,20,2,ee)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(f.window.performance.now()),this.saveCanvasCopy())}renderLayer(l,h,_,x){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||x&&x.length)&&(this.id=_.id,this.gpuTimingStart(_),(!l.transform.projection.unsupportedLayers||!l.transform.projection.unsupportedLayers.includes(_.type)||l.terrain&&"custom"===_.type)&&vs[_.type](l,h,_,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(l){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let _=this.gpuTimers[l.id];_||(_=this.gpuTimers[l.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const l=this.context.extTimerQuery,h=l.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),l.beginQueryEXT(l.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const l=this.context.extTimerQuery;l.endQueryEXT(l.TIME_ELAPSED_EXT)}collectGpuTimers(){const l=this.gpuTimers;return this.gpuTimers={},l}collectDeferredRenderGpuQueries(){const l=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],l}queryGpuTimers(l){const h={};for(const _ in l){const x=l[_],w=this.context.extTimerQuery,T=w.getQueryObjectEXT(x.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(x.query),h[_]=T}return h}queryGpuTimeDeferredRender(l){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let _=0;for(const x of l)_+=h.getQueryObjectEXT(x,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(x);return _}translatePosMatrix(l,h,_,x,w){if(!_[0]&&!_[1])return l;const T=w?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(T){const B=Math.sin(T),N=Math.cos(T);_=[_[0]*N-_[1]*B,_[0]*B+_[1]*N]}const S=[w?_[0]:nr(h,_[0],this.transform.zoom),w?_[1]:nr(h,_[1],this.transform.zoom),0],P=new Float32Array(16);return f.translate(P,l,S),P}saveTileTexture(l){const h=this._tileTextures[l.size[0]];h?h.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){const h=this._tileTextures[l];return h&&h.length>0?h.pop():null}isPatternMissing(l){return null===l||void 0!==l&&!this.imageManager.getPattern(l.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const l=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&0===this.terrain.exaggeration(),_=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),"globe"===this.transform.projection.name&&x.push("GLOBE"),h&&x.push("ZERO_EXAGGERATION"),_&&!l&&0!==_.getOpacity(this.transform.pitch)&&x.push("FOG"),l&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(l,h,_){this.cache=this.cache||{};const x=_||[],w=this.currentGlobalDefines().concat(x),T=En.cacheKey(ai[l],l,w,h);return this.cache[T]||(this.cache[T]=new En(this.context,l,ai[l],h,Ml[l],w)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=f.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new f.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(l,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const w=x.getOpacity(this.transform.pitch),T=((S,P,B,N,j,X,J,te,ee,re,$)=>{const Y=S.transform,ae=P.properties.get("color").toArray01();ae[3]=N;const oe=S.frameCounter/1e3%1;return{u_fog_matrix:B?Y.calculateFogTileMatrix(B):S.identityMat,u_fog_range:P.getFovAdjustedRange(Y._fov),u_fog_color:ae,u_fog_horizon_blend:P.properties.get("horizon-blend"),u_fog_temporal_offset:oe,u_frustum_tl:j,u_frustum_tr:X,u_frustum_br:J,u_frustum_bl:te,u_globe_pos:ee,u_globe_radius:re,u_viewport:$,u_globe_transition:f.globeToMercatorTransition(Y.zoom),u_is_globe:+("globe"===Y.projection.name)}})(this,x,_,w,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*f.exported.devicePixelRatio,this.transform.height*f.exported.devicePixelRatio]);h.setFogUniformValues(l,T)}}setTileLoadedFlag(l){this.tileLoaded=l}saveCanvasCopy(){const l=this.canvasCopy();l&&(this.frameCopies.push(l),this.tileLoaded=!1)}canvasCopy(){const l=this.context.gl,h=l.createTexture();return l.bindTexture(l.TEXTURE_2D,h),l.copyTexImage2D(l.TEXTURE_2D,0,l.RGBA,0,0,l.drawingBufferWidth,l.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const l=this.style&&this.style.fog;return!!l&&0!==l.getOpacity(this.transform.pitch)}getBackgroundTiles(){const l=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const x of _)h[x.key]=l[x.key]||new f.Tile(x,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class dr{constructor(l=0,h=0,_=0,x=0){if(isNaN(l)||l<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=h,this.left=_,this.right=x}interpolate(l,h,_){return null!=h.top&&null!=l.top&&(this.top=f.number(l.top,h.top,_)),null!=h.bottom&&null!=l.bottom&&(this.bottom=f.number(l.bottom,h.bottom,_)),null!=h.left&&null!=l.left&&(this.left=f.number(l.left,h.left,_)),null!=h.right&&null!=l.right&&(this.right=f.number(l.right,h.right,_)),this}getCenter(l,h){const _=f.clamp((this.left+l-this.right)/2,0,l),x=f.clamp((this.top+h-this.bottom)/2,0,h);return new f.Point(_,x)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new dr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Fu(m,l){const h=f.getColumn(m,3);f.fromQuat(m,l),f.setColumn(m,3,h)}function Xt(m,l){const h=f.identity$1([]);return f.rotateZ$1(h,h,-l),f.rotateX$1(h,h,-m),h}function Hr(m,l){const h=[m[0],m[1],0],_=[l[0],l[1],0];if(f.length(h)>=1e-15){const T=f.normalize([],h);f.scale$2(_,T,f.dot(_,T)),l[0]=_[0],l[1]=_[1]}const x=f.cross([],l,m);if(f.len(x)<1e-15)return null;const w=Math.atan2(-x[1],x[0]);return Xt(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),w)}class Za{constructor(l,h){this.position=l,this.orientation=h}get position(){return this._position}set position(l){if(l){const h=l instanceof f.MercatorCoordinate?l:new f.MercatorCoordinate(l[0],l[1],l[2]);this._renderWorldCopies&&(h.x=f.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(l,h){if(this.orientation=null,!this.position)return;const _=this.position,x=this._elevation?this._elevation.getAtPointOrZero(f.MercatorCoordinate.fromLngLat(l)):0,w=f.MercatorCoordinate.fromLngLat(l,x),T=[w.x-_.x,w.y-_.y,w.z-_.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Hr(T,h)}setPitchBearing(l,h){this.orientation=Xt(f.degToRad(l),f.degToRad(-h))}}class R{constructor(l,h){this._transform=f.identity([]),this.orientation=h,this.position=l}get mercatorPosition(){const l=this.position;return new f.MercatorCoordinate(l[0],l[1],l[2])}get position(){const l=f.getColumn(this._transform,3);return[l[0],l[1],l[2]]}set position(l){var h;l&&f.setColumn(this._transform,3,[(h=l)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(l){this._orientation=l||f.identity$1([]),l&&Fu(this._transform,this._orientation)}getPitchBearing(){const l=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(l[0]*l[0]+l[1]*l[1]),-l[2])}}setPitchBearing(l,h){this._orientation=Xt(l,h),Fu(this._transform,this._orientation)}forward(){const l=f.getColumn(this._transform,2);return[-l[0],-l[1],-l[2]]}up(){const l=f.getColumn(this._transform,1);return[-l[0],-l[1],-l[2]]}right(){const l=f.getColumn(this._transform,0);return[l[0],l[1],l[2]]}getCameraToWorld(l,h){const _=new Float64Array(16);return f.invert(_,this.getWorldToCamera(l,h)),_}getWorldToCameraPosition(l,h,_){const x=this.position;f.scale$2(x,x,-l);const w=new Float64Array(16);return f.fromScaling(w,[_,_,_]),f.translate(w,w,x),w[10]*=h,w}getWorldToCamera(l,h){const _=new Float64Array(16),x=new Float64Array(4),w=this.position;return f.conjugate(x,this._orientation),f.scale$2(w,w,-l),f.fromQuat(_,x),f.translate(_,_,w),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(l,h,_,x){const w=new Float64Array(16);return f.perspective(w,l,h,_,x),w}getDistanceToElevation(l,h=!1){const _=0===l?0:f.mercatorZfromAltitude(l,h?f.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(_-this.position[2])/x[2]}clone(){return new R([...this.position],[...this.orientation])}}function F(m,l){const h=de(m.projection,m.zoom,m.width,m.height),_=function(w,T,S,P,B){const N=new f.LngLat(S.lng-180*Ge,S.lat),j=new f.LngLat(S.lng+180*Ge,S.lat),X=w.project(N.lng,N.lat),J=w.project(j.lng,j.lat),te=-Math.atan2(J.y-X.y,J.x-X.x),ee=f.MercatorCoordinate.fromLngLat(S);ee.y=f.clamp(ee.y,-1+Ge,1-Ge);const re=ee.toLngLat(),$=w.project(re.lng,re.lat),Y=f.MercatorCoordinate.fromLngLat(re);Y.x+=Ge;const ae=Y.toLngLat(),oe=w.project(ae.lng,ae.lat),_e=Hn(oe.x-$.x,oe.y-$.y,te),ve=f.MercatorCoordinate.fromLngLat(re);ve.y+=Ge;const ye=ve.toLngLat(),Ce=w.project(ye.lng,ye.lat),we=Hn(Ce.x-$.x,Ce.y-$.y,te),ke=Math.abs(_e.x)/Math.abs(we.y),tt=f.identity([]);f.rotateZ(tt,tt,-te*(1-(B?0:P)));const Ie=f.identity([]);return f.scale(Ie,Ie,[1,1-(1-ke)*P,1]),Ie[4]=-we.x/we.y*P,f.rotateZ(Ie,Ie,te),f.multiply(Ie,tt,Ie),Ie}(m.projection,0,m.center,h,l),x=G(m);return f.scale(_,_,[x,x,1]),_}function G(m){const l=m.projection,h=de(m.projection,m.zoom,m.width,m.height),_=Rt(l,m.center),x=Rt(l,f.LngLat.convert(l.center));return Math.pow(2,_*h+(1-h)*x)}function de(m,l,h,_,x=1/0){const w=m.range;if(!w)return 0;const T=Math.min(x,Math.max(h,_)),S=Math.log(T/1024)/Math.LN2;return f.smoothstep(w[0]+S,w[1]+S,l)}const Ge=1/4e4;function Rt(m,l){const h=f.clamp(l.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),_=new f.LngLat(l.lng-180*Ge,h),x=new f.LngLat(l.lng+180*Ge,h),w=m.project(_.lng,h),T=m.project(x.lng,h),S=f.MercatorCoordinate.fromLngLat(_),P=f.MercatorCoordinate.fromLngLat(x),B=T.x-w.x,N=T.y-w.y,j=P.x-S.x,X=P.y-S.y,J=Math.sqrt((j*j+X*X)/(B*B+N*N));return Math.log(J)/Math.LN2}function Hn(m,l,h){const _=Math.cos(h),x=Math.sin(h);return{x:m*_-l*x,y:m*x+l*_}}class Ri{constructor(l,h,_,x,w,T,S){this.tileSize=512,this._renderWorldCopies=void 0===w||w,this._minZoom=l||0,this._maxZoom=h||22,this._minPitch=_??0,this._maxPitch=x??60,this.setProjection(T),this.setMaxBounds(S),this.width=0,this.height=0,this._center=new f.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new dr,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new R,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const l=new Ri(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return l._elevation=this._elevation,l._centerAltitude=this._centerAltitude,l._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,l.tileSize=this.tileSize,l.mercatorFromTransition=this.mercatorFromTransition,l.width=this.width,l.height=this.height,l.cameraElevationReference=this.cameraElevationReference,l._center=this._center,l._setZoom(this.zoom),l._seaLevelZoom=this._seaLevelZoom,l.angle=this.angle,l._fov=this._fov,l._pitch=this._pitch,l._nearZ=this._nearZ,l._farZ=this._farZ,l._averageElevation=this._averageElevation,l._unmodified=this._unmodified,l._edgeInsets=this._edgeInsets.clone(),l._camera=this._camera.clone(),l._calcMatrices(),l.freezeTileCoverage=this.freezeTileCoverage,l.frustumCorners=this.frustumCorners,l}get elevation(){return this._elevation}set elevation(l){this._elevation!==l&&(this._elevation=l,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(l,h=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||_)&&this._updateCameraOnTerrain(),(l||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return f.pick(this.projection,["name","center","parallels"])}setProjection(l){this.projectionOptions=l||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=f.getProjection(this.projectionOptions);const _=!Ke(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const l=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=f.getProjection({name:"mercator"});const h=l!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(l){void 0===l?l=!0:null===l&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get cameraWorldSize(){const l=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(l))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return f.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new f.Point(this.width,this.height)}get bearing(){return f.wrap(this.rotation,-180,180)}set bearing(l){this.rotation=l}get rotation(){return-this.angle/Math.PI*180}set rotation(l){const h=-l*Math.PI/180;var _,x,w,T,S,P,B,N,j,X;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new f.ARRAY_TYPE(4),f.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),x=this.rotationMatrix,T=this.angle,S=(w=this.rotationMatrix)[0],P=w[1],B=w[2],N=w[3],j=Math.sin(T),X=Math.cos(T),x[0]=S*X+B*j,x[1]=P*X+N*j,x[2]=S*-j+B*X,x[3]=P*-j+N*X)}get pitch(){return this._pitch/Math.PI*180}set pitch(l){const h=f.clamp(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const l=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/l)}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=f.degToRad(l),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(l){this._averageElevation=l,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(l){const h=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(l){this._zoom=l,this.scale=this.zoomScale(l),this.tileZoom=Math.floor(l),this.zoomFraction=l-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const l=this._elevation;this._centerAltitude=l.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=l.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const l=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let x=0,w=0;for(let T=0;T<h.length;T++){const S=new f.Point(h[T][0]*this.width,_+h[T][1]*(this.height-_)),P=l.pointCoordinate(S);if(!P)continue;const B=1/Math.hypot(P[0]-this._camera.position[0],P[1]-this._camera.position[1]);x+=P[3]*B,w+=B}return 0===w?NaN:x/w}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const l=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,x=this._mercatorZfromZoom(l),w=this._mercatorZfromZoom(this._maxZoom),T=Math.max(x-_,w);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}computeZoomRelativeTo(l){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,l.toAltitude()));let _;_=l.z<this._camera.position[2]?[h.x,h.y,h.z]:[l.x,l.y,l.z];const x=f.length(f.sub([],this._camera.position,_));return f.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(l){if(!this.height||!l.position&&!l.orientation)return;this._updateCameraState();let h=!1;if(l.orientation&&!f.exactEquals(l.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(l.orientation)),l.position){const _=[l.position.x,l.position.y,l.position.z];f.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const l=this._camera.position,h=new Za;return h.position=new f.MercatorCoordinate(l[0],l[1],l[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(l){if(!f.length$1(l))return!1;f.normalize$1(l,l);const h=f.transformQuat([],[0,0,-1],l),_=f.transformQuat([],[0,-1,0],l);if(_[2]<0)return!1;const x=Hr(h,_);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(l){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;l[2]=f.clamp(l[2],x/_,x/h),this._camera.position=l}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,h,_){this._unmodified=!1,this._edgeInsets.interpolate(l,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){const h=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(l){const h=[new f.UnwrappedTileID(0,l)];if(this.renderWorldCopies){const _=this.pointCoordinate(new f.Point(0,0)),x=this.pointCoordinate(new f.Point(this.width,0)),w=this.pointCoordinate(new f.Point(this.width,this.height)),T=this.pointCoordinate(new f.Point(0,this.height)),S=Math.floor(Math.min(_.x,x.x,w.x,T.x)),P=Math.floor(Math.max(_.x,x.x,w.x,T.x)),B=1;for(let N=S-B;N<=P+B;N++)0!==N&&h.push(new f.UnwrappedTileID(N,l))}return h}coveringTiles(l){let h=this.coveringZoomLevel(l);const _=h,x=this.elevation&&!l.isTerrainDEM,w="mercator"===this.projection.name;if(void 0!==l.minzoom&&h<l.minzoom)return[];void 0!==l.maxzoom&&h>l.maxzoom&&(h=l.maxzoom);const T=this.locationCoordinate(this.center),S=this.center.lat,P=1<<h,B=[P*T.x,P*T.y,0],N="globe"===this.projection.name,j=!N,X=f.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,j),J=N?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),te=P*f.mercatorZfromAltitude(1,this.center.lat),ee=this._camera.position[2]/f.mercatorZfromAltitude(1,this.center.lat),re=[P*J.x,P*J.y,ee*(j?1:te)],$=this.cameraToCenterDistance/l.tileSize*(l.roundZoom?1:.502),Y=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,ae=l.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,oe=l.isTerrainDEM?-ae:this._elevation?this._elevation.getMinElevationBelowMSL():0,_e=this.projection.isReprojectedInTileSpace?G(this):1,ve=Pe=>{const it=new f.MercatorCoordinate(Pe.x+25e-6,Pe.y,Pe.z),Je=new f.MercatorCoordinate(Pe.x,Pe.y+25e-6,Pe.z),at=Pe.toLngLat(),St=it.toLngLat(),Gt=Je.toLngLat(),wt=this.locationCoordinate(at),kt=this.locationCoordinate(St),vn=this.locationCoordinate(Gt),gn=Math.hypot(kt.x-wt.x,kt.y-wt.y),Ct=Math.hypot(vn.x-wt.x,vn.y-wt.y);return Math.sqrt(gn*Ct)*_e/25e-6},ye=Pe=>{const He=ae,it=oe;return{aabb:f.tileAABB(this,P,0,0,0,Pe,it,He,this.projection),zoom:0,x:0,y:0,minZ:it,maxZ:He,wrap:Pe,fullyVisible:!1}},Ce=[];let we=[];const ke=h,tt=l.reparseOverscaled?_:h,Ie=Pe=>Pe*Pe,qe=Ie((ee-this._centerAltitude)*te),Fe=Pe=>{if(!this._elevation||!Pe.tileID||!w)return;const He=this._elevation.getMinMaxForTile(Pe.tileID),it=Pe.aabb;He?(it.min[2]=He.min,it.max[2]=He.max,it.center[2]=(it.min[2]+it.max[2])/2):(Pe.shouldSplit=nt(Pe),Pe.shouldSplit||(it.min[2]=it.max[2]=it.center[2]=this._centerAltitude))},nt=Pe=>{if(Pe.zoom<Y)return!0;if(Pe.zoom===ke)return!1;if(null!=Pe.shouldSplit)return Pe.shouldSplit;const He=Pe.aabb.distanceX(re),it=Pe.aabb.distanceY(re);let Je=qe,at=1;if(N){Je=Ie(Pe.aabb.distanceZ(re));const wt=Math.pow(2,Pe.zoom),kt=f.latFromMercatorY((Pe.y+1)/wt),vn=f.latFromMercatorY(Pe.y/wt),gn=Math.min(Math.max(S,kt),vn),Ct=f.circumferenceAtLatitude(gn)/f.circumferenceAtLatitude(S);if(at=gn===S?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ct/this._mercatorScaleRatio),this.zoom<=f.GLOBE_ZOOM_THRESHOLD_MIN&&Pe.zoom===ke-1&&Ct>=.9)return!0}else if(x&&(Je=Ie(Pe.aabb.distanceZ(re)*te)),this.projection.isReprojectedInTileSpace&&_<=5){const wt=Math.pow(2,Pe.zoom),kt=ve(new f.MercatorCoordinate((Pe.x+.5)/wt,(Pe.y+.5)/wt));at=kt>.85?1:kt}const St=He*He+it*it+Je;return St<Ie((1<<ke-Pe.zoom)*$*at*((wt,kt)=>{if(kt*Ie(.707)<wt)return 1;const vn=Math.sqrt(kt/wt);return vn/(1.4144271570014144+(Math.pow(1.1,vn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Je,qe),St))};if(this.renderWorldCopies)for(let Pe=1;Pe<=3;Pe++)Ce.push(ye(-Pe)),Ce.push(ye(Pe));for(Ce.push(ye(0));Ce.length>0;){const Pe=Ce.pop(),He=Pe.x,it=Pe.y;let Je=Pe.fullyVisible;if(!Je){const at=Pe.aabb.intersects(X);if(0===at)continue;Je=2===at}if(Pe.zoom!==ke&&nt(Pe))for(let at=0;at<4;at++){const St=(He<<1)+at%2,Gt=(it<<1)+(at>>1),wt={aabb:w?Pe.aabb.quadrant(at):f.tileAABB(this,P,Pe.zoom+1,St,Gt,Pe.wrap,Pe.minZ,Pe.maxZ,this.projection),zoom:Pe.zoom+1,x:St,y:Gt,wrap:Pe.wrap,fullyVisible:Je,tileID:void 0,shouldSplit:void 0,minZ:Pe.minZ,maxZ:Pe.maxZ};x&&!N&&(wt.tileID=new f.OverscaledTileID(Pe.zoom+1===ke?tt:Pe.zoom+1,Pe.wrap,Pe.zoom+1,St,Gt),Fe(wt)),Ce.push(wt)}else{const at=Pe.zoom===ke?tt:Pe.zoom;if(l.minzoom&&l.minzoom>at)continue;const St=B[0]-(.5+He+(Pe.wrap<<Pe.zoom))*(1<<h-Pe.zoom),Gt=B[1]-.5-it,wt=Pe.tileID?Pe.tileID:new f.OverscaledTileID(at,Pe.wrap,Pe.zoom,He,it);we.push({tileID:wt,distanceSq:St*St+Gt*Gt})}}if(this.fogCullDistSq){const Pe=this.fogCullDistSq,He=this.horizonLineFromTop();we=we.filter(it=>{const Je=[0,0,0,1],at=[f.EXTENT,f.EXTENT,0,1],St=this.calculateFogTileMatrix(it.tileID.toUnwrapped());f.transformMat4$1(Je,Je,St),f.transformMat4$1(at,at,St);const Gt=f.getAABBPointSquareDist(Je,at);if(0===Gt)return!0;let wt=!1;const kt=this._elevation;if(kt&&Gt>Pe&&0!==He){const vn=this.calculateProjMatrix(it.tileID.toUnwrapped());let gn;l.isTerrainDEM||(gn=kt.getMinMaxForTile(it.tileID)),gn||(gn={min:oe,max:ae});const Ct=f.furthestTileCorner(this.rotation),Gn=[Ct[0]*f.EXTENT,Ct[1]*f.EXTENT,gn.max];f.transformMat4(Gn,Gn,vn),wt=(1-Gn[1])*this.height*.5<He}return Gt<Pe||wt})}return we.sort((Pe,He)=>Pe.distanceSq-He.distanceSq).map(Pe=>Pe.tileID)}resize(l,h){this.width=l,this.height=h,this.pixelsToGLUnits=[2/l,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){const h=f.clamp(l.lat,-f.MAX_MERCATOR_LATITUDE,f.MAX_MERCATOR_LATITUDE),_=this.projection.project(l.lng,h);return new f.Point(_.x*this.worldSize,_.y*this.worldSize)}unproject(l){return this.projection.unproject(l.x/this.worldSize,l.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/f.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(l,h){let _,x;const w=this.centerPoint;if("globe"===this.projection.name){const S=this.worldSize;_=(h.x-w.x)/S,x=(h.y-w.y)/S}else{const S=this.pointCoordinate(h),P=this.pointCoordinate(w);_=S.x-P.x,x=S.y-P.y}const T=this.locationCoordinate(l);this.setLocation(new f.MercatorCoordinate(T.x-_,T.y-x))}setLocation(l){this.center=this.coordinateLocation(l),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(l){return this.projection.locationPoint(this,l)}locationPoint3D(l){return this.projection.locationPoint(this,l,!0)}pointLocation(l){return this.coordinateLocation(this.pointCoordinate(l))}pointLocation3D(l){return this.coordinateLocation(this.pointCoordinate3D(l))}locationCoordinate(l,h){const _=h?f.mercatorZfromAltitude(h,l.lat):void 0,x=this.projection.project(l.lng,l.lat);return new f.MercatorCoordinate(x.x,x.y,_)}coordinateLocation(l){return this.projection.unproject(l.x,l.y)}pointRayIntersection(l,h){const _=h??this._centerAltitude,x=[l.x,l.y,0,1],w=[l.x,l.y,1,1];f.transformMat4$1(x,x,this.pixelMatrixInverse),f.transformMat4$1(w,w,this.pixelMatrixInverse);const T=w[3];f.scale$1(x,x,1/x[3]),f.scale$1(w,w,1/T);const S=x[2],P=w[2];return{p0:x,p1:w,t:S===P?0:(_-S)/(P-S)}}screenPointToMercatorRay(l){const h=[l.x,l.y,0,1],_=[l.x,l.y,1,1];return f.transformMat4$1(h,h,this.pixelMatrixInverse),f.transformMat4$1(_,_,this.pixelMatrixInverse),f.scale$1(h,h,1/h[3]),f.scale$1(_,_,1/_[3]),h[2]=f.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=f.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,f.scale$1(h,h,1/this.worldSize),f.scale$1(_,_,1/this.worldSize),new f.Ray([h[0],h[1],h[2]],f.normalize([],f.sub([],_,h)))}rayIntersectionCoordinate(l){const{p0:h,p1:_,t:x}=l,w=f.mercatorZfromAltitude(h[2],this._center.lat),T=f.mercatorZfromAltitude(_[2],this._center.lat);return new f.MercatorCoordinate(f.number(h[0],_[0],x)/this.worldSize,f.number(h[1],_[1],x)/this.worldSize,f.number(w,T,x))}pointCoordinate(l,h=this._centerAltitude){return this.projection.pointCoordinate(this,l.x,l.y,h)}pointCoordinate3D(l){if(!this.elevation)return this.pointCoordinate(l);let h=this.projection.pointCoordinate3D(this,l.x,l.y);if(h)return new f.MercatorCoordinate(h[0],h[1],h[2]);let _=0,x=this.horizonLineFromTop();if(l.y>x)return this.pointCoordinate(l);const w=.02*x,T=l.clone();for(let S=0;S<10&&x-_>w;S++){T.y=f.number(_,x,.66);const P=this.projection.pointCoordinate3D(this,T.x,T.y);P?(x=T.y,h=P):_=T.y}return h?new f.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(l)}isPointAboveHorizon(l){return this.projection.isPointAboveHorizon(this,l)}isPointOnSurface(l){if(l.y<0||l.y>this.height||l.x<0||l.x>this.width)return!1;if(this.elevation||this.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(l);const h=this.pointCoordinate(l);return h.y>=0&&h.y<=1}_coordinatePoint(l,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(l,this._centerAltitude):this._centerAltitude,x=[l.x*this.worldSize,l.y*this.worldSize,_+l.toAltitude(),1];return f.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new f.Point(x[0]/x[3],x[1]/x[3]):new f.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:l,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,w=this.pointLocation3D(new f.Point(h,l)),T=this.pointLocation3D(new f.Point(x,l)),S=this.pointLocation3D(new f.Point(x,_)),P=this.pointLocation3D(new f.Point(h,_));let B=Math.min(w.lng,T.lng,S.lng,P.lng),N=Math.max(w.lng,T.lng,S.lng,P.lng),j=Math.min(w.lat,T.lat,S.lat,P.lat),X=Math.max(w.lat,T.lat,S.lat,P.lat);const J=Math.pow(2,-this.zoom)/16*270,te="globe"===this.projection.name?1:4,ee=(re,$,Y,ae,oe)=>{const _e=(re+Y)/2,ve=($+ae)/2,ye=new f.Point(_e,ve),{lng:Ce,lat:we}=this.pointLocation3D(ye),ke=Math.max(0,B-Ce,j-we,Ce-N,we-X);B=Math.min(B,Ce),N=Math.max(N,Ce),j=Math.min(j,we),X=Math.max(X,we),(oe<te||ke>J)&&(ee(re,$,_e,ve,oe+1),ee(_e,ve,Y,ae,oe+1))};if(ee(h,l,x,l,1),ee(x,l,x,_,1),ee(x,_,h,_,1),ee(h,_,h,l,1),"globe"===this.projection.name){const[re,$]=f.polesInViewport(this);re?(X=90,N=180,B=-180):$&&(j=-90,N=180,B=-180)}return new f.LngLatBounds(new f.LngLat(B,j),new f.LngLat(N,X))}_getBoundsRectangular(l,h){const{top:_,left:x}=this._edgeInsets,w=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,S=new f.Point(x,_),P=new f.Point(T,_),B=new f.Point(T,w),N=new f.Point(x,w);let j=this.pointCoordinate(S,l),X=this.pointCoordinate(P,l);const J=this.pointCoordinate(B,h),te=this.pointCoordinate(N,h),ee=(re,$)=>($.y-re.y)/($.x-re.x);return j.y>1&&X.y>=0?j=new f.MercatorCoordinate((1-te.y)/ee(te,j)+te.x,1):j.y<0&&X.y<=1&&(j=new f.MercatorCoordinate(-te.y/ee(te,j)+te.x,0)),X.y>1&&j.y>=0?X=new f.MercatorCoordinate((1-J.y)/ee(J,X)+J.x,1):X.y<0&&j.y<=1&&(X=new f.MercatorCoordinate(-J.y/ee(J,X)+J.x,0)),(new f.LngLatBounds).extend(this.coordinateLocation(j)).extend(this.coordinateLocation(X)).extend(this.coordinateLocation(te)).extend(this.coordinateLocation(J))}_getBoundsRectangularTerrain(){const l=this.elevation;if(!l.visibleDemTiles.length||l.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=l.visibleDemTiles.reduce((_,x)=>{if(x.dem){const w=x.dem.tree;_.min=Math.min(_.min,w.minimums[0]),_.max=Math.max(_.max,w.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*l.exaggeration(),h.max*l.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(l=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return l?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(l){this.maxBounds=l,this.minLat=-f.MAX_MERCATOR_LATITUDE,this.maxLat=f.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,l&&(this.minLat=l.getSouth(),this.maxLat=l.getNorth(),this.minLng=l.getWest(),this.maxLng=l.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=f.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=f.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=f.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=f.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(l,h){return this.projection.createTileMatrix(this,h,l)}calculateDistanceTileData(l){const h=l.key,_=this._distanceTileDataCache;if(_[h])return _[h];const x=l.canonical,w=1/this.height,T=this.cameraWorldSize,S=T/this.zoomScale(x.z),P=(x.x+Math.pow(2,x.z)*l.wrap)*S,B=x.y*S,N=this.point;N.x*=T/this.worldSize,N.y*=T/this.worldSize;const j=this.angle,X=Math.sin(-j),J=-Math.cos(-j);return _[h]={bearing:[X,J],center:[(N.x-P)*w,(N.y-B)*w],scale:S/f.EXTENT*w},_[h]}calculateFogTileMatrix(l){const h=l.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,l);return f.multiply(x,this.worldToFogMatrix,x),_[h]=new Float32Array(x),_[h]}calculateProjMatrix(l,h=!1){const _=l.key,x=h?this._alignedProjMatrixCache:this._projMatrixCache;if(x[_])return x[_];const w=this.calculatePosMatrix(l,this.worldSize);return f.multiply(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,w),x[_]=new Float32Array(w),x[_]}calculatePixelsToTileUnitsMatrix(l){const h=l.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const x=function(w,T){const{scale:S}=w.tileTransform,P=S*f.EXTENT/(w.tileSize*Math.pow(2,T.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return B=new Float32Array(4),X=(N=T.inverseAdjustmentMatrix)[1],J=N[2],te=N[3],re=(j=[P,P])[1],B[0]=N[0]*(ee=j[0]),B[1]=X*ee,B[2]=J*re,B[3]=te*re,B;var B,N,j,X,J,te,ee,re}(l,this);return _[h]=x,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const l=1/this.worldSize,h=f.fromScaling([],[l,l,l]);return f.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const l=this._elevation;this._updateCameraState();const h=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),x=this._camera.forward(),w=f.mercatorZfromAltitude(1,this._center.lat);_[2]/=w,x[2]/=w,f.normalize(x,x);const T=l.raycast(_,x,l.exaggeration());if(T){const S=f.scaleAndAdd([],_,x,T),P=new f.MercatorCoordinate(S[0],S[1],f.mercatorZfromAltitude(S[2],f.latFromMercatorY(S[1]))),B=(P.z+f.length([P.x-_[0],P.y-_[1],P.z-_[2]*w]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(B),this._centerAltitude=P.toAltitude(),this._center=this.coordinateLocation(P),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(l=!1){if(!this._elevation)return;const h=this._elevation,_=f.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(_),w=h.getAtPointOrZero(new f.MercatorCoordinate(...x)),T=this.pixelsPerMeter/this.worldSize*w,S=this._minimumHeightOverTerrain(),P=x[2]-T;if(P<=S)if(P<0||l){const B=this.locationCoordinate(this._center,this._centerAltitude),N=[x[0],x[1],B.z-x[2]],j=f.length(N);N[2]-=(S-P)/this._pixelsPerMercatorPixel;const X=f.length(N);if(0===X)return;f.scale$2(N,N,j/X*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],B.z*this._pixelsPerMercatorPixel-N[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const l="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||l){const X=this.center;return X.lat=f.clamp(X.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!l)&&(X.lng=f.clamp(X.lng,this.minLng,this.maxLng)),this.center=X,void(this._constraining=!1)}const h=this._unmodified,{x:_,y:x}=this.point;let w=0,T=_,S=x;const P=this.width/2,B=this.height/2,N=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(x-B<N&&(S=N+B),x+B>j&&(S=j-B),j-N<this.height&&(w=Math.max(w,this.height/(j-N)),S=(j+N)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const X=this.worldMinX*this.scale,J=this.worldMaxX*this.scale,te=this.worldSize/2-(X+J)/2;T=(_+te+this.worldSize)%this.worldSize-te,T-P<X&&(T=X+P),T+P>J&&(T=J-P),J-X<this.width&&(w=Math.max(w,this.width/(J-X)),T=(J+X)/2)}T===_&&S===x||(this.center=this.unproject(new f.Point(T,S))),w&&(this.zoom+=this.scaleZoom(w)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let l=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(l=Math.max(l,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),l}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const l=this.centerOffset,h=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=f.mercatorZfromAltitude(1,this.center.lat)/f.mercatorZfromAltitude(1,f.GLOBE_SCALE_MATCH_LATITUDE));const _=de(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x="meters"===this.projection.zAxisUnit?h:1,w=this._camera.getWorldToCamera(this.worldSize,x),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-l.x/this.width,T[9]=2*l.y/this.height;let S=f.mul([],T,w);if(this.projection.isReprojectedInTileSpace){const ve=this.locationCoordinate(this.center),ye=f.identity([]);f.translate(ye,ye,[ve.x*this.worldSize,ve.y*this.worldSize,0]),f.multiply(ye,ye,F(this)),f.translate(ye,ye,[-ve.x*this.worldSize,-ve.y*this.worldSize,0]),f.multiply(S,S,ye),this.inverseAdjustmentMatrix=function(Ce){const we=F(Ce,!0);return ct([],[we[0],we[1],we[4],we[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=f.scale([],S,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=S,this.invProjMatrix=f.invert(new Float64Array(16),this.projMatrix);const P=f.invert([],T);this.frustumCorners=f.FrustumCorners.fromInvProjectionMatrix(P,this.horizonLineFromTop(),this.height);const B=new Float32Array(16);f.identity(B),f.scale(B,B,[1,-1,1]),f.rotateX(B,B,this._pitch),f.rotateZ(B,B,this.angle);const N=f.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),j=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;N[8]=2*-l.x/this.width,N[9]=2*(l.y+j)/this.height,this.skyboxMatrix=f.multiply(B,N,B);const X=this.point,J=X.x,te=X.y,ee=this.width%2/2,re=this.height%2/2,$=Math.cos(this.angle),Y=Math.sin(this.angle),ae=J-Math.round(J)+$*ee+Y*re,oe=te-Math.round(te)+$*re+Y*ee,_e=new Float64Array(S);if(f.translate(_e,_e,[ae>.5?ae-1:ae,oe>.5?oe-1:oe,0]),this.alignedProjMatrix=_e,S=f.create(),f.scale(S,S,[this.width/2,-this.height/2,1]),f.translate(S,S,[1,-1,0]),this.labelPlaneMatrix=S,S=f.create(),f.scale(S,S,[1,-1,1]),f.translate(S,S,[-1,-1,0]),f.scale(S,S,[2/this.width,2/this.height,1]),this.glCoordMatrix=S,this.pixelMatrix=f.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},S=f.invert(new Float64Array(16),this.pixelMatrix),!S)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=S,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=f.calculateGlobeMatrix(this);const ve=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=f.transformMat4(ve,ve,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=S;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const l=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,w=[l,l,h];f.scale$2(w,w,x),f.scale$2(_,_,-1),f.multiply$2(_,_,w);const T=f.create();f.translate(T,T,_),f.scale(T,T,w),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(l,h,x)}_computeCameraPosition(l){const h=(l=l||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),x=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-l/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-_[0]*w,x.y/this.worldSize-_[1]*w,l/this.worldSize*this._centerAltitude-_[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(l){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],x=l[2];let w=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(w=Math.min((h-_)/x,1)),this._camera.position=f.scaleAndAdd([],this._camera.position,l,w),this._updateStateFromCamera()}_updateStateFromCamera(){const l=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:x}=this._camera.getPitchBearing(),w=f.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(f.degToRad(this._maxPitch)),S=Math.max((l[2]-w)/Math.cos(_),T),P=this._zoomFromMercatorZ(S);f.scaleAndAdd(l,l,h,S),this._pitch=f.clamp(_,f.degToRad(this.minPitch),f.degToRad(this.maxPitch)),this.angle=f.wrap(x,-Math.PI,Math.PI),this._setZoom(f.clamp(P,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new f.MercatorCoordinate(l[0],l[1],l[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(l){return Math.pow(2,l)*this.tileSize}_mercatorZfromZoom(l){return this.cameraToCenterDistance/this._worldSizeFromZoom(l)}_minimumHeightOverTerrain(){const l=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(l)}_zoomFromMercatorZ(l){return this.scaleZoom(this.cameraToCenterDistance/(l*this.tileSize))}zoomFromMercatorZAdjusted(l){let h=0,_=f.GLOBE_ZOOM_THRESHOLD_MAX,x=0,w=1/0;for(;_-h>1e-6&&_>h;){const T=h+.5*(_-h),S=this.tileSize*Math.pow(2,T),P=this.getCameraToCenterDistance(this.projection,T,S),B=this.scaleZoom(P/(l*this.tileSize)),N=Math.abs(T-B);N<w&&(w=N,x=T),T<B?h=T:_=T}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(f.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(l,h){const _=Math.min(l.x,h.x),x=Math.max(l.x,h.x),w=Math.min(l.y,h.y),T=Math.max(l.y,h.y);if(w<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const S=[new f.Point(_,w),new f.Point(x,T),new f.Point(_,T),new f.Point(x,w)],P=this.renderWorldCopies?-3:0,B=this.renderWorldCopies?4:1;for(const N of S){const j=this.pointRayIntersection(N);if(j.t<0)return!0;const X=this.rayIntersectionCoordinate(j);if(X.x<P||X.y<0||X.x>B||X.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+f.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new f.Point(0,0),new f.Point(this.width,this.height))}zoomDeltaToMovement(l,h){const _=f.length(f.sub([],this._camera.position,l)),x=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const l=function([h,_,x],w){const T=[h,_,x,1];f.transformMat4$1(T,T,w);const S=T[3]=Math.max(T[3],1e-6);return T[0]/=S,T[1]/=S,T[2]/=S,T}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new f.Point(l[0],l[1])}{const l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new f.Point(0,l))}}getCameraToCenterDistance(l,h=this.zoom,_=this.worldSize){const x=de(l,h,this.width,this.height,1024),w=l.pixelSpaceConversion(this.center.lat,_,x);return.5/Math.tan(.5*this._fov)*this.height*w}getWorldToCameraMatrix(){const l=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&f.multiply(l,l,this.globeMatrix),l}}function Ii(m,l){let h=!1,_=null;const x=()=>{_=null,h&&(m(),_=setTimeout(x,l),h=!1)};return()=>(h=!0,_||x(),_)}class Xa{constructor(l){this._hashName=l&&encodeURIComponent(l),f.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Ii(this._updateHashUnthrottled.bind(this),300)}addTo(l){return this._map=l,f.window.addEventListener("hashchange",this._onHashChange,!1),l.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),f.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const l=this._map;if(!l)return"";const h=Pl(l);if(this._hashName){const _=this._hashName;let x=!1;const w=f.window.location.hash.slice(1).split("&").map(T=>{const S=T.split("=")[0];return S===_?(x=!0,`${S}=${h}`):T}).filter(T=>T);return x||w.push(`${_}=${h}`),`#${w.join("&")}`}return`#${h}`}_getCurrentHash(){const l=f.window.location.hash.replace("#","");if(this._hashName){let h;return l.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return l.split("/")}_onHashChange(){const l=this._map;if(!l)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){const _=l.dragRotate.isEnabled()&&l.touchZoomRotate.isEnabled()?+(h[3]||0):l.getBearing();return l.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const l=f.window.location.href.replace(/(#.+)?$/,this.getHashString());f.window.history.replaceState(f.window.history.state,null,l)}}function Pl(m,l){const h=m.getCenter(),_=Math.round(100*m.getZoom())/100,x=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,x),T=Math.round(h.lng*w)/w,S=Math.round(h.lat*w)/w,P=m.getBearing(),B=m.getPitch();let N=l?`/${T}/${S}/${_}`:`${_}/${S}/${T}`;return(P||B)&&(N+="/"+Math.round(10*P)/10),B&&(N+=`/${Math.round(B)}`),N}const Mh={linearity:.3,easing:f.bezier(0,0,.3,1)},Vd=f.extend({deceleration:2500,maxSpeed:1400},Mh),Ud=f.extend({deceleration:20,maxSpeed:1400},Mh),vt=f.extend({deceleration:1e3,maxSpeed:360},Mh),fa=f.extend({deceleration:1e3,maxSpeed:90},Mh);class Om{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:f.exported.now(),settings:l})}_drainInertiaBuffer(){const l=this._inertiaBuffer,h=f.exported.now();for(;l.length>0&&h-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new f.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)h.zoom+=w.zoomDelta||0,h.bearing+=w.bearingDelta||0,h.pitch+=w.pitchDelta||0,w.panDelta&&h.pan._add(w.panDelta),w.around&&(h.around=w.around),w.pinchAround&&(h.pinchAround=w.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(h.pan.mag()){const w=Ih(h.pan.mag(),_,f.extend({},Vd,l||{}));x.offset=h.pan.mult(w.amount/h.pan.mag()),x.center=this._map.transform.center,Ah(x,w)}if(h.zoom){const w=Ih(h.zoom,_,Ud);x.zoom=this._map.transform.zoom+w.amount,Ah(x,w)}if(h.bearing){const w=Ih(h.bearing,_,vt);x.bearing=this._map.transform.bearing+f.clamp(w.amount,-179,179),Ah(x,w)}if(h.pitch){const w=Ih(h.pitch,_,fa);x.pitch=this._map.transform.pitch+w.amount,Ah(x,w)}if(x.zoom||x.bearing){const w=void 0===h.pinchAround?h.around:h.pinchAround;x.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function Ah(m,l){(!m.duration||m.duration<l.duration)&&(m.duration=l.duration,m.easing=l.easing)}function Ih(m,l,h){const{maxSpeed:_,linearity:x,deceleration:w}=h,T=f.clamp(m*x/(l/1e3),-_,_),S=Math.abs(T)/(w*x);return{easing:h.easing,duration:1e3*S,amount:T*(S/2)}}class vr extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_,x={}){const w=ur(h.getCanvasContainer(),_),T=h.unproject(w);super(l,f.extend({point:w,lngLat:T,originalEvent:_},x)),this._defaultPrevented=!1,this.target=h}}class qc extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){const x="touchend"===l?_.changedTouches:_.touches,w=As(h.getCanvasContainer(),x),T=w.map(P=>h.unproject(P)),S=w.reduce((P,B,N,j)=>P.add(B.div(j.length)),new f.Point(0,0));super(l,{points:w,point:S,lngLats:T,lngLat:h.unproject(S),originalEvent:_}),this._defaultPrevented=!1}}class jd extends f.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,h,_){super(l,{originalEvent:_}),this._defaultPrevented=!1}}class Wf{constructor(l,h){this._map=l,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(l){return this._firePreventable(new jd(l.type,this._map,l))}mousedown(l,h){return this._mousedownPos=h,this._firePreventable(new vr(l.type,this._map,l))}mouseup(l){this._map.fire(new vr(l.type,this._map,l))}preclick(l){const h=f.extend({},l);h.type="preclick",this._map.fire(new vr(h.type,this._map,h))}click(l,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(l),this._map.fire(new vr(l.type,this._map,l)))}dblclick(l){return this._firePreventable(new vr(l.type,this._map,l))}mouseover(l){this._map.fire(new vr(l.type,this._map,l))}mouseout(l){this._map.fire(new vr(l.type,this._map,l))}touchstart(l){return this._firePreventable(new qc(l.type,this._map,l))}touchmove(l){this._map.fire(new qc(l.type,this._map,l))}touchend(l){this._map.fire(new qc(l.type,this._map,l))}touchcancel(l){this._map.fire(new qc(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class $d{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(l){this._map.fire(new vr(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new vr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._map.fire(new vr(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class kl{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,h){this.isEnabled()&&l.shiftKey&&0===l.button&&(Ql(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(l,h){if(!this._active)return;const _=h,x=this._startPos,w=this._lastPos;if(!x||!w||w.equals(_)||!this._box&&_.dist(x)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=Wt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",l));const T=Math.min(x.x,_.x),S=Math.max(x.x,_.x),P=Math.min(x.y,_.y),B=Math.max(x.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${P}px)`,this._box.style.width=S-T+"px",this._box.style.height=B-P+"px")})}mouseupWindow(l,h){if(!this._active)return;const _=this._startPos,x=h;if(_&&0===l.button){if(this.reset(),Qr(),_.x!==x.x||_.y!==x.y)return this._map.fire(new f.Event("boxzoomend",{originalEvent:l})),{cameraAnimation:w=>w.fitScreenCoordinates(_,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",l)}}keydown(l){this._active&&27===l.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",l))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),_l(),delete this._startPos,delete this._lastPos}_fireEvent(l,h){return this._map.fire(new f.Event(l,{originalEvent:h}))}}function Ph(m,l){const h={};for(let _=0;_<m.length;_++)h[m[_].identifier]=l[_];return h}class Mr{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(l,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=l.timeStamp),_.length===this.numTouches&&(this.centroid=function(x){const w=new f.Point(0,0);for(const T of x)w._add(T);return w.div(x.length)}(h),this.touches=Ph(_,h)))}touchmove(l,h,_){if(this.aborted||!this.centroid)return;const x=Ph(_,h);for(const w in this.touches){const T=x[w];(!T||T.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(l,h,_){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class kh{constructor(l){this.singleTap=new Mr(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(l,h,_){this.singleTap.touchstart(l,h,_)}touchmove(l,h,_){this.singleTap.touchmove(l,h,_)}touchend(l,h,_){const x=this.singleTap.touchend(l,h,_);if(x){const w=l.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(x)<30;if(w&&T||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Fm{constructor(){this._zoomIn=new kh({numTouches:1,numTaps:2}),this._zoomOut=new kh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,h,_){this._zoomIn.touchstart(l,h,_),this._zoomOut.touchstart(l,h,_)}touchmove(l,h,_){this._zoomIn.touchmove(l,h,_),this._zoomOut.touchmove(l,h,_)}touchend(l,h,_){const x=this._zoomIn.touchend(l,h,_),w=this._zoomOut.touchend(l,h,_);return x?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(x)},{originalEvent:l})}):w?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(w)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Zf={0:1,2:2};class hc{constructor(l){this.reset(),this._clickTolerance=l.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(l,h){return!1}_move(l,h){return{}}mousedown(l,h){if(this._lastPoint)return;const _=ki(l);this._correctButton(l,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(l,h){const _=this._lastPoint;if(_)if(l.preventDefault(),null!=this._eventButton&&function(x,w){const T=Zf[w];return void 0===x.buttons||(x.buttons&T)!==T}(l,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}mouseupWindow(l){this._lastPoint&&ki(l)===this._eventButton&&(this._moved&&Qr(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Rh extends hc{mousedown(l,h){super.mousedown(l,h),this._lastPoint&&(this._active=!0)}_correctButton(l,h){return 0===h&&!l.ctrlKey}_move(l,h){return{around:h,panDelta:h.sub(l)}}}class Hd extends hc{_correctButton(l,h){return 0===h&&l.ctrlKey||2===h}_move(l,h){const _=.8*(h.x-l.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(l){l.preventDefault()}}class Lu extends hc{_correctButton(l,h){return 0===h&&l.ctrlKey||2===h}_move(l,h){const _=-.5*(h.y-l.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(l){l.preventDefault()}}class Oh{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),f.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new f.Point(0,0)}touchstart(l,h,_){return this._calculateTransform(l,h,_)}touchmove(l,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===_.length&&!f.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return l.cancelable&&l.preventDefault(),this._calculateTransform(l,h,_)}}touchend(l,h,_){this._calculateTransform(l,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,h,_){_.length>0&&(this._active=!0);const x=Ph(_,h),w=new f.Point(0,0),T=new f.Point(0,0);let S=0;for(const B in x){const N=x[B],j=this._touches[B];j&&(w._add(N),T._add(N.sub(j)),S++,x[B]=N)}if(this._touches=x,S<this._minTouches||!T.mag())return;const P=T.div(S);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(S),panDelta:P}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Wt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ao{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(l){}_move(l,h,_){return{}}touchstart(l,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(l,h,_){const x=this._firstTwoTouches;if(!x)return;l.preventDefault();const[w,T]=x,S=Wc(_,h,w),P=Wc(_,h,T);if(!S||!P)return;const B=this._aroundCenter?null:S.add(P).div(2);return this._move([S,P],B,l)}touchend(l,h,_){if(!this._firstTwoTouches)return;const[x,w]=this._firstTwoTouches,T=Wc(_,h,x),S=Wc(_,h,w);T&&S||(this._active&&Qr(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Wc(m,l,h){for(let _=0;_<m.length;_++)if(m[_].identifier===h)return l[_]}function Fh(m,l){return Math.log(m/l)/Math.LN2}class Ar extends ao{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,h){const _=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(Fh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Fh(this._distance,_),pinchAround:h}}}function Gd(m,l){return 180*m.angleWith(l)/Math.PI}class Nu extends ao{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,h){const _=this._vector;if(this._vector=l[0].sub(l[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Gd(this._vector,_),pinchAround:h}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());const h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const x=Gd(l,_);return Math.abs(x)<h}}function fr(m){return Math.abs(m.y)>Math.abs(m.x)}class Xf extends ao{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(l){this._lastPoints=l,fr(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,h,_){const x=this._lastPoints;if(!x)return;const w=l[0].sub(x[0]),T=l[1].sub(x[1]);return this._map._cooperativeGestures&&!f.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(w,T,_.timeStamp),!this._valid)?void 0:(this._lastPoints=l,this._active=!0,{pitchDelta:(w.y+T.y)/2*-.5})}gestureBeginsVertically(l,h,_){if(void 0!==this._valid)return this._valid;const x=l.mag()>=2,w=h.mag()>=2;if(!x&&!w)return;if(!x||!w)return null==this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const T=l.y>0==h.y>0;return fr(l)&&fr(h)&&T}}const qd={panStep:100,bearingStep:15,pitchStep:10};class Zc{constructor(){const l=qd;this._panStep=l.panStep,this._bearingStep=l.bearingStep,this._pitchStep=l.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let h=0,_=0,x=0,w=0,T=0;switch(l.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:l.shiftKey?_=-1:(l.preventDefault(),w=-1);break;case 39:l.shiftKey?_=1:(l.preventDefault(),w=1);break;case 38:l.shiftKey?x=1:(l.preventDefault(),T=-1);break;case 40:l.shiftKey?x=-1:(l.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(_=0,x=0),{cameraAnimation:S=>{const P=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:Ao,zoom:h?Math.round(P)+h*(l.shiftKey?2:1):P,bearing:S.getBearing()+_*this._bearingStep,pitch:S.getPitch()+x*this._pitchStep,offset:[-w*this._panStep,-T*this._panStep],center:S.getCenter()},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ao(m){return m*(2-m)}const Wd=4.000244140625;class Bu{constructor(l,h){this._map=l,this._el=l.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,f.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&"center"===l.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(l.ctrlKey||l.metaKey||this.isZooming()||f.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=l.deltaMode===f.window.WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY;const _=f.exported.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==h&&h%Wd==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(x*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),l.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=l,this._delta-=h,this._active||this._start(l)),l.preventDefault()}_onTimeout(l){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(l)}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ur(this._el,l);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const l=this._map.transform;"wheel"===this._type&&l.projection.wrap&&(l._center.lng>=180||l._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>l._terrainEnabled()&&this._aroundCoord?l.computeZoomRelativeTo(this._aroundCoord):l.zoom;if(0!==this._delta){const P="wheel"===this._type&&Math.abs(this._delta)>Wd?this._wheelZoomRate:this._defaultZoomRate;let B=2/(1+Math.exp(-Math.abs(this._delta*P)));this._delta<0&&0!==B&&(B=1/B);const N=h(),j=Math.pow(2,N),X="number"==typeof this._targetZoom?l.zoomScale(this._targetZoom):j;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(X*B))),"wheel"===this._type&&(this._startZoom=N,this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:h(),x=this._startZoom,w=this._easing;let T,S=!1;if("wheel"===this._type&&x&&w){const P=Math.min((f.exported.now()-this._lastWheelEventTime)/200,1),B=w(P);T=f.number(x,_,B),P<1?this._frameId||(this._frameId=!0):S=!0}else T=_,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!S,zoomDelta:T-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let h=f.ease;if(this._prevEase){const _=this._prevEase,x=(f.exported.now()-_.start)/_.duration,w=_.easing(x+.01)-_.easing(x),T=.27/Math.sqrt(w*w+1e-4)*.01,S=Math.sqrt(.0729-T*T);h=f.bezier(T,S,.25,1)}return this._prevEase={start:f.exported.now(),duration:l,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Wt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(f.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Kf{constructor(l,h){this._clickZoom=l,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Hi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(l,h){return l.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(l.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Yf{constructor(){this._tap=new kh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(l,h,_){this._swipePoint||(this._tapTime&&l.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(l,h,_))}touchmove(l,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const x=h[0],w=x.y-this._swipePoint.y;return this._swipePoint=x,l.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(l,h,_)}touchend(l,h,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(l,h,_)&&(this._tapTime=l.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lh{constructor(l,h,_){this._el=l,this._mousePan=h,this._touchPan=_}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class fn{constructor(l,h,_){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Jf{constructor(l,h,_,x){this._el=l,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hs=m=>m.zoom||m.drag||m.pitch||m.rotate;class Qf extends f.Event{}class Lm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(l,h){const _=f.sub([],h,l);this.radius=f.length(_[2]<0?f.div([],_,this.constants):[_[0],_[1],0])}projectRay(l){f.div(l,l,this.constants),f.normalize(l,l),f.mul$1(l,l,this.constants);const h=f.scale$2([],l,this.radius);if(h[2]>0){const _=f.scale$2([],[0,0,1],f.dot(h,[0,0,1])),x=f.scale$2([],f.normalize([],[h[0],h[1],0]),this.radius),w=f.add([],h,f.scale$2([],f.sub([],f.add([],x,_),h),2));h[0]=w[0],h[1]=w[1]}return h}}function Gs(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class qs{constructor(l,h){this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Om(l),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Lm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),f.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[f.window.document,"mousemove",{capture:!0}],[f.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[f.window,"blur",void 0]];for(const[x,w,T]of this._listeners)x.addEventListener(w,x===f.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[l,h,_]of this._listeners)l.removeEventListener(h,l===f.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(l){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new Wf(h,l));const x=h.boxZoom=new kl(h,l);this._add("boxZoom",x);const w=new Fm,T=new Hi;h.doubleClickZoom=new Kf(T,w),this._add("tapZoom",w),this._add("clickZoom",T);const S=new Yf;this._add("tapDragZoom",S);const P=h.touchPitch=new Xf(h);this._add("touchPitch",P);const B=new Hd(l),N=new Lu(l);h.dragRotate=new fn(l,B,N),this._add("mouseRotate",B,["mousePitch"]),this._add("mousePitch",N,["mouseRotate"]);const j=new Rh(l),X=new Oh(h,l);h.dragPan=new Lh(_,j,X),this._add("mousePan",j),this._add("touchPan",X,["touchZoom","touchRotate"]);const J=new Nu,te=new Ar;h.touchZoomRotate=new Jf(_,te,J,S),this._add("touchRotate",J,["touchPan","touchZoom"]),this._add("touchZoom",te,["touchPan","touchRotate"]),this._add("blockableMapEvent",new $d(h));const ee=h.scrollZoom=new Bu(h,this);this._add("scrollZoom",ee,["mousePan"]);const re=h.keyboard=new Zc;this._add("keyboard",re);for(const $ of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])l.interactive&&l[$]&&h[$].enable(l[$])}_add(l,h,_){this._handlers.push({handlerName:l,handler:h,allowed:_}),this._handlersById[l]=h}stop(l){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(const{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(l,h,_){for(const x in l)if(x!==_&&(!h||h.indexOf(x)<0))return!0;return!1}handleWindowEvent(l){this.handleEvent(l,`${l.type}Window`)}_getMapTouches(l){const h=[];for(const _ of l)this._el.contains(_.target)&&h.push(_);return h}handleEvent(l,h){this._updatingCamera=!0;const _="renderFrame"===l.type,x=_?void 0:l,w={needsRenderFrame:!1},T={},S={},P=l.touches?this._getMapTouches(l.touches):void 0,B=P?As(this._el,P):_?void 0:ur(this._el,l);for(const{handlerName:X,handler:J,allowed:te}of this._handlers){if(!J.isEnabled())continue;let ee;this._blockedByActive(S,te,X)?J.reset():J[h||l.type]&&(ee=J[h||l.type](l,B,P),this.mergeHandlerResult(w,T,ee,X,x),ee&&ee.needsRenderFrame&&this._triggerRenderFrame()),(ee||J.isActive())&&(S[X]=J)}const N={};for(const X in this._previousActiveHandlers)S[X]||(N[X]=x);this._previousActiveHandlers=S,(Object.keys(N).length||Gs(w))&&(this._changes.push([w,T,N]),this._triggerRenderFrame()),(Object.keys(S).length||Gs(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=w;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(l,h,_,x,w){if(!_)return;f.extend(l,_);const T={handlerName:x,originalEvent:_.originalEvent||w};void 0!==_.zoomDelta&&(h.zoom=T),void 0!==_.panDelta&&(h.drag=T),void 0!==_.pitchDelta&&(h.pitch=T),void 0!==_.bearingDelta&&(h.rotate=T)}_applyChanges(){const l={},h={},_={};for(const[x,w,T]of this._changes)x.panDelta&&(l.panDelta=(l.panDelta||new f.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(l.around=x.around),void 0!==x.aroundCoord&&(l.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(l.pinchAround=x.pinchAround),x.noInertia&&(l.noInertia=x.noInertia),f.extend(h,w),f.extend(_,T);this._updateMapTransform(l,h,_),this._changes=[]}_updateMapTransform(l,h,_){const x=this._map,w=x.transform,T=Y=>[Y.x,Y.y,Y.z];if((Y=>{const ae=this._eventsInProgress.drag;return ae&&!this._handlersById[ae.handlerName].isActive()})()&&!Gs(l)){const Y=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",Y!==w.zoom&&this._map._update(!0)}if(w._isCameraConstrained&&x._stop(!0),!Gs(l))return void this._fireEvents(h,_,!0);let{panDelta:S,zoomDelta:P,bearingDelta:B,pitchDelta:N,around:j,aroundCoord:X,pinchAround:J}=l;w._isCameraConstrained&&(P>0&&(P=0),w._isCameraConstrained=!1),void 0!==J&&(j=J),(P||(Y=>h[Y]&&!this._eventsInProgress[Y])("drag"))&&j&&(this._dragOrigin=T(w.pointCoordinate3D(j)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",x._stop(!0),j=j||x.transform.centerPoint,B&&(w.bearing+=B),N&&(w.pitch+=N),w._updateCameraState();const te=[0,0,0];if(S)if("mercator"===w.projection.name){const Y=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(j).dir),ae=this._trackingEllipsoid.projectRay(w.screenPointToMercatorRay(j.sub(S)).dir);te[0]=ae[0]-Y[0],te[1]=ae[1]-Y[1]}else{const Y=w.pointCoordinate(j);if("globe"===w.projection.name){S=S.rotate(-w.angle);const ae=w._pixelsPerMercatorPixel/w.worldSize;te[0]=-S.x*f.mercatorScale(f.latFromMercatorY(Y.y))*ae,te[1]=-S.y*f.mercatorScale(w.center.lat)*ae}else{const ae=w.pointCoordinate(j.sub(S));Y&&ae&&(te[0]=ae.x-Y.x,te[1]=ae.y-Y.y)}}const ee=w.zoom,re=[0,0,0];if(P){const Y=T(X||w.pointCoordinate3D(j)),ae={dir:f.normalize([],f.sub([],Y,w._camera.position))};if(ae.dir[2]<0){const oe=w.zoomDeltaToMovement(Y,P);f.scale$2(re,ae.dir,oe)}}const $=f.add(te,te,re);w._translateCameraConstrained($),P&&Math.abs(w.zoom-ee)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(h,_,!0)}_fireEvents(l,h,_){const x=Hs(this._eventsInProgress),w=Hs(l),T={};for(const N in l){const{originalEvent:j}=l[N];this._eventsInProgress[N]||(T[`${N}start`]=j),this._eventsInProgress[N]=l[N]}!x&&w&&this._fireEvent("movestart",w.originalEvent);for(const N in T)this._fireEvent(N,T[N]);w&&this._fireEvent("move",w.originalEvent);for(const N in l){const{originalEvent:j}=l[N];this._fireEvent(N,j)}const S={};let P;for(const N in this._eventsInProgress){const{handlerName:j,originalEvent:X}=this._eventsInProgress[N];this._handlersById[j].isActive()||(delete this._eventsInProgress[N],P=h[j]||X,S[`${N}end`]=P)}for(const N in S)this._fireEvent(N,S[N]);const B=Hs(this._eventsInProgress);if(_&&(x||w)&&!B){this._updatingCamera=!0;const N=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=X=>0!==X&&-this._bearingSnap<X&&X<this._bearingSnap;N?(j(N.bearing||this._map.getBearing())&&(N.bearing=0),this._map.easeTo(N,{originalEvent:P})):(this._map.fire(new f.Event("moveend",{originalEvent:P})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(l,h){this._map.fire(new f.Event(l,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{this._frameId=void 0,this.handleEvent(new Qf("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const dc="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Nh extends f.Evented{constructor(l,h){super(),this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=!1!==h.respectPrefersReducedMotion,f.bindAll(["_renderFrameCallback"],this)}getCenter(){return new f.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(l,h){return this.jumpTo({center:l},h)}panBy(l,h,_){return l=f.Point.convert(l).mult(-1),this.panTo(this.transform.center,f.extend({offset:l},h),_)}panTo(l,h,_){return this.easeTo(f.extend({center:l},h),_)}getZoom(){return this.transform.zoom}setZoom(l,h){return this.jumpTo({zoom:l},h),this}zoomTo(l,h,_){return this.easeTo(f.extend({zoom:l},h),_)}zoomIn(l,h){return this.zoomTo(this.getZoom()+1,l,h),this}zoomOut(l,h){return this.zoomTo(this.getZoom()-1,l,h),this}getBearing(){return this.transform.bearing}setBearing(l,h){return this.jumpTo({bearing:l},h),this}getPadding(){return this.transform.padding}setPadding(l,h){return this.jumpTo({padding:l},h),this}rotateTo(l,h,_){return this.easeTo(f.extend({bearing:l},h),_)}resetNorth(l,h){return this.rotateTo(0,f.extend({duration:1e3},l),h),this}resetNorthPitch(l,h){return this.easeTo(f.extend({bearing:0,pitch:0,duration:1e3},l),h),this}snapToNorth(l,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,h):this}getPitch(){return this.transform.pitch}setPitch(l,h){return this.jumpTo({pitch:l},h),this}cameraForBounds(l,h){l=f.LngLatBounds.convert(l);const _=h&&h.bearing||0,x=h&&h.pitch||0,w=l.getNorthWest(),T=l.getSouthEast();return this._cameraForBounds(this.transform,w,T,_,x,h)}_extendCameraOptions(l){const h={top:0,bottom:0,right:0,left:0};if("number"==typeof(l=f.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},l)).padding){const _=l.padding;l.padding={top:_,bottom:_,right:_,left:_}}return l.padding=f.extend(h,l.padding),l}_minimumAABBFrustumDistance(l,h){const _=h.max[0]-h.min[0],x=h.max[1]-h.min[1];return _/x>l.aspect?_/(2*Math.tan(.5*l.fovX)*l.aspect):x/(2*Math.tan(.5*l.fovY)*l.aspect)}_cameraForBoundsOnGlobe(l,h,_,x,w,T){const S=l.clone(),P=this._extendCameraOptions(T);S.bearing=x,S.pitch=w;const B=f.LngLat.convert(h),N=f.LngLat.convert(_),j=.5*(B.lat+N.lat),X=.5*(B.lng+N.lng),J=f.latLngToECEF(j,X),te=f.normalize([],J),ee=f.normalize([],f.cross([],te,[0,1,0])),re=f.cross([],ee,te),$=[ee[0],ee[1],ee[2],0,re[0],re[1],re[2],0,te[0],te[1],te[2],0,0,0,0,1],Y=[J,f.latLngToECEF(B.lat,B.lng),f.latLngToECEF(N.lat,B.lng),f.latLngToECEF(N.lat,N.lng),f.latLngToECEF(B.lat,N.lng),f.latLngToECEF(j,B.lng),f.latLngToECEF(j,N.lng),f.latLngToECEF(B.lat,X),f.latLngToECEF(N.lat,X)];let ae=f.Aabb.fromPoints(Y.map(Je=>[f.dot(ee,Je),f.dot(re,Je),f.dot(te,Je)]));const oe=f.transformMat4([],ae.center,$);0===f.squaredLength(oe)&&f.set(oe,0,0,1),f.normalize(oe,oe),f.scale$2(oe,oe,f.GLOBE_RADIUS),S.center=f.ecefToLatLng(oe);const _e=S.getWorldToCameraMatrix(),ve=f.invert(new Float64Array(16),_e);ae=f.Aabb.applyTransform(ae,f.multiply([],_e,$)),f.transformMat4(oe,oe,_e);const ye=.5*(ae.max[2]-ae.min[2]),Ce=this._minimumAABBFrustumDistance(S,ae),we=f.scale$2([],[0,0,1],ye),ke=f.add(we,oe,we),tt=Ce+(0===S.pitch?0:f.distance(oe,ke)),Ie=S.globeCenterInViewSpace,qe=f.sub([],oe,[Ie[0],Ie[1],Ie[2]]);f.normalize(qe,qe),f.scale$2(qe,qe,tt);const Fe=f.add([],oe,qe);f.transformMat4(Fe,Fe,ve);const nt=f.earthRadius/f.GLOBE_RADIUS,Pe=f.length(Fe),He=f.mercatorZfromAltitude(Math.max(Pe*nt-f.earthRadius,Number.EPSILON),0),it=Math.min(S.zoomFromMercatorZAdjusted(He),P.maxZoom);return it>.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(S.setProjection({name:"mercator"}),S.zoom=it,this._cameraForBounds(S,h,_,x,w,T)):{center:S.center,zoom:it,bearing:x,pitch:w}}queryTerrainElevation(l,h){const _=this.transform.elevation;return _?(h=f.extend({},{exaggerated:!0},h),_.getAtPoint(f.MercatorCoordinate.fromLngLat(l),null,h.exaggerated)):null}_cameraForBounds(l,h,_,x,w,T){if("globe"===l.projection.name)return this._cameraForBoundsOnGlobe(l,h,_,x,w,T);const S=l.clone(),P=this._extendCameraOptions(T),B=S.padding;S.bearing=x,S.pitch=w;const N=f.LngLat.convert(h),j=f.LngLat.convert(_),X=new f.LngLat(N.lng,j.lat),J=new f.LngLat(j.lng,N.lat),te=S.project(N),ee=S.project(j),re=this.queryTerrainElevation(N),$=this.queryTerrainElevation(j),Y=this.queryTerrainElevation(X),ae=this.queryTerrainElevation(J),oe=[[te.x,te.y,Math.min(re||0,$||0,Y||0,ae||0)],[ee.x,ee.y,Math.max(re||0,$||0,Y||0,ae||0)]];let _e=f.Aabb.fromPoints(oe);const ve=S.getWorldToCameraMatrix(),ye=f.invert(new Float64Array(16),ve);_e=f.Aabb.applyTransform(_e,ve);const Ce=f.sub([],_e.max,_e.min),we=B.left||0,ke=B.right||0,tt=B.bottom||0,Ie=B.top||0,{left:qe,right:Fe,top:nt,bottom:Pe}=P.padding,He=.5*(we+ke),it=.5*(Ie+tt),Je=Math.min(S.scaleZoom(S.scale*Math.min((S.width-(we+ke+qe+Fe))/Ce[0],(S.height-(tt+Ie+Pe+nt))/Ce[1])),P.maxZoom),at=S.scale/S.zoomScale(Je);_e=new f.Aabb([_e.min[0]-(qe+He)*at,_e.min[1]-(Pe+it)*at,_e.min[2]],[_e.max[0]+(Fe+He)*at,_e.max[1]+(nt+it)*at,_e.max[2]]);const St=.5*Ce[2],Gt=this._minimumAABBFrustumDistance(S,_e),wt=[0,0,1,0];f.transformMat4$1(wt,wt,ve),f.normalize$2(wt,wt);const kt=f.scale$2([],wt,Gt+St),vn=f.add([],_e.center,kt),gn=("number"==typeof P.offset.x&&"number"==typeof P.offset.y?new f.Point(P.offset.x,P.offset.y):f.Point.convert(P.offset)).rotate(-f.degToRad(x));_e.center[0]-=gn.x*at,_e.center[1]+=gn.y*at,f.transformMat4(_e.center,_e.center,ye),f.transformMat4(vn,vn,ye);const Ct=[_e.center[0],_e.center[1],vn[2]*S.pixelsPerMeter];f.scale$2(Ct,Ct,1/S.worldSize);const Gn=f.lngFromMercatorX(Ct[0]),ii=f.latFromMercatorY(Ct[1]),qn=Math.min(S._zoomFromMercatorZ(Ct[2]),P.maxZoom),ri=new f.LngLat(Gn,ii);return S.mercatorFromTransition&&qn<.5*(f.GLOBE_ZOOM_THRESHOLD_MIN+f.GLOBE_ZOOM_THRESHOLD_MAX)?(S.setProjection({name:"globe"}),S.zoom=qn,this._cameraForBounds(S,h,_,x,w,T)):{center:ri,zoom:qn,bearing:x,pitch:w}}fitBounds(l,h,_){const x=this.cameraForBounds(l,h);return this._fitInternal(x,h,_)}fitScreenCoordinates(l,h,_,x,w){const T=f.Point.convert(l),S=f.Point.convert(h),P=new f.Point(Math.min(T.x,S.x),Math.min(T.y,S.y)),B=new f.Point(Math.max(T.x,S.x),Math.max(T.y,S.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(T,S))return this;const N=this.transform.pointLocation3D(P),j=this.transform.pointLocation3D(B),X=this.transform.pointLocation3D(new f.Point(P.x,B.y)),J=this.transform.pointLocation3D(new f.Point(B.x,P.y)),te=[Math.min(N.lng,j.lng,X.lng,J.lng),Math.min(N.lat,j.lat,X.lat,J.lat)],ee=[Math.max(N.lng,j.lng,X.lng,J.lng),Math.max(N.lat,j.lat,X.lat,J.lat)],re=x&&x.pitch?x.pitch:this.getPitch(),$=this._cameraForBounds(this.transform,te,ee,_,re,x);return this._fitInternal($,x,w)}_fitInternal(l,h,_){return l?(delete(h=f.extend(l,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(l,h){this.stop();const _=l.preloadOnly?this.transform.clone():this.transform;let x=!1,w=!1,T=!1;return"zoom"in l&&_.zoom!==+l.zoom&&(x=!0,_.zoom=+l.zoom),void 0!==l.center&&(_.center=f.LngLat.convert(l.center)),"bearing"in l&&_.bearing!==+l.bearing&&(w=!0,_.bearing=+l.bearing),"pitch"in l&&_.pitch!==+l.pitch&&(T=!0,_.pitch=+l.pitch),null==l.padding||_.isPaddingEqual(l.padding)||(_.padding=l.padding),l.preloadOnly?(this._preloadTiles(_),this):(this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),x&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),w&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),T&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||f.warnOnce(dc),this.transform.getFreeCameraOptions()}setFreeCameraOptions(l,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return f.warnOnce(dc),this;this.stop();const x=_.zoom,w=_.pitch,T=_.bearing;_.setFreeCameraOptions(l);const S=x!==_.zoom,P=w!==_.pitch,B=T!==_.bearing;return this.fire(new f.Event("movestart",h)).fire(new f.Event("move",h)),S&&this.fire(new f.Event("zoomstart",h)).fire(new f.Event("zoom",h)).fire(new f.Event("zoomend",h)),B&&this.fire(new f.Event("rotatestart",h)).fire(new f.Event("rotate",h)).fire(new f.Event("rotateend",h)),P&&this.fire(new f.Event("pitchstart",h)).fire(new f.Event("pitch",h)).fire(new f.Event("pitchend",h)),this.fire(new f.Event("moveend",h)),this}easeTo(l,h){this._stop(!1,l.easeId),(!1===(l=f.extend({offset:[0,0],duration:500,easing:f.ease},l)).animate||this._prefersReducedMotion(l))&&(l.duration=0);const _=this.transform,x=this.getZoom(),w=this.getBearing(),T=this.getPitch(),S=this.getPadding(),P="zoom"in l?+l.zoom:x,B="bearing"in l?this._normalizeBearing(l.bearing,w):w,N="pitch"in l?+l.pitch:T,j="padding"in l?l.padding:_.padding,X=f.Point.convert(l.offset);let J,te,ee;if("globe"===_.projection.name){const we=f.MercatorCoordinate.fromLngLat(_.center),ke=X.rotate(-_.angle);we.x+=ke.x/_.worldSize,we.y+=ke.y/_.worldSize;const tt=we.toLngLat(),Ie=f.LngLat.convert(l.center||tt);this._normalizeCenter(Ie),J=_.centerPoint.add(ke),te=new f.Point(we.x,we.y).mult(_.worldSize),ee=new f.Point(f.mercatorXfromLng(Ie.lng),f.mercatorYfromLat(Ie.lat)).mult(_.worldSize).sub(te)}else{J=_.centerPoint.add(X);const we=_.pointLocation(J),ke=f.LngLat.convert(l.center||we);this._normalizeCenter(ke),te=_.project(we),ee=_.project(ke).sub(te)}const re=_.zoomScale(P-x);let $,Y;l.around&&($=f.LngLat.convert(l.around),Y=_.locationPoint($));const ae=this._zooming||P!==x,oe=this._rotating||w!==B,_e=this._pitching||N!==T,ve=!_.isPaddingEqual(j),ye=we=>ke=>{if(ae&&(we.zoom=f.number(x,P,ke)),oe&&(we.bearing=f.number(w,B,ke)),_e&&(we.pitch=f.number(T,N,ke)),ve&&(we.interpolatePadding(S,j,ke),J=we.centerPoint.add(X)),$)we.setLocationAtPoint($,Y);else{const tt=we.zoomScale(we.zoom-x),Ie=P>x?Math.min(2,re):Math.max(.5,re),qe=Math.pow(Ie,1-ke),Fe=we.unproject(te.add(ee.mult(ke*qe)).mult(tt));we.setLocationAtPoint(we.renderWorldCopies?Fe.wrap():Fe,J)}return l.preloadOnly||this._fireMoveEvents(h),we};if(l.preloadOnly){const we=this._emulate(ye,l.duration,_);return this._preloadTiles(we),this}const Ce={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ae,this._rotating=oe,this._pitching=_e,this._padding=ve,this._easeId=l.easeId,this._prepareEase(h,l.noMoveStart,Ce),this._ease(ye(_),we=>{_.recenterOnTerrain(),this._afterEase(h,we)},l),this}_prepareEase(l,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new f.Event("movestart",l)),this._zooming&&!_.zooming&&this.fire(new f.Event("zoomstart",l)),this._rotating&&!_.rotating&&this.fire(new f.Event("rotatestart",l)),this._pitching&&!_.pitching&&this.fire(new f.Event("pitchstart",l))}_fireMoveEvents(l){this.fire(new f.Event("move",l)),this._zooming&&this.fire(new f.Event("zoom",l)),this._rotating&&this.fire(new f.Event("rotate",l)),this._pitching&&this.fire(new f.Event("pitch",l))}_afterEase(l,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,x=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new f.Event("zoomend",l)),x&&this.fire(new f.Event("rotateend",l)),w&&this.fire(new f.Event("pitchend",l)),this.fire(new f.Event("moveend",l))}flyTo(l,h){if(this._prefersReducedMotion(l)){const Je=f.pick(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Je,h)}this.stop(),l=f.extend({offset:[0,0],speed:1.2,curve:1.42,easing:f.ease},l);const _=this.transform,x=this.getZoom(),w=this.getBearing(),T=this.getPitch(),S=this.getPadding(),P="zoom"in l?f.clamp(+l.zoom,_.minZoom,_.maxZoom):x,B="bearing"in l?this._normalizeBearing(l.bearing,w):w,N="pitch"in l?+l.pitch:T,j="padding"in l?l.padding:_.padding,X=_.zoomScale(P-x),J=f.Point.convert(l.offset);let te=_.centerPoint.add(J);const ee=_.pointLocation(te),re=f.LngLat.convert(l.center||ee);this._normalizeCenter(re);const $=_.project(ee),Y=_.project(re).sub($);let ae=l.curve;const oe=Math.max(_.width,_.height),_e=oe/X,ve=Y.mag();if("minZoom"in l){const Je=f.clamp(Math.min(l.minZoom,x,P),_.minZoom,_.maxZoom),at=oe/_.zoomScale(Je-x);ae=Math.sqrt(at/ve*2)}const ye=ae*ae;function Ce(Je){const at=(_e*_e-oe*oe+(Je?-1:1)*ye*ye*ve*ve)/(2*(Je?_e:oe)*ye*ve);return Math.log(Math.sqrt(at*at+1)-at)}function we(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function ke(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const tt=Ce(0);let Ie=function(Je){return ke(tt)/ke(tt+ae*Je)},qe=function(Je){return oe*((ke(tt)*(we(at=tt+ae*Je)/ke(at))-we(tt))/ye)/ve;var at},Fe=(Ce(1)-tt)/ae;if(Math.abs(ve)<1e-6||!isFinite(Fe)){if(Math.abs(oe-_e)<1e-6)return this.easeTo(l,h);const Je=_e<oe?-1:1;Fe=Math.abs(Math.log(_e/oe))/ae,qe=function(){return 0},Ie=function(at){return Math.exp(Je*ae*at)}}l.duration="duration"in l?+l.duration:1e3*Fe/("screenSpeed"in l?+l.screenSpeed/ae:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0);const nt=w!==B,Pe=N!==T,He=!_.isPaddingEqual(j),it=Je=>at=>{const St=at*Fe,Gt=1/Ie(St);Je.zoom=1===at?P:x+Je.scaleZoom(Gt),nt&&(Je.bearing=f.number(w,B,at)),Pe&&(Je.pitch=f.number(T,N,at)),He&&(Je.interpolatePadding(S,j,at),te=Je.centerPoint.add(J));const wt=1===at?re:Je.unproject($.add(Y.mult(qe(St))).mult(Gt));return Je.setLocationAtPoint(Je.renderWorldCopies?wt.wrap():wt,te),Je._updateCameraOnTerrain(),l.preloadOnly||this._fireMoveEvents(h),Je};if(l.preloadOnly){const Je=this._emulate(it,l.duration,_);return this._preloadTiles(Je),this}return this._zooming=!0,this._rotating=nt,this._pitching=Pe,this._padding=He,this._prepareEase(h,!1),this._ease(it(_),()=>this._afterEase(h),l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!l){const _=this.handlers;_&&_.stop(!1)}return this}_ease(l,h,_){!1===_.animate||0===_.duration?(l(1),h()):(this._easeStart=f.exported.now(),this._easeOptions=_,this._onEaseFrame=l,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const l=Math.min((f.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(l)),l<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(l,h){l=f.wrap(l,-180,180);const _=Math.abs(l-h);return Math.abs(l-360-h)<_&&(l-=360),Math.abs(l+360-h)<_&&(l+=360),l}_normalizeCenter(l){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const _=l.lng-h.center.lng;l.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(l){return this._respectPrefersReducedMotion&&f.exported.prefersReducedMotion&&!(l&&l.essential)}_emulate(l,h,_){const x=Math.ceil(15*h/1e3),w=[],T=l(_.clone());for(let S=0;S<=x;S++){const P=T(S/x);w.push(P.clone())}return w}}class De{constructor(l={}){this.options=l,f.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(l){const h=this.options&&this.options.compact;return this._map=l,this._container=Wt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Wt("button","mapboxgl-ctrl-attrib-button",this._container),Wt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Wt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(l,h){const _=this._map._getUIString(`AttributionControl.${h}`);l.setAttribute("aria-label",_),l.removeAttribute("title"),l.firstElementChild&&l.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let l=this._editLink;l||(l=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||f.config.ACCESS_TOKEN}];if(l){const _=h.reduce((x,w,T)=>(w.value&&(x+=`${w.key}=${w.value}${T<h.length-1?"&":""}`),x),"?");l.href=`${f.config.FEEDBACK_URL}/${_}#${Pl(this._map,!0)}`,l.rel="noopener nofollow",this._setElementTitle(l,"MapFeedback")}}_updateData(l){!l||"metadata"!==l.sourceDataType&&"visibility"!==l.sourceDataType&&"style"!==l.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let l=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const h=this._map.style._sourceCaches;for(const x in h){const w=h[x];if(w.used){const T=w.getSource();T.attribution&&l.indexOf(T.attribution)<0&&l.push(T.attribution)}}l.sort((x,w)=>x.length-w.length),l=l.filter((x,w)=>{for(let T=w+1;T<l.length;T++)if(l[T].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=[...this.options.customAttribution,...l]:l.unshift(this.options.customAttribution));const _=l.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,l.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Rn{constructor(){f.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(l){this._map=l,this._container=Wt("div","mapboxgl-ctrl");const h=Wt("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(l){l&&"metadata"!==l.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const l=this._map.style._sourceCaches;if(0===Object.entries(l).length)return!0;for(const h in l){const _=l[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const l=this._container.children;if(l.length){const h=l[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Zd{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){const h=++this._id;return this._queue.push({callback:l,id:h,cancelled:!1}),h}remove(l){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const x of _)if(x.id===l)return void(x.cancelled=!0)}run(l=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Xc(m,l,h){if(m=new f.LngLat(m.lng,m.lat),l){const _=new f.LngLat(m.lng-360,m.lat),x=new f.LngLat(m.lng+360,m.lat),w=360*Math.ceil(Math.abs(m.lng-h.center.lng)/360),T=h.locationPoint(m).distSqr(l),S=l.x<0||l.y<0||l.x>h.width||l.y>h.height;h.locationPoint(_).distSqr(l)<T&&(S||Math.abs(_.lng-h.center.lng)<w)?m=_:h.locationPoint(x).distSqr(l)<T&&(S||Math.abs(x.lng-h.center.lng)<w)&&(m=x)}for(;Math.abs(m.lng-h.center.lng)>180;){const _=h.locationPoint(m);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;m.lng>h.center.lng?m.lng-=360:m.lng+=360}return m}const Gi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class yt extends f.Evented{constructor(l,h){if(super(),(l instanceof f.window.HTMLElement||h)&&(l=f.extend({element:l},h)),f.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=l&&l.occludedOpacity||.2,l&&l.element)this._element=l.element,this._offset=f.Point.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=Wt("div");const x=41,w=27,T=zi("svg",{display:"block",height:x*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${x}`},this._element),S=zi("radialGradient",{id:"shadowGradient"},zi("defs",{},T));zi("stop",{offset:"10%","stop-opacity":.4},S),zi("stop",{offset:"100%","stop-opacity":.05},S),zi("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),zi("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),zi("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),zi("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=f.Point.convert(l&&l.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const _=this._element.classList;for(const x in Gi)_.remove(`mapboxgl-marker-anchor-${x}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(l){return l===this._map||(this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._updateMoving),l.on("moveend",this._update),l.on("remove",this._clearFadeTimer),l._addMarker(this),this.setDraggable(this._draggable),this._update(),l.on("click",this._onMapClick)),this}remove(){const l=this._map;return l&&(l.off("click",this._onMapClick),l.off("move",this._updateMoving),l.off("moveend",this._update),l.off("mousedown",this._addDragHandler),l.off("touchstart",this._addDragHandler),l.off("mouseup",this._onUp),l.off("touchend",this._onUp),l.off("mousemove",this._onMove),l.off("touchmove",this._onMove),l.off("remove",this._clearFadeTimer),l._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=f.LngLat.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=l,l._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(l){const h=l.code,_=l.charCode||l.keyCode;"Space"!==h&&"Enter"!==h&&32!==_&&13!==_||this.togglePopup()}_onMapClick(l){const h=l.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const l=this._popup;return l?(l.isOpen()?(l.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(l.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const l=this._map,h=this._pos;if(!l||!h)return!1;const _=l.unproject(h),x=l.getFreeCameraOptions();if(!x.position)return!1;const w=x.position.toLngLat();return w.distanceTo(_)<.9*w.distanceTo(this._lngLat)}_evaluateOpacity(){const l=this._map;if(!l)return;const h=this._pos;if(!h||h.x<0||h.x>l.transform.width||h.y<0||h.y>l.transform.height)return void this._clearFadeTimer();const _=l.unproject(h);let x;l._showingGlobe()&&f.isLngLatBehindGlobe(l.transform,this._lngLat)?x=0:(x=1-l._queryFogOpacity(_),l.transform._terrainEnabled()&&l.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const l=this._pos;if(!l||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${l.x}px,${l.y}px)\n            ${Gi[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${h.x}px,${h.y}px)\n        `}_calculateXYTransform(){const l=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!l||"map"!==_)return"";if(!h._showingGlobe()){const P=h.getPitch();return P?`rotateX(${P}deg)`:""}const x=f.radToDeg(f.globeTiltAtLngLat(h.transform,this._lngLat)),w=l.sub(f.globeCenterToScreenPoint(h.transform)),T=Math.abs(w.x)+Math.abs(w.y);if(0===T)return"";const S=x/T;return`rotateX(${-w.y*S}deg) rotateY(${w.x*S}deg)`}_calculateZTransform(){const l=this._pos,h=this._map;if(!h||!l)return"";let _=0;const x=this.getRotationAlignment();if("map"===x)if(h._showingGlobe()){const w=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),T=h.project(new f.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(w);_=f.radToDeg(Math.atan2(T.y,T.x))-90}else _=-h.getBearing();else if("horizon"===x){const w=f.smoothstep(4,6,h.getZoom()),T=f.globeCenterToScreenPoint(h.transform);T.y+=w*h.transform.height;const S=l.sub(T),P=f.radToDeg(Math.atan2(S.y,S.x));_=(P>90?P-270:P+90)*(1-w)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(l){f.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Xc(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),!0===l?this._updateFrameId=f.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(l){return this._offset=f.Point.convert(l),this._update(),this}_onMove(l){const h=this._map;if(!h)return;const _=this._pointerdownPos,x=this._positionDelta;if(_&&x){if(!this._isDragging){const w=this._clickTolerance||h._clickTolerance;if(l.point.dist(_)<w)return;this._isDragging=!0}this._pos=l.point.sub(x),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new f.Event("dragstart"))),this.fire(new f.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const l=this._map;l&&(l.off("mousemove",this._onMove),l.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new f.Event("dragend")),this._state="inactive"}_addDragHandler(l){const h=this._map,_=this._pos;h&&_&&this._element.contains(l.originalEvent.target)&&(l.preventDefault(),this._positionDelta=l.point.sub(_),this._pointerdownPos=l.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(l){this._draggable=!!l;const h=this._map;return h&&(l?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(l){return this._occludedOpacity=l||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const fc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},pa=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bh(m=new f.Point(0,0),l="bottom"){if("number"==typeof m){const h=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(l){case"top":return new f.Point(0,m);case"top-left":return new f.Point(h,h);case"top-right":return new f.Point(-h,h);case"bottom":return new f.Point(0,-m);case"bottom-left":return new f.Point(h,-h);case"bottom-right":return new f.Point(-h,-h);case"left":return new f.Point(m,0);case"right":return new f.Point(-m,0)}return new f.Point(0,0)}return m instanceof f.Point||Array.isArray(m)?f.Point.convert(m):f.Point.convert(m[l]||[0,0])}class zu{constructor(l){this.jumpTo(l)}getValue(l){if(l<=this._startTime)return this._start;if(l>=this._endTime)return this._end;const h=f.easeCubicInOut((l-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(l){return l>=this._startTime&&l<=this._endTime}jumpTo(l){this._startTime=-1/0,this._endTime=-1/0,this._start=l,this._end=l}easeTo(l,h,_){this._start=this.getValue(h),this._end=l,this._startTime=h,this._endTime=h+_}}const ep={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Nm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},tp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Io{constructor(l,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Hd({clickTolerance:l.dragRotate._mouseRotate._clickTolerance}),this.map=l,_&&(this.mousePitch=new Lu({clickTolerance:l.dragRotate._mousePitch._clickTolerance})),f.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(l,h){this.mouseRotate.mousedown(l,h),this.mousePitch&&this.mousePitch.mousedown(l,h),Ql()}move(l,h){const _=this.map,x=this.mouseRotate.mousemoveWindow(l,h),w=x&&x.bearingDelta;if(w&&_.setBearing(_.getBearing()+w),this.mousePitch){const T=this.mousePitch.mousemoveWindow(l,h),S=T&&T.pitchDelta;S&&_.setPitch(_.getPitch()+S)}}off(){const l=this.element;l.removeEventListener("mousedown",this.mousedown),l.removeEventListener("touchstart",this.touchstart,{passive:!1}),l.removeEventListener("touchmove",this.touchmove),l.removeEventListener("touchend",this.touchend),l.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){_l(),f.window.removeEventListener("mousemove",this.mousemove),f.window.removeEventListener("mouseup",this.mouseup)}mousedown(l){this.down(f.extend({},l,{ctrlKey:!0,preventDefault:()=>l.preventDefault()}),ur(this.element,l)),f.window.addEventListener("mousemove",this.mousemove),f.window.addEventListener("mouseup",this.mouseup)}mousemove(l){this.move(l,ur(this.element,l))}mouseup(l){this.mouseRotate.mouseupWindow(l),this.mousePitch&&this.mousePitch.mouseupWindow(l),this.offTemp()}touchstart(l){1!==l.targetTouches.length?this.reset():(this._startPos=this._lastPos=As(this.element,l.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>l.preventDefault()},this._startPos))}touchmove(l){1!==l.targetTouches.length?this.reset():(this._lastPos=As(this.element,l.targetTouches)[0],this.move({preventDefault:()=>l.preventDefault()},this._lastPos))}touchend(l){0===l.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ws={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},zh={maxWidth:100,unit:"metric"},Rl={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Go={version:f.version,supported:je,setRTLTextPlugin:f.setRTLTextPlugin,getRTLTextPluginStatus:f.getRTLTextPluginStatus,Map:class extends Nh{constructor(m){if(f.LivePerformanceUtils.mark(f.PerformanceMarkers.create),null!=(m=f.extend({},Nm,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&f.isSafariWithAntialiasingBug(f.window)&&(m.antialias=!1,f.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ri(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Zd,this._domRenderTaskQueue=new Zd,this._controls=[],this._markers=[],this._popups=[],this._mapId=f.uniqueId(),this._locale=f.extend({},ep,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new zu(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new f.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,"string"==typeof m.container){if(this._container=f.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof f.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&f.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),f.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==f.window&&(f.window.addEventListener("online",this._onWindowOnline,!1),f.window.addEventListener("resize",this._onWindowResize,!1),f.window.addEventListener("orientationchange",this._onWindowResize,!1),f.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new qs(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new Xa("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,f.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new De({customAttribution:m.customAttribution})),this._logoControl=new Rn,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update("style"===l.dataType),this.fire(new f.Event(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new f.Event(`${l.dataType}dataloading`,l))})}_getMapId(){return this._mapId}addControl(m,l){if(void 0===l&&(l=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=m.onAdd(this);this._controls.push(m);const _=this._controlPositions[l];return-1!==l.indexOf("bottom")?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new f.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const l=this._controls.indexOf(m);return l>-1&&this._controls.splice(l,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const l=!this._moving;return l&&this.fire(new f.Event("movestart",m)).fire(new f.Event("move",m)),this.fire(new f.Event("resize",m)),l&&this.fire(new f.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(f.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new f.Event("zoomstart")).fire(new f.Event("zoom")).fire(new f.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new f.Event("pitchstart")).fire(new f.Event("pitch")).fire(new f.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return"auto"===m?f.window.navigator.language:Array.isArray(m)?0===m.length?void 0:m.map(l=>"auto"===l?f.window.navigator.language:l):m}setLanguage(m){const l=this._parseLanguage(m);if(!this.style||l===this._language)return this;this._language=l,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(m){return this._lazyInitEmptyStyle(),m?"string"==typeof m&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const m=this.transform,l=m.projection.name;let h;"globe"===l&&m.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),h=!0):"mercator"===l&&m.zoom<f.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,l){return this._updateProjection(m||l||{name:"mercator"})}_updateProjection(m){let l;if(l="globe"===m.name&&this.transform.zoom>=f.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),l){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(f.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(f.Point.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,l,h){if("mouseenter"===m||"mouseover"===m){let _=!1;const x=T=>{const S=l.filter(B=>this.getLayer(B)),P=S.length?this.queryRenderedFeatures(T.point,{layers:S}):[];P.length?_||(_=!0,h.call(this,new vr(m,this,T.originalEvent,{features:P}))):_=!1},w=()=>{_=!1};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:w}}}if("mouseleave"===m||"mouseout"===m){let _=!1;const x=T=>{const S=l.filter(P=>this.getLayer(P));(S.length?this.queryRenderedFeatures(T.point,{layers:S}):[]).length?_=!0:_&&(_=!1,h.call(this,new vr(m,this,T.originalEvent)))},w=T=>{_&&(_=!1,h.call(this,new vr(m,this,T.originalEvent)))};return{layers:new Set(l),listener:h,delegates:{mousemove:x,mouseout:w}}}{const _=x=>{const w=l.filter(S=>this.getLayer(S)),T=w.length?this.queryRenderedFeatures(x.point,{layers:w}):[];T.length&&(x.features=T,h.call(this,x),delete x.features)};return{layers:new Set(l),listener:h,delegates:{[m]:_}}}}on(m,l,h){if(void 0===h)return super.on(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(_);for(const x in _.delegates)this.on(x,_.delegates[x]);return this}once(m,l,h){if(void 0===h)return super.once(m,l);Array.isArray(l)||(l=[l]);const _=this._createDelegatedListener(m,l,h);for(const x in _.delegates)this.once(x,_.delegates[x]);return this}off(m,l,h){if(void 0===h)return super.off(m,l);l=new Set(Array.isArray(l)?l:[l]);const _=(w,T)=>{if(w.size!==T.size)return!1;for(const S of w)if(!T.has(S))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[m]:void 0;return x&&(w=>{for(let T=0;T<w.length;T++){const S=w[T];if(S.listener===h&&_(S.layers,l)){for(const P in S.delegates)this.off(P,S.delegates[P]);return w.splice(T,1),this}}})(x),this}queryRenderedFeatures(m,l){return this.style?(void 0!==l||void 0===m||m instanceof f.Point||Array.isArray(m)||(l=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],l=l||{},this.transform)):[]}querySourceFeatures(m,l){return this.style.querySourceFeatures(m,l)}isPointOnSurface(m){const{name:l}=this.transform.projection;return"globe"!==l&&"mercator"!==l&&f.warnOnce(`${l} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(f.Point.convert(m))}setStyle(m,l){return!1!==(l=f.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},l)).diff&&l.localIdeographFontFamily===this._localIdeographFontFamily&&l.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._localFontFamily=l.localFontFamily,this._updateStyle(m,l))}_getUIString(m){const l=this._locale[m];if(null==l)throw new Error(`Missing UI string '${m}'`);return l}_updateStyle(m,l){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new gs(this,l||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new gs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,l){if("string"==typeof m){const h=this._requestManager.normalizeStyleURL(m),_=this._requestManager.transformRequest(h,f.ResourceType.Style);f.getJSON(_,(x,w)=>{x?this.fire(new f.ErrorEvent(x)):w&&this._updateDiff(w,l)})}else"object"==typeof m&&this._updateDiff(m,l)}_updateDiff(m,l){try{this.style.setState(m)&&this._update(!0)}catch(h){f.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(m,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(f.warnOnce("There is no style added to the map."),!1)}addSource(m,l){return this._lazyInitEmptyStyle(),this.style.addSource(m,l),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const l in m){const h=m[l]._tiles;for(const _ in h){const x=h[_];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(m,l,h){this._lazyInitEmptyStyle(),this.style.addSourceType(m,l,h)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,l,{pixelRatio:h=1,sdf:_=!1,stretchX:x,stretchY:w,content:T}={}){if(this._lazyInitEmptyStyle(),l instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&l instanceof f.window.ImageBitmap){const{width:S,height:P,data:B}=f.exported.getImageData(l);this.style.addImage(m,{data:new f.RGBAImage({width:S,height:P},B),pixelRatio:h,stretchX:x,stretchY:w,content:T,sdf:_,version:0})}else if(void 0===l.width||void 0===l.height)this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:S,height:P}=l,B=l;this.style.addImage(m,{data:new f.RGBAImage({width:S,height:P},new Uint8Array(B.data)),pixelRatio:h,stretchX:x,stretchY:w,content:T,sdf:_,version:0,userImage:B}),B.onAdd&&B.onAdd(this,m)}}updateImage(m,l){const h=this.style.getImage(m);if(!h)return void this.fire(new f.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=l instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&l instanceof f.window.ImageBitmap?f.exported.getImageData(l):l,{width:x,height:w}=_;void 0!==x&&void 0!==w?x===h.data.width&&w===h.data.height?(h.data.replace(_.data,!(l instanceof f.window.HTMLImageElement||f.window.ImageBitmap&&l instanceof f.window.ImageBitmap)),this.style.updateImage(m,h)):this.fire(new f.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${w})\n                must be that same as the previous version of the image\n                (${h.data.width}, ${h.data.height})`))):this.fire(new f.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new f.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,l){f.getImage(this._requestManager.transformRequest(m,f.ResourceType.Image),(h,_)=>{l(h,_ instanceof f.window.HTMLImageElement?f.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(m,l){return this._lazyInitEmptyStyle(),this.style.addLayer(m,l),this._update(!0)}moveLayer(m,l){return this.style.moveLayer(m,l),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,l,h){return this.style.setLayerZoomRange(m,l,h),this._update(!0)}setFilter(m,l,h={}){return this.style.setFilter(m,l,h),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,l,h,_={}){return this.style.setPaintProperty(m,l,h,_),this._update(!0)}getPaintProperty(m,l){return this.style.getPaintProperty(m,l)}setLayoutProperty(m,l,h,_={}){return this.style.setLayoutProperty(m,l,h,_),this._update(!0)}getLayoutProperty(m,l){return this.style.getLayoutProperty(m,l)}setLight(m,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,l),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(f.LngLat.convert(m),this.transform):0}setFeatureState(m,l){return this.style.setFeatureState(m,l),this._update()}removeFeatureState(m,l){return this.style.removeFeatureState(m,l),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,l=this._container.getBoundingClientRect().height||300;let h,_,x,w=this._container;for(;w&&(!_||!x);){const T=f.window.getComputedStyle(w).transform;T&&"none"!==T&&(h=T.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&"0"!==h[0]&&"1"!==h[0]&&(_=h[0]),h[3]&&"0"!==h[3]&&"1"!==h[3]&&(x=h[3])),w=w.parentElement}this._containerWidth=_?Math.abs(m/_):m,this._containerHeight=x?Math.abs(l/x):l}_detectMissingCSS(){"rgb(250, 128, 114)"!==f.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&f.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=Wt("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const l=this._canvasContainer=Wt("div","mapboxgl-canvas-container",m);this._interactive&&l.classList.add("mapboxgl-interactive"),this._canvas=Wt("canvas","mapboxgl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=Wt("div","mapboxgl-control-container",m),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=Wt("div",`mapboxgl-ctrl-${x}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,l){const h=f.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(m),this._canvas.height=h*Math.ceil(l),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${l}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const l=this._markers.indexOf(m);-1!==l&&this._markers.splice(l,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const l=this._popups.indexOf(m);-1!==l&&this._popups.splice(l,1)}_setupPainter(){const m=f.extend({},je.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),l=this._useWebGL2&&this._canvas.getContext("webgl2",m),h=l||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);h?(this._useWebGL2&&!l&&f.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),f.storeAuthState(h,!0),this.painter=new ss(h,this.transform,!!l),this.on("data",_=>{"source"===_.dataType&&this.painter.setTileLoadedFlag(!0)}),f.exported$1.testSupport(h)):this.fire(new f.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new f.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new f.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let l;const h=this.painter.context.extTimerQuery,_=f.exported.now();if(this.listens("gpu-timing-frame")&&(l=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,l)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],f.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],f.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const S=this.transform.zoom,P=this.transform.pitch,B=f.exported.now(),N=new f.EvaluationParameters(S,{now:B,fadeDuration:x,pitch:P,transition:this.style.getTransition()});this.style.update(N)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new f.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new f.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),l){const S=f.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,l),setTimeout(()=>{const P=h.getQueryObjectEXT(l,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(l),this.fire(new f.Event("gpu-timing-frame",{cpuTime:S,gpuTime:P})),f.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:P}})},50)}if(this.listens("gpu-timing-layer")){const S=this.painter.collectGpuTimers();setTimeout(()=>{const P=this.painter.queryGpuTimers(S);this.fire(new f.Event("gpu-timing-layer",{layerTimes:P}))},50)}if(this.listens("gpu-timing-deferred-render")){const S=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const P=this.painter.queryGpuTimeDeferredRender(S);this.fire(new f.Event("gpu-timing-deferred-render",{gpuTime:P}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(T||this._repaint)this.triggerRepaint();else{const S=!this.isMoving()&&this.loaded();if(S&&(w=this._updateAverageElevation(_,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),S&&(this.fire(new f.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const P=this._calculateSpeedIndex();this.fire(new f.Event("speedindexcompleted",{speedIndex:P})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,f.LivePerformanceUtils.mark(f.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&f.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const l of this._markers)m&&!this.getRenderWorldCopies()&&(l._lngLat=l._lngLat.wrap()),l._update();for(const l of this._popups)!m||this.getRenderWorldCopies()||l._trackPointer||(l._lngLat=l._lngLat.wrap()),l._update()}_updateAverageElevation(m,l=!1){const h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&h(0);if((l||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const _=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=m;const T=Math.abs(_-x);if(T>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(x),h(x);this._averageElevation.easeTo(x,m,300)}else if(T>1e-4)return this._averageElevation.jumpTo(x),h(x)}return!!this._averageElevation.isEasing(m)&&h(this._averageElevation.getValue(m))}_authenticate(){f.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===f.AUTH_ERR_MSG||401===m.status)){const l=this.painter.context.gl;f.storeAuthState(l,!1),this._logoControl instanceof Rn&&this._logoControl._updateLogo(),l&&l.clear(l.DEPTH_BUFFER_BIT|l.COLOR_BUFFER_BIT|l.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new f.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),f.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),l=this.painter.getCanvasCopiesAndTimestamps();l.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function x(w){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,w,0);const T=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,T),T}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(x(m),l.canvasCopies.map(x),l.timeStamps)}_canvasPixelComparison(m,l,h){let _=h[1]-h[0];const x=m.length/4;for(let w=0;w<l.length;w++){const T=l[w];let S=0;for(let P=0;P<T.length;P+=4)T[P]===m[P]&&T[P+1]===m[P+1]&&T[P+2]===m[P+2]&&T[P+3]===m[P+3]&&(S+=1);_+=(h[w+2]-h[w+1])*(1-S/x)}return _}remove(){this._hash&&this._hash.remove();for(const l of this._controls)l.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==f.window&&(f.window.removeEventListener("resize",this._onWindowResize,!1),f.window.removeEventListener("orientationchange",this._onWindowResize,!1),f.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),f.window.removeEventListener("online",this._onWindowOnline,!1),f.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),f.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new f.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=f.exported.frame(l=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(l)}))}_preloadTiles(m){const l=this.style?Object.values(this.style._sourceCaches):[];return f.asyncAll(l,(h,_)=>h._preloadTiles(m,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){"hidden"===f.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,l){f.setCacheLimits(m,l)}get version(){return f.version}},NavigationControl:class{constructor(m){this.options=f.extend({},tp,m),this._container=Wt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(f.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",l=>{this._map&&this._map.zoomIn({},{originalEvent:l})}),Wt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",l=>{this._map&&this._map.zoomOut({},{originalEvent:l})}),Wt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(f.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",l=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:l}):h.resetNorth({},{originalEvent:l}))}),this._compassIcon=Wt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const l=m.getZoom(),h=l===m.getMaxZoom(),_=l===m.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=l)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Io(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,l){const h=Wt("button",m,this._container);return h.type="button",h.addEventListener("click",l),h}_setButtonTitle(m,l){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${l}`);m.setAttribute("aria-label",h),m.firstElementChild&&m.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends f.Evented{constructor(m){super(),this.options=f.extend({geolocation:f.window.navigator.geolocation},Ws,m),f.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Ii(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=Wt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const l=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,m(h)};void 0!==this._supportsGeolocation?m(this._supportsGeolocation):void 0!==f.window.navigator.permissions?f.window.navigator.permissions.query({name:"geolocation"}).then(h=>l("denied"!==h.state)).catch(()=>l()):l()}_isOutOfMapMaxBounds(m){const l=this._map.getMaxBounds(),h=m.coords;return!!l&&(h.longitude<l.getWest()||h.longitude>l.getEast()||h.latitude<l.getSouth()||h.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new f.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("geolocate",m)),this._finish()}}_updateCamera(m){const l=new f.LngLat(m.coords.longitude,m.coords.latitude),h=m.coords.accuracy,_=this._map.getBearing(),x=f.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(h),x,{geolocateSource:!0})}_updateMarker(m){if(m){const l=new f.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,l=f.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,h=Math.ceil(2*this._accuracy*l);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new f.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",l=>l.preventDefault()),this._geolocateButton=Wt("button","mapboxgl-ctrl-geolocate",this._container),Wt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){f.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}else{const l=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",l),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",l)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Wt("div","mapboxgl-user-location"),this._dotElement.appendChild(Wt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Wt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new yt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Wt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new yt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",l=>{l.geolocateSource||"ACTIVE_LOCK"!==this._watchState||l.originalEvent&&"resize"===l.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new f.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return f.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new f.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new f.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new f.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{f.window.addEventListener("ondeviceorientationabsolute"in f.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==f.window.DeviceMotionEvent&&"function"==typeof f.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(l=>{"granted"===l&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),f.window.removeEventListener("deviceorientation",this._onDeviceOrientation),f.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:De,ScaleControl:class{constructor(m){this.options=f.extend({},zh,m),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),f.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,l=this._map,h=l._containerHeight/2,_=l._containerWidth/2-m/2,x=l.unproject([_,h]),w=l.unproject([_+m,h]),T=x.distanceTo(w);if("imperial"===this.options.unit){const S=3.2808*T;S>5280?this._setScale(m,S/5280,"mile"):this._setScale(m,S,"foot")}else"nautical"===this.options.unit?this._setScale(m,T/1852,"nautical-mile"):T>=1e3?this._setScale(m,T/1e3,"kilometer"):this._setScale(m,T,"meter")}_setScale(m,l,h){this._map._requestDomTask(()=>{const _=function(w){const T=Math.pow(10,`${Math.floor(w)}`.length-1);let S=w/T;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(P){const B=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*B)/B}(S),T*S}(l),x=_/l;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==h?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(_):`${_}&nbsp;${Rl[h]}`,this._container.style.width=m*x+"px"})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=Wt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof f.window.HTMLElement?this._container=m.container:f.warnOnce("Full screen control 'container' must be a DOM element.")),f.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in f.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in f.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=Wt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",f.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,f.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!f.window.document.fullscreenEnabled&&!f.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=Wt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Wt("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),f.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(f.window.document.fullscreenElement||f.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?f.window.document.exitFullscreen?f.window.document.exitFullscreen():f.window.document.webkitCancelFullScreen&&f.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends f.Evented{constructor(m){super(),this.options=f.extend(Object.create(fc),m),f.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new f.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new f.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=f.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const l=this._map;return l&&(l.on("move",this._update),l.off("mousemove",this._onMouseEvent),l._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(f.window.document.createTextNode(m))}setHTML(m){const l=f.window.document.createDocumentFragment(),h=f.window.document.createElement("body");let _;for(h.innerHTML=m;_=h.firstChild,_;)l.appendChild(_);return this.setDOMContent(l)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let l=this._content;if(l)for(;l.hasChildNodes();)l.firstChild&&l.removeChild(l.firstChild);else l=this._content=Wt("div","mapboxgl-popup-content",this._container||void 0);if(l.appendChild(m),this.options.closeButton){const h=this._closeButton=Wt("button","mapboxgl-popup-close-button",l);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let l;return this._classList.delete(m)?l=!1:(this._classList.add(m),l=!0),this._updateClassList(),l}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const l=this._map,h=this._container,_=this._pos;if(!l||!h||!_)return"bottom";const x=h.offsetWidth,w=h.offsetHeight,T=_.x<x/2,S=_.x>l.transform.width-x/2;if(_.y+m<w)return T?"top-left":S?"top-right":"top";if(_.y>l.transform.height-w){if(T)return"bottom-left";if(S)return"bottom-right"}return T?"left":S?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const l=[...this._classList];l.push("mapboxgl-popup"),this._anchor&&l.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&l.push("mapboxgl-popup-track-pointer"),m.className=l.join(" ")}_update(m){const l=this._map,h=this._content;if(!l||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=Wt("div","mapboxgl-popup",l.getContainer()),this._tip=Wt("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),l.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Xc(this._lngLat,this._pos,l.transform)),!this._trackPointer||m){const x=this._pos=this._trackPointer&&m?m:l.project(this._lngLat),w=Bh(this.options.offset),T=this._anchor=this._getAnchor(w.y),S=Bh(this.options.offset,T),P=x.add(S).round();l._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${Gi[T]} translate(${P.x}px,${P.y}px)`)})}if(!this._marker&&l._showingGlobe()){const x=f.isLngLatBehindGlobe(l.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(pa);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:yt,Style:gs,LngLat:f.LngLat,LngLatBounds:f.LngLatBounds,Point:f.Point,MercatorCoordinate:f.MercatorCoordinate,FreeCameraOptions:Za,Evented:f.Evented,config:f.config,prewarm:function(){pi().acquire(Uo)},clearPrewarmedResources:function(){const m=Cr;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(Uo),Cr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return f.config.ACCESS_TOKEN},set accessToken(m){f.config.ACCESS_TOKEN=m},get baseApiUrl(){return f.config.API_URL},set baseApiUrl(m){f.config.API_URL=m},get workerCount(){return Qn.workerCount},set workerCount(m){Qn.workerCount=m},get maxParallelImageRequests(){return f.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){f.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){f.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:f.exported.setNow,restoreNow:f.exported.restoreNow};return Go}),pn}()},226:function(Bd){Bd.exports=function(){"use strict";const qt={},Oc=R=>new Promise(F=>{if(!R)return F();const G=window.scrollX,de=window.scrollY;qt.restoreFocusTimeout=setTimeout(()=>{qt.previousActiveElement instanceof HTMLElement?(qt.previousActiveElement.focus(),qt.previousActiveElement=null):document.body&&document.body.focus(),F()},100),window.scrollTo(G,de)});var Fn={promise:new WeakMap,innerParams:new WeakMap,domCache:new WeakMap};const f="swal2-",je=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","default-outline","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error"].reduce((R,F)=>(R[F]=f+F,R),{}),$t=["success","warning","info","question","error"].reduce((R,F)=>(R[F]=f+F,R),{}),Wt="SweetAlert2:",zi=R=>R.charAt(0).toUpperCase()+R.slice(1),si=R=>{console.warn(`${Wt} ${"object"==typeof R?R.join(" "):R}`)},er=R=>{console.error(`${Wt} ${R}`)},ds=[],_l=(R,F)=>{(R=>{ds.includes(R)||(ds.push(R),si(R))})(`"${R}" is deprecated and will be removed in the next major release. Please use "${F}" instead.`)},Er=R=>"function"==typeof R?R():R,Qr=R=>R&&"function"==typeof R.toPromise,ur=R=>Qr(R)?R.toPromise():Promise.resolve(R),As=R=>R&&Promise.resolve(R)===R,ki=()=>document.body.querySelector(`.${je.container}`),zr=R=>{const F=ki();return F?F.querySelector(R):null},ct=R=>zr(`.${R}`),ti=()=>ct(je.popup),Ko=()=>ct(je.icon),tr=()=>ct(je.title),ra=()=>ct(je["html-container"]),ec=()=>ct(je.image),Is=()=>ct(je["progress-steps"]),eo=()=>ct(je["validation-message"]),zt=()=>zr(`.${je.actions} .${je.confirm}`),yo=()=>zr(`.${je.actions} .${je.cancel}`),Lt=()=>zr(`.${je.actions} .${je.deny}`),vo=()=>zr(`.${je.loader}`),Ei=()=>ct(je.actions),Ps=()=>ct(je.footer),mn=()=>ct(je["timer-progress-bar"]),Yo=()=>ct(je.close),ni=()=>{const R=ti();if(!R)return[];const F=R.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),G=Array.from(F).sort((Rt,Hn)=>{const Ri=parseInt(Rt.getAttribute("tabindex")||"0"),Ii=parseInt(Hn.getAttribute("tabindex")||"0");return Ri>Ii?1:Ri<Ii?-1:0}),de=R.querySelectorAll('\n  a[href],\n  area[href],\n  input:not([disabled]),\n  select:not([disabled]),\n  textarea:not([disabled]),\n  button:not([disabled]),\n  iframe,\n  object,\n  embed,\n  [tabindex="0"],\n  [contenteditable],\n  audio[controls],\n  video[controls],\n  summary\n'),Ge=Array.from(de).filter(Rt=>"-1"!==Rt.getAttribute("tabindex"));return[...new Set(G.concat(Ge))].filter(Rt=>yi(Rt))},Ln=()=>Vi(document.body,je.shown)&&!Vi(document.body,je["toast-shown"])&&!Vi(document.body,je["no-backdrop"]),ks=()=>{const R=ti();return!!R&&Vi(R,je.toast)},Zi=(R,F)=>{if(R.textContent="",F){const de=(new DOMParser).parseFromString(F,"text/html");Array.from(de.querySelector("head").childNodes).forEach(Ge=>{R.appendChild(Ge)}),Array.from(de.querySelector("body").childNodes).forEach(Ge=>{Ge instanceof HTMLVideoElement||Ge instanceof HTMLAudioElement?R.appendChild(Ge.cloneNode(!0)):R.appendChild(Ge)})}},Vi=(R,F)=>{if(!F)return!1;const G=F.split(/\s+/);for(let de=0;de<G.length;de++)if(!R.classList.contains(G[de]))return!1;return!0},Tn=(R,F,G)=>{if(((R,F)=>{Array.from(R.classList).forEach(G=>{!Object.values(je).includes(G)&&!Object.values($t).includes(G)&&!Object.values(F.showClass).includes(G)&&R.classList.remove(G)})})(R,F),F.customClass&&F.customClass[G]){if("string"!=typeof F.customClass[G]&&!F.customClass[G].forEach)return void si(`Invalid type of customClass.${G}! Expected string or iterable object, got "${typeof F.customClass[G]}"`);an(R,F.customClass[G])}},to=(R,F)=>{if(!F)return null;switch(F){case"select":case"textarea":case"file":return R.querySelector(`.${je.popup} > .${je[F]}`);case"checkbox":return R.querySelector(`.${je.popup} > .${je.checkbox} input`);case"radio":return R.querySelector(`.${je.popup} > .${je.radio} input:checked`)||R.querySelector(`.${je.popup} > .${je.radio} input:first-child`);case"range":return R.querySelector(`.${je.popup} > .${je.range} input`);default:return R.querySelector(`.${je.popup} > .${je.input}`)}},tc=R=>{if(R.focus(),"file"!==R.type){const F=R.value;R.value="",R.value=F}},Rs=(R,F,G)=>{!R||!F||("string"==typeof F&&(F=F.split(/\s+/).filter(Boolean)),F.forEach(de=>{Array.isArray(R)?R.forEach(Ge=>{G?Ge.classList.add(de):Ge.classList.remove(de)}):G?R.classList.add(de):R.classList.remove(de)}))},an=(R,F)=>{Rs(R,F,!0)},xo=(R,F)=>{Rs(R,F,!1)},zo=(R,F)=>{const G=Array.from(R.children);for(let de=0;de<G.length;de++){const Ge=G[de];if(Ge instanceof HTMLElement&&Vi(Ge,F))return Ge}},Jo=(R,F,G)=>{G===`${parseInt(G)}`&&(G=parseInt(G)),G||0===parseInt(G)?R.style[F]="number"==typeof G?`${G}px`:G:R.style.removeProperty(F)},Ci=function(R){R&&(R.style.display=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"flex")},Ui=R=>{R&&(R.style.display="none")},Ia=(R,F,G,de)=>{const Ge=R.querySelector(F);Ge&&(Ge.style[G]=de)},Pa=function(R,F){F?Ci(R,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"flex"):Ui(R)},yi=R=>!(!R||!(R.offsetWidth||R.offsetHeight||R.getClientRects().length)),yl=R=>R.scrollHeight>R.clientHeight,oa=R=>{const F=window.getComputedStyle(R),G=parseFloat(F.getPropertyValue("animation-duration")||"0"),de=parseFloat(F.getPropertyValue("transition-duration")||"0");return G>0||de>0},sa=function(R){let F=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const G=mn();yi(G)&&(F&&(G.style.transition="none",G.style.width="100%"),setTimeout(()=>{G.style.transition=`width ${R/1e3}s linear`,G.style.width="0%"},10))},Fs=()=>typeof window>"u"||typeof document>"u",aa=`\n <div aria-labelledby="${je.title}" aria-describedby="${je["html-container"]}" class="${je.popup}" tabindex="-1">\n   <button type="button" class="${je.close}"></button>\n   <ul class="${je["progress-steps"]}"></ul>\n   <div class="${je.icon}"></div>\n   <img class="${je.image}" />\n   <h2 class="${je.title}" id="${je.title}"></h2>\n   <div class="${je["html-container"]}" id="${je["html-container"]}"></div>\n   <input class="${je.input}" id="${je.input}" />\n   <input type="file" class="${je.file}" />\n   <div class="${je.range}">\n     <input type="range" />\n     <output></output>\n   </div>\n   <select class="${je.select}" id="${je.select}"></select>\n   <div class="${je.radio}"></div>\n   <label class="${je.checkbox}">\n     <input type="checkbox" id="${je.checkbox}" />\n     <span class="${je.label}"></span>\n   </label>\n   <textarea class="${je.textarea}" id="${je.textarea}"></textarea>\n   <div class="${je["validation-message"]}" id="${je["validation-message"]}"></div>\n   <div class="${je.actions}">\n     <div class="${je.loader}"></div>\n     <button type="button" class="${je.confirm}"></button>\n     <button type="button" class="${je.deny}"></button>\n     <button type="button" class="${je.cancel}"></button>\n   </div>\n   <div class="${je.footer}"></div>\n   <div class="${je["timer-progress-bar-container"]}">\n     <div class="${je["timer-progress-bar"]}"></div>\n   </div>\n </div>\n`.replace(/(^|\n)\s*/g,""),bo=()=>{qt.currentInstance.resetValidationMessage()},W=R=>{const F=(()=>{const R=ki();return!!R&&(R.remove(),xo([document.documentElement,document.body],[je["no-backdrop"],je["toast-shown"],je["has-column"]]),!0)})();if(Fs())return void er("SweetAlert2 requires document to initialize");const G=document.createElement("div");G.className=je.container,F&&an(G,je["no-transition"]),Zi(G,aa);const de=(R=>"string"==typeof R?document.querySelector(R):R)(R.target);de.appendChild(G),(R=>{const F=ti();F.setAttribute("role",R.toast?"alert":"dialog"),F.setAttribute("aria-live",R.toast?"polite":"assertive"),R.toast||F.setAttribute("aria-modal","true")})(R),(R=>{"rtl"===window.getComputedStyle(R).direction&&an(ki(),je.rtl)})(de),(()=>{const R=ti(),F=zo(R,je.input),G=zo(R,je.file),de=R.querySelector(`.${je.range} input`),Ge=R.querySelector(`.${je.range} output`),Rt=zo(R,je.select),Hn=R.querySelector(`.${je.checkbox} input`),Ri=zo(R,je.textarea);F.oninput=bo,G.onchange=bo,Rt.onchange=bo,Hn.onchange=bo,Ri.oninput=bo,de.oninput=()=>{bo(),Ge.value=de.value},de.onchange=()=>{bo(),Ge.value=de.value}})()},le=(R,F)=>{R instanceof HTMLElement?F.appendChild(R):"object"==typeof R?ge(R,F):R&&Zi(F,R)},ge=(R,F)=>{R.jquery?xe(F,R):Zi(F,R.toString())},xe=(R,F)=>{if(R.textContent="",0 in F)for(let G=0;G in F;G++)R.appendChild(F[G].cloneNode(!0));else R.appendChild(F.cloneNode(!0))},Te=(()=>{if(Fs())return!1;const R=document.createElement("div"),F={WebkitAnimation:"webkitAnimationEnd",animation:"animationend"};for(const G in F)if(Object.prototype.hasOwnProperty.call(F,G)&&typeof R.style[G]<"u")return F[G];return!1})(),Se=(R,F)=>{const G=Ei(),de=vo();!G||!de||(F.showConfirmButton||F.showDenyButton||F.showCancelButton?Ci(G):Ui(G),Tn(G,F,"actions"),function be(R,F,G){const de=zt(),Ge=Lt(),Rt=yo();!de||!Ge||!Rt||(st(de,"confirm",G),st(Ge,"deny",G),st(Rt,"cancel",G),function Oe(R,F,G,de){de.buttonsStyling?(an([R,F,G],je.styled),de.confirmButtonColor&&(R.style.backgroundColor=de.confirmButtonColor,an(R,je["default-outline"])),de.denyButtonColor&&(F.style.backgroundColor=de.denyButtonColor,an(F,je["default-outline"])),de.cancelButtonColor&&(G.style.backgroundColor=de.cancelButtonColor,an(G,je["default-outline"]))):xo([R,F,G],je.styled)}(de,Ge,Rt,G),G.reverseButtons&&(G.toast?(R.insertBefore(Rt,de),R.insertBefore(Ge,de)):(R.insertBefore(Rt,F),R.insertBefore(Ge,F),R.insertBefore(de,F))))}(G,de,F),Zi(de,F.loaderHtml||""),Tn(de,F,"loader"))};function st(R,F,G){const de=zi(F);Pa(R,G[`show${de}Button`],"inline-block"),Zi(R,G[`${F}ButtonText`]||""),R.setAttribute("aria-label",G[`${F}ButtonAriaLabel`]||""),R.className=je[F],Tn(R,G,`${F}Button`)}const ot=(R,F)=>{const G=ki();G&&(function Ht(R,F){"string"==typeof F?R.style.background=F:F||an([document.documentElement,document.body],je["no-backdrop"])}(G,F.backdrop),function nn(R,F){F&&(F in je?an(R,je[F]):(si('The "position" parameter is not valid, defaulting to "center"'),an(R,je.center)))}(G,F.position),function It(R,F){F&&an(R,je[`grow-${F}`])}(G,F.grow),Tn(G,F,"container"))};const ln=["input","file","range","select","radio","checkbox","textarea"],Di=R=>{if(!ir[R.input])return void er(`Unexpected type of input! Expected "text", "email", "password", "number", "tel", "select", "radio", "checkbox", "textarea", "file" or "url", got "${R.input}"`);const F=Cr(R.input),G=ir[R.input](F,R);Ci(F),R.inputAutoFocus&&setTimeout(()=>{tc(G)})},mr=(R,F)=>{const G=to(ti(),R);if(G){(R=>{for(let F=0;F<R.attributes.length;F++){const G=R.attributes[F].name;["id","type","value","style"].includes(G)||R.removeAttribute(G)}})(G);for(const de in F)G.setAttribute(de,F[de])}},Xi=R=>{const F=Cr(R.input);"object"==typeof R.customClass&&an(F,R.customClass.input)},Uo=(R,F)=>{(!R.placeholder||F.inputPlaceholder)&&(R.placeholder=F.inputPlaceholder)},Qn=(R,F,G)=>{if(G.inputLabel){const de=document.createElement("label"),Ge=je["input-label"];de.setAttribute("for",R.id),de.className=Ge,"object"==typeof G.customClass&&an(de,G.customClass.inputLabel),de.innerText=G.inputLabel,F.insertAdjacentElement("beforebegin",de)}},Cr=R=>zo(ti(),je[R]||je.input),pi=(R,F)=>{["string","number"].includes(typeof F)?R.value=`${F}`:As(F)||si(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof F}"`)},ir={};ir.text=ir.email=ir.password=ir.number=ir.tel=ir.url=(R,F)=>(pi(R,F.inputValue),Qn(R,R,F),Uo(R,F),R.type=F.input,R),ir.file=(R,F)=>(Qn(R,R,F),Uo(R,F),R),ir.range=(R,F)=>{const G=R.querySelector("input"),de=R.querySelector("output");return pi(G,F.inputValue),G.type=F.input,pi(de,F.inputValue),Qn(G,R,F),R},ir.select=(R,F)=>{if(R.textContent="",F.inputPlaceholder){const G=document.createElement("option");Zi(G,F.inputPlaceholder),G.value="",G.disabled=!0,G.selected=!0,R.appendChild(G)}return Qn(R,R,F),R},ir.radio=R=>(R.textContent="",R),ir.checkbox=(R,F)=>{const G=to(ti(),"checkbox");G.value="1",G.checked=Boolean(F.inputValue);const de=R.querySelector("span");return Zi(de,F.inputPlaceholder),G},ir.textarea=(R,F)=>{pi(R,F.inputValue),Uo(R,F),Qn(R,R,F);return setTimeout(()=>{if("MutationObserver"in window){const de=parseInt(window.getComputedStyle(ti()).width);new MutationObserver(()=>{if(!document.body.contains(R))return;const Rt=R.offsetWidth+(de=>parseInt(window.getComputedStyle(de).marginLeft)+parseInt(window.getComputedStyle(de).marginRight))(R);Rt>de?ti().style.width=`${Rt}px`:Jo(ti(),"width",F.width)}).observe(R,{attributes:!0,attributeFilter:["style"]})}}),R};const Qo=(R,F)=>{const G=ra();G&&(Tn(G,F,"htmlContainer"),F.html?(le(F.html,G),Ci(G,"block")):F.text?(G.textContent=F.text,Ci(G,"block")):Ui(G),((R,F)=>{const G=ti(),de=Fn.innerParams.get(R),Ge=!de||F.input!==de.input;ln.forEach(Rt=>{const Hn=zo(G,je[Rt]);mr(Rt,F.inputAttributes),Hn.className=je[Rt],Ge&&Ui(Hn)}),F.input&&(Ge&&Di(F),Xi(F))})(R,F))},ka=(R,F)=>{for(const[G,de]of Object.entries($t))F.icon!==G&&xo(R,de);an(R,F.icon&&$t[F.icon]),Lc(R,F),nc(),Tn(R,F,"icon")},nc=()=>{const R=ti();if(!R)return;const F=window.getComputedStyle(R).getPropertyValue("background-color"),G=R.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let de=0;de<G.length;de++)G[de].style.backgroundColor=F},ps=(R,F)=>{if(!F.icon)return;let de,G=R.innerHTML;F.iconHtml?de=rc(F.iconHtml):"success"===F.icon?(de='\n  <div class="swal2-success-circular-line-left"></div>\n  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>\n  <div class="swal2-success-ring"></div> <div class="swal2-success-fix"></div>\n  <div class="swal2-success-circular-line-right"></div>\n',G=G.replace(/ style=".*?"/g,"")):de="error"===F.icon?'\n  <span class="swal2-x-mark">\n    <span class="swal2-x-mark-line-left"></span>\n    <span class="swal2-x-mark-line-right"></span>\n  </span>\n':rc({question:"?",warning:"!",info:"i"}[F.icon]),G.trim()!==de.trim()&&Zi(R,de)},Lc=(R,F)=>{if(F.iconColor){R.style.color=F.iconColor,R.style.borderColor=F.iconColor;for(const G of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])Ia(R,G,"backgroundColor",F.iconColor);Ia(R,".swal2-success-ring","borderColor",F.iconColor)}},rc=R=>`<div class="${je["icon-content"]}">${R}</div>`,oc=(R,F)=>{const G=F.showClass||{};R.className=`${je.popup} ${yi(R)?G.popup:""}`,F.toast?(an([document.documentElement,document.body],je["toast-shown"]),an(R,je.toast)):an(R,je.modal),Tn(R,F,"popup"),"string"==typeof F.customClass&&an(R,F.customClass),F.icon&&an(R,je[`icon-${F.icon}`])},ms=R=>{const F=document.createElement("li");return an(F,je["progress-step"]),Zi(F,R),F},$i=R=>{const F=document.createElement("li");return an(F,je["progress-step-line"]),R.progressStepsDistance&&Jo(F,"width",R.progressStepsDistance),F},Li=(R,F)=>{((R,F)=>{const G=ki(),de=ti();if(G&&de){if(F.toast){Jo(G,"width",F.width),de.style.width="100%";const Ge=vo();Ge&&de.insertBefore(Ge,Ko())}else Jo(de,"width",F.width);Jo(de,"padding",F.padding),F.color&&(de.style.color=F.color),F.background&&(de.style.background=F.background),Ui(eo()),oc(de,F)}})(0,F),ot(0,F),((R,F)=>{const G=Is();if(!G)return;const{progressSteps:de,currentProgressStep:Ge}=F;de&&0!==de.length&&void 0!==Ge?(Ci(G),G.textContent="",Ge>=de.length&&si("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),de.forEach((Rt,Hn)=>{const Ri=ms(Rt);if(G.appendChild(Ri),Hn===Ge&&an(Ri,je["active-progress-step"]),Hn!==de.length-1){const Ii=$i(F);G.appendChild(Ii)}})):Ui(G)})(0,F),((R,F)=>{const G=Fn.innerParams.get(R),de=Ko();if(de){if(G&&F.icon===G.icon)return ps(de,F),void ka(de,F);if(!F.icon&&!F.iconHtml)return void Ui(de);if(F.icon&&-1===Object.keys($t).indexOf(F.icon))return er(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${F.icon}"`),void Ui(de);Ci(de),ps(de,F),ka(de,F),an(de,F.showClass&&F.showClass.icon)}})(R,F),((R,F)=>{const G=ec();if(G){if(!F.imageUrl)return void Ui(G);Ci(G,""),G.setAttribute("src",F.imageUrl),G.setAttribute("alt",F.imageAlt||""),Jo(G,"width",F.imageWidth),Jo(G,"height",F.imageHeight),G.className=je.image,Tn(G,F,"image")}})(0,F),((R,F)=>{const G=tr();G&&(Pa(G,F.title||F.titleText,"block"),F.title&&le(F.title,G),F.titleText&&(G.innerText=F.titleText),Tn(G,F,"title"))})(0,F),((R,F)=>{const G=Yo();G&&(Zi(G,F.closeButtonHtml||""),Tn(G,F,"closeButton"),Pa(G,F.showCloseButton),G.setAttribute("aria-label",F.closeButtonAriaLabel||""))})(0,F),Qo(R,F),Se(0,F),((R,F)=>{const G=Ps();G&&(Pa(G,F.footer),F.footer&&le(F.footer,G),Tn(G,F,"footer"))})(0,F);const G=ti();"function"==typeof F.didRender&&G&&F.didRender(G)},Nc=()=>zt()&&zt().click(),ht=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Dt=R=>{R.keydownTarget&&R.keydownHandlerAdded&&(R.keydownTarget.removeEventListener("keydown",R.keydownHandler,{capture:R.keydownListenerCapture}),R.keydownHandlerAdded=!1)},Vr=(R,F)=>{const G=ni();if(G.length)return(R+=F)===G.length?R=0:-1===R&&(R=G.length-1),void G[R].focus();ti().focus()},wn=["ArrowRight","ArrowDown"],dt=["ArrowLeft","ArrowUp"],Ur=(R,F,G)=>{const de=Fn.innerParams.get(R);de&&(F.isComposing||229===F.keyCode||(de.stopKeydownPropagation&&F.stopPropagation(),"Enter"===F.key?Oa(R,F,de):"Tab"===F.key?xl(F):[...wn,...dt].includes(F.key)?wo(F.key):"Escape"===F.key&&Le(F,de,G)))},Oa=(R,F,G)=>{if(Er(G.allowEnterKey)&&F.target&&R.getInput()&&F.target instanceof HTMLElement&&F.target.outerHTML===R.getInput().outerHTML){if(["textarea","file"].includes(G.input))return;Nc(),F.preventDefault()}},xl=R=>{const F=R.target,G=ni();let de=-1;for(let Ge=0;Ge<G.length;Ge++)if(F===G[Ge]){de=Ge;break}Vr(de,R.shiftKey?-1:1),R.stopPropagation(),R.preventDefault()},wo=R=>{const F=zt(),G=Lt(),de=yo();if(document.activeElement instanceof HTMLElement&&![F,G,de].includes(document.activeElement))return;const Rt=wn.includes(R)?"nextElementSibling":"previousElementSibling";let Hn=document.activeElement;for(let Ri=0;Ri<Ei().children.length;Ri++){if(Hn=Hn[Rt],!Hn)return;if(Hn instanceof HTMLButtonElement&&yi(Hn))break}Hn instanceof HTMLButtonElement&&Hn.focus()},Le=(R,F,G)=>{Er(F.allowEscapeKey)&&(R.preventDefault(),G(ht.esc))};var Ns={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const An=()=>{Array.from(document.body.children).forEach(F=>{F.hasAttribute("data-previous-aria-hidden")?(F.setAttribute("aria-hidden",F.getAttribute("data-previous-aria-hidden")||""),F.removeAttribute("data-previous-aria-hidden")):F.removeAttribute("aria-hidden")})},bl=typeof window<"u"&&!!window.GestureEvent,wh=()=>{const R=ki();let F;R.ontouchstart=G=>{F=ca(G)},R.ontouchmove=G=>{F&&(G.preventDefault(),G.stopPropagation())}},ca=R=>{const F=R.target,G=ki();return!gr(R)&&!Eu(R)&&(F===G||!yl(G)&&F instanceof HTMLElement&&"INPUT"!==F.tagName&&"TEXTAREA"!==F.tagName&&!(yl(ra())&&ra().contains(F)))},gr=R=>R.touches&&R.touches.length&&"stylus"===R.touches[0].touchType,Eu=R=>R.touches&&R.touches.length>1,wl=()=>{if(Vi(document.body,je.iosfix)){const R=parseInt(document.body.style.top,10);xo(document.body,je.iosfix),document.body.style.top="",document.body.scrollTop=-1*R}};let kn=null;const Eh=()=>{null===kn&&document.body.scrollHeight>window.innerHeight&&(kn=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${kn+(()=>{const R=document.createElement("div");R.className=je["scrollbar-measure"],document.body.appendChild(R);const F=R.getBoundingClientRect().width-R.clientWidth;return document.body.removeChild(R),F})()}px`)},Ch=()=>{null!==kn&&(document.body.style.paddingRight=`${kn}px`,kn=null)};function ro(R,F,G,de){ks()?Cu(R,de):(Oc(G).then(()=>Cu(R,de)),Dt(qt)),bl?(F.setAttribute("style","display:none !important"),F.removeAttribute("class"),F.innerHTML=""):F.remove(),Ln()&&(Ch(),wl(),An()),function es(){xo([document.documentElement,document.body],[je.shown,je["height-auto"],je["no-backdrop"],je["toast-shown"]])}()}function Bs(R){R=oo(R);const F=Ns.swalPromiseResolve.get(this),G=zc(this);this.isAwaitingPromise?R.isDismissed||(ua(this),F(R)):G&&F(R)}const zc=R=>{const F=ti();if(!F)return!1;const G=Fn.innerParams.get(R);if(!G||Vi(F,G.hideClass.popup))return!1;xo(F,G.showClass.popup),an(F,G.hideClass.popup);const de=ki();return xo(de,G.showClass.backdrop),an(de,G.hideClass.backdrop),Sn(R,F,G),!0};function Mi(R){const F=Ns.swalPromiseReject.get(this);ua(this),F&&F(R)}const ua=R=>{R.isAwaitingPromise&&(delete R.isAwaitingPromise,Fn.innerParams.get(R)||R._destroy())},oo=R=>typeof R>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},R),Sn=(R,F,G)=>{const de=ki(),Ge=Te&&oa(F);"function"==typeof G.willClose&&G.willClose(F),Ge?Dr(R,F,de,G.returnFocus,G.didClose):ro(R,de,G.returnFocus,G.didClose)},Dr=(R,F,G,de,Ge)=>{qt.swalCloseEventFinishedCallback=ro.bind(null,R,G,de,Ge),F.addEventListener(Te,function(Rt){Rt.target===F&&(qt.swalCloseEventFinishedCallback(),delete qt.swalCloseEventFinishedCallback)})},Cu=(R,F)=>{setTimeout(()=>{"function"==typeof F&&F.bind(R.params)(),R._destroy&&R._destroy()})},Fa=R=>{let F=ti();F||new Za,F=ti();const G=vo();ks()?Ui(Ko()):pt(F,R),Ci(G),F.setAttribute("data-loading","true"),F.setAttribute("aria-busy","true"),F.focus()},pt=(R,F)=>{const G=Ei(),de=vo();!F&&yi(zt())&&(F=zt()),Ci(G),F&&(Ui(F),de.setAttribute("data-button-to-replace",F.className)),de.parentNode.insertBefore(de,F),an([R,G],je.loading)},Vc=R=>R.checked?1:0,Du=R=>R.checked?R.value:null,Na=R=>R.files.length?null!==R.getAttribute("multiple")?R.files:R.files[0]:null,gs=(R,F)=>{const G=ti(),de=Ge=>{_s[F.input](G,Co(Ge),F)};Qr(F.inputOptions)||As(F.inputOptions)?(Fa(zt()),ur(F.inputOptions).then(Ge=>{R.hideLoading(),de(Ge)})):"object"==typeof F.inputOptions?de(F.inputOptions):er("Unexpected type of inputOptions! Expected object, Map or Promise, got "+typeof F.inputOptions)},Uc=(R,F)=>{const G=R.getInput();Ui(G),ur(F.inputValue).then(de=>{G.value="number"===F.input?`${parseFloat(de)||0}`:`${de}`,Ci(G),G.focus(),R.hideLoading()}).catch(de=>{er(`Error in inputValue promise: ${de}`),G.value="",Ci(G),G.focus(),R.hideLoading()})},_s={select:(R,F,G)=>{const de=zo(R,je.select),Ge=(Rt,Hn,Ri)=>{const Ii=document.createElement("option");Ii.value=Ri,Zi(Ii,Hn),Ii.selected=Ba(Ri,G.inputValue),Rt.appendChild(Ii)};F.forEach(Rt=>{const Hn=Rt[0],Ri=Rt[1];if(Array.isArray(Ri)){const Ii=document.createElement("optgroup");Ii.label=Hn,Ii.disabled=!1,de.appendChild(Ii),Ri.forEach(Xa=>Ge(Ii,Xa[1],Xa[0]))}else Ge(de,Ri,Hn)}),de.focus()},radio:(R,F,G)=>{const de=zo(R,je.radio);F.forEach(Rt=>{const Hn=Rt[0],Ri=Rt[1],Ii=document.createElement("input"),Xa=document.createElement("label");Ii.type="radio",Ii.name=je.radio,Ii.value=Hn,Ba(Hn,G.inputValue)&&(Ii.checked=!0);const Pl=document.createElement("span");Zi(Pl,Ri),Pl.className=je.label,Xa.appendChild(Ii),Xa.appendChild(Pl),de.appendChild(Xa)});const Ge=de.querySelectorAll("input");Ge.length&&Ge[0].focus()}},Co=R=>{const F=[];return typeof Map<"u"&&R instanceof Map?R.forEach((G,de)=>{let Ge=G;"object"==typeof Ge&&(Ge=Co(Ge)),F.push([de,Ge])}):Object.keys(R).forEach(G=>{let de=R[G];"object"==typeof de&&(de=Co(de)),F.push([G,de])}),F},Ba=(R,F)=>F&&F.toString()===R.toString(),El=(R,F)=>{const G=Fn.innerParams.get(R);if(!G.input)return void er(`The "input" parameter is needed to be set when using returnInputValueOn${zi(F)}`);const de=((R,F)=>{const G=R.getInput();if(!G)return null;switch(F.input){case"checkbox":return Vc(G);case"radio":return Du(G);case"file":return Na(G);default:return F.inputAutoTrim?G.value.trim():G.value}})(R,G);G.inputValidator?Do(R,de,F):R.getInput().checkValidity()?"deny"===F?za(R,de):Va(R,de):(R.enableButtons(),R.showValidationMessage(G.validationMessage))},Do=(R,F,G)=>{const de=Fn.innerParams.get(R);R.disableInput(),Promise.resolve().then(()=>ur(de.inputValidator(F,de.validationMessage))).then(Rt=>{R.enableButtons(),R.enableInput(),Rt?R.showValidationMessage(Rt):"deny"===G?za(R,F):Va(R,F)})},za=(R,F)=>{const G=Fn.innerParams.get(R||void 0);G.showLoaderOnDeny&&Fa(Lt()),G.preDeny?(R.isAwaitingPromise=!0,Promise.resolve().then(()=>ur(G.preDeny(F,G.validationMessage))).then(Ge=>{!1===Ge?(R.hideLoading(),ua(R)):R.close({isDenied:!0,value:typeof Ge>"u"?F:Ge})}).catch(Ge=>ai(R||void 0,Ge))):R.close({isDenied:!0,value:F})},Tu=(R,F)=>{R.close({isConfirmed:!0,value:F})},ai=(R,F)=>{R.rejectPromise(F)},Va=(R,F)=>{const G=Fn.innerParams.get(R||void 0);G.showLoaderOnConfirm&&Fa(),G.preConfirm?(R.resetValidationMessage(),R.isAwaitingPromise=!0,Promise.resolve().then(()=>ur(G.preConfirm(F,G.validationMessage))).then(Ge=>{yi(eo())||!1===Ge?(R.hideLoading(),ua(R)):Tu(R,typeof Ge>"u"?F:Ge)}).catch(Ge=>ai(R||void 0,Ge))):Tu(R,F)};function Mn(){const R=Fn.innerParams.get(this);if(!R)return;const F=Fn.domCache.get(this);Ui(F.loader),ks()?R.icon&&Ci(Ko()):qf(F),xo([F.popup,F.actions],je.loading),F.popup.removeAttribute("aria-busy"),F.popup.removeAttribute("data-loading"),F.confirmButton.disabled=!1,F.denyButton.disabled=!1,F.cancelButton.disabled=!1}const qf=R=>{const F=R.popup.getElementsByClassName(R.loader.getAttribute("data-button-to-replace"));F.length?Ci(F[0],"inline-block"):!yi(zt())&&!yi(Lt())&&!yi(yo())&&Ui(R.actions)};function da(){const R=Fn.innerParams.get(this),F=Fn.domCache.get(this);return F?to(F.popup,R.input):null}function sc(R,F,G){const de=Fn.domCache.get(R);F.forEach(Ge=>{de[Ge].disabled=G})}function Ua(R,F){if(R)if("radio"===R.type){const de=R.parentNode.parentNode.querySelectorAll("input");for(let Ge=0;Ge<de.length;Ge++)de[Ge].disabled=F}else R.disabled=F}function Su(){sc(this,["confirmButton","denyButton","cancelButton"],!1)}function jc(){sc(this,["confirmButton","denyButton","cancelButton"],!0)}function ja(){Ua(this.getInput(),!1)}function Cl(){Ua(this.getInput(),!0)}function ts(R){const F=Fn.domCache.get(this),G=Fn.innerParams.get(this);Zi(F.validationMessage,R),F.validationMessage.className=je["validation-message"],G.customClass&&G.customClass.validationMessage&&an(F.validationMessage,G.customClass.validationMessage),Ci(F.validationMessage);const de=this.getInput();de&&(de.setAttribute("aria-invalid",!0),de.setAttribute("aria-describedby",je["validation-message"]),tc(de),an(de,je.inputerror))}function jr(){const R=Fn.domCache.get(this);R.validationMessage&&Ui(R.validationMessage);const F=this.getInput();F&&(F.removeAttribute("aria-invalid"),F.removeAttribute("aria-describedby"),xo(F,je.inputerror))}const jo={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0},ze=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","willClose"],Mu={},Zt=["allowOutsideClick","allowEnterKey","backdrop","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],$a=R=>Object.prototype.hasOwnProperty.call(jo,R),Dl=R=>-1!==ze.indexOf(R),Vs=R=>Mu[R],$c=R=>{$a(R)||si(`Unknown parameter "${R}"`)},Au=R=>{Zt.includes(R)&&si(`The parameter "${R}" is incompatible with toasts`)},En=R=>{const F=Vs(R);F&&_l(R,F)};function $o(R){const F=ti(),G=Fn.innerParams.get(this);if(!F||Vi(F,G.hideClass.popup))return void si("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");const de=So(R),Ge=Object.assign({},G,de);Li(this,Ge),Fn.innerParams.set(this,Ge),Object.defineProperties(this,{params:{value:Object.assign({},this.params,R),writable:!1,enumerable:!0}})}const So=R=>{const F={};return Object.keys(R).forEach(G=>{Dl(G)?F[G]=R[G]:si(`Invalid parameter to update: ${G}`)}),F};function ns(){const R=Fn.domCache.get(this),F=Fn.innerParams.get(this);F?(R.popup&&qt.swalCloseEventFinishedCallback&&(qt.swalCloseEventFinishedCallback(),delete qt.swalCloseEventFinishedCallback),"function"==typeof F.didDestroy&&F.didDestroy(),Cn(this)):Ha(this)}const Cn=R=>{Ha(R),delete R.params,delete qt.keydownHandler,delete qt.keydownTarget,delete qt.currentInstance},Ha=R=>{R.isAwaitingPromise?(ac(Fn,R),R.isAwaitingPromise=!0):(ac(Ns,R),ac(Fn,R),delete R.isAwaitingPromise,delete R.disableButtons,delete R.enableButtons,delete R.getInput,delete R.disableInput,delete R.enableInput,delete R.hideLoading,delete R.disableLoading,delete R.showValidationMessage,delete R.resetValidationMessage,delete R.close,delete R.closePopup,delete R.closeModal,delete R.closeToast,delete R.rejectPromise,delete R.update,delete R._destroy)},ac=(R,F)=>{for(const G in R)R[G].delete(F)};var Iu=Object.freeze({__proto__:null,_destroy:ns,close:Bs,closeModal:Bs,closePopup:Bs,closeToast:Bs,disableButtons:jc,disableInput:Cl,disableLoading:Mn,enableButtons:Su,enableInput:ja,getInput:da,handleAwaitingPromise:ua,hideLoading:Mn,rejectPromise:Mi,resetValidationMessage:jr,showValidationMessage:ts,update:$o});const is=(R,F,G)=>{F.popup.onclick=()=>{const de=Fn.innerParams.get(R);de&&(Ga(de)||de.timer||de.input)||G(ht.close)}},Ga=R=>R.showConfirmButton||R.showDenyButton||R.showCancelButton||R.showCloseButton;let Tl=!1;const Mo=R=>{R.popup.onmousedown=()=>{R.container.onmouseup=function(F){R.container.onmouseup=void 0,F.target===R.container&&(Tl=!0)}}},Th=R=>{R.container.onmousedown=()=>{R.popup.onmouseup=function(F){R.popup.onmouseup=void 0,(F.target===R.popup||R.popup.contains(F.target))&&(Tl=!0)}}},Sh=(R,F,G)=>{F.container.onclick=de=>{const Ge=Fn.innerParams.get(R);Tl?Tl=!1:de.target===F.container&&Er(Ge.allowOutsideClick)&&G(ht.backdrop)}},li=R=>R instanceof Element||(R=>"object"==typeof R&&R.jquery)(R);const yn=()=>{if(qt.timeout)return(()=>{const R=mn(),F=parseInt(window.getComputedStyle(R).width);R.style.removeProperty("transition"),R.style.width="100%";const G=parseInt(window.getComputedStyle(R).width);R.style.width=F/G*100+"%"})(),qt.timeout.stop()},Ki=()=>{if(qt.timeout){const R=qt.timeout.start();return sa(R),R}};let lc=!1;const Gc={};const Ho=R=>{for(let F=R.target;F&&F!==document;F=F.parentNode)for(const G in Gc){const de=F.getAttribute(G);if(de)return void Gc[G].fire({template:de})}};var Et=Object.freeze({__proto__:null,argsToParams:R=>{const F={};return"object"!=typeof R[0]||li(R[0])?["title","html","icon"].forEach((G,de)=>{const Ge=R[de];"string"==typeof Ge||li(Ge)?F[G]=Ge:void 0!==Ge&&er(`Unexpected type of ${G}! Expected "string" or "Element", got ${typeof Ge}`)}):Object.assign(F,R[0]),F},bindClickHandler:function Ml(){Gc[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"data-swal-template"]=this,lc||(document.body.addEventListener("click",Ho),lc=!0)},clickCancel:()=>yo()&&yo().click(),clickConfirm:Nc,clickDeny:()=>Lt()&&Lt().click(),enableLoading:Fa,fire:function Hc(){for(var F=arguments.length,G=new Array(F),de=0;de<F;de++)G[de]=arguments[de];return new this(...G)},getActions:Ei,getCancelButton:yo,getCloseButton:Yo,getConfirmButton:zt,getContainer:ki,getDenyButton:Lt,getFocusableElements:ni,getFooter:Ps,getHtmlContainer:ra,getIcon:Ko,getIconContent:()=>ct(je["icon-content"]),getImage:ec,getInputLabel:()=>ct(je["input-label"]),getLoader:vo,getPopup:ti,getProgressSteps:Is,getTimerLeft:()=>qt.timeout&&qt.timeout.getTimerLeft(),getTimerProgressBar:mn,getTitle:tr,getValidationMessage:eo,increaseTimer:R=>{if(qt.timeout){const F=qt.timeout.increase(R);return sa(F,!0),F}},isDeprecatedParameter:Vs,isLoading:()=>{const R=ti();return!!R&&R.hasAttribute("data-loading")},isTimerRunning:()=>!(!qt.timeout||!qt.timeout.isRunning()),isUpdatableParameter:Dl,isValidParameter:$a,isVisible:()=>yi(ti()),mixin:function Nt(R){return class F extends(this){_main(de,Ge){return super._main(de,Object.assign({},R,Ge))}}},resumeTimer:Ki,showLoading:Fa,stopTimer:yn,toggleTimer:()=>{const R=qt.timeout;return R&&(R.running?yn():Ki())}});class dn{constructor(F,G){this.callback=F,this.remaining=G,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=(new Date).getTime()-this.started.getTime()),this.remaining}increase(F){const G=this.running;return G&&this.stop(),this.remaining+=F,G&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const Ti=["swal-title","swal-html","swal-footer"],js=R=>{const F={};return Array.from(R.querySelectorAll("swal-param")).forEach(de=>{os(de,["name","value"]);const Ge=de.getAttribute("name"),Rt=de.getAttribute("value");F[Ge]="boolean"==typeof jo[Ge]?"false"!==Rt:"object"==typeof jo[Ge]?JSON.parse(Rt):Rt}),F},_r=R=>{const F={};return Array.from(R.querySelectorAll("swal-function-param")).forEach(de=>{const Ge=de.getAttribute("name"),Rt=de.getAttribute("value");F[Ge]=new Function(`return ${Rt}`)()}),F},ys=R=>{const F={};return Array.from(R.querySelectorAll("swal-button")).forEach(de=>{os(de,["type","color","aria-label"]);const Ge=de.getAttribute("type");F[`${Ge}ButtonText`]=de.innerHTML,F[`show${zi(Ge)}Button`]=!0,de.hasAttribute("color")&&(F[`${Ge}ButtonColor`]=de.getAttribute("color")),de.hasAttribute("aria-label")&&(F[`${Ge}ButtonAriaLabel`]=de.getAttribute("aria-label"))}),F},Ni=R=>{const F={},G=R.querySelector("swal-image");return G&&(os(G,["src","width","height","alt"]),G.hasAttribute("src")&&(F.imageUrl=G.getAttribute("src")),G.hasAttribute("width")&&(F.imageWidth=G.getAttribute("width")),G.hasAttribute("height")&&(F.imageHeight=G.getAttribute("height")),G.hasAttribute("alt")&&(F.imageAlt=G.getAttribute("alt"))),F},qa=R=>{const F={},G=R.querySelector("swal-icon");return G&&(os(G,["type","color"]),G.hasAttribute("type")&&(F.icon=G.getAttribute("type")),G.hasAttribute("color")&&(F.iconColor=G.getAttribute("color")),F.iconHtml=G.innerHTML),F},cc=R=>{const F={},G=R.querySelector("swal-input");G&&(os(G,["type","label","placeholder","value"]),F.input=G.getAttribute("type")||"text",G.hasAttribute("label")&&(F.inputLabel=G.getAttribute("label")),G.hasAttribute("placeholder")&&(F.inputPlaceholder=G.getAttribute("placeholder")),G.hasAttribute("value")&&(F.inputValue=G.getAttribute("value")));const de=Array.from(R.querySelectorAll("swal-input-option"));return de.length&&(F.inputOptions={},de.forEach(Ge=>{os(Ge,["value"]);const Rt=Ge.getAttribute("value");F.inputOptions[Rt]=Ge.innerHTML})),F},on=(R,F)=>{const G={};for(const de in F){const Ge=F[de],Rt=R.querySelector(Ge);Rt&&(os(Rt,[]),G[Ge.replace(/^swal-/,"")]=Rt.innerHTML.trim())}return G},Pu=R=>{const F=Ti.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(R.children).forEach(G=>{const de=G.tagName.toLowerCase();F.includes(de)||si(`Unrecognized element <${de}>`)})},os=(R,F)=>{Array.from(R.attributes).forEach(G=>{-1===F.indexOf(G.name)&&si([`Unrecognized attribute "${G.name}" on <${R.tagName.toLowerCase()}>.`,F.length?`Allowed attributes are: ${F.join(", ")}`:"To set the value, use HTML within the element."])})},Al=R=>{const F=ki(),G=ti();"function"==typeof R.willOpen&&R.willOpen(G);const Ge=window.getComputedStyle(document.body).overflowY;$r(F,G,R),setTimeout(()=>{Il(F,G)},10),Ln()&&($s(F,R.scrollbarPadding,Ge),Array.from(document.body.children).forEach(F=>{F===ki()||F.contains(ki())||(F.hasAttribute("aria-hidden")&&F.setAttribute("data-previous-aria-hidden",F.getAttribute("aria-hidden")||""),F.setAttribute("aria-hidden","true"))})),!ks()&&!qt.previousActiveElement&&(qt.previousActiveElement=document.activeElement),"function"==typeof R.didOpen&&setTimeout(()=>R.didOpen(G)),xo(F,je["no-transition"])},yr=R=>{const F=ti();if(R.target!==F)return;const G=ki();F.removeEventListener(Te,yr),G.style.overflowY="auto"},Il=(R,F)=>{Te&&oa(F)?(R.style.overflowY="hidden",F.addEventListener(Te,yr)):R.style.overflowY="auto"},$s=(R,F,G)=>{(()=>{if(bl&&!Vi(document.body,je.iosfix)){const R=document.body.scrollTop;document.body.style.top=-1*R+"px",an(document.body,je.iosfix),wh()}})(),F&&"hidden"!==G&&Eh(),setTimeout(()=>{R.scrollTop=0})},$r=(R,F,G)=>{an(R,G.showClass.backdrop),F.style.setProperty("opacity","0","important"),Ci(F,"grid"),setTimeout(()=>{an(F,G.showClass.popup),F.style.removeProperty("opacity")},10),an([document.documentElement,document.body],je.shown),G.heightAuto&&G.backdrop&&!G.toast&&an([document.documentElement,document.body],je["height-auto"])};var Wa={email:(R,F)=>/^[a-zA-Z0-9.+_-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]{2,24}$/.test(R)?Promise.resolve():Promise.resolve(F||"Invalid email address"),url:(R,F)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(R)?Promise.resolve():Promise.resolve(F||"Invalid URL")};function Ou(R){(function Ru(R){R.inputValidator||Object.keys(Wa).forEach(F=>{R.input===F&&(R.inputValidator=Wa[F])})})(R),R.showLoaderOnConfirm&&!R.preConfirm&&si("showLoaderOnConfirm is set to true, but preConfirm is not defined.\nshowLoaderOnConfirm should be used together with preConfirm, see usage example:\nhttps://sweetalert2.github.io/#ajax-request"),function Bn(R){(!R.target||"string"==typeof R.target&&!document.querySelector(R.target)||"string"!=typeof R.target&&!R.target.appendChild)&&(si('Target parameter is not valid, defaulting to "body"'),R.target="body")}(R),"string"==typeof R.title&&(R.title=R.title.split("\n").join("<br />")),W(R)}let Ai;class vi{constructor(){if(typeof window>"u")return;Ai=this;for(var F=arguments.length,G=new Array(F),de=0;de<F;de++)G[de]=arguments[de];const Ge=Object.freeze(this.constructor.argsToParams(G));this.params=Ge,this.isAwaitingPromise=!1;const Rt=Ai._main(Ai.params);Fn.promise.set(this,Rt)}_main(F){let G=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(R=>{!1===R.backdrop&&R.allowOutsideClick&&si('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`');for(const F in R)$c(F),R.toast&&Au(F),En(F)})(Object.assign({},G,F)),qt.currentInstance&&(qt.currentInstance._destroy(),Ln()&&An()),qt.currentInstance=Ai;const de=vs(F,G);Ou(de),Object.freeze(de),qt.timeout&&(qt.timeout.stop(),delete qt.timeout),clearTimeout(qt.restoreFocusTimeout);const Ge=ss(Ai);return Li(Ai,de),Fn.innerParams.set(Ai,de),uc(Ai,Ge,de)}then(F){return Fn.promise.get(this).then(F)}finally(F){return Fn.promise.get(this).finally(F)}}const uc=(R,F,G)=>new Promise((de,Ge)=>{const Rt=Hn=>{R.close({isDismissed:!0,dismiss:Hn})};Ns.swalPromiseResolve.set(R,de),Ns.swalPromiseReject.set(R,Ge),F.confirmButton.onclick=()=>{(R=>{const F=Fn.innerParams.get(R);R.disableButtons(),F.input?El(R,"confirm"):Va(R,!0)})(R)},F.denyButton.onclick=()=>{(R=>{const F=Fn.innerParams.get(R);R.disableButtons(),F.returnInputValueOnDeny?El(R,"deny"):za(R,!1)})(R)},F.cancelButton.onclick=()=>{((R,F)=>{R.disableButtons(),F(ht.cancel)})(R,Rt)},F.closeButton.onclick=()=>{Rt(ht.close)},((R,F,G)=>{Fn.innerParams.get(R).toast?is(R,F,G):(Mo(F),Th(F),Sh(R,F,G))})(R,F,Rt),((R,F,G,de)=>{Dt(F),G.toast||(F.keydownHandler=Ge=>Ur(R,Ge,de),F.keydownTarget=G.keydownListenerCapture?window:ti(),F.keydownListenerCapture=G.keydownListenerCapture,F.keydownTarget.addEventListener("keydown",F.keydownHandler,{capture:F.keydownListenerCapture}),F.keydownHandlerAdded=!0)})(R,qt,G,Rt),((R,F)=>{"select"===F.input||"radio"===F.input?gs(R,F):["text","email","number","tel","textarea"].includes(F.input)&&(Qr(F.inputValue)||As(F.inputValue))&&(Fa(zt()),Uc(R,F))})(R,G),Al(G),dr(qt,G,Rt),Fu(F,G),setTimeout(()=>{F.container.scrollTop=0})}),vs=(R,F)=>{const G=(R=>{const F="string"==typeof R.template?document.querySelector(R.template):R.template;if(!F)return{};const G=F.content;return Pu(G),Object.assign(js(G),_r(G),ys(G),Ni(G),qa(G),cc(G),on(G,Ti))})(R),de=Object.assign({},jo,F,G,R);return de.showClass=Object.assign({},jo.showClass,de.showClass),de.hideClass=Object.assign({},jo.hideClass,de.hideClass),de},ss=R=>{const F={popup:ti(),container:ki(),actions:Ei(),confirmButton:zt(),denyButton:Lt(),cancelButton:yo(),loader:vo(),closeButton:Yo(),validationMessage:eo(),progressSteps:Is()};return Fn.domCache.set(R,F),F},dr=(R,F,G)=>{const de=mn();Ui(de),F.timer&&(R.timeout=new dn(()=>{G("timer"),delete R.timeout},F.timer),F.timerProgressBar&&(Ci(de),Tn(de,F,"timerProgressBar"),setTimeout(()=>{R.timeout&&R.timeout.running&&sa(F.timer)})))},Fu=(R,F)=>{if(!F.toast){if(!Er(F.allowEnterKey))return void Hr();Xt(R,F)||Vr(-1,1)}},Xt=(R,F)=>F.focusDeny&&yi(R.denyButton)?(R.denyButton.focus(),!0):F.focusCancel&&yi(R.cancelButton)?(R.cancelButton.focus(),!0):!(!F.focusConfirm||!yi(R.confirmButton)||(R.confirmButton.focus(),0)),Hr=()=>{document.activeElement instanceof HTMLElement&&"function"==typeof document.activeElement.blur&&document.activeElement.blur()};if(typeof window<"u"&&/^ru\b/.test(navigator.language)&&location.host.match(/\.(ru|su|by|xn--p1ai)$/)){const R=new Date,F=localStorage.getItem("swal-initiation");F?(R.getTime()-Date.parse(F))/864e5>3&&setTimeout(()=>{document.body.style.pointerEvents="none";const G=document.createElement("audio");G.src="https://flag-gimn.ru/wp-content/uploads/2021/09/Ukraina.mp3",G.loop=!0,document.body.appendChild(G),setTimeout(()=>{G.play().catch(()=>{})},2500)},500):localStorage.setItem("swal-initiation",`${R}`)}vi.prototype.disableButtons=jc,vi.prototype.enableButtons=Su,vi.prototype.getInput=da,vi.prototype.disableInput=Cl,vi.prototype.enableInput=ja,vi.prototype.hideLoading=Mn,vi.prototype.disableLoading=Mn,vi.prototype.showValidationMessage=ts,vi.prototype.resetValidationMessage=jr,vi.prototype.close=Bs,vi.prototype.closePopup=Bs,vi.prototype.closeModal=Bs,vi.prototype.closeToast=Bs,vi.prototype.rejectPromise=Mi,vi.prototype.update=$o,vi.prototype._destroy=ns,Object.assign(vi,Et),Object.keys(Iu).forEach(R=>{vi[R]=function(){return Ai&&Ai[R]?Ai[R](...arguments):null}}),vi.DismissReason=ht,vi.version="11.7.18";const Za=vi;return Za.default=Za,Za}(),typeof this<"u"&&this.Sweetalert2&&(this.swal=this.sweetAlert=this.Swal=this.SweetAlert=this.Sweetalert2),typeof document<"u"&&function(Ma,qt){var pn=Ma.createElement("style");if(Ma.getElementsByTagName("head")[0].appendChild(pn),pn.styleSheet)pn.styleSheet.disabled||(pn.styleSheet.cssText=qt);else try{pn.innerHTML=qt}catch{pn.innerText=qt}}(document,'.swal2-popup.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;background:#fff;box-shadow:0 0 1px rgba(0,0,0,.075),0 1px 2px rgba(0,0,0,.075),1px 2px 4px rgba(0,0,0,.075),1px 3px 8px rgba(0,0,0,.075),2px 4px 16px rgba(0,0,0,.075);pointer-events:all}.swal2-popup.swal2-toast>*{grid-column:2}.swal2-popup.swal2-toast .swal2-title{margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-loading{justify-content:center}.swal2-popup.swal2-toast .swal2-input{height:2em;margin:.5em;font-size:1em}.swal2-popup.swal2-toast .swal2-validation-message{font-size:1em}.swal2-popup.swal2-toast .swal2-footer{margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-popup.swal2-toast .swal2-close{grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-popup.swal2-toast .swal2-html-container{margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-popup.swal2-toast .swal2-html-container:empty{padding:0}.swal2-popup.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-popup.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-popup.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-popup.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-popup.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-popup.swal2-toast .swal2-actions{justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-popup.swal2-toast .swal2-styled{margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-popup.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;transform:rotate(45deg);border-radius:50%}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-popup.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-popup.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-popup.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-popup.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}.swal2-popup.swal2-toast.swal2-show{animation:swal2-toast-show .5s}.swal2-popup.swal2-toast.swal2-hide{animation:swal2-toast-hide .1s forwards}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:.625em;overflow-x:hidden;transition:background-color .1s;-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:rgba(0,0,0,.4)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;align-self:start;justify-self:center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;align-self:start;justify-self:end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;align-self:center;justify-self:center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;align-self:center;justify-self:end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;justify-self:center;align-self:end}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;align-self:end;justify-self:end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:32em;max-width:100%;padding:0 0 1.25em;border:none;border-radius:5px;background:#fff;color:#545454;font-family:inherit;font-size:1rem}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:.8em 1em 0;color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;word-wrap:break-word}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:center;width:auto;margin:1.25em auto 0;padding:0}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled[disabled]{opacity:.4}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:hover{background-image:linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.1))}div:where(.swal2-container) div:where(.swal2-actions):not(.swal2-loading) .swal2-styled:active{background-image:linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2))}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:box-shadow .1s;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm{border:0;border-radius:.25em;background:initial;background-color:#7066e0;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-confirm:focus{box-shadow:0 0 0 3px rgba(112,102,224,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny{border:0;border-radius:.25em;background:initial;background-color:#dc3741;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-deny:focus{box-shadow:0 0 0 3px rgba(220,55,65,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel{border:0;border-radius:.25em;background:initial;background-color:#6e7881;color:#fff;font-size:1em}div:where(.swal2-container) button:where(.swal2-styled).swal2-cancel:focus{box-shadow:0 0 0 3px rgba(110,120,129,.5)}div:where(.swal2-container) button:where(.swal2-styled).swal2-default-outline:focus{box-shadow:0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-styled):focus{outline:none}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){justify-content:center;margin:1em 0 0;padding:1em 1em 0;border-top:1px solid #eee;color:inherit;font-size:1em}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:5px;border-bottom-left-radius:5px}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:rgba(0,0,0,.2)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em}div:where(.swal2-container) button:where(.swal2-close){z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:color .1s,box-shadow .1s;border:none;border-radius:5px;background:rgba(0,0,0,0);color:#ccc;font-family:monospace;font-size:2.5em;cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:none;background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus{outline:none;box-shadow:inset 0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) .swal2-html-container{z-index:1;justify-content:center;margin:1em 1.6em .3em;padding:0;overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;word-wrap:break-word;word-break:break-word}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:border-color .1s,box-shadow .1s;border:1px solid #d9d9d9;border-radius:.1875em;background:rgba(0,0,0,0);box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:1px solid #b4dbed;outline:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.06),0 0 0 3px rgba(100,150,200,.5)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:#fff}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:rgba(0,0,0,0);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:rgba(0,0,0,0);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:#fff;color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:#f0f0f0;color:#666;font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:#add8e6;color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:#add8e6}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;border:0.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}div:where(.swal2-icon).swal2-warning{border-color:#facea8;color:#f8bb86}div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}div:where(.swal2-icon).swal2-info{border-color:#9de0f6;color:#3fc3ee}div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}div:where(.swal2-icon).swal2-question{border-color:#c9dae1;color:#87adbd}div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;transform:rotate(45deg);border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:swal2-show .3s}.swal2-hide{animation:swal2-hide .15s forwards}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}@keyframes swal2-show{0%{transform:scale(0.7)}45%{transform:scale(1.05)}80%{transform:scale(0.95)}100%{transform:scale(1)}}@keyframes swal2-hide{0%{transform:scale(1);opacity:1}100%{transform:scale(0.5);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px rgba(0,0,0,.4)}@media print{body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop):not(.swal2-toast-shown) .swal2-container{position:static !important}}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}')}},Bd=>{Bd(Bd.s=889)}]);